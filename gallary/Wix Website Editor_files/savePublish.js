define("savePublish/managers/savePublishState",[],function(){"use strict";function b(b){a.isSaveInProgress=b}function c(b){a.isPublishInProgress=b}function d(){return a.isPublishInProgress}function e(){return a.isSaveInProgress}function f(){return!a.isPublishInProgress&&!a.isSaveInProgress}var a={isSaveInProgress:!1,isPublishInProgress:!1};return{setSaveProgress:b,setPublishProgress:c,isSaveInProgress:e,isPublishInProgress:d,canSaveOrPublish:f}}),define("savePublish/constants/constants",[],function(){"use strict";return{ERROR_CODES:{SAVE_PUBLISH_DISABLED_ON_SERVER:-10132},SAVE:{SAVE_FAILED_HELP_LINK:"8045e8e4-6f47-4913-8d74-6239f21fffec"}}}),define("savePublish/managers/saveManager",["jquery","lodash","core","panels","util","baseUI","savePublish/managers/savePublishState","savePublish/constants/constants","experiment!googleDomain"],function(a,b,c,d,e,f,g,h,i){"use strict";function o(a){var b=m.domain.isDomainConnected();n={isFirstSave:m.generalInfo.isFirstSave(),isSitePublished:m.generalInfo.isSitePublished(),isDomainConnected:b,domain:b?m.generalInfo.getPublicUrl():m.domain.getFreeDomainPrefix()+m.siteName.get(),isSitePremium:m.site.isPremium(),callback:a}}function p(a){var c=m.domain.isDomainConnected();n=b.merge(n,{isDomainConnected:c,domain:c?m.generalInfo.getPublicUrl():m.domain.getFreeDomainPrefix()+m.siteName.get(),isSitePremium:m.site.isPremium()},a)}function q(){for(var a=20,c=m.siteName.getUsed(),d=e.translate("Save_Publish_Site_Default_Name"),f=m.siteName.sanitize(d.slice(0,a).replace(/\-$/,"").replace(/_/g,"-")),g=1;b.includes(c,f);){var h="-"+g;f=d.slice(0,a-h.length).replace(/\-$/,"").replace(/_/g,"-")+h,g++}return f}function r(){var a=m.generalInfo.getSiteId(),c=m.generalInfo.getMetaSiteId(),d=e.url.parseUrl(window.location.href).query;delete d.siteId,d.metaSiteId=c;var f=b.template(l)({siteId:a});f=e.url.setUrlParams(f,d),window.history&&window.history.replaceState?window.history.replaceState({},"",f):console.error("window.history is not supported in this OLD browser!")}function s(){var a="blog";b.size(m.wixapps.classics.getAllAppPartComps(a))>0&&m.wixapps.classics.reloadApp(a)}function t(a){return b.get(a,"document.errorType")}function u(a){switch(t(a)){case m.errors.save.SITE_NAME_TAKEN:var b="ERROR_SITE_NOT_RENAMED_TITLE_LABEL",c="ERROR_SITE_NOT_RENAMED_BODY_SUBTITLE",d=["ERROR_SITE_NOT_RENAMED_STEP1_TEXT","ERROR_SITE_NOT_RENAMED_STEP2_TEXT","ERROR_SITE_NOT_RENAMED_STEP3_TEXT"],e="ERROR_SITE_NOT_RENAMED_TRY_STEPS";x(a,b,c,e,d);break;default:x(a)}}function v(a,c,e){var f=a||C,g=c||x,h=b.partial(K,f,g,e);d.panelManager.openPanel(j.CONCURRENT_SAVE,{overrideSaveMethod:h,onCancel:c},!0)}function w(a){d.panelManager.openPanel(j.SAVE_REMINDER,{saveMethod:b.partial(O,a,{origin:"remember_to_save_active_save_popup"})},!0)}function x(a,b,c,d,e){y(a)?A():B(a,b,c,d,e)}function y(a){return a&&Number(z(a))===h.ERROR_CODES.SAVE_PUBLISH_DISABLED_ON_SERVER}function z(a){return b.get(a,"document.errorCode")}function A(){var a={titleKey:"SAVE_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnSave"};d.panelManager.openPanel(j.SERVER_SAVE_DISABLED_PANEL,a,!0)}function B(a,b,e,f,g){var i=c.bi.events.save.saveFailed,k=n.isFirstSave,l=a&&a.errorCode;d.panelManager.openPanel(j.SAVE_FAILED,{titleKey:b||"SAVE_ERROR_TITLE_LABEL",description:e||"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",stepsTitle:f||"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION_BOLD",steps:g||["SAVE_PUBLISH_SAVE_ERROR_OPTION_1","SAVE_PUBLISH_SAVE_ERROR_OPTION_2"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:h.SAVE.SAVE_FAILED_HELP_LINK,errorCode:l,biConfirm:k?i.First_Save_error_work_not_saved_error_ok_click:null,biHelp:k?i.First_Save_error_work_not_saved_error_help_center_link_click:null,biCancel:k?i.First_Save_error_work_not_saved_error_close_click:null},!0)}function C(a,c){if(p(),D()){var e=b.clone(n);e.overrideTitle=a,e.overrideSubtitle=c,d.panelManager.openPanel(j.SITE_WAS_SAVED,e,!0)}}function D(){return m&&m.account.isUserOwner()&&!m.wixStores.isSiteInWixStoreTestDrive()}function E(a){a=b(a).pick("overrideTitle","overrideSubtitle").assign({defaultSiteName:q(),freeDomainPrefix:m.domain.getFreeDomainPrefix(),connectDomainHandler:b.partial(I,a.origin),freeDomainHandler:b.partial(G,a.origin)}).value(),d.panelManager.openPanel(j.CHOOSE_DOMAIN,a,!0)}function F(a){d.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:a,isFirstSave:n.isFirstSave,isFirstPublish:!n.isSitePublished,isPremium:n.isSitePremium,flowId:c.constants.CONNECT_DOMAIN.FLOWS.SAVE},!0)}function G(a,b){M(b,C,N,a)}function H(){function a(a){var b={isDomainConnected:a.isDomainConnected,isSitePremium:a.isSitePremium};a.sitePublishedDomain&&(b.domain=a.sitePublishedDomain,m.generalInfo.setPublicUrl(a.sitePublishedDomain)),p(b),C(k.SITE_SAVED_WELCOME_BACK_TITLE,k.SITE_SAVED_WELCOME_BACK_SUBTITLE)}m.site.getSiteDomainInfo(a,C)}function I(a){M(q(),F.bind(this,H),N,a)}function J(a,b,c,d){function e(a,b){g.setSaveProgress(!1),a(b)}g.isSaveInProgress()&&b(),g.setSaveProgress(!0);var f=e.bind(this,a);m.savePublish.save(f,e.bind(this,b),c,d)}function K(a,b,c){J(a,b,!0,c)}function L(a){return m.errors.save.SITE_NAME_TAKEN===t(a)}function M(a,b,c,d){g.isSaveInProgress()||(m.siteName.set(a),J(function(){r(),s(),b()},function(b){L(b)&&m.siteName.markAsUsed(a),c(b)},d))}function N(a,b,c,d){var e=t(b);e===m.errors.save.CONCURRENT_SAVE?v(c,d,a):d?d(b):u(b)}function O(a,d){if(!g.canSaveOrPublish())return void console.error("Site is being saved or published!");d=d||{};var e=d.callback,f=d.origin,h=b.partial(N,f);if(m=a,o(e),n.isFirstSave)i&&a.domain.doesUserOwnGoogleDomain()?M(q(),C,h,f):E(d);else{var j=function(){var a=m.getUserPreferences(),b=c.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN,d=!a||a.session.get(b)!==!0;d?C("SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE"):e&&e()};J(j,h,!1,d.origin)}}function P(a,b,c,d){return g.canSaveOrPublish()?(m=a,o(),void(n.isFirstSave?M(q(),b,c,d):J(b,function(a){N(d,a,b,c)},!1,d))):void console.error("Site is being saved or published!")}function Q(a){function h(){a.generalInfo.isFirstSave()&&(!g.canSaveOrPublish()||k()||a.zoomMode.isInZoomMode()||(w(a),clearTimeout(e)),setTimeout(h,c.constants.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT))}function i(){a.generalInfo.isFirstSave()&&(!g.canSaveOrPublish()||k()||a.zoomMode.isInZoomMode()||(f.tooltipManager.showForDuration("save-button-tooltip",c.constants.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION),a.bi.event(c.bi.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"save tool-tip"})),e=setTimeout(i,c.constants.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT))}function k(){var a=b.filter(d.panelManager.getOpenPanels(),function(a){return b.includes([j.SAVE_REMINDER,j.CHOOSE_DOMAIN],a.name)});return!b.isEmpty(a)}setTimeout(h,c.constants.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT);var e=setTimeout(i,c.constants.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT)}function R(a,c,d){function e(a,b){g.setSaveProgress(!1),g.setPublishProgress(!1),a&&a(b)}g.isSaveInProgress()&&d(),g.setSaveProgress(!0),g.setPublishProgress(!0),S(a),a.savePublish.saveAsTemplate(b.partial(e,c),b.partial(e,d))}function S(a){var c=a.pages.getPageIdList();b.forEach(c,function(b){T(a,b,"desktop"),T(a,b,"mobile")})}function T(a,b,c){var d=a.pages.background.get(b,c);d&&!d.isPreset&&(d.isPreset=!0,a.pages.background.update(b,d,c))}var j={CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",SERVER_SAVE_DISABLED_PANEL:"savePublish.panels.common.serverDisabledFeaturePanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel",SAVE_REMINDER:"savePublish.panels.save.saveReminderPanel"},k={SITE_SAVED_WELCOME_BACK_TITLE:"SAVE_SITE_SAVED_WELCOME_BACK_TITLE",SITE_SAVED_WELCOME_BACK_SUBTITLE:"SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"},l=e.serviceTopology.editorServerRoot||"//editor.wix.com/html/editor/web";l+="/renderer/edit/<%= siteId %>";var m=null,n=null;return{save:O,saveInBackground:P,isSaveInProgress:g.isSaveInProgress,saveAsTemplate:R,setTimerForSaveReminder:b.once(Q)}}),define("savePublish/managers/mockSaveManager",["jquery","lodash","core","panels","savePublish/constants/constants"],function(a,b,c,d,e){"use strict";function j(a){i=b.clone(a)}function k(a){i=b.merge(i||{},a)}function l(){for(var a=20,c=h.siteName.getUsed(),d=h.siteName.get(),e=d.slice(0,a),f=1;b.includes(c,e);){var g="-"+f;e=d.slice(0,a-g.length)+g,f++}return e}function m(){var a={defaultSiteName:l(),freeDomainPrefix:f,connectDomainHandler:r,freeDomainHandler:q};d.panelManager.openPanel(g.CHOOSE_DOMAIN,a,!0)}function n(){d.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:p.bind(this,"SAVE_SITE_SAVED_WELCOME_BACK_TITLE","SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"),isFirstSave:!0,isFirstPublish:!0,isPremium:i.isSitePremium,flowId:c.constants.CONNECT_DOMAIN.FLOWS.SAVE},!0)}function o(){d.panelManager.openPanel(g.SAVE_FAILED,{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",stepsTitle:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION_BOLD",steps:["SAVE_PUBLISH_SAVE_ERROR_OPTION_1","SAVE_PUBLISH_SAVE_ERROR_OPTION_2"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:e.SAVE.SAVE_FAILED_HELP_LINK},!0)}function p(a,c){var e=b.clone(i);e.isMockSave=!0,e.overrideTitle=a,e.overrideSubtitle=c,d.panelManager.openPanel(g.SITE_WAS_SAVED,e,!0)}function q(a){i.shouldSaveSucceed?(s(),k({domain:f+a}),p()):o()}function r(){i.shouldSaveSucceed?(s(),n()):o()}function s(){console.log("First Save Was Performed!")}function t(){console.log("Save Was Performed!")}function u(){function a(a,b){h=a,b.isDomainConnected||(b.domain=f+l()),j(b),b.isFirstSave?m():b.shouldSaveSucceed?(t(),p("SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")):o()}d.panelManager.openPanel("savePublish.panels.save.saveConfigurationPanel",{onConfirm:a},!0)}var f="http://www.wix.com/",g={CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel"},h=null,i=null;return{save:u}}),define("savePublish/panels/publish/publishInnerPanelTypes",["core"],function(a){"use strict";var b=a.constants.USER_PREFS.PUBLISH;return{SHOUTOUT:{name:"SHOUTOUT",userPref:b.SHOUTOUT_DONT_SHOW_AGAIN},CONNECT_DOMAIN:{name:"CONNECT_DOMAIN",userPref:b.CONNECT_DOMAIN_DONT_SHOW_AGAIN},GROW_BUSINESS:{name:"GROW_BUSINESS",userPref:b.GROW_BUSINESS_DONT_SHOW_AGAIN},MUSIC_PROMO:{name:"MUSIC_PROMO",userPref:b.MUSIC_PROMO_DONT_SHOW_AGAIN}}}),define("savePublish/managers/publishManager",["lodash","core","panels","savePublish/constants/constants","savePublish/managers/savePublishState","savePublish/managers/saveManager","savePublish/panels/publish/publishInnerPanelTypes","experiment!musicPromotionFixed","experiment!musicPromotionRotation"],function(a,b,c,d,e,f,g,h,i){"use strict";function r(a){function b(b){p=!0,b.shouldPublishSucceed&&!b.isSiteContributor?E(a,b):b.shouldPublishSucceed&&b.isSiteContributor?(console.log("Contributors dont get to see any post operations except failure."),y()):A()}S(a),c.panelManager.openPanel(j,{onConfirm:b})}function s(a){function b(b){function c(){E(a,b),y()}S(a),a.savePublish.publish(c,v)}e.canSaveOrPublish()&&(t(a)?(x(),P(a,b)):u(a))}function t(a){return a.account.isUserOwner()&&!a.wixStores.isSiteInWixStoreTestDrive()}function u(a){a.savePublish.publish(y,v)}function v(a){A(a),y()}function w(a,b){if(e.canSaveOrPublish()){if(a.generalInfo.isFirstSave()){var c={overrideTitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_TITLE",overrideSubtitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_SUBTITLE",callback:s.bind(this,a)};return void f.save(a,c)}f.saveInBackground(a,s.bind(this,a),A,b)}}function x(){e.setPublishProgress(!0)}function y(){e.setPublishProgress(!1)}function z(b){return a.get(b,"document.errorCode")}function A(a){B(a)?C():D(a)}function B(a){return a&&Number(z(a))===d.ERROR_CODES.SAVE_PUBLISH_DISABLED_ON_SERVER}function C(){var a={titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnPublish"};c.panelManager.openPanel(m,a,!0)}function D(a){var d={titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_ERROR_OPTION_1","SAVE_PUBLISH_ERROR_OPTION_2"],helpMessage:"PUBLISH_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:n,errorCode:z(a),biConfirm:b.bi.events.publish.Publish_Work_not_Published_Error_ok_Click,biHelp:b.bi.events.publish.Publish_Work_not_Published_Error_Help_Center_Link_Click};c.panelManager.openPanel(l,d,!0)}function E(a,b){var d=a.generalInfo.getPublicUrl()||a.domain.getFreeDomainPrefix()+a.siteName.get();d=b.isDomainConnected?b.sitePremiumDomain:d;var e=F(a,b);if(null!==e){var f={isFakePanel:p,contentPanelType:e,configuration:b,currentDomain:a.site.getCurrentSiteDomain(),userPreferences:o,sitePublicUrl:d,closePanel:Q.bind(null,k)};c.panelManager.openPanel(k,f,!0)}}function F(a,b){var c=null,d=!b.isPremiumUser&&b.isDomainConnected;if(!d){var e=N();if(G(a)){var f=e[g.MUSIC_PROMO.name].dontShowAgain;c=!f||p?g.MUSIC_PROMO:null}else if(H(b))c=g.CONNECT_DOMAIN;else{var h=M(a,b,e);c=h[q%h.length]||null,q=(q+1)%h.length}}return c}function G(a){return h&&a.promotions.music.isActive()}function H(a){return a.isFirstPublish&&!a.isDomainConnected}function I(a,b){var c=b[g.CONNECT_DOMAIN.name].dontShowAgain;return!a.isDomainConnected&&(!c||p)}function J(a,b){var c=b[g.MUSIC_PROMO.name].dontShowAgain;return i&&a.promotions.music.isActive()&&(!c||p)}function K(a,b){var c=b[g.SHOUTOUT.name].dontShowAgain;return!a.isDomainConnected&&(!c||p)}function L(a,b){var c=b[g.GROW_BUSINESS.name].dontShowAgain;return a.isPremiumUser&&a.isDomainConnected&&(!c||p)}function M(a,b,c){var d=[],e=I(b,c),f=J(a,c),h=K(b,c),i=L(b,c);return e&&d.push(g.CONNECT_DOMAIN),f&&d.push(g.MUSIC_PROMO),!f&&h&&d.push(g.SHOUTOUT),i&&d.push(g.GROW_BUSINESS),d}function N(){var b={};return a.forEach(g,function(a){b[a.name]=O(a.userPref)}),b}function O(a){return{dontShowThisAgainKey:a,dontShowAgain:o.session.get(a)}}function P(a,b){a.site.getSiteDomainInfo(function(c){var d=c.isDomainConnected,e=c.sitePublishedDomain;b({isFirstSave:a.generalInfo.isFirstSave(),isPremiumUser:a.site.isPremium(),sitePremiumDomain:e,isDomainConnected:d,isFirstPublish:!a.generalInfo.isSitePublished()})})}function Q(a){return p=!1,c.panelManager.closePanelByName(a)}function R(a){o=a.getUserPreferences(),null===o&&a.registerInitUserPrefsCallback(function(a){o=a})}var j="savePublish.panels.publish.config.publishConfigurationPanel",k="savePublish.panels.publish.publishSuccessPanel",l="savePublish.panels.common.failPanel",m="savePublish.panels.common.serverDisabledFeaturePanel",n="3de8a931-e665-4c9f-bcb3-7096ea89f9e3",o=null,p=!1,q=0,S=a.once(R);return{publish:s,saveAndPublish:w,configurePublish:r,isPublishInProgress:e.isPublishInProgress}}),define("savePublish/panels/connectDomain/connectDomainPanel.rt",["react/addons","lodash","panels","util","baseUI","symbols"],function(a,b,c,d,e,f){"use strict";function g(){this.onClose(!1)}function h(){this.hoverOnAction(1)}function i(){this.hoverOnAction(2)}return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",className:"connect-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:g.bind(this)},a.createElement(f.symbol,{name:"headerCloseButton"})),a.createElement("span",{className:"title"},this.translateIfNeeded(this.props.title)),a.createElement("span",{className:"subtitle"},this.translateIfNeeded(this.props.subtitle))),a.createElement("div",{className:"actions"},a.createElement("a",{className:"action",onClick:this.connectToNewDomain,onMouseEnter:h.bind(this),onMouseLeave:this.resetHoverOnAction},a.createElement("div",{className:"action-graphics"},a.createElement(e.symbol,{name:"connectNewDomain"})),a.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_1")),this.isActionHovered(1)?null:a.createElement("div",{key:"optionArrow",className:"action-arrow"},a.createElement(e.symbol,{name:"arrowWithCircle"})),this.isActionHovered(1)?a.createElement("div",{key:"optionLink",className:"action-arrow"},a.createElement(e.symbol,{name:"openLinkInWindow"})):null),a.createElement("a",{className:"action",onClick:this.connectExistingDomain,onMouseEnter:i.bind(this),onMouseLeave:this.resetHoverOnAction},a.createElement("div",{className:"action-graphics"},a.createElement(e.symbol,{name:"connectDomainLight"})),a.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_2")),this.isActionHovered(2)?null:a.createElement("div",{key:"optionArrow",className:"action-arrow"},a.createElement(e.symbol,{name:"arrowWithCircle"})),this.isActionHovered(2)?a.createElement("div",{key:"optionLink",className:"action-arrow"},a.createElement(e.symbol,{name:"openLinkInWindow"})):null)),a.createElement("div",{className:"connect-domain-panel-footer"},a.createElement(e.button,{type:"button",label:"PREMIUM_BUTTON_LABEL",className:"maybe-later-button",onClick:this.maybeLater})))}}),define("savePublish/panels/connectDomain/connectDomainPanel",["react","jquery","lodash","core","util","savePublish/panels/connectDomain/connectDomainPanel.rt"],function(a,b,c,d,e,f){"use strict";var g="https://premium.wix.com/wix/api/",h="?siteGuid=<%= siteGUID %>&referralAdditionalInfo=<%= referralInfo %>",i=g+"domainConsole"+h;return a.createClass({displayName:"connectDomainPanel",mixins:[d.mixins.editorAPIMixin,e.translationMixin],propTypes:{isPremium:a.PropTypes.bool.isRequired,isFirstSave:a.PropTypes.bool,isFirstPublish:a.PropTypes.bool,title:a.PropTypes.string,subtitle:a.PropTypes.string,onConnectDomainFlowEnded:a.PropTypes.func,flowId:a.PropTypes.oneOf(c.values(d.constants.CONNECT_DOMAIN.FLOWS)).isRequired},getInitialState:function(){return{actionIndexHovered:-1}},connectToNewDomain:function(){var a="CONNECT_NEW_DOMAIN",b=d.bi.events.save.siteWasSavedPanel.CONNECT_NEW_DOMAIN_CLICKED,c=this.openUpgrade.bind(this,a);this.props.isPremium&&(c=this.openConnectDomainInWindow.bind(this,a)),this.connectDomain(b,c)},connectExistingDomain:function(){var a="CONNECT_EXISTING_DOMAIN",b=d.bi.events.save.siteWasSavedPanel.CONNECT_EXISTING_DOMAIN_CLICKED,c=this.openUpgrade.bind(this,a);this.props.isPremium&&(c=this.openConnectDomainInWindow.bind(this,a)),this.connectDomain(b,c)},connectDomain:function(a,b){this.props.isFirstSave&&this.sendBI(a);var c=this.listenToTabFocusIfNeeded();b.call(this),this.onClose(c)},listenToTabFocusIfNeeded:function(){if(this.props.onConnectDomainFlowEnded){var a=function(){this.getWindow().off("focus",a),this.props.onConnectDomainFlowEnded()}.bind(this);return this.getWindow().on("focus",this.onEditorFocus),!0}return!1},onEditorFocus:function(){this.getWindow().off("focus",this.onEditorFocus),this.props.onConnectDomainFlowEnded()},getReferralCode:function(a){var b="edhtml_";switch(this.props.flowId){case d.constants.CONNECT_DOMAIN.FLOWS.SAVE:b+="SAVE_FLOW_",b+=this.props.isFirstSave?"FIRST_SAVE_":"SECOND_SAVE_",b+=a;break;case d.constants.CONNECT_DOMAIN.FLOWS.TOP_BAR:b+="TOP_BAR_SITE_MENU_CONNECT_DOMAIN_"+a;break;case d.constants.CONNECT_DOMAIN.FLOWS.PUBLISH:b+="PUBLISH_FLOW_",b+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_",b+=a;break;case d.constants.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON:b+="PUBLISH_FLOW_CONNECT_BUTTON_",b+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_",b+=a;break;default:b=null}return b},openUpgrade:function(a){var b=this.getReferralCode(a);this.getEditorAPI().account.upgrade(b)},openConnectDomainInWindow:function(a){var b=this.createURLWithParams(i,a);window.open(b)},createURLWithParams:function(a,b){var d=this.getReferralCode(b),e=c.template(a),f=this.getEditorAPI().generalInfo.getSiteId();return e({siteGUID:f,referralInfo:d})},maybeLater:function(){this.getEditorAPI().bi.event(d.bi.events.save.siteWasSavedPanel.First_Save_Dialog_2_maybe_later_click),this.onClose(!1)},onClose:function(a){this.refs.frame.close(),!a&&this.props.onConnectDomainFlowEnded&&this.props.onConnectDomainFlowEnded()},getWindow:function(){return b(window)},resetHoverOnAction:function(){this.hoverOnAction(-1)},hoverOnAction:function(a){this.setState({actionIndexHovered:a})},isActionHovered:function(a){return this.state.actionIndexHovered===a},sendBI:function(a){this.getEditorAPI().bi.event(a)},getKeyboardShortcuts:function(){var a=this;return{enter:function(){a.maybeLater()},esc:function(){a.onClose(!1)}}},render:f})}),define("savePublish/panels/connectDomain/connectDomainInProgress.rt",["react/addons","lodash","panels","util","baseUI","symbols"],function(a,b,c,d,e,f){"use strict";return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",className:"connect-domain-in-progress-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},a.createElement("div",{className:"save-publish-panel-header"},a.createElement("div",{className:"title"},d.translate("PUBLISH_HANGON_TITLE")),a.createElement("div",{className:"subtitle"},d.translate("PUBLISH_HANGON_SUBTITLE")),a.createElement("button",{className:"close-button",onClick:this.onClose},a.createElement(f.symbol,{name:"headerCloseButton"}))),a.createElement("div",{className:"panel-content"},a.createElement("div",{className:"content-top-part"},a.createElement("div",{className:"content-graphics"},a.createElement(e.symbol,{name:"hangon"})),a.createElement("div",{className:"content-top-message"},"\n                ",d.translate("PUBLISH_HANGON_MAIN_TEXT"),"\n                ",a.createElement("span",{className:"public-url"},this.props.connectedDomainURL))),a.createElement("div",{className:"content-bottom-message"},"\n            ",d.translate("PUBLISH_HANGON_MEANTIME_TEXT"),"\n            ",a.createElement("a",{className:"content-bottom-message-link",onClick:this.openWorkingURL},d.translate("PUBLISH_HANGON_CLICKING_HERE_LINK")))),a.createElement("div",{className:"connect-domain-panel-footer"},a.createElement(e.button,{type:"button",className:"maybe-later-button",label:"PUBLISH_HANGON_DONE_BUTTON",onClick:this.onClose})))}}),define("savePublish/panels/connectDomain/connectDomainInProgress",["react","savePublish/panels/connectDomain/connectDomainInProgress.rt"],function(a,b){"use strict";return a.createClass({displayName:"connectDomainInProgress",propTypes:{connectedDomainURL:a.PropTypes.string.isRequired,currentPublicURL:a.PropTypes.string.isRequired},getShortcuts:function(){return{esc:this.onClose,enter:this.onClose}},openWorkingURL:function(){window.open(this.props.currentPublicURL)},onClose:function(){this.refs.frame.close()},render:b})}),define("savePublish/panels/common/failPanel.rt",["react/addons","lodash","util","baseUI","panels"],function(a,b,c,d,e){"use strict";function f(b,d){return a.createElement("li",{key:b},c.translate(b))}return function(){return a.createElement(e.frames.messagePanelFrame,{ref:"frame",editorAPI:this.getEditorAPI(),panelName:this.props.panelName,className:"fail-panel",panelTitle:c.translate(this.props.titleKey),confirmLabel:"SAVE_PUBLISH_ERROR_BUTTON_OK",onConfirm:this.onConfirm,onCancel:this.onCancel,footerText:this.getFooterText(),keyboardShortcuts:this.getShortcuts()},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"icon"},a.createElement(d.symbol,{name:"plaster"})),a.createElement("div",{className:"textual"},a.createElement("p",{className:"description",dangerouslySetInnerHTML:{__html:c.translate(this.props.description)}}),this.props.stepsTitle?a.createElement("div",{key:"stepsTitle",className:"steps-title"},c.translate(this.props.stepsTitle)):null,a.createElement.apply(this,["ol",{},b.map(this.props.steps,f.bind(this))]))))}}),define("savePublish/panels/common/failPanel",["react","core","util","panels","savePublish/panels/common/failPanel.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"failPanel",mixins:[b.mixins.editorAPIMixin],propTypes:{titleKey:a.PropTypes.string.isRequired,description:a.PropTypes.string.isRequired,stepsTitle:a.PropTypes.string,steps:a.PropTypes.array.isRequired,helpMessage:a.PropTypes.string.isRequired,helpLinkMessage:a.PropTypes.string.isRequired,helpLink:a.PropTypes.string.isRequired,errorCode:a.PropTypes.number,biEvent:a.PropTypes.object,biParams:a.PropTypes.object,failHelpId:a.PropTypes.string,biConfirm:a.PropTypes.object,biHelp:a.PropTypes.object,biCancel:a.PropTypes.object},getShortcuts:function(){var a=this;return{esc:function(){a.refs.frame.onCancel()},enter:function(){a.refs.frame.onConfirm()}}},getErrorCodeMessage:function(){return void 0!==this.props.errorCode&&null!==this.props.errorCode?" (Error Code: "+this.props.errorCode+")":""},getFooterText:function(){return a.DOM.p({className:"fail-panel-help-text"},a.DOM.span({className:"text-part"},c.translate(this.props.helpMessage)),a.DOM.a({onClick:this.openHelpLink,className:"link-part"},c.translate(this.props.helpLinkMessage)),a.DOM.span({className:"error-code-part"},this.getErrorCodeMessage()))},onCancel:function(){this.props.biCancel&&this.getEditorAPI().bi.event(this.props.biCancel)},onConfirm:function(){this.props.biConfirm&&this.getEditorAPI().bi.event(this.props.biConfirm)},openHelpLink:function(){this.props.biHelp&&this.getEditorAPI().bi.event(this.props.biHelp);var a={panel_name:this.props.panelName,origin:b.constants.BI.HELP.ORIGIN.PANEL,learn_more:!0};d.panelManager.openHelpCenter(this.props.helpLink,null,null,a),d.panelManager.closePanelByName(this.props.panelName)},sendPanelLoadedBiEvent:function(){this.props.biEvent&&this.props.biParams&&this.getEditorAPI().bi.event(this.props.biEvent,this.props.biParams)},componentDidMount:function(){this.sendPanelLoadedBiEvent()},render:e})}),define("savePublish/panels/common/serverDisabledFeaturePanel.rt",["react/addons","lodash","util","panels"],function(a,b,c,d){"use strict";return function(){return a.createElement(d.frames.messagePanelFrame,{ref:"frame",editorAPI:this.getEditorAPI(),panelName:this.props.panelName,className:"fail-panel",panelTitle:c.translate(this.props.titleKey),confirmLabel:"SAVE_PUBLISH_ERROR_BUTTON_OK"},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"full-textual"},a.createElement("p",{className:"description",dangerouslySetInnerHTML:{__html:c.translate(this.props.description)}}))))}}),define("savePublish/panels/common/serverDisabledFeaturePanel",["react","core","savePublish/panels/common/serverDisabledFeaturePanel.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"serverDisabledFeaturePanel",mixins:[b.mixins.editorAPIMixin],propTypes:{titleKey:a.PropTypes.string.isRequired,description:a.PropTypes.string.isRequired},render:c})}),define("savePublish/panels/common/commonPanels",["savePublish/panels/common/failPanel","savePublish/panels/common/serverDisabledFeaturePanel"],function(a,b){"use strict";return{failPanel:a,serverDisabledFeaturePanel:b}}),define("savePublish/panels/save/chooseDomainPanel.rt",["react/addons","lodash","panels","baseUI","symbols"],function(a,b,c,d,e){"use strict";function f(a){this.handleDomainOptionSelected(a.value)}function g(){var c=this.getOptions()[this.DomainStates.FREE];return a.createElement("label",{className:b.keys(b.pick({"domain-option":!0,checked:this.state.domainChoice===this.DomainStates.FREE},b.identity)).join(" ")},a.createElement("span",{className:"domain-option-label"},c.label),a.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:c.value,checked:this.state.domainChoice===c.value,onChange:f.bind(this,c)}),a.createElement("span",{}),a.createElement("div",{className:"domain-input"},a.createElement(d.domainInput,{value:c.domain,onChange:this.handleDomainChanged,prefix:c.prefix,isEditable:c.isEditable,domainValidator:c.domainValidator,biHandler:this.domainInputBiReporter})))}function h(a){this.handleDomainOptionSelected(a.value)}function i(){var c=this.getOptions()[this.DomainStates.BUY];return a.createElement("label",{className:b.keys(b.pick({"domain-option":!0,checked:this.state.domainChoice===this.DomainStates.BUY},b.identity)).join(" ")},a.createElement("span",{className:"domain-option-label"},c.label),a.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:c.value,checked:this.state.domainChoice===c.value,onChange:h.bind(this,c)}),a.createElement("span",{}),a.createElement("span",{className:"connect-domain-example"},c.domain))}return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",className:"choose-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:this.close},a.createElement(e.symbol,{name:"headerCloseButton"})),a.createElement("span",{className:"title"},this.getTitle()),a.createElement("span",{className:"subtitle"},this.getSubtitle())),g.apply(this,[]),i.apply(this,[]),a.createElement(d.button,{className:"choose-domain-action-button",shouldTranslate:!1,label:this.getActionButtonLabel(),onClick:this.handleAction,disabled:this.state.isActionDisabled}))}}),define("savePublish/panels/save/chooseDomainPanel",["react","lodash","core","util","panels","savePublish/panels/save/chooseDomainPanel.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"chooseDomainPanel",mixins:[c.mixins.editorAPIMixin],propTypes:{defaultSiteName:a.PropTypes.string.isRequired,freeDomainPrefix:a.PropTypes.string.isRequired,freeDomainHandler:a.PropTypes.func.isRequired,connectDomainHandler:a.PropTypes.func.isRequired,overrideTitle:a.PropTypes.string,overrideSubtitle:a.PropTypes.string},DomainStates:{FREE:"free",BUY:"buy"},getInitialState:function(){var a=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);return{domainChoice:this.DomainStates.FREE,siteName:this.props.defaultSiteName,sanitizedSiteName:this.props.defaultSiteName,isActionDisabled:!a.success}},getTitle:function(){return d.translate(this.props.overrideTitle||"SAVE_CHOOSE_DOMAIN_TITLE_TITLE")},getSubtitle:function(){return d.translate(this.props.overrideSubtitle||"SAVE_CHOOSE_DOMAIN_TITLE_SUBTITLE")},getOptions:function(){var a={};return a[this.DomainStates.FREE]={value:"free",label:d.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_1"),prefix:this.props.freeDomainPrefix,domain:this.state.siteName,isEditable:this.state.domainChoice===this.DomainStates.FREE,domainValidator:this.getEditorAPI().siteName.validate},a[this.DomainStates.BUY]={value:"buy",label:d.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE1"),domain:d.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE2"),isEditable:!1},a},getNextDomainOptionValue:function(){return this.state.domainChoice===this.DomainStates.FREE?this.DomainStates.BUY:this.DomainStates.FREE},getActionButtonLabel:function(){return d.translate("SAVE_CHOOSE_DOMAIN_BUTTON_SAVENCONTINUE")},handleDomainChanged:function(a){var b={};b.isActionDisabled=!a.isValid,b.siteName=a.value,b.sanitizedSiteName=a.sanitizedValue,this.setState(b)},handleDomainOptionSelected:function(a){if(!b.isEqual(this.state.domainChoice,a)){var c={domainChoice:a};if(a===this.DomainStates.BUY)c.isActionDisabled=!1,c.siteName=this.props.defaultSiteName,
c.sanitizedSiteName=this.props.defaultSiteName;else{var d=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);c.isActionDisabled=!d.success}this.setState(c),this.reportDomainClickedBI(a)}},handleAction:function(){if(this.reportActionButtonClickedBI(this.state.domainChoice),this.state.isActionDisabled)throw new Error("Should not get to handleAction if continue button is disabled");this.state.domainChoice===this.DomainStates.FREE?(this.refs.frame.close(),this.props.freeDomainHandler(this.state.sanitizedSiteName)):this.state.domainChoice===this.DomainStates.BUY&&(this.refs.frame.close(),this.props.connectDomainHandler())},reportActionButtonClickedBI:function(a){var b=this.getEditorAPI(),d=a===this.DomainStates.BUY?"connect your own domain":"free WIX domain";b.bi.event(c.bi.events.save.chooseDomainPanel.ACTION_BUTTON_CLICKED,{value_selected:d})},reportDomainClickedBI:function(a){var b=this.getEditorAPI(),d=a===this.DomainStates.BUY?"connect your own domain":"free WIX domain";b.bi.event(c.bi.events.save.chooseDomainPanel.DOMAIN_OPTION_CLICKED,{selection:d})},getUserStatus:function(){var a="";return this.props.isSitePublished||(a+="not_"),a+="published_",this.props.isDomainConnected||(a+="not_"),a+="connected"},domainInputBiReporter:function(a){var b={user_status:"not_published_not_connected",panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:1};this.getEditorAPI().bi.event(c.bi.events.domainInput[a],b)},close:function(){this.refs.frame.close()},getKeyboardShortcuts:function(){var a=this;return{enter:function(){a.state.isActionDisabled||a.handleAction()},esc:function(){a.close()},tab:function(b){a.handleDomainOptionSelected(a.getNextDomainOptionValue()),b.preventDefault()}}},render:f})}),define("savePublish/panels/save/siteWasSavedPanel.rt",["react/addons","lodash","panels","baseUI","util","symbols"],function(a,b,c,d,e,f){"use strict";function g(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function h(){var b=this.getInnerPanel();return a.createElement("div",{className:"wrapper"},a.createElement("div",{className:"domain-input"},a.createElement(d.domainInputWithEditButtons,this.getDomainInputProps())),this.shouldDisplayInnerPanel()?a.createElement(b,g({key:"innerPanel",className:"inner-panel "+this.getInnerPanelClass()},this.getInnerPanelProps())):null,a.createElement("div",{className:"site-saved-footer"},this.props.isFirstSave?null:a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,key:"dontShowAgainCheckbox",className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",valueLink:{value:this.state.doNotShowAgain,requestChange:this.handleDontShowAgainClicked}}),this.props.isSitePremium&&!this.props.isDomainConnected&&this.props.isFirstSave?a.createElement("span",{key:"needHelpConnectingDomain",className:"help-connecting-domain"},e.translate("SAVE_SITE_SAVED_NEED_HELP_LABEL")+" ",a.createElement("a",{target:"_blank",href:e.translate("SAVE_SITE_SAVED_NEED_HELP_URL"),onClick:this.handleNeedHelpConnectingDomainClicked},e.translate("SAVE_SITE_SAVED_NEED_HELP_LINK"))):null,a.createElement("div",{className:"footer-buttons"},this.props.isSitePublished?a.createElement(d.button,{onClick:this.continueToPublish,key:"publishButton",className:"publish-button btn-confirm-secondary",label:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",disabled:this.state.isContinueDisabled}):null,a.createElement(d.button,{className:"continue-button btn-confirm-primary",label:"SAVE_SITE_SAVED_BUTTON_OK",onClick:this.continueEditing,disabled:this.state.isContinueDisabled}))))}return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",className:this.getPanelClass(),panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:this.close},a.createElement(f.symbol,{name:"headerCloseButton"})),a.createElement("span",{className:"title"},this.getPanelTitle()),a.createElement("span",{className:"subtitle"},this.getPanelSubtitle())),h.apply(this,[]))}}),define("savePublish/panels/content/generalContent.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:this.getClassName()},a.createElement("div",{className:"main-title-wrapper"},a.createElement("hr",{className:"divider-long"}),a.createElement("div",{className:"main-title"},this.translateIfNeeded(this.props.mainTitle)),a.createElement("hr",{className:"divider-long"})),a.createElement("div",{className:"middle-spacer"}),a.createElement("div",{className:"bottom-section"},a.createElement("div",{className:"left-side"},this.props.symbolName?a.createElement(c.symbol,{name:this.props.symbolName,key:"symbol"}):null,this.props.imageSrc?a.createElement("img",{key:"image",src:this.props.imageSrc,style:this.props.imageStyle||{}}):null),a.createElement("div",{className:"right-side"},a.createElement("div",{className:"title"},this.translateIfNeeded(this.props.title)),this.props.subtitle?a.createElement("div",{key:"subtitle",className:"subtitle",dangerouslySetInnerHTML:{__html:this.translateIfNeeded(this.props.subtitle)}}):null,a.createElement("a",{className:"general-content-action",onClick:this.props.actionCallback},this.translateIfNeeded(this.props.actionLabel)))))}}),define("savePublish/panels/content/generalContent",["react","panels","util","savePublish/panels/content/generalContent.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"generalContent",mixins:[c.translationMixin],propTypes:{symbolName:a.PropTypes.string,imageSrc:a.PropTypes.string,imageStyle:a.PropTypes.object,mainTitle:a.PropTypes.string.isRequired,title:a.PropTypes.string.isRequired,subtitle:a.PropTypes.string,actionCallback:a.PropTypes.func.isRequired,actionLabel:a.PropTypes.string.isRequired,className:a.PropTypes.string},getClassName:function(){return"general-content"+(this.props.className?" "+this.props.className:"")},render:d})}),define("savePublish/panels/content/connectDomain.rt",["react/addons","lodash","savePublish/panels/content/generalContent"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement(c,d({className:"connect-domain-content "+this.props.className},this.getGeneralContentProps()))}}),define("savePublish/panels/content/connectDomain",["lodash","core","react","panels","util","experiment!spanishUpgradeText","savePublish/panels/content/connectDomain.rt"],function(a,b,c,d,e,f,g){"use strict";function j(b){var c=b.campaigns.personalSale.getDiscountValue(),d=b.campaigns.personalSale.getAssetPath(),f=[d,"connectDomain_"+c+".svg"].join("/"),g=a.template(e.translate("SAVE_PUBLISH_WHATS_NEXT_PERSONAL_SALE_TEXT_DYNAMIC"));return{symbolName:"",className:"personal-sale-campaign",imageSrc:e.media.getAssetUrl(f),subtitle:g({discount:c})}}var h="savePublish.panels.connectDomainInProgress",i=f?"UPGRADE_NOW_FOR_SPAIN_ONLY":"SAVE_PUBLISH_WHATS_NEXT_UPGRADE_LINK";return c.createClass({displayName:"connectDomain",mixins:[b.mixins.editorAPIMixin],propTypes:{className:c.PropTypes.string,closePanel:c.PropTypes.func.isRequired,sitePublishedDomain:c.PropTypes.string,isDomainConnected:c.PropTypes.bool,isFirstPublish:c.PropTypes.bool,isSitePremium:c.PropTypes.bool,isFirstSave:c.PropTypes.bool,actionCallback:c.PropTypes.func,flowId:c.PropTypes.oneOf(a.values(b.constants.CONNECT_DOMAIN.FLOWS)).isRequired},getGeneralContentProps:function(){var b=this.getEditorAPI(),c={className:"",symbolName:"connectDomain",mainTitle:e.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:e.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE1"),actionLabel:e.translate(this.props.isSitePremium?"SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINK":i),shouldTranslate:!1,actionCallback:this.panelAction,subtitle:e.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE2")};return b.campaigns.personalSale.isActiveCampaign()&&!this.props.isSitePremium&&a.assign(c,j(b)),c},panelAction:function(){this.props.actionCallback&&this.props.actionCallback(),this.props.closePanel();var a=this.isSiteBeingConnectedToDomain();a?this.openConnectDomainInProgressPanel():!this.props.isDomainConnected&&this.props.isSitePremium?this.getEditorAPI().account.openConnectDomain(this.props.flowId):this.getEditorAPI().account.upgrade(this.getUpgradeReferralCode())},getUpgradeReferralCode:function(){var a="edhtml_";switch(this.props.flowId){case b.constants.CONNECT_DOMAIN.FLOWS.PUBLISH:var c=this.props.isFirstPublish?"FIRST_PUBLISH":"SECOND_PUBLISH";a+="PUBLISH_FLOW_"+c;break;case b.constants.CONNECT_DOMAIN.FLOWS.SAVE:a+="SAVE_FLOW_SECOND_SAVE_AND_PUBLISHED";break;default:a=null}return a},isSiteBeingConnectedToDomain:function(){return this.isUnconnectedDomainPremium()&&!a.isEmpty(this.props.sitePublishedDomain)&&!a.includes(this.props.sitePublishedDomain,"wix.com")},isUnconnectedDomainPremium:function(){return!this.props.isDomainConnected&&this.props.isSitePremium},openConnectDomainInProgressPanel:function(){d.panelManager.openPanel(h,{connectedDomainURL:this.props.sitePublishedDomain,currentPublicURL:this.props.currentDomain},!0)},render:g})}),define("savePublish/panels/content/publishContent.rt",["react/addons","lodash","savePublish/panels/content/generalContent"],function(a,b,c){"use strict";return function(){return a.createElement(c,b.assign({},{className:this.getClassName()},this.getGeneralContentProps()))}}),define("savePublish/panels/content/publishContent",["react","core","panels","savePublish/panels/content/publishContent.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"publishContent",mixins:[b.mixins.editorAPIMixin],propTypes:{closePanel:a.PropTypes.func.isRequired,publishMethod:a.PropTypes.func.isRequired,className:a.PropTypes.string,actionCallback:a.PropTypes.func},getClassName:function(){return"publish-site-content"+(this.props.className?" "+this.props.className:"")},getGeneralContentProps:function(){return{symbolName:"publishSite",mainTitle:"SAVE_SITE_SAVED_WHATS_NEXT_LABEL",title:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINE",actionLabel:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",actionCallback:this.publishSite}},publishSite:function(){this.props.closePanel(),this.props.publishMethod(),this.props.actionCallback&&this.props.actionCallback()},render:d})}),define("savePublish/panels/save/siteWasSavedPanel",["react","lodash","core","util","savePublish/constants/constants","savePublish/managers/publishManager","savePublish/panels/save/siteWasSavedPanel.rt","savePublish/panels/content/connectDomain","savePublish/panels/content/publishContent"],function(a,b,c,d,e,f,g,h,i){"use strict";function k(a){var b=a.lastIndexOf("/");return{prefix:a.slice(0,b+1),siteName:a.slice(b+1)}}var j={PUBLISH:"PUBLISH",CONNECT_DOMAIN:"CONNECT_DOMAIN"};return a.createClass({displayName:"siteWasSavedPanel",mixins:[a.addons.LinkedStateMixin,c.mixins.editorAPIMixin],propTypes:{domain:a.PropTypes.string.isRequired,isSitePremium:a.PropTypes.bool,isFirstSave:a.PropTypes.bool,isDomainConnected:a.PropTypes.bool,isSitePublished:a.PropTypes.bool,isMockSave:a.PropTypes.bool,overrideTitle:a.PropTypes.string,overrideSubtitle:a.PropTypes.string,callback:a.PropTypes.func},getInitialState:function(){var a={isContinueDisabled:!1,doNotShowAgain:null,domain:this.props.domain};if(!this.props.isFirstSave){var b=this.getEditorAPI().getUserPreferences();b&&(a.doNotShowAgain=!!b.session.get(c.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN))}return a},getPanelTitle:function(){return d.translate(this.props.overrideTitle||"SAVE_SITE_SAVED_TITLE_TITLE")},getPanelSubtitle:function(){return d.translate(this.props.overrideSubtitle||"SAVE_SITE_SAVED_TITLE_SUBTITLE")},getDomainInputProps:function(){var a,b=this.state.domain,c=!this.props.isDomainConnected;if(c){var d=k(b);a={prefix:d.prefix,value:d.siteName,isEditable:!0,domainValidator:this.getEditorAPI().siteName.validate,domainHandler:this.props.isMockSave?null:this.renameSiteAndProcessResult,onChange:this.handleDomainEditingStatusChanged}}else a={value:b,isEditable:!1};return a.biHandler=this.domainInputBiReporter,a},getInnerPanelType:function(){return this.props.isSitePublished?this.props.isDomainConnected?void 0:j.CONNECT_DOMAIN:j.PUBLISH},getInnerPanel:function(){var a=this.getInnerPanelType();switch(a){case j.PUBLISH:return i;case j.CONNECT_DOMAIN:return h}},getPanelClass:function(){var a="site-was-saved-panel",b=this.getInnerPanelClass();return a+=b?" contains-"+b:"",this.props.isSitePremium&&this.props.isSitePublished&&this.props.isDomainConnected&&(a+=" narrow-domain-input"),a+" save-publish-panel"},getInnerPanelClass:function(){var a=this.getInnerPanelType();switch(a){case j.PUBLISH:return"publish-inner-panel";case j.CONNECT_DOMAIN:return"connect-domain-inner-panel"}},getInnerPanelProps:function(){var a={sitePublishedDomain:this.props.domain,isDomainConnected:this.props.isDomainConnected,isFirstPublish:!this.props.isSitePublished,isSitePremium:this.props.isSitePremium,isFirstSave:this.props.isFirstSave,flowId:c.constants.CONNECT_DOMAIN.FLOWS.SAVE,closePanel:this.close},b=this.getInnerPanelType();switch(b){case j.PUBLISH:a.publishMethod=this.props.isMockSave?f.configurePublish.bind(f,this.getEditorAPI()):f.publish.bind(f,this.getEditorAPI()),this.props.isMockSave||(a.actionCallback=function(){this.reportPublishClickedBI(),this.getEditorAPI().bi.event(c.bi.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"})}.bind(this));break;case j.CONNECT_DOMAIN:this.props.isMockSave||(a.actionCallback=this.reportConnectDomainClickedBI)}return a},shouldDisplayInnerPanel:function(){return!this.props.isSitePublished||!this.props.isDomainConnected},continueToPublish:function(){this.props.isMockSave||(this.getEditorAPI().bi.event(c.bi.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"}),this.reportBIWithUserStatus(c.bi.events.save.siteWasSavedPanel.SECOND_SAVE_PUBLISH_NOW_BUTTON_CLICKED)),this.close(),f.publish(this.getEditorAPI())},continueEditing:function(){if(this.props.isMockSave||(this.props.isFirstSave?this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.FIRST_SAVE_ACTION_BUTTON_CLICKED,{}):this.reportBIWithUserStatus(c.bi.events.save.siteWasSavedPanel.SECOND_SAVE_ACTION_BUTTON_CLICKED)),this.state.isContinueDisabled)throw new Error("Should not get to continueEditing if continue button is disabled");if(this.state.doNotShowAgain){var a=this.getEditorAPI().getUserPreferences();a?a.session.set(c.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN,this.state.doNotShowAgain):console.error("siteWasSavedPanel tried to use userPreferences while they are not initialized")}this.close()},reportBIWithUserStatus:function(a){var b={user_status:this.getUserStatus()};this.getEditorAPI().bi.event(a,b)},getUserStatus:function(){var a="";return this.props.isSitePublished||(a+="not_"),a+="published_",this.props.isDomainConnected||(a+="not_"),a+="connected"},renameSiteAndProcessResult:function(a,b,c){var d=this;this.getEditorAPI().siteName.rename(a,function(){b()},function(a){var b=a&&a.errorCode;b===e.RENAME.ERRORS.SITE_NAME_TAKEN?c("SAVE_SITE_NAME_ALREADY_EXISTS"):(c(),d.getEditorAPI().panelManager.openPanel("savePublish.panels.common.failPanel",{titleKey:"ERROR_NAME_SITE_AGAIN_TITLE_LABEL",description:"ERROR_NAME_SITE_AGAIN_SUBTITLE",stepsTitle:"ERROR_NAME_SITE_AGAIN_TRY_STEPS",steps:["ERROR_NAME_SITE_AGAIN_STEP1_TEXT","ERROR_NAME_SITE_AGAIN_STEP2_TEXT","ERROR_NAME_SITE_AGAIN_STEP3_TEXT"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:e.SAVE.SAVE_FAILED_HELP_LINK,errorCode:b},!0))})},handleDomainEditingStatusChanged:function(a){var b={};if(a){var c=k(this.props.domain).prefix;b.isContinueDisabled=!1,b.domain=c+a}else b.isContinueDisabled=!0;this.setState(b)},handleNeedHelpConnectingDomainClicked:function(){this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.HELP_CONNECTING_DOMAIN_CLICKED,{})},handleDontShowAgainClicked:function(a){this.setState({doNotShowAgain:a}),this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.SECOND_SAVE_DONT_SHOW_AGAIN_CLICKED,{toggle:a,user_status:this.getUserStatus()})},reportPublishClickedBI:function(){this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.PUBLISH_NOW_CLICKED,{user_status:this.getUserStatus(),is_first_save:this.props.isFirstSave?1:0})},reportConnectDomainClickedBI:function(){this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.SECOND_SAVE_CONNECT_DOMAIN_CLICKED,{user_status:this.getUserStatus()})},domainInputBiReporter:function(a){if(!this.props.isMockSave){var b={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:this.props.isFirstSave?1:0};this.getEditorAPI().bi.event(c.bi.events.domainInput[a],b)}},componentWillUnmount:function(){this.props.callback&&this.props.callback()},close:function(){this.refs.frame.close()},getKeyboardShortcuts:function(){var a=this;return{enter:function(){a.state.isContinueDisabled||a.continueEditing()},esc:function(){a.close()}}},render:g})}),define("savePublish/panels/save/concurrentSavePanel.rt",["react/addons","lodash","panels","baseUI","symbols","util"],function(a,b,c,d,e,f){"use strict";return function(){return a.createElement(c.frames.confirmationPanelFrame,{ref:"frame",panelName:this.props.panelName,className:"concurrent-save-panel save-publish-panel",panelTitle:f.translate(this.getTitle()),confirmLabel:"SAVE_ERROR_CONCURRENT_EDITING_SAVE_BUTTON",cancelLabel:"SAVE_ERROR_CONCURRENT_EDITING_DONT_SAVE_BUTTON",onConfirm:this.overrideSave,onCancel:this.handleCancel},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"error-logo"},a.createElement(d.symbol,{name:"plaster"})),a.createElement("div",{className:"description-wrapper"},a.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:f.translate("SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE1")}}),a.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:f.translate("SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE2")}}))))}}),define("savePublish/panels/save/concurrentSavePanel",["react","core","util","savePublish/panels/save/concurrentSavePanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"concurrentSavePanel",mixins:[b.mixins.editorAPIMixin],PropTypes:{overrideSaveMethod:a.PropTypes.func.isRequired,onCancel:a.PropTypes.func},getTitle:function(){return"SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_TITLE"},overrideSave:function(){this.props.overrideSaveMethod?(this.props.overrideSaveMethod(this.getEditorAPI),this.getEditorAPI().bi.event(b.bi.events.save.saveFailed.CONCURRENT_SAVE,{selection:"save"})):console.log("Mock Overriding Save"),this.close()},handleCancel:function(){this.props.overrideSaveMethod&&this.getEditorAPI().bi.event(b.bi.events.save.saveFailed.CONCURRENT_SAVE,{selection:"don't save"}),this.close(),this.props.onCancel&&this.props.onCancel()},close:function(){this.refs.frame.close()},render:d})}),define("savePublish/panels/save/saveConfigurationPanel.rt",["react/addons","lodash","panels","baseUI"],function(a,b,c,d){"use strict";function e(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement(c.frames.emptyPanelFrame,e({ref:"frame",className:"save-configuration-panel"},this.getFrameProps()),a.createElement("a",{className:"close-button",onClick:this.close},"x"),a.createElement("h2",{style:{textAlign:"center"}},"Save Testing Configuration"),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"First save",valueLink:this.linkState("isFirstSave")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"Save succeeds",valueLink:this.linkState("shouldSaveSucceed")}),a.createElement("p",{},a.createElement("br",{}),"Premium Interaction:"),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"Site is/upgraded-to premium",value:this.state.isSitePremium,onChange:this.premiumToggled}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"Domain is/will-be connected",value:this.state.isDomainConnected,onChange:this.domainConnectedToggled}),a.createElement(d.textInput,{className:"domain-text-field",shouldTranslate:!1,label:"Custom Domain",valueLink:this.linkState("domain"),disabled:!this.state.isDomainConnected}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field"+(this.state.isFirstSave?" disabled":""),shouldTranslate:!1,label:"Site is published",valueLink:this.linkState("isSitePublished"),diabled:this.state.isFirstSave}),a.createElement("button",{className:"concurrent-save-button",shouldTranslate:!1,onClick:this.openConcurrentSave},"Concurrent Save"),a.createElement("button",{className:"save-reminder-button",shouldTranslate:!1,onClick:this.openSaveReminder},"Save Reminder"),a.createElement("div",{className:"save-configuration-footer"},a.createElement(d.button,{className:"confirm-button",shouldTranslate:!1,label:"Start Save",onClick:this.onConfirm})))}}),define("savePublish/panels/save/saveConfigurationPanel",["react","core","panels","savePublish/panels/save/saveConfigurationPanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"SaveConfigurationPanel",mixins:[a.addons.LinkedStateMixin,b.mixins.editorAPIMixin],propTypes:{onConfirm:a.PropTypes.func.isRequired},getInitialState:function(){return{isSitePremium:!1,isFirstSave:!0,isDomainConnected:!1,domain:"http://www.my-domain.com",isSitePublished:!1,shouldSaveSucceed:!0}},getFrameProps:function(){return{panelName:this.props.panelName}},openConcurrentSave:function(){c.panelManager.openPanel("savePublish.panels.save.concurrentSavePanel",{overrideSaveMethod:function(){console.log("Override Save")}},!0)},openSaveReminder:function(){c.panelManager.openPanel("savePublish.panels.save.saveReminderPanel",{saveMethod:this.onConfirm},!0)},componentWillUpdate:function(a,b){b.isFirstSave&&b.isSitePublished&&this.setState({isSitePublished:!1,isFirstSave:!0})},premiumToggled:function(){var a=!this.state.isSitePremium;this.setState({isSitePremium:a,isDomainConnected:a?this.state.isDomainConnected:!1})},domainConnectedToggled:function(){var a=!this.state.isDomainConnected;this.setState({isDomainConnected:a,isSitePremium:a||this.state.isSitePremium})},onConfirm:function(){this.props.onConfirm(this.getEditorAPI(),{isSitePremium:this.state.isSitePremium,isFirstSave:this.state.isFirstSave,isDomainConnected:this.state.isDomainConnected,domain:this.state.domain,isSitePublished:this.state.isSitePublished,shouldSaveSucceed:this.state.shouldSaveSucceed})},close:function(){this.refs.frame.close()},render:d})}),define("savePublish/panels/save/saveReminderPanel.rt",["react/addons","lodash","util","baseUI","panels","experiment!disableSaveReminder"],function(a,b,c,d,e,f){"use strict";return function(){return f?null:a.createElement(e.frames.messagePanelFrame,{ref:"frame",editorAPI:this.getEditorAPI(),key:"saveReminder",panelName:this.props.panelName,className:"save-reminder-panel save-publish-panel",panelTitle:c.translate("SAVE_REMINDER_MSG_TITLE"),confirmLabel:"SAVE_REMINDER_MSG_BUTTON",onConfirm:this.handleSave,keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"icon"},a.createElement(d.symbol,{name:"saveYourWork"})),a.createElement("div",{className:"message"},c.translate("SAVE_REMINDER_MSG_BODY"))))}}),define("savePublish/panels/save/saveReminderPanel",["react","lodash","core","savePublish/panels/save/saveReminderPanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"saveReminderPanel",mixins:[c.mixins.editorAPIMixin],propTypes:{saveMethod:a.PropTypes.func.isRequired},componentWillMount:function(){this.getEditorAPI().bi.event(c.bi.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"pop up message"})},handleSave:function(){this.getEditorAPI().bi.event(c.bi.events.save.saveReminder.SAVE_CLICKED,{}),this.close(),this.props.saveMethod()},getKeyboardShortcuts:function(){var a=this;return{enter:function(){a.close(),a.handleSave()},esc:function(){a.close()}}},close:function(){this.refs.frame.close()},render:d})}),define("savePublish/panels/save/saveYourSitePanel.rt",["react/addons","lodash","util","baseUI","panels"],function(a,b,c,d,e){"use strict";return function(){return a.createElement(e.frames.messagePanelFrame,{ref:"frame",panelName:this.props.panelName,className:"save-your-site-panel",panelTitle:c.translate(this.props.title),confirmLabel:"TOPBAR_SETTINGS_BUTTON_SAVE",onConfirm:this.handleSave,keyboardShortcuts:this.keyboardShortcuts},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"logo"},a.createElement(d.symbol,{name:"saveYourWork"})),a.createElement("div",{className:"message"},c.translate(this.props.messageBody))))}}),define("savePublish/panels/save/saveYourSitePanel",["react","lodash","core","savePublish/managers/saveManager","savePublish/panels/save/saveYourSitePanel.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"saveYourSitePanel",mixins:[c.mixins.editorAPIMixin],propTypes:{title:a.PropTypes.string.isRequired,messageBody:a.PropTypes.string.isRequired},getInitialState:function(){return this.keyboardShortcuts={enter:this.handleSave,esc:this.close},{}},handleSave:function(){this.close(),d.save(this.getEditorAPI())},close:function(){this.refs.frame.close()},render:e})}),define("savePublish/panels/save/savePanels",["savePublish/panels/save/chooseDomainPanel","savePublish/panels/save/siteWasSavedPanel","savePublish/panels/save/concurrentSavePanel","savePublish/panels/save/saveConfigurationPanel","savePublish/panels/save/saveReminderPanel","savePublish/panels/save/saveYourSitePanel"],function(a,b,c,d,e,f){"use strict";return{chooseDomainPanel:a,siteWasSavedPanel:b,concurrentSavePanel:c,saveConfigurationPanel:d,saveReminderPanel:e,saveYourSitePanel:f}}),define("savePublish/panels/publish/config/publishConfigurationPanel.rt",["react/addons","lodash","panels","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(c.frames.emptyPanelFrame,{ref:"publishFrame",className:"save-configuration-panel",panelName:this.props.panelName},a.createElement("a",{className:"close-button",onClick:this.close},"x"),a.createElement("h2",{style:{textAlign:"center"}},"Publish Testing Configuration"),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"Is Contributor to site",valueLink:this.linkState("isSiteContributor")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"Did Publish Succeed",valueLink:this.linkState("shouldPublishSucceed")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"Site is Premium",valueLink:this.linkState("isPremiumUser")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"First Publish",valueLink:this.linkState("isFirstPublish")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"checkbox-field",shouldTranslate:!1,label:"Is Domain Connected",valueLink:this.linkState("isDomainConnected")}),a.createElement(d.textInput,{className:"domain-text-field",shouldTranslate:!1,label:"Site address (Domain Name)",valueLink:this.linkState("sitePremiumDomain")}),a.createElement(d.button,{className:"confirm-button",disabled:!this.state.isPremiumUser&&this.state.isDomainConnected&&this.state.shouldPublishSucceed,shouldTranslate:!1,label:"Start Publish",onClick:this.onConfirm}))}}),define("savePublish/panels/publish/config/publishConfigurationPanel",["react","savePublish/panels/publish/config/publishConfigurationPanel.rt"],function(a,b){"use strict";return a.createClass({displayName:"publishConfigurationPanel",mixins:[a.addons.LinkedStateMixin],propTypes:{onConfirm:a.PropTypes.func.isRequired},getInitialState:function(){return{isSiteContributor:!1,isFirstPublish:!0,isDomainConnected:!1,isPremiumUser:!0,shouldPublishSucceed:!0,sitePremiumDomain:"http://www.published-site-domain.com"}},onConfirm:function(){this.props.onConfirm({isSiteContributor:this.state.isSiteContributor,isFirstPublish:this.state.isFirstPublish,isDomainConnected:this.state.isDomainConnected,sitePremiumDomain:this.state.sitePremiumDomain,isPremiumUser:this.state.isPremiumUser,shouldPublishSucceed:this.state.shouldPublishSucceed})},close:function(){this.refs.publishFrame.close()},render:b})}),define("savePublish/panels/publish/content/postPublishPromotePanel.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(b,d){return a.createElement("div",{className:"promote"},b.symbol?a.createElement("div",{key:"promotionSymbol-"+b.key,className:"promote-symbol promote-symbol-"+b.key},a.createElement(c.symbol,{name:b.symbol})):null,b.img&&!b.symbol?a.createElement("div",{key:"promotionImg-"+b.key,className:"promote-image",style:{backgroundImage:"url("+b.img+")"}}):null,a.createElement("div",{className:"description"},b.description),a.createElement("a",{onClick:b.action},b.actionTitle))}return function(){return a.createElement("div",{className:"panel-shout-out"},a.createElement("div",{className:"promote-title-wrapper"},a.createElement("hr",{className:"divider-long"}),a.createElement("div",{className:"promote-title"},this.getTitle()),a.createElement("hr",{className:"divider-long"})),a.createElement.apply(this,["div",{className:"promotion-content"},b.map(this.getPanelContent(),d.bind(this))]))}}),define("savePublish/panels/publish/content/shoutoutPanel",["lodash","react","core","util","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(a,b,c,d,e){"use strict";return b.createClass({displayName:"shoutoutPanel",mixins:[c.mixins.editorAPIMixin],propTypes:{isUserPremium:b.PropTypes.bool,languageCode:b.PropTypes.string,metaSiteId:b.PropTypes.string.isRequired,sitePublicUrl:b.PropTypes.string,siteNameSEO:b.PropTypes.string,siteDescriptionSEO:b.PropTypes.string,isFirstPublish:b.PropTypes.bool,userStatus:b.PropTypes.string},getTitle:function(){return d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_TITLE")},getPanelContent:function(){var a={key:"facebook",symbol:"publishFacebook",description:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_1_TITLE"),actionTitle:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_1_LINK"),action:this.openFacebook},b={key:"twitter",symbol:"publishTwitter",description:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_TITLE"),actionTitle:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_LINK"),action:this.openTwitter},c={key:"shoutout",symbol:"publishShoutout",description:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_TITLE"),actionTitle:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_LINK"),action:this.openShoutout};return[a,b,c]},openFacebook:function(){this.sendSecondPublishBI(c.bi.events.publish.Second_Publish_facebook_Share_click),c.utils.social.openFacebook(this.props.sitePublicUrl,this.props.languageCode,this.props.siteNameSEO,this.props.siteDescriptionSEO)},openTwitter:function(){this.sendSecondPublishBI(c.bi.events.publish.Second_Publish_Twitter_share_click),c.utils.social.openTwitter(this.props.sitePublicUrl,this.props.isUserPremium);
},openShoutout:function(){this.sendSecondPublishBI(c.bi.events.publish.Second_Publish_ShoutOut_Share_click),c.utils.social.openShoutout(this.props.metaSiteId)},sendSecondPublishBI:function(a){!this.props.isFirstPublish&&this.props.userStatus&&this.getEditorAPI().bi.event(a,{user_status:this.props.userStatus})},render:e})}),define("savePublish/panels/publish/content/growBusinessPanel",["react","core","util","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"growBusinessPanel",mixins:[b.mixins.editorAPIMixin],propTypes:{metaSiteId:a.PropTypes.string.isRequired,isFirstPublish:a.PropTypes.bool,userStatus:a.PropTypes.string},getTitle:function(){return c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_TITLE")},getPanelContent:function(){var a={key:"newsletter",symbol:"publishShoutout",description:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_TITLE"),actionTitle:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_LINK"),action:this.openShoutout},b={key:"mail",symbol:"promoteMail",description:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_TITLE"),actionTitle:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_LINK"),action:this.getYourOwnMailbox},d={key:"traffic",symbol:"promoteContact",description:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_TITLE"),actionTitle:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_LINK"),action:this.getTrafficApps};return[a,b,d]},openShoutout:function(){this.sendPublishBI(b.bi.events.publish.First_Publish_Send_ShoutOut_link_click,b.bi.events.publish.Second_Publish_ShoutOut_Share_click),b.utils.social.openShoutout(this.props.metaSiteId)},getYourOwnMailbox:function(){this.sendPublishBI(b.bi.events.publish.First_Publish_get_own_Mailbox_link_click,b.bi.events.publish.Second_Publish_get_own_Mailbox_click),window.open("https://premium.wix.com/wix/api/googleMailBoxConsole?referralAdditionalInfo=da_quick_actions")},getTrafficApps:function(){this.sendPublishBI(b.bi.events.publish.First_Publish_Traffic_Apps_link_click,b.bi.events.publish.Second_Publish_Traffic_Apps_click);var a=["http://www.wix.com/my-account/sites/",this.props.metaSiteId,"/apps/all?referralInfo=premium_publish"].join("");window.open(a)},sendPublishBI:function(a,b){this.props.isFirstPublish&&this.props.userStatus?this.getEditorAPI().bi.event(a,{user_status:this.props.userStatus}):!this.props.isFirstPublish&&this.props.userStatus&&this.getEditorAPI().bi.event(b,{user_status:this.props.userStatus})},render:d})}),define("savePublish/panels/content/musicPromoContent.rt",["react/addons","lodash","savePublish/panels/content/generalContent"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement(c,d({className:"music-promo-content "+this.props.className},this.getGeneralContentProps()))}}),define("savePublish/panels/content/musicPromoContent",["react","lodash","core","util","staticAssets","savePublish/panels/content/musicPromoContent.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"musicPromoContent",propTypes:{className:a.PropTypes.string,closePanel:a.PropTypes.func.isRequired},mixins:[c.mixins.editorAPIMixin],getGeneralContentProps:function(){var a,b,c=d.browserUtil.getDevicePixelRatio();c>=2?(a=d.media.getMediaUrl(e.staticAssetsMap["savePublish/panels/content/musicPromotionRetina.png"]),b={width:110.5}):a=d.media.getMediaUrl(e.staticAssetsMap["savePublish/panels/content/musicPromotion.png"]);var f={className:"",imageSrc:a,imageStyle:b,mainTitle:d.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:d.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_TITLE"),subtitle:d.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BODY1"),actionLabel:d.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BUTTON"),shouldTranslate:!1,actionCallback:this.handleActionClicked};return f},handleActionClicked:function(){var a=c.bi.events.musicPromotionPopup.submit_video_clicked,b={origin:"post-publish-link"};this.getEditorAPI().bi.event(a,b);var e=d.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BUTTON_URL");this.props.closePanel(),window.open(e)},render:f})}),define("savePublish/panels/publish/publishSuccessPanel.rt",["react/addons","lodash","panels","util","baseUI","symbols"],function(a,b,c,d,e,f){"use strict";function g(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function h(){var b=this.getInnerPanel();return a.createElement(c.frames.focusPanelFrame,g({ref:"frame",className:this.getFrameClass(),frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},this.getFrameProps()),a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:this.props.closePanel},a.createElement(f.symbol,{name:"headerCloseButton"})),a.createElement("span",{className:"title"},d.translate("PUBLISH_CONGRATULATIONS_TITLE_TITLE")),a.createElement("span",{className:"subtitle"},d.translate("PUBLISH_CONGRATULATIONS_TITLE_SUBTITLE"))),a.createElement("div",{className:"address-bar-wrapper"},a.createElement("span",{className:"address"},a.createElement(e.domainInput,{value:this.getSiteUrl(),isEditable:!1,biHandler:this.domainInputBiReporter})),a.createElement(e.button,{className:"view-site-button",label:"SAVE_PUBLISH_BUTTON_VIEW",onClick:this.viewYourSite})),null!==b?a.createElement("div",{key:"innerPanel",className:"publish-inner-panel"},b):null,a.createElement("div",{className:"publish-success-footer"},this.isDontShowAgainCheckboxVisible()&&null!==b?a.createElement(e.toggle,{key:"dontShowAgain",name:"checkbox",labelAfterSymbol:!0,className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",onChange:this.toggleDontShowAgain}):null,a.createElement("div",{className:"footer-buttons"},this.isSecondaryButtonDisplayed()?a.createElement(e.button,{key:"secondaryFooterButton",className:"btn-confirm-secondary",label:this.getSecondaryButtonText(),onClick:this.handleSecondaryButtonClicked}):null,a.createElement(e.button,{className:"btn-confirm-primary",label:this.getPrimaryButtonText(),onClick:this.handlePrimaryButtonClicked}))))}return function(){return h.apply(this,[])}}),define("savePublish/panels/publish/publishSuccessPanel",["react","lodash","core","util","savePublish/panels/publish/publishInnerPanelTypes","savePublish/panels/publish/content/shoutoutPanel","savePublish/panels/publish/content/growBusinessPanel","savePublish/panels/content/connectDomain","savePublish/panels/content/musicPromoContent","savePublish/panels/publish/publishSuccessPanel.rt","experiment!publishUpgradeButtons","experiment!spanishUpgradeText"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m="savePublish.panels.connectDomainInProgress";return a.createClass({displayName:"publishSuccessPanel",mixins:[a.addons.LinkedStateMixin,c.mixins.editorAPIMixin],propTypes:{isFakePanel:a.PropTypes.bool,contentPanelType:function(a,c){return b.includes(e,a[c])},configuration:a.PropTypes.object.isRequired,currentDomain:a.PropTypes.string.isRequired,userPreferences:a.PropTypes.object,sitePublicUrl:a.PropTypes.string.isRequired,closePanel:a.PropTypes.func.isRequired},componentDidMount:function(){this.sendPanelMountedBI()},getInitialState:function(){return{dontShowAgain:!1}},getShortcuts:function(){var a=this;return{esc:function(){a.refs.frame.close()},enter:this.handlePrimaryButtonClicked}},getFrameProps:function(){return{panelName:this.props.panelName,shouldHideHeader:!0}},getInnerContentClass:function(){if(null===this.props.contentPanelType)return null;var a=this.props.contentPanelType.name;switch(a){case e.SHOUTOUT.name:return"grow-business-inner-panel";case e.CONNECT_DOMAIN.name:return"connect-domain-inner-panel";case e.GROW_BUSINESS.name:return"grow-business-inner-panel";case e.MUSIC_PROMO.name:return"music-promo-inner-panel";default:return""}},getFrameClass:function(){var a="publish-success-panel save-publish-panel",b=this.getInnerContentClass();return a+=b?" contains-"+b:""},onDoneAndBI:function(a){this.sendActionButtonClickedBI(a),this.onDone()},onDone:function(){if(this.state.dontShowAgain||this.props.isFakePanel){var a=this.props.contentPanelType.userPref;if(a){var b=this.state.dontShowAgain;this.setDontShowPanelValue(a,b)}}this.props.closePanel()},isDontShowAgainCheckboxVisible:function(){var a=this.props.configuration.isFirstPublish;return!a&&null!==this.props.contentPanelType},isSecondaryButtonDisplayed:function(){return k&&!this.props.configuration.isDomainConnected&&this.props.contentPanelType.name===e.CONNECT_DOMAIN.name},setDontShowPanelValue:function(a,b){a&&this.props.userPreferences.session.set(a,b)},viewYourSite:function(){this.sendViewSiteBI();var a=this.getEditorAPI().site.getSitePublicUrl();this.props.configuration.isDomainConnected&&(a=this.props.configuration.sitePremiumDomain),window.open(a)},getSiteUrl:function(){return this.props.configuration.sitePremiumDomain||this.props.sitePublicUrl},getInnerPanel:function(){if(null===this.props.contentPanelType)return null;var b=this.props.contentPanelType.name,c=null,d=null;switch(b){case e.SHOUTOUT.name:c=f,d=this.getShoutoutPanelProps();break;case e.CONNECT_DOMAIN.name:c=h,d=this.getConnectDomainPanelProps(this.props.configuration);break;case e.GROW_BUSINESS.name:c=g,d={metaSiteId:this.getEditorAPI().generalInfo.getMetaSiteId(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish};break;case e.MUSIC_PROMO.name:c=i,d={closePanel:this.onDone}}return c?a.createElement(c,d):null},getShoutoutPanelProps:function(){var a=this.getEditorAPI();return{isUserPremium:this.props.configuration.isPremiumUser,languageCode:a.getLanguageCode(),metaSiteId:a.generalInfo.getMetaSiteId(),sitePublicUrl:this.props.sitePublicUrl,siteNameSEO:a.site.getSEOSiteName(),siteDescriptionSEO:a.site.getSEOSiteDescription(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish}},getConnectDomainPanelProps:function(a){return{isFirstPublish:a.isFirstPublish,isDomainConnected:a.isDomainConnected,currentDomain:this.props.sitePublicUrl,sitePublishedDomain:a.sitePremiumDomain,isSitePremium:a.isPremiumUser,isFirstSave:a.isFirstSave,closePanel:this.onDone,flowId:c.constants.CONNECT_DOMAIN.FLOWS.PUBLISH,actionCallback:this.sendConnectDomainClickedBI}},getPrimaryButtonText:function(){return this.isSecondaryButtonDisplayed()?this.props.configuration.isPremiumUser?"Save_Publish_POST_CONNECT_NOW":"Save_Publish_POST_UPGRADE_NOW":"SAVE_PUBLISH_BUTTON_DONE"},getSecondaryButtonText:function(){return"Save_Publish_POST_CONNECT_LATER"},handlePrimaryButtonClicked:function(){var a=this.props.configuration.isFirstPublish,b=c.bi.events.publish,d=a?b.First_Publish_Done_click:b.Second_Publish_Done_click;if(this.isSecondaryButtonDisplayed())if(this.isConnectDomainInProgress())this.openConnectDomainInProgressPanel(),d=b.publish_flow_connect_domain_now_button_click;else if(this.props.configuration.isPremiumUser)this.getEditorAPI().account.openConnectDomain(c.constants.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON,a),d=b.publish_flow_connect_domain_now_button_click;else{var e="edhtml_PUBLISH_FLOW_UPGRADE_BUTTON_"+(a?"FIRST_PUBLISH":"SECOND_PUBLISH");this.getEditorAPI().account.upgrade(e),d=b.publish_flow_upgrade_now_button_click}this.onDoneAndBI(d)},handleSecondaryButtonClicked:function(){var a=this.props.configuration.isFirstPublish,b=c.bi.events.publish,d=a?b.First_Publish_Done_click:b.Second_Publish_Done_click;this.isSecondaryButtonDisplayed()&&(d=this.props.configuration.isPremiumUser?b.publish_flow_connect_domain_later_button_click:b.publish_flow_upgrade_later_button_click),this.onDoneAndBI(d)},isConnectDomainInProgress:function(){var a=this.props.configuration.sitePremiumDomain,c=this.props.configuration.isDomainConnected,d=this.props.configuration.isPremiumUser,e=!b.isEmpty(a)&&!b.includes(a,"wix.com");return d&&e&&!c},openConnectDomainInProgressPanel:function(){this.getEditorAPI().panelManager.openPanel(m,{connectedDomainURL:this.props.configuration.sitePremiumDomain,currentPublicURL:this.props.sitePublicUrl},!0)},sendPanelMountedBI:function(){var a=c.bi.events.publish.publish_success_panel_opened_with_content,b={is_first_publish:this.props.configuration.isFirstPublish,message:this.props.contentPanelType.name};this.sendBI(a,b)},sendConnectDomainClickedBI:function(){var a=null,b=null;a=this.props.configuration.isFirstPublish?c.bi.events.publish.First_Publish_connect_domain_click:c.bi.events.publish.Second_Publish_connect_domain_click,this.props.configuration.isSitePremium&&!this.props.configuration.isDomainConnected?b={user_status:"Not Connected Premium"}:this.props.configuration.isSitePremium||(b={user_status:"free user"}),a.fields.message&&(b.message=this.props.contentPanelType.name),a&&b&&this.sendBI(a,b)},sendActionButtonClickedBI:function(a){var b=this.props.configuration.isFirstPublish,c={user_status:this.getUserStatus()};a.fields.is_first_publish&&(c.is_first_publish=b),a.fields.message&&(c.message=this.props.contentPanelType.name),this.sendBI(a,c)},sendViewSiteBI:function(){this.sendBI(c.bi.events.publish.publish_view_your_site_click,{is_first_publish:this.props.configuration.isFirstPublish?1:0,panel_name:"savePublish.panels.publish.publishSuccessPanel",user_status:this.getUserStatus()})},getUserStatus:function(){var a=this.props.configuration.isPremiumUser,b=this.props.configuration.isDomainConnected,c=null;return a?a&&b?c="Connected Premium":a&&!b&&(c="Not Connected Premium"):c="free user",c},toggleDontShowAgain:function(){var a=!this.state.dontShowAgain;this.sendToggleDontShowAgainBI(a),this.setState({dontShowAgain:a})},sendToggleDontShowAgainBI:function(a){a=a?1:0,this.props.configuration.isFirstPublish?this.sendBI(c.bi.events.publish.First_Publish_dont_show_again_click,{toggle:a,user_status:this.getUserStatus()}):this.sendBI(c.bi.events.publish.Second_Publish_dont_show_again_click,{toggle:a})},domainInputBiReporter:function(a){var b={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"publish",is_first_save_or_publish:this.props.configuration.isFirstPublish?1:0};this.sendBI(c.bi.events.domainInput[a],b)},sendBI:function(a,b){this.getEditorAPI().bi.event(a,b)},render:j})}),define("savePublish/panels/publish/publishPanels",["savePublish/panels/publish/config/publishConfigurationPanel","savePublish/panels/publish/publishSuccessPanel"],function(a,b){"use strict";return{config:{publishConfigurationPanel:a},publishSuccessPanel:b}}),define("savePublish",["lodash","savePublish/managers/saveManager","savePublish/managers/mockSaveManager","savePublish/managers/publishManager","savePublish/panels/connectDomain/connectDomainPanel","savePublish/panels/connectDomain/connectDomainInProgress","savePublish/panels/common/commonPanels","savePublish/panels/save/savePanels","savePublish/panels/publish/publishPanels"],function(a,b,c,d,e,f,g,h,i){"use strict";return{save:b.save,saveAsTemplate:b.saveAsTemplate,saveInBackground:b.saveInBackground,configureSave:c.save,isSaveInProgress:b.isSaveInProgress,isPublishInProgress:d.isPublishInProgress,setTimerForSaveReminder:b.setTimerForSaveReminder,panels:{connectDomain:e,connectDomainInProgress:f,common:g,publish:i,save:h},publish:d.publish,saveAndPublish:d.saveAndPublish,configurePublish:d.configurePublish}});