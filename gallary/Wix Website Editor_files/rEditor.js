define("rEditor/app/panelHelpers",["lodash","util","core"],function(a,b,c){"use strict";function h(){return(g++).toString()}function i(c){var d=a.map(c.items,function(a){var c=a.link;return{id:h(),data:a,linkText:c?b.link.getLinkValueAsString(this,c,!0):""}},this);return d}function j(a,b){a&&a(b)}function k(a,b){var c=this.selection.getSelectedComponentData();return{imageDatas:i.call(this,c),isPreset:c.metaData.isPreset,imagesChanged:j.bind(this,b),createImageDataItem:this.data.createItem.bind(null,"Image"),galleryType:a}}function l(b,c){var d=this.panelManager.getOpenPanels();a.find(d,{name:b})?c&&this.panelManager.updatePanelProps(b,c):this.panelManager.openPanel(b,c)}var d="panels.focusPanels.organizeImagesPanel",e="panels.focusPanels.aviaryPanel",f={NOTIFICATION_RATE:10,FORBIDDEN_COMP_TYPES:["wysiwyg.common.components.anchor.viewer.Anchor","mobile.core.components.Page"],DESKTOP:{DONT_SHOW_AGAIN_KEY:c.constants.USER_PREFS.OUT_OF_GRID.DESKTOP.OUT_OF_GRID_DONT_SHOW_AGAIN,OUT_OF_GRID_COUNT_KEY:c.constants.USER_PREFS.OUT_OF_GRID.DESKTOP.OUT_OF_GRID_COUNT,PANEL_NAME:"panels.focusPanels.outOfGridDesktopPanel"},MOBILE:{DONT_SHOW_AGAIN_KEY:c.constants.USER_PREFS.OUT_OF_GRID.MOBILE.OUT_OF_GRID_DONT_SHOW_AGAIN,OUT_OF_GRID_COUNT_KEY:c.constants.USER_PREFS.OUT_OF_GRID.MOBILE.OUT_OF_GRID_COUNT,PANEL_NAME:"panels.focusPanels.outOfGridMobilePanel"}},g=0;return{openOrganizeImagesPanel:function(a){this.panelManager.openPanel(d,k.call(this,"images",a),!0)},openOrganizeSocialIconsPanel:function(a){this.panelManager.openPanel(d,k.call(this,"socialIcons",a))},openAviaryPanel:function(a){this.panelManager.openPanel(e,{imageLink:a,editorAPI:this,onDialogResult:function(){this.panelManager.closePanelByName(e)}.bind(this)},!0)},openPagesPanel:function(a){var b=this.isMobileEditor()?"rEditor.panels.pagesPanelMobile":"rEditor.panels.pagesPanel";l.call(this,b,a)},openMobileElementsPanel:function(a){if(this.isMobileEditor()){var b="mobileEditor.mobileElementsPanel",d=(new Date).getTime();a=a||{},a.key=c.lazyComponent.isLoaded(b)?b+d:b+"loading",l.call(this,b,a,"leftPanelFrame")}},openCompOutOfGridPanel:function(b){var c=this.isMobileEditor()?f.MOBILE:f.DESKTOP,d=this.components.getType(this.selection.getSelectedComponents()),e=this.userPreferences.site.get(c.DONT_SHOW_AGAIN_KEY);if(!e&&!a.includes(f.FORBIDDEN_COMP_TYPES,d)){var g=this.userPreferences.session.get(c.OUT_OF_GRID_COUNT_KEY)||0;g%f.NOTIFICATION_RATE===0&&this.panelManager.openPanel(c.PANEL_NAME,b,!0),g+=1,this.userPreferences.session.set(c.OUT_OF_GRID_COUNT_KEY,g)}},openDragToHeaderPanel:function(a){var b=this.userPreferences.site.get(c.constants.USER_PREFS.DRAG_TO_HEADER.DONT_SHOW_AGAIN);if(!b){var d=this.userPreferences.session.get(c.constants.USER_PREFS.DRAG_TO_HEADER.DRAG_COUNT)||0;d%10===0&&this.panelManager.openPanel("panels.focusPanels.dragToHeaderPanel",a),d+=1,this.userPreferences.session.set(c.constants.USER_PREFS.DRAG_TO_HEADER.DRAG_COUNT,d)}},openPinModeSizeRestrictionPanel:function(a){var b=this.userPreferences.site.get(c.constants.PANELS.PIN_TOO_BIG.PIN_TOO_BIG_DONT_SHOW_AGAIN);b||this.panelManager.openPanel(c.constants.PANELS.PIN_TOO_BIG.PANEL_NAME,a,!0)},openLinkPanel:function(a,c){this.panelManager.openPanel("panels.toolPanels.linkPanel",b.link.getLinkPanelProps(this,a),!c)}}}),define("rEditor/app/updateOperationsPlugins",["lodash"],function(a){"use strict";function b(){var b=arguments;a.forEach(this.list,function(a){a.apply(this,b)})}return{setHomePagePlugins:{list:[],run:b},updatePagePlugins:{list:[],run:b}}}),define("rEditor/app/updateOperationsPlugins/siteSeoUpdateOperationPlugin",["rEditor/app/updateOperationsPlugins"],function(a){"use strict";function b(a,b){b=b&&b.replace(/^#/,"")||a.homePage.get();var c=a.pages.data.get(b);return{name:c.pageTitleSEO,description:c.descriptionSEO,keywords:c.metaKeywordsSEO}}function c(a,b){a.site.setSEOSiteName(b.name),a.site.setSEOSiteDescription(b.description),a.site.setSEOSiteKeywords(b.keywords)}return{register:function(){a.setHomePagePlugins.list.push(function(a,d){c(a,b(a,d))}),a.updatePagePlugins.list.push(function(a,d){var e=d===a.homePage.get();e&&c(a,b(a,d))})}}}),define("rEditor/app/pluginsRegistrar",["rEditor/app/updateOperationsPlugins/siteSeoUpdateOperationPlugin"],function(a){"use strict";return{register:function(){a.register()}}}),define("rEditor/utils/removeUtil",["lodash","panels","util","core"],function(a,b,c,d){"use strict";function m(a,b,c,d){var e=b.tpa.app.getData(a.applicationId);c.app_id=e.appDefinitionId,c.app_site_id=e.instanceId,c.instance_id=d}function s(b,d,f,g,h,i,j){var k=f[0];e.openPanel("tpa.confirmation.deleteContainerContainsPremiumTpa",{appName:k.appDefinitionName,appDefId:k.appDefinitionId,appCount:f.length,onConfirm:function(e){r(b,d,g,!1,i,j),e.bi.reportBI(c.bi.events.COMPONENT_REMOVED,h),a.forEach(h,function(a){e.bi.event(c.bi.events.REMOVE_COMPONENT_SECOND_STEP_CLICK,a)})}},!0)}var e=b.panelManager,f=function(a){return!!a.tpaApplicationId},g=function(a,b,c){var d=a.app.isPremium(b);return d&&c>1?!0:!d&&c>0},h=function(b,d,h,i,k){var l=d.pages.getReference(i),m=d.pages.data.get(i),n=d.tpa.getPremiumTpaChildrenOnPage(l,m.tpaApplicationId,!0),o=d.wixapps.classics.isBlogPage(i),p=d.components.getTpaChildren(l);o&&(p=p.concat(d.components.getBlogChildren(l)));var q=b.bi.getComponentsBIParams(p);a.forEach(q,function(a){a.removal_method="delete_page"});var r=f(m)&&d.tpa.app.isMultiSectionInstalled(m.tpaApplicationId);if(n.length>0&&!r||r&&g(d.tpa,m.tpaApplicationId,n.length)){var s=m&&m.title||"",t=n[0];e.openPanel("tpa.confirmation.deletePageContainsPremiumTpa",{appName:t.appDefinitionName,appDefId:t.appDefinitionId,appCount:n.length,pageTitle:s,onConfirm:function(){j(b,d,i,m,h,!1,q,k),a.forEach(n,function(a,e){var f={app_id:a.appDefinitionId,app_site_id:a.instanceId,instance_id:p[e].id,is_last_tpa:d.tpa.app.isLastAppComp(a.applicationId)?1:0,component_type:"tpa"};b.bi.event(c.bi.events.REMOVE_COMPONENT_SECOND_STEP_CLICK,f)})}},!0)}else o?e.openPanel("blog.blogDeleteConfirmation",{onConfirm:function(){j(b,d,i,m,h,!1,q,k)}},!0):j(b,d,i,m,h,!0,q,k)},i=function(a,b){a.bi.reportBI(c.bi.events.COMPONENT_REMOVED,b)},j=function(b,c,d,f,g,h,j,l){var m=c.tpa.section.getPageData(d),n=m.hasSection&&g[c.tpa.constants.COMP_TYPES.TPA_SECTION],o=c.wixapps.classics.isBlogPage(d);if(o)g.blog&&g.blog(),b.pages.beforePageRemoveHook(d,function(){a.forEach(c.pages.getPagesData(),function(a){c.wixapps.classics.isBlogPage(a.id)&&(c.pages.remove(a.id),i(b,j))}),l&&l()});else if(n)g[c.tpa.constants.COMP_TYPES.TPA_SECTION](d,m.title,m.appData,h,l,j);else if(h){var p={pageTitle:f.title,onConfirm:k.bind(this,b,c,d,l,j)};e.openPanel("pagesMenu.deletePageMessage",p,!0)}else k(b,c,d,l,j)},k=function(a,b,c,d,e){a.pages.beforePageRemoveHook(c,function(){b.pages.remove(c),d&&d(),i(a,e)})},l=function(a,b){a.components.remove(b)},n=function(b,c,f){a.forEach(f,function(a){var f=b.components.getType(a),g=c.mobile.mobileOnlyComponents.isMobileOnlyComponent(a.id)?a.id:f,h=b.components.data.get(a);b.mobile.hiddenComponents.hide(a),e.openPanel("mobileEditor.hiddenItemsPanel");var i={current_page_name:b.pages.getCurrentPageId(),component_id:g,origin:"",component_type:f};c.isTpa(f)&&m(h,c,i,a.id),c.bi.event(d.bi.events.mobileEditor.hiddenElements.HIDDEN_ELEMENTS_HIDE,i)})},o=function(b,d,e,f,g,h){var i=a.some(e,b.components.is.container),j=e.length>1;if(b.viewMode.get()===b.viewMode.VIEW_MODES.MOBILE)n(b,f,e),g&&g();else{var k=b.tpa.getPremiumTpaChildren(e),l=a.reject(k,b.tpa.app.hasSections),m=p(b,f,e);if((i||j)&&l.length>0)s(b,d,k,e,m,g,h);else{var o=q(e.length,function(){f.bi.reportBI(c.bi.events.COMPONENT_REMOVED,m)});r(b,d,e,!0,function(){return o(),g?g(arguments):null},h)}}},p=function(b,c,d){var e=b.tpa.getTpaPointersRecursive(d),f=d.concat(e);f=a.uniq(f,"id");var g=c.bi.getComponentsBIParams(f);return g},q=function(a,b){var c=a;return function(){c--,0===c&&b()}},r=function(b,c,d,e,f,g){a.forEach(d,function(a){var d=b.components.getType(a);c[d]?c[d](a,e,f):b.components.remove(a,f,g)})};return{removePage:h,removeComponent:o,cutComponent:l}}),define("rEditor/app/APISections/concurrentUsersWrapper",["lodash","jquery","util","panels"],function(a,b,c,d){"use strict";function m(){j&&(clearTimeout(j),j=null),i=null,k=!1}function n(){k||(k=!0,o(this,!0))}function o(a,b){p(a)?j=q(a)?setTimeout(function(){o(a,b)},h):setTimeout(function(){var c=r.bind(null,a,b);u(a,c)},b?0:h):m()}function p(b){var d=b.generalInfo.getUserInfo(),e=c.cookie.getCookie("wixClient");return d&&d.name&&a.includes(e,d.name)}function q(a){return a.generalInfo.isFirstSave()}function r(b,c,f){if(c&&null===l&&(l=a.isEmpty(f)),!a.isEmpty(f)&&!t(i,f)){var g=s(i,f);i=f;var h={isFirstUser:l,concurrentUsers:f,concurrentUserToDisplay:g};d.panelManager.openPanel(e,h)}o(b,!1)}function s(b,c){var d={};a.forEach(b,function(a){d[a]=d});var e=null;return a.forEach(c,function(a){return d[a]?void 0:(e=a,!1)}),e}function t(b,c){if(b===c)return!0;if(b&&!c||!b&&c||a.size(b)<a.size(c))return!1;var d={},e=b.length;return a.forEach(b,function(a){d[a]=a}),a.forEach(c,function(a){d[a]=a}),e===a.size(d)}function u(a,b){if(b){var d=a.generalInfo.getMetaSiteId(),e=c.editorModel.editorSessionId;v(d,e,b)}}function v(a,c,d){var e=null,f=g({msid:a,esi:c});b.get(f).done(function(a){a&&(e=a.otherUsersOnSite||null),d(e)}).fail(function(){d(e)})}var e="panels.messagePanels.concurrentUserPanel",f="http://editor.wix.com/concurrent-editing-session-watcher/watcher/report",g=a.template(f+"?msid=<%= msid %>&esi=<%= esi %>"),h=6e4,i=null,j=null,k=!1,l=null;return{concurrentUsers:{checkForConcurrentUsers:n,stopCheckForConcurrentUsers:m}}}),define("rEditor/app/APISections/themeWrapper",["lodash"],function(a){"use strict";return{theme:{colors:{get:function(b){return a.includes(b,"color")?this.documentServices.theme.colors.get(b):b}},styles:{getExcludedList:function(){return this.theme.styles.excludedList||[]},setExcluded:function(a){var b=this.theme.styles;b.excludedList||(b.excludedList=[]),b.excludedList.push(a)},update:function(b,c,d){this.updateHooks&&a.forEach(this.updateHooks,function(a){a(b,c)}),this.documentServices.theme.styles.update(b,c),d||this.history.debouncedAdd("Update component style")},getAllIds:function(){var b=this.documentServices.theme.styles;return a.difference(b.getAllIds(),this.theme.styles.getExcludedList())},registerHook:function(a){this.updateHooks=this.updateHooks||[],this.updateHooks.push(a)}}}}}),define("rEditor/app/APISections/historyWrapper",["lodash"],function(a){"use strict";function c(){a.forEach(b,this.panelManager.closePanelByName)}function d(b,d){var e=this,f=d.isMobileEditor===this.isMobileEditor(),g=this.selection.getSelectedComponents();c.call(this),this.selection.deselectComponents(),this.setEditorMode(d.isMobileEditor,function(){b.call(e.documentServices.history),e.waitForChangesApplied(function(){var b=a.filter(g,e.components.is.exist,this);if(!a.isEmpty(b)){var c=e.components.getPage(b),d=c&&c.id===e.documentServices.pages.getCurrentPageId(),h=c&&"masterPage"===c.id;f&&(d||h)&&e.selection.selectComponentByCompRef(b)}})},!0)}var b=["panels.toolPanels.colorPicker.colorPickerPanel","rEditor.panels.backgroundApplyPanel","compPanels.dynamicPanels.pinnedDockPanel","rEditor.panels.slideShowBgApplyPanel"];return{history:{add:function(a){var b=this.isMobileEditor();this.documentServices.history.add(a,{label:a,currentPage:this.pages.getCurrentPageId(),isMobileEditor:b})},debouncedAdd:function(b){this.history._debouncedAdd||(this.history._debouncedAdd=a.debounce(this.history.add,500)),this.history._debouncedAdd(b)},undo:function(){this.waitForChangesApplied(function(){if(this.text.isEditingText())return void this.text.undo();var a=this.documentServices.history;if(a.canUndo()){var b=a.getUndoLastSnapshotParams();b.currentPage===this.documentServices.pages.getCurrentPageId()?d.call(this,a.undo,b):this.pages.navigateTo(b.currentPage,d.bind(this,a.undo,b))}}.bind(this))},redo:function(){this.waitForChangesApplied(function(){if(this.text.isEditingText())return void this.text.redo();var a=this.documentServices.history;if(a.canRedo()){var b=a.getRedoLastSnapshotParams();b.currentPage===this.documentServices.pages.getCurrentPageId()?d.call(this,a.redo,b):this.pages.navigateTo(b.currentPage,d.bind(this,a.redo,b))}}.bind(this))}}}}),define("rEditor/app/APISections/imageCrop",["lodash","core","util"],function(a,b,c){"use strict";function g(a,b){var c=d.getMiddlePoint(a);return d.getPointRatioFromRect(c,b)}function h(a,b,c){var d=g(a,b);return{x:c.width*d.x,y:c.height*d.y}}function i(b,c,e){var f=a.clone(c),g=a.clone(e),i=d.getMiddlePoint(e),j=h(e,b,f),k={x:j.x-i.x,y:j.y-i.y};return g.x+=k.x,g.y+=k.y,f.x-=k.x,f.y-=k.y,{originArea:f,area:g}}function j(a,b,c){var e=a/d.getAreaRatioPercentage(b,c);return d.getResizedByRatio(b,e)}function k(b){return{cropOriginArea:b,cropArea:a(b).pick(["height","width"]).assign({x:0,y:0}).value()}}function l(a,b){var c=e.reverseAutoCrop(a,b.crop),d=e.reverseManualCrop(c,b.crop,b),f=e.reverseAutoCrop(d,b),g=e.manualCrop(f,b.crop,b);return g=e.autoCrop(g,a),{cropOriginArea:f,cropArea:g}}function m(a,b){var c=e.reverseManualCrop(a,b.crop,b),d=e.manualCrop(c,b.crop,b);return{cropOriginArea:c,cropArea:d}}function n(b,c){var d=e.reverseAutoCrop(b,c),f=a.assign({},d,{x:0,y:0});return f=e.autoCrop(f,a.pick(b,["height","width"])),{cropOriginArea:d,cropArea:f}}function o(a){var b={x:0,y:0,width:this.site.getSiteWidth(),height:this.site.getHeight()};return{cropArea:e.ensure.areaWithinViewport(b,a),cropOriginArea:a.cropOriginArea}}function p(b){var c=this.components.data.get(b),d=this.components.properties.get(b).displayMode,e=this.components.layout.get(b).rotationInDegrees,g=d===f.fittingTypes.SCALE_TO_FILL,h=a.pick(this.components.layout.getRelativeToScreen(b),["height","width","x","y"]),i={};i=c.crop||g?!c.crop&&g?n(h,c):c.crop&&!g?m(h,c):l(h,c):k(h);var j=q(i.cropArea,i.cropOriginArea,e);return a.assign(i.cropOriginArea,j),i=o.call(this,i)}function q(b,e,f){var g=a.clone(b);g.x+=e.x,g.y+=e.y;var h=c.math.getPointAsIfRectWasNotRotated(g,d.getMiddlePoint(e),-f);return{x:h.x-e.width/2,y:h.y-e.height/2}}function r(){return this.editor.state.imageCrop.isOn}function s(b){var d=c.imageTransform.fittingTypes,e=d.SCALE_TO_FILL,f=d.STRETCH,g=this.components.properties.get(b).displayMode;a.includes([e,f],g)||this.components.properties.update(b,{displayMode:e})}function t(d,e){var f,g,h=this.editor.state.imageCrop,i=this.editor.state.selectedComponents;i&&(h.isOn="undefined"==typeof d?!h.isOn:d,h.isOn?(s.call(this,i),f=p.call(this,i),this.bi.event(b.bi.events.imageCrop.Open_crop_mode,{fixed_layout:!1}),g=c.keyboardShortcuts.CONTEXTS.IMAGE_CROP):(f={cropArea:null,cropOriginArea:null},g=c.keyboardShortcuts.CONTEXTS.EDITOR),a.assign(h,f),e=e||a.noop,c.keyboardShortcuts.setContext(g),h.isOn?D.call(this,h,e):this.editor.setState({imageCrop:h},e))}function u(){return a.clone(this.editor.state.imageCrop.cropArea)}function v(){return a.clone(this.editor.state.imageCrop.cropOriginArea)}function w(a){var b=this.components.get.byId("PAGES_CONTAINER"),c=this.components.layout.getRelativeToScreen(b),d=this.components.getContainer(a),e=this.components.layout.getRelativeToScreen(d);return(this.components.is.fullWidth(d)||this.components.isShowOnAllPages(a))&&(e.x+=c.x),e}function x(b,e,f){var g=d.getMiddlePoint(b),h=a.assign({},e,{x:0,y:0}),i=c.math.getPointAsIfRectWasNotRotated(h,g,-f);return{x:i.x-b.width/2,y:i.y-b.height/2}}function y(b,c){var d=this.editor.state.selectedComponents,e=this.editor.state.imageCrop,f=e.cropOriginArea,g=e.cropArea,h=this.components.layout.get(d).rotationInDegrees,i=b?{x:0,y:0}:w.call(this,d);if(!e)return null;var j=c?g:x(g,f,h);return a(g).pick(["height","width"]).assign({x:j.x+f.x-i.x,y:j.y+f.y-i.y}).value()}function z(b){return a(b).pick(["x","y","width","height"]).mapValues(Math.round).value()}function A(b,c){var d=a.cloneDeep(b);d.cropArea=z(b.cropArea),d.cropOriginArea=z(b.cropOriginArea),c=c||a.noop,this.editor.setState({imageCrop:d},c)}function B(b,c){var d=a.assign({},this.editor.state.imageCrop,{cropOriginArea:b});A.call(this,d,c)}function C(b,c){var d=a.assign({},this.editor.state.imageCrop,{cropArea:b});A.call(this,d,c)}function D(b,c){var d=a.assign({},this.editor.state.imageCrop,b);A.call(this,d,c)}function E(){var b=this.editor.state.selectedComponents,c=this.components.data.get(b),e=this.components.layout.get(b).fixedPosition,f=this.imageCrop.getCropArea(),g=this.imageCrop.getCropOriginArea(),h=this.imageCrop.getCropAreaFinalPosition(e),i={width:g.width/c.width,height:g.height/c.height},j=a.mapValues({x:f.x/i.width,y:f.y/i.height,height:f.height/i.height,width:f.width/i.width},Math.round),k=d.areRectsTheSameSize(c,j)&&0===j.x&&0===j.y;k&&c.crop?this.components.data.update(b,{crop:null}):k||this.components.data.update(b,{crop:j}),this.components.layout.update(b,h)}function F(a,b,e){var f=d.getMiddlePoint(a),g=d.getMiddlePoint(b),h={x:g.x-f.x,y:g.y-f.y},i=c.math.degToRad(e),j=c.math.rotateVectorAround(h,i);return{x:c.math.roundToNearestHalf(j.x-h.x),y:c.math.roundToNearestHalf(j.y-h.y)}}function G(b,c){var g=this.components.data.get(b),h=this.components.layout.get(b),k=h.rotationInDegrees,l=this.components.properties.get(b).displayMode,m=this.imageCrop.getCropOriginArea(),n=this.imageCrop.getCropArea(),o=d.getAspectRatio(h),p=a.assign({},g,{height:g.width*o}),q=l===f.fittingTypes.STRETCH?p:g,r=d.getRectMinDimensionsByContainedInnerRect(q,n),s=j(c,m,g);s=e.ensure.scaleWithinDimensions(s,n,r);var t=i(m,s,n),u=e.ensure.areaIsFullyContained(t.originArea,t.area),v=F(m,u.originArea,k);return u.originArea.x+=v.x,u.originArea.y+=v.y,u}function H(a){return G.call(this,a,100)}function I(){var a=this.imageCrop.getCropOriginArea(),b=this.imageCrop.getCropArea(),c=Math.min(b.width,b.height);return b.height=c,b.width=c,{area:b,originArea:a}}function J(){var a=this.ui.stage.getEditingAreaLayout(),b=this.ui.scroll.getScroll(),c={originArea:v.call(this)},e=16,f=d.getRight(c.originArea),g=d.getBottom(c.originArea),h=a.width+b.scrollLeft-e,i=Math.max(this.site.getHeight(),a.height+b.scrollTop)-e,j=Math.min(h,f),k=Math.max(e,c.originArea.x),l=Math.min(i,g),m=Math.max(e,c.originArea.y);return c.area={y:Math.max(-c.originArea.y+e,0),x:Math.max(-c.originArea.x+e,0),width:j-k,height:l-m},c}var d=c.math.rect,e=c.imageCrop,f=c.imageTransform;return{imageCrop:{isCropMode:r,toggleCropMode:t,getCropArea:u,getCropOriginArea:v,getCropAreaFinalPosition:y,setCropOriginArea:B,setCropArea:C,setCropData:D,updateCrop:E,getNewCropStateByPercentageFromOriginalImage:G,quickActions:{getNewCropStateForHundredPercent:H,getNewCropStateForSquare:I,getNewCropStateResetCrop:J}}}}),define("rEditor/app/APISections/siteWrapper",["core","util"],function(a,b){"use strict";function c(a){var c=b.url,d=c.getParameterByName("ReactSource");return a=d?c.setUrlParam(a,"ReactSource",d):a}return{site:{getCurrentSiteDomain:function(){var a=window.location.hostname,b=a.match(/editor\.(.*)/);return b?"www."+b[1]:"www.wix.com"},getSEOSiteName:function(){return this.documentServices.seo.title.get()},setSEOSiteName:function(a){return this.documentServices.seo.title.set(a)},getSEOSiteDescription:function(){return this.documentServices.seo.description.get()},setSEOSiteDescription:function(a){return this.documentServices.seo.description.set(a)},getSEOSiteKeywords:function(){return this.documentServices.seo.keywords.get()},setSEOSiteKeywords:function(a){return this.documentServices.seo.keywords.set(a)},getMetaSiteId:function(){return this.documentServices.generalInfo.getMetaSiteId()},isPremium:function(){return this.documentServices&&this.documentServices.premiumFeatures&&this.documentServices.premiumFeatures.get().length>0},getXPos:function(){return this.components.layout.getRelativeToScreen(this.siteSegments.getPagesContainer()).x},getSiteDomainInfo:function(b,c){var d=this.documentServices.generalInfo.getMetaSiteId();a.premiumServicesAPI.getSiteDomainInfo(d,b,c)},getSitePremiumPackage:function(){return this.editor.state.site.premiumPackage||-1},getSitePublicUrl:function(){var a=this.generalInfo.getPublicUrl()||this.domain.getFreeDomainPrefix()+this.siteName.get();return a=c(a)},getSiteWidth:function(){var a=document.getElementById("preview").getBoundingClientRect();return a.width}}}}),define("rEditor/app/APISections/domainWrapper",["lodash","util"],function(a,b){"use strict";function c(){return this.generalInfo.urlFormat.isSlash()?"wixwebsite.com":"wix.com"}return{domain:{isDomainConnected:function(){var b=this.generalInfo.getPublicUrl();return null!==b&&void 0!==b&&!a.includes(b,c.call(this))},getFreeDomainPrefix:function(){return"http://"+this.generalInfo.getUserInfo().name+"."+c.call(this)+"/"},doesUserOwnGoogleDomain:function(){var a=b.cookie.getCookie("wixClient");return a.indexOf("GOOGLE_DOMAIN")>0||a.indexOf("REGRU")>0}}}}),define("rEditor/app/APISections/developerMode",["core"],function(a){"use strict";function b(){var b=!c.call(this),d={developerModeEnabled:b,developerToolBarEnabled:b};this.userPreferences.site.set(a.constants.USER_PREFS.VIEW_TOOLS.DEVELOPER_MODE_ENABLED,b),this.userPreferences.site.set(a.constants.USER_PREFS.VIEW_TOOLS.DEVELOPER_TOOLBAR_ENABLED,b),b&&this.editor.state.viewTools.toolbarEnabled&&(d.toolbarEnabled=!1),b&&!this.userPreferences.site.get(a.constants.USER_PREFS.DEVELOPER_MODE.FIRST_TIME)&&(this.panelManager.openPanel("wixCode.panels.developerWelcomePanel"),this.userPreferences.site.set(a.constants.USER_PREFS.DEVELOPER_MODE.FIRST_TIME,!0)),this.updateEditorViewTools(d)}function c(){var a=this.getViewTools();return a?a.developerModeEnabled:!1}var d={isEnabled:c,toggle:b};return{developerMode:d}}),define("rEditor/app/APISections/selectedComponent",["lodash"],function(a){"use strict";var b=function(a){var b=this.components.layout.get(a),c=!b.fixedPosition;return this.components.layout.setFixed(a,c),c};return{selectedComponent:{sendSelectedComponentBI:function(b,c){var d=this.selection.getSelectedComponents();if(b&&d){var e=this.getComponentType(d),f={component_id:a.first(d).id,component_type:e};c&&a.merge(f,c),this.bi.event(b,f)}},copy:function(){return this.components.copy(this.selection.getSelectedComponents())},duplicate:function(){return this.components.duplicate(this.selection.getSelectedComponents())},cut:function(){var a=this.selection.getSelectedComponents();return this.selection.isComponentSelected()&&this.components.cut(a),a},remove:function(a){var b=this.selection.getSelectedComponents();return this.selection.isComponentSelected()&&this.components.remove(b,a),b},copyStyle:function(){console.log("copyStyle")},pasteStyle:function(){console.log("pasteStyle")},lock:function(){console.log("lock")},toggleFixedPosition:function(){var a=this.selection.getSelectedComponents();return a&&this.components.layout.canBeFixedPosition(a)?b.call(this,a):!1},togglePin:function(){var a=this.selection.getSelectedComponents();return a?b.call(this,a):!1}}}}),define("rEditor/app/APISections/savePublishWrapper",["lodash","core","util"],function(a,b,c){"use strict";function e(){this.userPreferences.loadSitePreferences(this.documentServices.generalInfo.getSiteId(),!0),this.leftBar.collapseMenu()}function f(a){try{return JSON.stringify(a)}catch(b){return"Failed to stringify save error info"}}function g(c,d,e){var f=a.keys(d),g=a.compact(a.pluck(d,"errorCode")),h=a.compact(a.pluck(d,"errorType")),i={p1:f,p2:h,p3:g};e?c.bi.error(b.bi.errors.FIRST_SAVE_ERROR,i):c.bi.error(b.bi.errors.SAVE_ERROR,i)}function h(a,b){return a?"first":b?"full":"partial"}var d=[e],i=c.newrelic,j=0,k=0;return{savePublish:{save:function(c,e,k,l){function s(){q.duration=a.now()-n,m.bi.event(b.bi.events.save.saveProcess.SUCCESS_SAVE_PROCESS,q),r=a.assign(r,q,{result:"success"}),i.addPageAction("save finish",r),o&&a.forEach(d,function(a){a.call(m)}),c&&(m.isSavedInCurrentSession=!0,c()),m.editor.setState({savingStatus:b.constants.PROGRESS_STATUS.DONE_SUCCESS}),setTimeout(function(){m.editor.setState({savingStatus:b.constants.PROGRESS_STATUS.IDLE})},b.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)}function t(c){g(m,c,o),r=a.assign(r,{result:"failure",error:f(c)}),i.addPageAction("save finish",r),e&&e(c),m.editor.setState({savingStatus:b.constants.PROGRESS_STATUS.DONE_FAILED}),setTimeout(function(){m.editor.setState({savingStatus:b.constants.PROGRESS_STATUS.IDLE})},b.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)}var m=this,n=a.now();this.editor.setState({savingStatus:b.constants.PROGRESS_STATUS.IN_PROGRESS});var o=this.documentServices.generalInfo.isFirstSave(),p=h(o,k);m.bi.event(b.bi.events.save.saveProcess.SAVE_CLICK,{origin:l});var q={save_type:p};m.bi.event(b.bi.events.save.saveProcess.START_SAVE_PROCESS,q);var r=a.assign({is_first_save:o,save_count:++j},q);i.addPageAction("save start",a.clone(r)),m.documentServices.save(s,t,k),i.addPageAction("save computed",a.assign(a.clone(r),{duration:a.now()-n}))},saveAsTemplate:function(a,b){function c(a){b&&b(a),console.log("Failed saving as template ",a)}function d(){a&&a()}this.documentServices.saveAsTemplate(d,c)},publish:function(c,d){function g(){f.result="success",i.addPageAction("publish finish",f),a.forEach(e.sitePublishedCallbacks,function(a){a()}),c&&c(),e.editor.setState({publishingStatus:b.constants.PROGRESS_STATUS.DONE_SUCCESS}),setTimeout(function(){e.editor.setState({publishingStatus:b.constants.PROGRESS_STATUS.IDLE})},b.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)}function h(a){f.result="failure",i.addPageAction("publish finish",f),d&&d(a),e.editor.setState({publishingStatus:b.constants.PROGRESS_STATUS.DONE_FAILED}),setTimeout(function(){e.editor.setState({publishingStatus:b.constants.PROGRESS_STATUS.IDLE})},b.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)}var e=this;this.editor.setState({publishingStatus:b.constants.PROGRESS_STATUS.IN_PROGRESS});var f={publish_count:++k};i.addPageAction("publish start",a.clone(f)),this.documentServices.publish(g,h)},registerFirstSaveCallback:function(a){d.push(a)}}}}),define("rEditor/utils/multiSelectHandler",["lodash"],function(a){"use strict";return function(){var b=a.toArray(arguments),c=b.shift(),d=b.pop(),e=this.components.asArray(c);return this.multiselect.isMultiselect(e)?d.multiCompHandler.apply(this,[e].concat(b)):d.singleCompHandler.apply(this,[e[0]].concat(b))}}),define("rEditor/app/APISections/componentsFacade/layoutWrapper",["lodash","experiment","core","util","rEditor/utils/multiSelectHandler"],function(a,b,c,d,e){"use strict";function f(a,b,c){var e=l.call(this,a,b),f=d.layoutUtils.getLayoutRelativeToParentFromRelativeToScreen(this,a,e);this.documentServices.components.layout.update(a,f),c||this.history.debouncedAdd("component - update layout")}function g(a,b,c){var e=d.layoutUtils.getLayoutRelativeToParentFromRelativeToStructure(this,a,b);this.components.layout.update(a,e,c)}function h(a,b,c){var e=d.layoutUtils.getLayoutRelativeToParentFromRelativeToScreen(this,a,b);this.components.layout.updateAndPreserveProportions(a,e,c)}function i(a,b,c){var e=d.layoutUtils.getLayoutRelativeToParentFromRelativeToStructure(this,a,b);this.components.layout.updateAndPreserveProportions(a,e,c)}function j(a,b,c){this.documentServices.components.layout.updateAndPreserveProportions(b,c,!0)}function k(a,b){var d=this.components.layout.get(a);return c.utils.updateLayoutUtil.getLayoutAfterConstraints(this,a,b,d)}function l(a,b){var d=this.components.layout.getRelativeToScreen(a);return c.utils.updateLayoutUtil.getLayoutRelativeToScreenAfterConstraints(this,a,b,d)}function m(c,d,e){var f=!b.isOpen("se_screenWidthOff")&&b.isOpen("exp171"),g=f&&b.isOpen("se_screenWidthEditBox");if(g&&this.components.layout.isHorizontallyStretchedToScreen(c))return d;var h={left:this.components.layout.RESIZE_SIDES.LEFT,right:this.components.layout.RESIZE_SIDES.RIGHT,top:this.components.layout.RESIZE_SIDES.TOP,bottom:this.components.layout.RESIZE_SIDES.BOTTOM},i=a.map(e,function(a,b){return h[b]});return a.difference(d,i)}function n(a){return this.documentServices.components.layout.canBeStretched(a)&&!this.components.layout.isPinned(a)}return{get:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.get,singleCompHandler:this.documentServices.components.layout.get})},isRenderedInFixedPosition:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isRenderedInFixedPosition(a)},this);return d},isAncestorRenderedInFixedPosition:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isAncestorRenderedInFixedPosition(a)},this);return d},isShowOnFixedPosition:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isShowOnFixedPosition(a)},this);return d},isHorizontallyStretchedToScreen:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isHorizontallyStretchedToScreen(a)},this);return d},isDocked:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isDocked(a)},this);return d},unDock:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.unDock,singleCompHandler:this.documentServices.components.layout.unDock})},isRotated:function(b){var c=this.components.asArray(b);return a.every(c,function(a){return this.documentServices.components.layout.isRotated(a)},this)},isPinnedBySerializedLayout:function(b){var c=a.isArray(b)?b:[b];return a.isEmpty(c)?!1:a.every(c,function(b){return!a.isUndefined(b.docked)&&b.fixedPosition},this)},isPinned:function(b){var c=this.components.asArray(b);return a.isEmpty(c)?!1:a.every(c,function(a){var b=this.documentServices.components.layout.get(a);return b.docked=this.documentServices.components.layout.getDock(a),this.components.layout.isPinnedBySerializedLayout(b)},this)},canBeStretched:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.canBeStretched,singleCompHandler:n})},canBeFixedPosition:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.canBeFixedPosition,singleCompHandler:this.documentServices.components.layout.canBeFixedPosition})},getRelativeToScreen:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.layout.getRelativeToScreen,singleCompHandler:this.documentServices.components.layout.getRelativeToScreen})},getRelativeToScreenConsideringScroll:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.getRelativeToScreenConsideringScroll,singleCompHandler:this.documentServices.components.layout.getRelativeToScreenConsideringScroll})},getRelativeToStructure:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.getRelativeToStructure,singleCompHandler:this.documentServices.components.layout.getRelativeToStructure})},getResizableSides:function(b){return e.call(this,b,{multiCompHandler:this.multiselect.layout.getResizableSides,singleCompHandler:function(c){if(this.editor.state.pinMode)return{};if(this.components.is.group(c))return a.map(this.components.layout.RESIZE_SIDES,a.identity);var d=this.documentServices.components.layout.getResizableSides(c),e=this.components.layout.getDock(c);return e&&(d=m.apply(this,[b,d,e])),d}})},getProportionStructure:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.layout.getProportionStructure,singleCompHandler:this.documentServices.components.layout.getProportionStructure})},update:function(a,b,c){if(b){var d=k.call(this,a,b);e.call(this,a,d,{multiCompHandler:this.multiselect.layout.update,singleCompHandler:this.documentServices.components.layout.update}),c||this.history.debouncedAdd("component - update layout")}},updateRelativeToStructure:function(a,b,c){e.call(this,a,b,c,{multiCompHandler:this.multiselect.layout.updateRelativeToStructure,singleCompHandler:g})},updateRelativeToScreen:function(a,b,c){e.call(this,a,b,c,{multiCompHandler:this.multiselect.layout.updateRelativeToScreen,singleCompHandler:f
})},updateRelativeToStructureAndPreserveProportions:function(a,b,c){e.call(this,a,b,c,{multiCompHandler:this.multiselect.layout.updateRelativeToStructureAndPreserveProportions,singleCompHandler:i})},updateRelativeToScreenAndPreserveProportions:function(a,b,c,d){e.call(this,a,b,c,d,{multiCompHandler:this.multiselect.layout.updateRelativeToScreenAndPreserveProportions,singleCompHandler:h})},updateAndPreserveProportions:function(a,b,c){e.call(this,a,b,c,{multiCompHandler:this.multiselect.layout.updateAndPreserveProportions,singleCompHandler:j})},updateAndAdjustLayout:function(a,b,c){var d=k.call(this,a,b),f=e.call(this,a,d,{multiCompHandler:this.multiselect.layout.updateAndAdjustLayout,singleCompHandler:this.documentServices.components.layout.updateAndAdjustLayout});return c||this.history.debouncedAdd("component - update layout"),f},updateRelativeToStructureAndAdjustLayout:function(a,b,c){var e=d.layoutUtils.getLayoutRelativeToParentFromRelativeToStructure(this,a,b);return this.components.layout.updateAndAdjustLayout(a,e,c)},updateRelativeToScreenAndAdjustLayout:function(a,b,c){var e=d.layoutUtils.getLayoutRelativeToParentFromRelativeToScreen(this,a,b);return this.components.layout.updateAndAdjustLayout(a,e,c)},setFixed:function(a,b){return e.call(this,this,a,b,{multiCompHandler:this.multiselect.layout.setFixed,singleCompHandler:c.utils.fixedPositionUtils.setFixedPosition})},isStretchedToScreen:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.isStretchedToScreen,singleCompHandler:this.documentServices.components.layout.isHorizontallyStretchedToScreen})},setDock:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.layout.setDock,singleCompHandler:this.documentServices.components.layout.setDock})},getDock:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.getDock,singleCompHandler:this.documentServices.components.layout.getDock})},updateDock:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.layout.updateDock,singleCompHandler:this.documentServices.components.layout.updateDock})},updateAspectRatio:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.updateAspectRatio,singleCompHandler:this.documentServices.components.layout.updateAspectRatio})},removeAspectRatio:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.layout.removeAspectRatio,singleCompHandler:this.documentServices.components.layout.removeAspectRatio})},isAspectRatioOn:function(b){var c=this.components.asArray(b);return a.every(c,function(a){return this.documentServices.components.layout.isAspectRatioOn(a)},this)},isCompOutOfPageBounds:function(a){var b=this.components.layout.getRelativeToScreen(a),d=this.components.layout.getRelativeToScreen(this.siteSegments.getPagesContainer()),e=this.isMobileEditor()?c.constants.SIZE_LIMITS.MOBILE_DRAG_CONSTRAINT_MARGINS:0,f=d.x+e,g=d.x+d.width-e;return b.x+b.width<=f||b.x>=g}}}),define("rEditor/app/APISections/componentsFacade/arrangementFacade",["core"],function(a){"use strict";return{moveForward:function(a){var b=this.components.asArray(a);return this.components.arrangement.canMoveForward(b)?(this.documentServices.components.arrangement.moveForward(b[0]),void this.history.add("component - move forward")):null},moveBackward:function(a){var b=this.components.asArray(a);return this.components.arrangement.canMoveBackward(b)?(this.documentServices.components.arrangement.moveBackward(b[0]),void this.history.add("component - move backward")):null},moveToFront:function(a){var b=this.components.asArray(a);return this.components.arrangement.canMoveForward(b)?(this.documentServices.components.arrangement.moveToFront(b[0]),void this.history.add("component - move to front")):null},moveToBack:function(a){var b=this.components.asArray(a);return this.components.arrangement.canMoveBackward(b)?(this.documentServices.components.arrangement.moveToBack(b[0]),void this.history.add("component - move to back")):null},moveToIndex:function(a,b){var c=this.components.asArray(a);this.documentServices.components.arrangement.moveToIndex(c[0],b),this.history.add("component - move to index")},canMoveBackward:function(b){var c=this.components.asArray(b);if(this.multiselect.isMultiselect(c))return this.multiselect.arrangement.canMoveBackward(c);var d=this.components.getType(c)===a.constants.COMP_TYPES.ANCHOR;return!d&&this.documentServices.components.arrangement.canMoveBackward(c[0])},canMoveForward:function(b){var c=this.components.asArray(b);if(this.multiselect.isMultiselect(c))return this.multiselect.arrangement.canMoveForward(c);var d=this.components.getType(c)===a.constants.COMP_TYPES.ANCHOR;return!d&&this.documentServices.components.arrangement.canMoveForward(c[0])}}}),define("rEditor/app/APISections/componentsFacade/behaviorsFacade",["rEditor/utils/multiSelectHandler"],function(a){"use strict";return{update:function(b,c,d){return a.call(this,b,c,d,{multiCompHandler:this.multiselect.behaviors.update,singleCompHandler:this.documentServices.components.behaviors.update})},get:function(b){return a.call(this,b,{multiCompHandler:this.multiselect.behaviors.get,singleCompHandler:this.documentServices.components.behaviors.get})},remove:function(b,c,d){return a.call(this,b,c,d,{multiCompHandler:this.multiselect.behaviors.remove,singleCompHandler:this.documentServices.components.behaviors.remove})},removeAll:function(b){return a.call(this,b,{multiCompHandler:this.multiselect.behaviors.removeAll,singleCompHandler:this.documentServices.components.behaviors.removeAll})},previewAnimation:function(b,c,d){return a.call(this,b,c,d,{multiCompHandler:this.multiselect.behaviors.previewAnimation,singleCompHandler:this.documentServices.components.behaviors.previewAnimation})},stopPreviewAnimation:function(b){return a.call(this,b,{multiCompHandler:this.multiselect.behaviors.stopPreviewAnimation,singleCompHandler:this.documentServices.components.behaviors.stopPreviewAnimation})},execute:function(b,c,d){return a.call(this,b,c,d,{multiCompHandler:this.multiselect.behaviors.execute,singleCompHandler:this.documentServices.components.behaviors.execute})},getRuntimeState:function(b){return a.call(this,b,{multiCompHandler:this.multiselect.behaviors.getRuntimeState,singleCompHandler:this.documentServices.components.behaviors.getRuntimeState})}}}),define("rEditor/componentsMetaData/components/bgImageStrip",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/fiveGridLine",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/footer",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/header",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/screenWidthContainer",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/stripShowcase",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/stripSlideshowGallery",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/blogComponents",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/rssButton",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/tpaGluedWidget",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/page",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/boxSlideShow",["baseUI"],function(a){"use strict";return{slidesContainer:!0,focusable:!0,canContain:!1,canContainByStructure:!1,focusBoxNavType:a.uiConstants.NAVIGATION_TYPES.PAGINATION}}),define("rEditor/componentsMetaData/components/hoverBox",["baseUI"],function(a){"use strict";return{focusable:!0,hoverBox:!0,focusBoxNavType:a.uiConstants.NAVIGATION_TYPES.TABS}}),define("rEditor/componentsMetaData/components/stripSlideShowMetaData",[],function(){"use strict";return{slidesContainer:!0,focusable:!0,canContain:!1,canContainByStructure:!1,pinnable:!1}}),define("rEditor/componentsMetaData/components/boxSlideShowSlide",[],function(){"use strict";return{selectable:!1,slideContainer:!0}}),define("rEditor/componentsMetaData/components/stripSlideShowSlide",[],function(){"use strict";return{selectable:!1,slideContainer:!0}}),define("rEditor/componentsMetaData/components/anchor",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/collage",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/wRichText",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/group",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/stripContainer",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/stripColumnsContainer",[],function(){"use strict";return{focusable:!0}}),define("rEditor/componentsMetaData/components/tpaSection",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/column",["lodash","baseUI"],function(a,b){"use strict";return{showMarginsIndicator:!0,focusable:!0,focusParent:!0,focusBoxNavType:b.uiConstants.NAVIGATION_TYPES.LABEL,focusBoxNavContent:function(b,c){var d=b.components.getContainer(c),e=b.components.getChildren(d),f=a.findIndex(e,function(b){return a.isEqual(b,c)});return{label:"Column "+(f+1),translate:!1}}}}),define("rEditor/componentsMetaData/metaDataMap",["rEditor/componentsMetaData/components/bgImageStrip","rEditor/componentsMetaData/components/fiveGridLine","rEditor/componentsMetaData/components/footer","rEditor/componentsMetaData/components/header","rEditor/componentsMetaData/components/screenWidthContainer","rEditor/componentsMetaData/components/stripShowcase","rEditor/componentsMetaData/components/stripSlideshowGallery","rEditor/componentsMetaData/components/blogComponents","rEditor/componentsMetaData/components/rssButton","rEditor/componentsMetaData/components/tpaGluedWidget","rEditor/componentsMetaData/components/page","rEditor/componentsMetaData/components/boxSlideShow","rEditor/componentsMetaData/components/hoverBox","rEditor/componentsMetaData/components/stripSlideShowMetaData","rEditor/componentsMetaData/components/boxSlideShowSlide","rEditor/componentsMetaData/components/stripSlideShowSlide","rEditor/componentsMetaData/components/anchor","rEditor/componentsMetaData/components/collage","rEditor/componentsMetaData/components/wRichText","rEditor/componentsMetaData/components/group","rEditor/componentsMetaData/components/stripContainer","rEditor/componentsMetaData/components/stripColumnsContainer","rEditor/componentsMetaData/components/tpaSection","rEditor/componentsMetaData/components/column"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){"use strict";return{"wysiwyg.viewer.components.BgImageStrip":a,"wysiwyg.viewer.components.FiveGridLine":b,"wysiwyg.viewer.components.FooterContainer":c,"wysiwyg.viewer.components.HeaderContainer":d,"wysiwyg.viewer.components.ScreenWidthContainer":e,"tpa.viewer.components.StripSlideshow":g,"tpa.viewer.components.StripShowcase":f,"wixapps.integration.components.AppPart":h,"wysiwyg.common.components.rssbutton.viewer.RSSButton":i,"wysiwyg.viewer.components.tpapps.TPAGluedWidget":j,"mobile.core.components.Page":k,"wysiwyg.viewer.components.BoxSlideShow":l,"wysiwyg.viewer.components.HoverBox":m,"wysiwyg.viewer.components.StripContainerSlideShow":n,"wysiwyg.viewer.components.BoxSlideShowSlide":o,"wysiwyg.viewer.components.StripContainerSlideShowSlide":p,"wysiwyg.common.components.anchor.viewer.Anchor":q,"tpa.viewer.components.Collage":r,"wysiwyg.viewer.components.WRichText":s,"wysiwyg.viewer.components.Group":t,"wysiwyg.viewer.components.StripContainer":u,"wysiwyg.viewer.components.StripColumnsContainer":v,"wysiwyg.viewer.components.tpapps.TPASection":w,"wysiwyg.viewer.components.Column":x}}),define("rEditor/app/APISections/singleCompHandlers/componentsMetaData",["lodash","rEditor/componentsMetaData/metaDataMap"],function(a,b){"use strict";function d(d,e){return!b[d]||a.isUndefined(b[d][e])?c[e]:b[d][e]}function e(b,c,e){var f=b.components.getType(e),g=d(f,c);if("function"==typeof g){var h=a.toArray(arguments);return h.splice(1,1),g.apply(this,h)}return g}var c={pinnable:!0,duplicatable:!0,containable:!0,canContain:!0,containableByStructure:!0,canContainByStructure:!0,focusable:!1,focusParent:!1,resizable:!0,rotatable:!0,selectable:!0,slidesContainer:!1,slideContainer:!1,showMarginsIndicator:!1};return{is:{fixed:function(a){return this.documentServices.components.layout.get(a).fixedPosition},exist:function(a){return this.documentServices.components.is.exist(a)},container:function(a){return this.documentServices.components.is.container(a)},selectable:function(a){return e(this,"selectable",a)},siteSegment:function(b){var c=this.siteSegments.getRefs();return a.find(c,b)},removable:function(a){return this.documentServices.components.is.removable(a)},duplicatable:function(a){return e(this,"duplicatable",a)&&this.documentServices.components.is.duplicatable(a)},containable:function(a,b){return e(this,"containable",a,b)&&e(this,"canContain",b,a)&&this.documentServices.components.is.containable(a,b)},containableByStructure:function(b,c){var f=b.componentType,g=d(f,"containableByStructure"),h=a.isFunction(g)?g(b,c):g;return h&&e(this,"canContainByStructure",c,b)&&this.documentServices.components.is.containableByStructure(b,c)},styleCanBeApplied:function(a,b){return this.documentServices.components.is.styleCanBeApplied(a,b)},movable:function(a){return this.documentServices.components.is.movable(a)},horizontallyMovable:function(a){return this.documentServices.components.is.horizontallyMovable(a)&&!this.components.layout.isPinned(a)&&!this.components.layout.isHorizontallyStretchedToScreen(a)},verticallyMovable:function(a){return this.documentServices.components.is.verticallyMovable(a)&&!this.components.layout.isPinned(a)},canMoveUp:function(a){return this.documentServices.components.is.canMoveUp(a)},focusable:function(a){return e(this,"focusable",a)},focusParent:function(a){return e(this,"focusParent",a)},fullWidth:function(a){return this.documentServices.components.is.fullWidth(a)},rotatable:function(a){return e(this,"rotatable",a)&&this.documentServices.components.is.rotatable(a)},slidesContainer:function(a){return e(this,"slidesContainer",a)},slideContainer:function(a){return e(this,"slideContainer",a)},hoverBox:function(a){return e(this,"hoverBox",a)},resizable:function(a){return e(this,"resizable",a)&&this.documentServices.components.is.resizable(a)},horizontallyResizable:function(a){return!this.components.layout.isHorizontallyStretchedToScreen(a)&&(this.documentServices.components.is.horizontallyResizable(a)||this.components.is.group(a))},verticallyResizable:function(a){return this.documentServices.components.is.verticallyResizable(a)||this.components.is.group(a)},proportionallyResizable:function(a){return!this.components.is.fullWidth(a)&&!this.components.layout.isPinned(a)},group:function(a){return this.documentServices.components.is.group(a)},groupable:function(a){return this.documentServices.components.is.groupable(a)},topMost:function(a,b){return this.documentServices.components.is.topMost(a,b)},leftMost:function(a,b){return this.documentServices.components.is.leftMost(a,b)},groupedComponent:function(a){return this.documentServices.components.is.groupedComponent(a)},animatable:function(a,b){return this.documentServices.components.is.animatable(a,b)},pinnable:function(a){return e(this,"pinnable",a)&&!this.components.is.fullWidth(a)&&!this.components.layout.isRotated(a)&&!this.components.layout.isHorizontallyStretchedToScreen(a)},alignable:function(a){return this.documentServices.components.is.alignable(a)&&this.components.is.movable(a)},draggable:function(a){return this.components.is.movable(a)&&!this.components.layout.isPinned(a)&&!this.components.is.page(a)},showMarginsIndicator:function(a){return e(this,"showMarginsIndicator",a)},focusBoxNavType:function(a){return e(this,"focusBoxNavType",a)},focusBoxNavContent:function(a){return e(this,"focusBoxNavContent",a)}}}}),define("rEditor/app/APISections/componentsFacade/componentsMetaDataFacade",["lodash","rEditor/utils/multiSelectHandler","rEditor/app/APISections/singleCompHandlers/componentsMetaData"],function(a,b,c){"use strict";return{fixed:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.fixed,singleCompHandler:c.is.fixed})},exist:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.exist,singleCompHandler:c.is.exist})},container:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.container,singleCompHandler:c.is.container})},selectable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.selectable,singleCompHandler:c.is.selectable})},siteSegment:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.siteSegment,singleCompHandler:c.is.siteSegment})},siblings:function(b){if(a.includes(b,void 0))return!1;var c=b.pop(),d=this.components.getSiblings(c);return a.every(b,function(b){return a.find(d,b)})},removable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.removable,singleCompHandler:c.is.removable})},duplicatable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.duplicatable,singleCompHandler:c.is.duplicatable})},showMarginsIndicator:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.showMarginsIndicator,singleCompHandler:c.is.showMarginsIndicator})},containable:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.containable,singleCompHandler:c.is.containable})},containableByStructure:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.containableByStructure,singleCompHandler:c.is.containableByStructure})},styleCanBeApplied:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.styleCanBeApplied,singleCompHandler:c.is.styleCanBeApplied})},movable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.movable,singleCompHandler:c.is.movable})},horizontallyMovable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.horizontallyMovable,singleCompHandler:c.is.horizontallyMovable})},verticallyMovable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.verticallyMovable,singleCompHandler:c.is.verticallyMovable})},canMoveUp:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.canMoveUp,singleCompHandler:c.is.canMoveUp})},fullWidth:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.fullWidth,singleCompHandler:c.is.fullWidth})},resizable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.resizable,singleCompHandler:c.is.resizable})},horizontallyResizable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.horizontallyResizable,singleCompHandler:c.is.horizontallyResizable})},verticallyResizable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.verticallyResizable,singleCompHandler:c.is.verticallyResizable})},proportionallyResizable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.proportionallyResizable,singleCompHandler:c.is.proportionallyResizable})},group:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.group,singleCompHandler:c.is.group})},groupable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.groupable,singleCompHandler:c.is.groupable})},page:function(a){var b=this.components.asArray(a);return this.pages.isPageExist(b[0].id)},topMost:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.topMost,singleCompHandler:c.is.topMost})},leftMost:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.leftMost,singleCompHandler:c.is.leftMost})},groupedComponent:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.groupedComponent,singleCompHandler:c.is.groupedComponent})},rotatable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.rotatable,singleCompHandler:c.is.rotatable})},animatable:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.animatable,singleCompHandler:c.is.animatable})},pinnable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.pinnable,singleCompHandler:c.is.pinnable})},focusable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.focusable,singleCompHandler:c.is.focusable})},focusParent:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.focusParent,singleCompHandler:c.is.focusParent})},slidesContainer:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.slidesContainer,singleCompHandler:c.is.slidesContainer})},slideContainer:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.slideContainer,singleCompHandler:c.is.slideContainer})},hoverBox:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.hoverBox,singleCompHandler:c.is.hoverBox})},alignable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.alignable,singleCompHandler:c.is.alignable})},draggable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.draggable,singleCompHandler:c.is.draggable})},focusBoxNavType:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.focusBoxNavType,singleCompHandler:c.is.focusBoxNavType})},focusBoxNavContent:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.focusBoxNavContent,singleCompHandler:c.is.focusBoxNavContent})},potentialContainerForScreenWidthComp:function(a){var b=this.components.asArray(a);return 1===b.length&&this.documentServices.components.is.potentialContainerForScreenWidthComp(b[0])}}}),define("rEditor/app/APISections/componentsWrapper",["lodash","core","util","rEditor/utils/removeUtil","rEditor/utils/multiSelectHandler","rEditor/app/APISections/componentsFacade/layoutWrapper","rEditor/app/APISections/componentsFacade/arrangementFacade","rEditor/app/APISections/componentsFacade/behaviorsFacade","rEditor/app/APISections/componentsFacade/componentsMetaDataFacade","experiment!dontCloseAddPanelOnAdd","experiment"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(b,c){return a.every(c,function(c,d){return a.isEqual(b[d],c)})}function m(a,b,c){var d=this.documentServices.components.properties,e=d.get(a),f=!e||!l(e,b),g=d.mobile.isForked(a);f&&(this.isMobileEditor()&&e&&!g&&d.mobile.fork(a),d.update(a,b),c||this.history.debouncedAdd("comp properties changed"),this.pluginService.getPlugin("propertiesChange","*")([a]))}function n(a,c,d){c.type=c.type||this.components.data.get(a).type,c=b.utils.updateDataUtil.fixData(c);var e=this.components.data.get(a),f=!e||!l(e,c);f&&(this.documentServices.components.data.update(a,c),d||this.history.debouncedAdd("comp data changed"))}return{layouters:{getNonMasterChildren:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getNonMasterChildren,singleCompHandler:this.documentServices.layouters.getNonMasterChildren})}},components:{onPreviewReady:function(c){var d=b.utils.componentPreviewReadyPlugins;a.forEach(d,function(a){a(c)},this)},getPage:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getPage,singleCompHandler:this.documentServices.components.getPage})},asArray:function(b){return a.compact(a.isArray(b)?b:[b])},reset:function(){this.clipboard.setItem(b.constants.EDITOR_CLIPBOARD_TYPES.COMPONENT,void 0)},isShowOnAllPages:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.isShowOnAllPages,singleCompHandler:this.documentServices.components.isShowOnAllPages})},cut:function(b){var c=this.selection.getSelectedComponents();return c=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(c),b=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(b),a.isEqual(c,b)&&this.selection.deselectComponents(),this.isMobileEditor()?void this.openCantCopyPastePanel():void(this.components.is.duplicatable(b)&&(this.components.copy(b),a.forEach(b,function(a){d.cutComponent(this.documentServices,a)},this)))},add:function(c,d,e,f){return b.utils.addUtil.addComponent(this,this.documentServices.components.add,c,d,e,function(){j||this.panelManager.closePanelByName("addPanelInfra.addPanel"),this.utils.isSameRef(c,this.siteSegments.getHeader())&&this.openDragToHeaderPanel(),a.isFunction(f)&&f.apply(this,arguments)}.bind(this))},addAndAdjustLayout:function(a,c,d,e){return b.utils.addUtil.addComponent(this,this.documentServices.components.addAndAdjustLayout,a,c,d,e)},remove:function(b,c,e){var f=this.components.asArray(b),g=this;if(!this.components.is.removable(f))return void a.forEach(f,function(a){var b=g.components.getType(a);g.cannotRemovePlugins[b]&&g.cannotRemovePlugins[b](a)});k.isOpen("ds_OperationsQAllAsync")||this.selection.deselectComponents(f);var h=f;k.isOpen("se_hoverBox")&&(h=a.filter(f,function(a){var b=g.documentServices.components.modes.getFirstAncestorActiveModes(a),c=g.documentServices.components.modes.isDisplayedByDefault(a);if(b){g.documentServices.components.modes.hideComponentOnModes(a,[b]);var d=g.documentServices.components.modes.isComponentDisplayedOnSomeModes(a);return!d&&!c}return!0})),a.isEmpty(h)||d.removeComponent(this.documentServices,this.removePlugins,h,this,c,e),this.waitForChangesApplied(function(){k.isOpen("ds_OperationsQAllAsync")?e&&e.isReplacingComp||this.selection.deselectComponents(f):this.selection.deselectComponents(f)}.bind(this))},setContainer:function(a,b){var c=this.components.isShowOnAllPages(a),d=e.call(this,a,b,{multiCompHandler:this.multiselect.setContainer,singleCompHandler:this.documentServices.components.setContainer});return!c&&this.utils.isSameRef(b,this.siteSegments.getHeader())&&this.openDragToHeaderPanel(),this.setStateUpdateCallback(function(){return{focusedContainer:this.selection.getFocusedContainer()}}.bind(this)),d},reparentComponentToPage:function(a,b){var c=e.call(this,a,b,{multiCompHandler:this.multiselect.reparentComponentToPage,singleCompHandler:this.documentServices.components.reparentComponentToPage});return c},getType:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getType,singleCompHandler:this.documentServices.components.getType})},getSiblings:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getSiblings,singleCompHandler:this.documentServices.components.getSiblings})},getChildren:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getChildren,singleCompHandler:this.documentServices.components.getChildren})},getDisplayName:function(a){var b=this.documentServices.components.getType(a);return this.compNamePlugins[b]?this.compNamePlugins[b](a):c.translate("component_label_"+b.split(".").pop())},ungroup:function(a){var b=this.components.asArray(a);if(this.components.is.exist(b[0])){var c=this.documentServices.components.getChildren(b[0]);this.selection.selectComponentByCompRef(c),this.documentServices.components.ungroup(b[0]),this.history.add("ungroup")}},getIconInfo:function(a,b){var d=this.documentServices.components.getType(a);return this.compIconPlugins[d]?this.compIconPlugins[d](a):c.compIcon.getCompIconInfo(a,d,b,this)},getContainer:function(a){var b=this.components.asArray(a);return this.documentServices.components.getContainer(b[0])},moveToFooter:function(a){var b=15,c=this.components.layout.getRelativeToStructure(a),d=this.siteSegments.getFooter(),e=this.components.layout.get(d),f=this.components.setContainer(a,d),g=e.height<c.bounding.height+b;g&&this.components.layout.update(d,{height:c.bounding.height+2*b}),this.waitForChangesApplied(function(){this.components.layout.update(f,{y:c.y-c.bounding.y+b})}.bind(this))},isDescendantOfComp:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.isDescendantOfComp,singleCompHandler:this.documentServices.components.isDescendantOfComp})},isAscendantOfComp:function(b,c){return a.some(b,function(a){return this.components.isDescendantOfComp(c,a)},this)},data:{update:function(a,b,c){e.call(this,a,b,c,{multiCompHandler:this.multiselect.data.update,singleCompHandler:n})},get:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.data.get,singleCompHandler:this.documentServices.components.data.get})},remove:function(a,b){e.call(this,a,{multiCompHandler:this.multiselect.data.remove,singleCompHandler:this.documentServices.components.data.remove}),b||this.history.add("comp data removed")}},properties:{update:function(a,b,c){return e.call(this,a,b,c,{multiCompHandler:this.multiselect.properties.update,singleCompHandler:m})},get:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.properties.get,singleCompHandler:this.documentServices.components.properties.get})}},alignment:{align:function(a,b){e.call(this,a,b,{multiCompHandler:this.multiselect.alignment.align,singleCompHandler:this.documentServices.components.alignment.alignInContainer}),this.history.add("component - align - "+b)},canAlign:function(a,b){return this.documentServices.components.alignment.canAlign(a,b)}},multiComponents:{distribute:function(b,c){e.call(this,b,c,{multiCompHandler:this.multiselect.multiComponents.distribute,singleCompHandler:a.noop}),this.history.add("component - distribute - "+c)},matchSize:function(b,c){e.call(this,b,c,{multiCompHandler:this.multiselect.multiComponents.matchSize,singleCompHandler:a.noop}),this.history.add("component - matchSize - "+c)},canDistribute:function(a,b){return this.documentServices.components.multiComponents.canDistribute(a,b)},canMatchSize:function(a,b){return this.documentServices.components.multiComponents.canMatchSize(a,b)}},layout:f,style:{getId:function(a){var b=this.components.asArray(a);if(this.multiselect.isMultiselect(b))throw"components.style.getId isn't supported for multi select";return this.documentServices.components.style.getId(b[0])},setId:function(a,b,c){var d=this.components.asArray(a);if(this.multiselect.isMultiselect(d))throw"components.style.setId isn't supported for multi select";return this.documentServices.components.style.setId(d[0],b,c)}},arrangement:g,is:i,skin:{getComponentSkinExports:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.skin.getComponentSkinExports,singleCompHandler:this.documentServices.components.skin.getComponentSkinExports})},get:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.skin.get,singleCompHandler:this.documentServices.components.skin.get})}},behaviors:h,code:{setNickname:function(a,b){this.documentServices.components.code.setNickname(a,b),this.history.debouncedAdd("comp nick name changed")}},canToggleShowOnAllPages:function(a){return this.components.canShowOnAllPages(a)&&this.components.canShowOnCurrentPage(a)},canShowOnCurrentPage:function(a){var b=this.documentServices.pages.getCurrentPage();return this.components.is.containable(a,b)&&!this.components.isDescendantOfComp(a,this.siteSegments.getFooter())},canShowOnAllPages:function(b){b=this.components.asArray(b);var c=this.documentServices.siteSegments.getSiteStructure(),d=a.some(b,function(a){return this.documentServices.components.is.groupedComponent(a)},this),e=this.components.is.containable(b,c);return!this.isCurrentPageLandingPage()&&e&&!d},setShowOnAllPages:function(a,b){var c;return a=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(a),c=b?this.documentServices.siteSegments.getSiteStructure():this.documentServices.pages.getReference(this.pages.getCurrentPageId()),this.components.setContainer(a,c)},toggleShowOnAllPages:function(a){var b=this.selection.getSelectedComponents(),c=!this.components.isShowOnAllPages(a),d=this.components.setShowOnAllPages(a,c);b===a&&this.selection.selectComponentByCompRef(d),this.history.add(c?"Show component on all pages":"Show component on current page");
}}}}),define("rEditor/app/APISections/rulersAPI",["lodash","core"],function(a,b){"use strict";function c(){return this.editor.state.viewTools.rulersEnabled}function d(){var b=a.clone(this.editor.state.viewTools.rulers.guidesState);return b=a.isEmpty(b)?e():b}function e(){return{desktop:{verticalGuides:[],horizontalGuides:[]},mobile:{verticalGuides:[],horizontalGuides:[]}}}function f(a){return{guideId:"GUIDE_"+Date.now().toString(36),guidePosition:a}}function g(a,b){var c=b?"mobile.":"desktop.";return c+a+"Guides"}function h(b,c){var d=a.clone(this.editor.state.viewTools.rulers);d[b]=c,this.updateEditorViewTools("rulers",d)}function i(a){this.userPreferences.site.set(b.constants.USER_PREFS.VIEW_TOOLS.GUIDES_STATE,a),h.call(this,"guidesState",a)}function j(a,d){var e=!c.call(this);this.updateEditorViewTools("rulersEnabled",e),this.userPreferences.site.set(b.constants.USER_PREFS.VIEW_TOOLS.RULERS_ENABLED,e,a,d)}function k(a){h.call(this,"selectedGuide",a)}function l(b,c){var e=d.call(this),g=f(c);a.get(e,b).push(g),i.call(this,e)}function m(a){var b=g("vertical",this.isMobileEditor());l.call(this,b,a)}function n(a){var b=g("horizontal",this.isMobileEditor());l.call(this,b,a)}function o(b,c){var e=d.call(this),f=a.reject(a.get(e,b),a.matchesProperty("guideId",c));return a.set(e,b,f),e}function p(a,b){var c=g(a,this.isMobileEditor()),d=o.call(this,c,b);i.call(this,d)}function q(b,c,d){var e=g(b,this.isMobileEditor()),f=o.call(this,e,c),h={guidePosition:d,guideId:c};a.get(f,e).push(h),i.call(this,f)}function r(a){var b=this.siteSegments.getPagesContainerAbsLayout();return a+b.x}function s(c,d){var e=b.bi.events.rulers[c],f={editor_view_mode:this.isMobileEditor()?"mobile":"desktop"};a.merge(f,d),this.bi.event(e,f)}return{rulers:{getRulersState:d,isRulersEnabled:c,toggleRulers:j,getGuidesInitialState:e,setVerticalGuide:m,setHorizontalGuide:n,removeGuide:p,setSelectedGuide:k,changeGuidePosition:q,updateEditorRulersState:h,getVerticalGuideRealPosition:r,sendBIEvent:s}}}),define("rEditor/app/APISections/feedback",["lodash","jquery","experiment"],function(a,b,c){"use strict";function f(){var a=this.generalInfo.getSiteId(),b=this.generalInfo.getMetaSiteId();return d+a+"?metaSiteId="+b}function g(){return e+this.generalInfo.getSiteId()+"?metaSiteId="+this.generalInfo.getMetaSiteId()}function h(a){a=a>99?"99+":a,this.editor.state.unreadComments!==a&&this.editor.setState({unreadComments:a})}function i(){var a=f.call(this);b.ajax({url:a,type:"GET",xhrFields:{withCredentials:!0},success:function(a){h.call(this,a.count)}.bind(this)})}var d="http://feedback.wix.com/_api/feedback-server/getNewCommentsCount/",e="http://feedback.wix.com/_api/feedback-server/siteIsShared/",j={init:function(){if(c.isOpen("exp171")&&!c.isOpen("feedmeIntegrationOff")&&this.account.isUserOwner()){var a=g.call(this);b.ajax({url:a,type:"GET",xhrFields:{withCredentials:!0},success:function(a){a.shared?(h.call(this,a.count),i.call(this),setInterval(i.bind(this),3e4)):setTimeout(this.feedback.init,3e5)}.bind(this)})}},getNewCommentsCounter:function(){return this.editor.state.unreadComments}};return{feedback:j}}),define("rEditor/app/APISections/mainMenuWrapper",["lodash","pagesMenu","experiment!pagesPanelOpenCollapsed"],function(a,b,c){"use strict";function f(a){return a.replace("#","")}function g(b,c){var d;return a.some(c,function(a){return a.type.isPage&&!b.pages.isHomePage(a.pageData.id)?(d=a,!0):a.items&&a.items.length&&(d=g(b,a.items))?!0:void 0}),d}function h(b,c){var d;return a.some(b,function(a){var b=a.link&&a.link.pageId,e=b&&b.substr(1);return e===c?(d=a,!0):a.items&&a.items.length&&(d=h(a.items,c))?!0:void 0}),d}function i(a){var b=a.link&&a.link.type,c="PageLink"===b;return{raw:b,isDropdown:!b,isLink:!c&&e.test(b),isPage:c}}function j(a,b,c,d){return{id:a.id,type:b||i(a),label:a.label,parent:d,isVisible:a.isVisible,isVisibleMobile:a.isVisibleMobile,pageData:c,link:a.link}}function k(b,d,e){var g=[];return a.forEach(b,function(b){var h,m,l=i(b);m=c?l.isPage?d.pagesDataMap[f(b.link.pageId)]:null:l.isPage?a.find(d.pagesDataList,"id",f(b.link.pageId)):null,e&&!e(b,m)||(h=j(b,l,m,d.parent),b.items.length>0?h.items=k(b.items,a.defaults({parent:h},d),e):h.items=[],g.push(h))}),g}function l(b,d){if(c){var e=a.indexBy(b,"id");return k(this.mainMenu.getMenu(),{parent:null,homePageId:this.homePage.get(),pagesDataMap:e},d)}return k(this.mainMenu.getMenu(),{parent:null,homePageId:this.homePage.get(),pagesDataList:b},d)}function m(b,c){function d(c){var g,h,k;a.forEach(c,function(c){h=i(c),h.isPage&&(k=a.findIndex(b,{id:f(c.link.pageId)}),k>-1&&(g=b[k],e[k]=j(c,h,g))),c.items.length>0&&d(c.items)})}var e=[];return d(c||this.mainMenu.getMenu()),e}function n(a){var b=this.data.getById(f(a)),c=i(b),d=c.isPage?this.data.getById(f(b.link.pageId)):null;return j(b,c,d)}var d=b.specialPages.menuLogic,e=/Link$/;return{mainMenu:{hasOnlyLastPageMenuItem:function(){var b=this.documentServices.pages.getPagesData(),c=a.filter(b,function(a){return!d.isSpecialPage(this,a)},this);return 1===c.length},getFirstNonHomePageMenuItem:function(){var a=this.mainMenu.getMenuItemsTreeForMainMenu();return g(this,a)},getMenuItemIdForCurrentPage:function(){var a=this.documentServices.mainMenu.getMenu(),b=this.documentServices.pages.getCurrentPage().id,c=h(a,b);return c&&c.id},getMenuItemsTree:function(){var a=this.pages.getPagesData();return this.mainMenu.extendMenuItemsTreeWithPageData(a)},getMenuItemsTreeForMainMenu:function(a){a=a||this.pages.getPagesData();var b=function(a,b){return b?!d.isSpecialPage(this,b):!0}.bind(this);return this.mainMenu.extendMenuItemsTreeWithPageData(a,b)},getExtendedMenuItemWithPageData:n,extendMenuItemsTreeWithPageData:l,convertPagesDataListToMenuItemsList:m}}}),define("rEditor/app/APISections/multiselect",["lodash","core","util"],function(a,b,c){"use strict";function d(b){return a.some(b,this.selection.isSingleSelectionComponent,this)}function e(b,d,e){return a.map(d,function(d){var f=a.pick(b.components.layout.get(d),["x","y"]),g=c.layoutUtils.addXYOffsetsToLayout(f,e);return{component:d,newLayout:g}})}function f(b,d,f,g){var h=c.layoutUtils.getLayoutsXYDiff(g,f),i=e(b,d,h);a.forEach(i,function(a){b.components.layout.update(a.component,a.newLayout)})}function g(a,b){for(var c=a.components.getContainer(b);c&&!a.components.is.group(c);)c=a.components.getContainer(c);return c}function h(a,b){var d=c.layoutUtils.calcLayoutFromLayoutAndRatio(b,a.proportions),e=c.layoutUtils.addXYOffsetsToLayout(d,b);return e}return{multiselect:{canBeMasterChild:function(){return!1},getNonMasterChildren:function(){},isShownOnAllStates:function(){return!1},isDescendantOfComp:function(b,c){return a.every(b,function(a){return this.documentServices.components.isDescendantOfComp(a,c)},this)},getType:function(){return b.constants.MULTISELECT.TYPE},canBeShownOnAllStates:function(){return!1},toggleShowOnAllStates:function(){},getPage:function(b){return this.multiselect.areComponentsOfSamePage(b)?this.documentServices.components.getPage(a.first(b)):null},count:function(b){return a.isArray(b)?b.length:0},isMultiselect:function(a){return this.multiselect.count(a)>1},getContainer:function(b){return this.multiselect.containsSiblingsOnly(b)?this.documentServices.components.getContainer(a.first(b)):null},getChildren:function(){return[]},getSiblings:function(b){if(!this.multiselect.containsSiblingsOnly(b))throw"Cannot obtain siblings of the given compoents since they are not siblings";var c=this.documentServices.components.getSiblings(b[0]),d=a.reject(c,function(c){return a.some(b,{id:c.id})},this);return d},isShowOnAllPages:function(b){var c=a.every(b,function(a){return this.documentServices.components.isShowOnAllPages(a)},this);return c},canBeSelectedTogether:function(a){return this.multiselect.count(a)<=1?!0:!d.call(this,a)},containsSiblingsOnly:function(b){if(!this.multiselect.isMultiselect(b))return!0;var c=this.components.getSiblings(a.first(b)),d=a.rest(b);return a.every(d,function(b){return!!a.find(c,b)})},containsAncestorsAndDescendants:function(b){return this.multiselect.isMultiselect(b)?a.every(b,function(d,e){var f=b.slice(e+1);return a.every(f,function(a){return this.components.isDescendantOfComp(d,a)||this.components.isDescendantOfComp(a,d)},this)},this):!1},areComponentsOfSamePage:function(b){if(!this.multiselect.isMultiselect(b))return!0;var c=a.first(b),d=a.rest(b),e=this.documentServices.components.getPage(c);return a.every(d,function(b){var c=this.documentServices.components.getPage(b);return a.isEqual(c,e)},this)},getComponentsWhichDontHaveAncestorsInTheArray:function(b){var c=a.clone(b);return a.forEach(b,function(d,e){var f=b.slice(e+1);a.forEach(f,function(b){return this.components.isDescendantOfComp(d,b)?(a.remove(c,d),!1):void(this.components.isDescendantOfComp(b,d)&&a.remove(c,b))},this)},this),c},removeGroupedCompsIfTheirGroupIsInArray:function(b){return a.reject(b,function(d){var e=g(this,d);return e&&!!a.find(b,e)},this)},setContainer:function(b,c){var d=a.map(b,function(a){return this.documentServices.components.setContainer(a,c)},this);return d},reparentComponentToPage:function(b,c){var d=a.map(b,function(a){return this.documentServices.components.reparentComponentToPage(a,c)},this);return d},data:{update:function(){throw"Cannot update data for multiple components"},get:function(b){var c=a.map(b,function(a){return this.documentServices.components.data.get(a)},this);return c},remove:function(){throw"Cannot remove data for multiple components"}},properties:{update:function(){throw"cannot update multiple components properties"},get:function(b){var c=a.map(b,function(a){return this.documentServices.components.properties.get(a)},this);return c}},arrangement:{canMoveForward:function(){return!1},canMoveBackward:function(){return!1}},alignment:{align:function(a,b){this.documentServices.components.alignment.alignComponents(a,b)}},multiComponents:{distribute:function(a,b){this.documentServices.components.multiComponents.distribute(a,b)},matchSize:function(a,b){this.documentServices.components.multiComponents.matchSize(a,b)}},layout:{get:function(a){if(!this.multiselect.containsSiblingsOnly(a))throw"Cannot get layout for non-siblings components";var b=this.documentServices.components.layout.getSnugLayout(a);return b},canBeFixedPosition:function(b){var c=a.every(b,function(a){return this.documentServices.components.layout.canBeFixedPosition(a)},this);return c},getRelativeToScreen:function(a){return this.documentServices.components.layout.getSnugLayoutRelativeToScreen(a)},getRelativeToScreenConsideringScroll:function(a){return this.documentServices.components.layout.getSnugLayoutRelativeToScreenConsideringScroll(a)},getRelativeToStructure:function(a){return this.documentServices.components.layout.getSnugLayoutRelativeToStructure(a)},getResizableSides:function(b){return this.multiselect.is.proportionallyResizable(b)?a.values(this.components.layout.RESIZE_SIDES):[]},update:function(a,b){if(!this.multiselect.containsSiblingsOnly(a))throw"Selected components do not share the same parent and therefore cannot be positioned relative to their container";var c=this.documentServices.components.layout.getSnugLayout(a);f(this,a,c,b)},updateRelativeToStructure:function(b,c){var d=a.pick(this.multiselect.layout.getRelativeToStructure(b),["x","y"]);f(this,b,d,c)},updateRelativeToScreen:function(b,c){var d=a.pick(this.multiselect.layout.getRelativeToScreen(b),["x","y"]);f(this,b,d,c)},updateRelativeToScreenAndPreserveProportions:function(b,c,d){a.defaults(c,d.layout),a.forEach(d.children,function(a){var b=h(a,c);this.components.layout.updateRelativeToScreenAndPreserveProportions(a.component,b,a)},this)},updateRelativeToStructureAndPreserveProportions:function(a,b,d){var e=c.layoutUtils.getLayoutRelativeToScreenFromRelativeToStructure(this,a,b);this.multiselect.layout.updateRelativeToScreenAndPreserveProportions(a,e,d)},updateAndPreserveProportions:function(a,b,d){if(!this.multiselect.containsSiblingsOnly(a))throw"Selected components do not share the same parent and therefore cannot be positioned relative to their container";var e=c.layoutUtils.getLayoutRelativeToScreenFromRelativeToParent(this,a,b);this.multiselect.layout.updateRelativeToScreenAndPreserveProportions(a,e,d)},getProportionStructure:function(b,d){var e=this.components.layout.getRelativeToScreen(b);return{component:null,layout:e,children:a.map(b,function(b){var f=this.components.layout.getRelativeToScreen(b),g=c.layoutUtils.getLayoutsXYDiff(f,e),h=a.defaults(g,f),i=c.layoutUtils.getChildContainerLayoutRatio(h,e),j=this.components.layout.getProportionStructure(b,d);return j.proportions=i,j.minLayout=a.omit(j.minLayout,["x","y"]),j},this)}},updateAndAdjustLayout:function(b,d){if(!this.multiselect.containsSiblingsOnly(b))throw"Cannot update and adjust layout of non-siblings components";var f=this.documentServices.components.layout.getSnugLayout(b);f=a.pick(f,"y");var g=c.layoutUtils.getLayoutsXYDiff(d,f),h=e(this,b,g);a.forEach(h,function(a){this.documentServices.components.layout.updateAndAdjustLayout(a.component,a.newLayout)},this)},setFixed:function(c,d){return a.map(c,function(a){return b.utils.fixedPositionUtils.setFixedPosition(this,a,d)})},updateAspectRatio:function(b){a.forEach(b,function(a){this.documentServices.components.layout.updateAspectRatio(a)},this)},removeAspectRatio:function(b){a.forEach(b,function(a){this.documentServices.components.layout.removeAspectRatio(a)},this)},unDock:function(){throw"Dock / Undock not supported for multiselect"},setDock:function(){throw"Dock / Undock not supported for multiselect"},updateDock:function(){throw"Dock / Undock not supported for multiselect"},getDock:function(){throw"Dock / Undock not supported for multiselect"},canBeStretched:function(){return!1},isStretchedToScreen:function(b){return a.some(b,function(a){return this.components.layout.isStretchedToScreen(a)},this)}},skin:{get:function(){throw"cannot get skin of multiple components"},getComponentSkinExports:function(){throw"Cannot get component skin exports for multiple components"}},is:{fixed:function(b){return a.every(b,this.components.is.fixed,this)},selectable:function(){return!0},alignable:function(b){return a.every(b,this.components.is.alignable)},container:function(){return!1},exist:function(b){return a.every(b,function(a){return this.components.is.exist(a)},this)},siteSegment:function(){return!1},removable:function(b){var c=a.every(b,function(a){return this.components.is.removable(a)},this);return c},duplicatable:function(b){var c=a.every(b,function(a){return this.components.is.duplicatable(a)},this);return c},styleCanBeApplied:function(){return!1},containable:function(b,c){var d=a.every(b,function(a){return this.components.is.containable(a,c)},this);return d},containableByStructure:function(b,c){var d=a.every(b,function(a){return this.components.is.containableByStructure(a,c)},this);return d},movable:function(b){var c=a.every(b,function(a){return this.components.is.movable(a)},this);return c},horizontallyMovable:function(b){var c=a.every(b,function(a){return this.components.is.horizontallyMovable(a)},this);return c},verticallyMovable:function(b){var c=a.every(b,function(a){return this.components.is.verticallyMovable(a)},this);return c},canMoveUp:function(b){var c=a.every(b,function(a){return this.components.is.canMoveUp(a)},this);return c&&this.multiselect.containsSiblingsOnly(b)},fullWidth:function(b){var c=a.every(b,function(a){return this.components.is.fullWidth(a)},this);return c},horizontallyResizable:function(b){return a.every(b,this.components.is.horizontallyResizable)},verticallyResizable:function(b){return a.every(b,this.components.is.verticallyResizable)},proportionallyResizable:function(a){return this.multiselect.is.horizontallyResizable(a)&&this.multiselect.is.verticallyResizable(a)},group:function(){return!1},groupable:function(b){return a.every(b,function(a){return this.components.is.groupable(a)},this)},groupedComponent:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.groupedComponent(a)},this);return c},topMost:function(b,c){var d=a.some(b,function(a){return this.documentServices.components.is.topMost(a,c)},this);return d},leftMost:function(b,c){var d=a.some(b,function(a){return this.documentServices.components.is.leftMost(a,c)},this);return d},resizable:function(){return!1},rotatable:function(){return!1},animatable:function(b,c){var d=a.every(b,function(a){return this.components.is.animatable(a,c)},this);return d},focusable:function(){return!1},pinnable:function(){return!1},slidesContainer:function(){return!1},slideContainer:function(){return!1},hoverBox:function(){return!1},draggable:function(b){return a.every(b,this.components.is.draggable)}},behaviors:{update:function(b,c,d){a.forEach(b,function(a){this.documentServices.components.behaviors.update(a,c,d)},this)},get:function(b){var c=a.reduce(b,function(a,b){return a.concat(this.documentServices.components.behaviors.get(b)||[])},[],this);return c},remove:function(b,c,d){a.forEach(b,function(a){this.documentServices.components.behaviors.remove(a,c,d)},this)},removeAll:function(b){a.forEach(b,function(a){this.documentServices.components.behaviors.removeAll(a)},this)},previewAnimation:function(b,c,d){var e=a.map(b,function(b,e,f){return this.documentServices.components.behaviors.previewAnimation(b,a.cloneDeep(c),e===f.length-1?d:void 0)},this);return e},stopPreviewAnimation:function(b){a.forEach(b,function(a){this.documentServices.components.behaviors.stopPreviewAnimation(a)},this)},execute:function(b,c,d){a.forEach(b,function(a){this.documentServices.components.behaviors.execute(a,c,d)},this)},getRuntimeState:function(b){return a.map(b,function(a){return this.documentServices.components.behaviors.getRuntimeState(a)},this)}}}}}),define("rEditor/app/APISections/leftBarAPI",["lodash","core"],function(a,b){"use strict";function c(c,d,e,f,g,h,i){return{panelName:c,panelProps:d,label:e,className:f,symbolName:g,order:a.indexOf(b.constants.LEFT_BAR.SUPER_APPS_ORDER.DESKTOP,c),collapseOnClick:h||!1,isButtonOpen:i}}function d(a,b){delete a.notifications[b],this.panelManager.closePanelByName(b)}return{leftBar:{collapseMenu:function(){var b=a.cloneDeep(this.editor.state.leftBar);b.isCollapsed=!0,this.editor.setState({leftBar:b})},superApps:{addButton:function(b,d,e,f,g,h,i,j){var k=c(b,d,e,f,g,i,j),l=a.cloneDeep(this.editor.state.leftBar),m=[l.superApps.desktop];h&&m.push(l.superApps.mobile),m.forEach(function(c){var d=a.find(c,{panelName:b});d?a.assign(d,k):c.push(k)}),this.editor.setState({leftBar:l})},removeButton:function(b){var c=a.cloneDeep(this.editor.state.leftBar);c.superApps.desktop=a.reject(this.editor.state.leftBar.superApps.desktop,{panelName:b}),c.superApps.mobile=a.reject(this.editor.state.leftBar.superApps.mobile,{panelName:b}),d.call(this,c,b),this.editor.setState({leftBar:c})}},notifications:{setCount:function(b,c){var d=a.cloneDeep(this.editor.state.leftBar);d.notifications[b]=c,this.editor.setState({leftBar:d})},getCount:function(a){return this.editor.state.leftBar.notifications[a]},increaseCount:function(b,c){var d=a.cloneDeep(this.editor.state.leftBar);d.notifications[b]+=c||1,this.editor.setState({leftBar:d})},decreaseCount:function(b,c){var d=a.cloneDeep(this.editor.state.leftBar);d.notifications[b]-=c||1,this.editor.setState({leftBar:d})}}}}}),define("rEditor/app/APISections/selectionUtils/selectionUtils",["lodash","experiment!boxSlideShow"],function(a,b){"use strict";function c(b,c,d){for(var e=b.components.getContainer(c);e;){if(a.isEqual(e,d))return!0;e=b.components.getContainer(e)}return!1}return{replaceComponentSelectedIfNeeded:function(a,d,e){var f=a.utils.findAncestorMatchesCondition(d,a.components.is.group),g=b?a.utils.findAncestorMatchesCondition(d,a.components.is.slidesContainer):void 0,h=a.selection.isComponentSelected(d),i=(f||g)&&!a.components.is.siblings([e,d]);return!h&&i?f&&g?c(a,g,f)?g:f:f||g:d}}}),define("rEditor/app/APISections/selection",["lodash","core","util","baseUI","experiment","rEditor/app/APISections/selectionUtils/selectionUtils"],function(a,b,c,d,e,f){"use strict";function m(b){var c=o.call(this,b);c&&!a.isEqual(c,this.editor.state.focusedContainer)&&(b=[c]),n.call(this,{selectedComponents:b,focusedContainer:c})}function n(b){var c=!a.isEqual(b.selectedComponents,this.editor.state.selectedComponents);this.editor.setState(b,function(){if(c){var b=this.pluginService.getPlugin("selection","*");a.isFunction(b)&&b(this.editor.state.selectedComponents)}}.bind(this))}function o(b){for(var c=a.first(b);c&&!this.components.is.focusable(c);)c=this.components.getContainer(c);return c}function p(a,b){return this.selection.isComponentSelected(a)?b.button===h?null:this.selection.deselectComponents(a):(this.closeCompPanelIfExists(),this.selection.addComponentToSelectionByRef(a))}function q(a){if(this.closeCompPanelIfExists(),e.isOpen("boxSlideShow")){var b=this.utils.getParentIfCompCanBeSelected(a);b&&(a=b)}this.selection.selectComponentByCompRef(a)}function r(b){var c=this.components.getSiblings(b),d=a.reject(c,function(a){return this.components.is.siteSegment(a)},this);return d}function s(a,b){var c=a.getComponentType(b);return"Page"===c||"AppPage"===c}function t(a,b){var c=this.editor.getPreviewFrameLayout();return{x:a-c.left,y:b-c.top}}var g="compPanels.panels.MultiSelect.layoutPanel",h=2,i=d.uiConstants,j=c.browserUtil,k=!0,l=!1;return{selection:{isMultiSelectKeyPressed:function(a){return a.shiftKey||j.isSpecialKeyPressed(a)},isSingleSelectionComponent:function(c){var d=this.components.getType(c);return a.includes(b.constants.MULTISELECT.SINGLE_SELECTION_COMPONENT_TYPES,d)||this.components.layout.isShowOnFixedPosition(c)},setIsMouseUpSelectionEnabled:function(a){k=a},getIsMouseUpSelectionEnabled:function(){return k},setIsHiddenComponentDraggedNext:function(a){l=!!a},isHiddenComponentDraggedNext:function(){return l},getAnchorsUnderClick:function(b,c){var d=t.call(this,b,c),e=this.pages.getReference(this.pages.getCurrentPageId()),f=this.components.get.byType("wysiwyg.common.components.anchor.viewer.Anchor",e);return a.filter(f,function(a){var b=this.components.layout.getRelativeToScreenConsideringScroll(a);return b.y+=i.ANCHOR_OFFSET_TOP,d.x>=b.x&&d.x<=b.x+i.ANCHOR_WIDTH&&d.y>=b.y&&d.y<=b.y+i.ANCHOR_HEIGHT},this)},getComponentsUnderClick:function(a,b){var c=t.call(this,a,b),d=this.components.get.byXYRelativeToScreen(c.x,c.y),e=this.selection.getAnchorsUnderClick(a,b);return e.concat(d)},getNonGroupCompUnderCursor:function(b,c,d){var f=this.selection.getComponentsUnderClick(b,c),g=0,h=f[g],i=h?this.components.getContainer(f[g]):null;if(e.isOpen("boxSlideShow")){if(d&&h&&i)for(;this.components.is.group(h)||(h&&i&&"SITE_STRUCTURE"!==i.id?!a.includes(a.pluck(f,"id"),i.id):!1);)g++,h=f[g],i=h?this.components.getContainer(f[g]):null}else for(;this.components.is.group(h);)g++,h=f[g];return h||null},getComponentUnderClickToBeSelected:function(b,c,d){var e=this.selection.getNonGroupCompUnderCursor(b,c,d),g=a.first(this.selection.getSelectedComponents());return e?e=f.replaceComponentSelectedIfNeeded(this,e,g):null},getComponentToBeMarkedByHoverBox:function(a,b){var c=this.selection.getComponentUnderClickToBeSelected(a,b,!0);return c},selectComponentByClick:function(a,b){var c=this.selection.getComponentUnderClickToBeSelected(a.clientX,a.clientY,!1,b),d=this.selection.isComponentSelected(c),e=this.selection.getSelectedComponents();if(!c)return void this.selection.deselectComponents();if(!this.selection.isSelectedCompUnderCursorAndBeneathSiteSegment(e,a))if(this.selection.isMultiSelectKeyPressed(a)&&!d)p.call(this,c,a),this.selection.setLastSelectionClickPos(null);else{if(!this.multiselect.isMultiselect(e)){var g,f=this.components.layout.isShowOnFixedPosition(c);if(f)g={x:a.clientX,y:a.clientY};else{var h=this.ui.scroll.getScroll();g={x:a.clientX+h.scrollLeft,y:a.clientY+h.scrollTop}}this.selection.setLastSelectionClickPos(g)}if(d)return void this.selection.setIsMouseUpSelectionEnabled(!0);q.call(this,c)}},selectNonGroupCompUnderCursor:function(a){var b=this.selection.getNonGroupCompUnderCursor(a.clientX,a.clientY);return this.selection.isComponentSelected(b)?null:this.selection.isMultiSelectKeyPressed(a)?p.call(this,b):q.call(this,b)},selectComponentByCompRef:function(b){var d=this.components.asArray(b);if(d=a.uniq(d,"id"),!(d.length>30)&&(!(e.isOpen("boxSlideShow")&&d.length>0)||this.components.is.selectable(d))&&this.multiselect.canBeSelectedTogether(d)){d=a.isEmpty(d)?null:this.multiselect.removeGroupedCompsIfTheirGroupIsInArray(d);var f=a.find(this.panelManager.getOpenPanels(),{name:g});a.size(d)<2&&f&&this.panelManager.closePanelByName(g),this.components.layout.isPinned(d)?c.keyboardShortcuts.setContext(c.keyboardShortcuts.CONTEXTS.PIN_MODE):c.keyboardShortcuts.getContext()===c.keyboardShortcuts.CONTEXTS.PIN_MODE&&c.keyboardShortcuts.setContext(c.keyboardShortcuts.CONTEXTS.EDITOR),e.isOpen("exp171")&&!e.isOpen("hoverBoxStateToEditorStageOff")?m.call(this,d):n.call(this,{selectedComponents:d,hoveredComp:null})}},addComponentToSelectionByRef:function(a){var c=this.components.asArray(a),d=this.selection.getSelectedComponents()||[],e=d.concat(c);return e.length>1&&this.bi.event(b.bi.events.selection.MULTISELECT,{num_of_elements_selected:e.length,selection_method:"keyboard"}),this.selection.selectComponentByCompRef(e),d},deselectComponent:function(){c.keyboardShortcuts.setContext(c.keyboardShortcuts.CONTEXTS.EDITOR),m.call(this,null)},getSelectedComponentId:function(){var b=this.selection.getSelectedComponents();return!!b&&a.first(b).id},getSelectedComponents:function(){return this.editor.state.selectedComponents},getFocusedContainer:function(){var a=this.selection.getSelectedComponents();return o.call(this,a)},getSelectedComponentType:function(){var b=this.selection.getSelectedComponents();return a.isEmpty(b)?null:this.getComponentType(a.first(b))},selectAll:function(){var d,e,c=this.selection.getSelectedComponents();this.multiselect.containsSiblingsOnly(c)&&this.selection.isComponentSelected()?this.components.is.siteSegment(c)||s(this,c)?d=this.components.getChildren(c):(e=r.call(this,c),d=c.concat(e)):d=(c||[]).concat(this.components.getChildren(this.pages.getCurrentPage())),a.isEmpty(d)||(this.closeCompPanelIfExists(),d.length>1&&this.bi.event(b.bi.events.selection.MULTISELECT,{num_of_elements_selected:d.length,selection_method:"keyboard"}),this.selection.selectComponentByCompRef(d))},getSelectedComponentData:function(){var a=this.selection.getSelectedComponents();return a?this.components.data.get(a):null},deselectComponents:function(b){c.keyboardShortcuts.getContext()===c.keyboardShortcuts.CONTEXTS.PIN_MODE&&c.keyboardShortcuts.setContext(c.keyboardShortcuts.CONTEXTS.EDITOR);var d=!b,e=this.components.asArray(b),f=this.selection.getSelectedComponents(),g=a.reject(f,function(b){return d||a.some(e,b)},this);this.selection.selectComponentByCompRef(g)},isComponentSelected:function(b){var c=this.selection.getSelectedComponents();if(a.isEmpty(b))return!!c;var d=this.components.asArray(b);return a.every(d,function(b){return a.some(c,b)})},setLastSelectionClickPos:function(a){a&&(a.y-=this.editorConfig.editingAreaLayout.top,a.x-=this.editorConfig.editingAreaLayout.left),n.call(this,{lastSelectionClickPos:a})},isSelectedCompUnderCursorAndBeneathSiteSegment:function(b,c){var d=this.selection.getComponentsUnderClick(c.clientX,c.clientY),e=this.siteSegments.getRefs().concat(this.pages.getCurrentPage()),f=a.findIndex(d,function(b){return!!a.find(e,b)},this);if(-1===f)return!1;var g=!1;return a.forEach(b,function(b){a.forEach(d,function(c,d){a.isEqual(b,c)&&d>f&&(g=!0)})}),g}}}}),define("rEditor/app/APISections/databaseEditor",["savePublish","experiment!disableDbEditorAutoSave"],function(a,b){"use strict";function c(a,c,d,e){a.openPanel("compPanels.panels.AppPart2.databaseEditorPanel",{selectedComponentType:e,listId:c,compRef:d,autoSave:!b})}function d(a){a.openPanel("savePublish.panels.common.failPanel",{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_ERROR_OPTION_1","SAVE_PUBLISH_ERROR_OPTION_2"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"http://www.wix.com/"})}function e(e,f){var g=this.panelManager,h=this.selection.getSelectedComponentType();!b&&this.generalInfo.isFirstSave()?a.saveInBackground(this,c.bind(null,g,e,f,h),d.bind(null,g)):c(g,e,f,h)}return{openDatabaseEditor:e}}),define("rEditor/app/APISections/welcomeScreensWrapper",["lodash","panels","util","core","experiment!newUserIntroVideo","experiment!appBuilderFeaturesRevival"],function(a,b,c,d,e,f){"use strict";function g(a){return a.compatibility.hasOldApp()||a.compatibility.hasAppPage()}function h(a){var b=a.account.getEditorVersionsInfo(),c=window.editorModel.firstSave===!1&&b.isEligibleForSwitch===!1;return b&&!b.isNewUser&&!c}function i(a,b){var d=a.account.getEditorVersionsInfo(),e=d.isEligibleForSwitch?"START_NOW_CLICK_WITH_BACK_OPTION":"START_NOW_CLICK_WITHOUT_BACK_OPTION";k(a,e,b),c.cookie.setUserPetriOverrideCookie("SantaEditorUserOverride","new")}function j(a,b){k(a,"BACK_TO_OLD_EDITOR_CLICK",b),c.cookie.setUserPetriOverrideCookie("SantaEditorUserOverride","old"),c.windowInteractionUtils.reloadPageWithoutQuestion()}function k(a,b,c){var e=d.bi.events.newEditorWelcomeScreens[b],f={site_id:a.generalInfo.getSiteId()};e.fields.duration&&(f.duration=Date.now()-c),a.bi.event(e,f)}function l(b){return a(b.components.get.byType("wixapps.integration.components.AppPart2")).map(b.components.data.get).pluck("appPartName").map(b.wixapps.appbuilder.data.lists.getListVersion).some(function(a){return!a||"1.0"===a})}function m(a){if(!h(a))return!1;var b=a.account.getEditorVersionsInfo(),c="new"===b.userOverride,d="old"===b.userOverride&&b.isEligibleForSwitch;return!c&&!d}function n(a){return f&&h(a)&&l(a)}function o(a){var c=a.account.getEditorVersionsInfo(),d=n(a);b.panelManager.openPanel("panels.focusPanels.newEditorWelcomeScreenPanel",{isEligibleForSwitch:c.isEligibleForSwitch,onNextClick:d?p.bind(this,a):i.bind(this,a,Date.now()),nextBtnLabel:d?"Notification_Box_Next":"Notification_Box_Start_Now",onBackClick:j.bind(this,a,Date.now())})}function p(a){var c=a.account.getEditorVersionsInfo();b.panelManager.openPanel("panels.focusPanels.newEditorListWelcomeScreenPanel",{isEligibleForSwitch:c.isEligibleForSwitch,onNextClick:i.bind(this,a,Date.now()),onBackClick:j.bind(this,a,Date.now())})}function q(a){if(!e)return!1;var b=a.siteName.getUsed(),c=b?0===b.length:!0,d=!!a.getUserPreferences().global.get("didPassNewUserVideoCheck");return d?!1:(a.getUserPreferences().global.set("didPassNewUserVideoCheck",!0),c)}return{initWelcomeScreen:function(a){var d="true"===c.url.getParameterByName("disableWelcomeScreen");if(!d){if(a.wixStores.isSiteInWixStoreTestDrive())return;q(a)?b.panelManager.openPanel("panels.focusPanels.welcomeVideoNoFrame",{panelManager:a.panelManager},!1):g(a)?b.panelManager.openPanel("panels.focusPanels.editorMigrationFailedPanel",{}):m(a)?o(a):n(a)&&p(a)}}}}),define("rEditor/app/APISections/layoutersWrapper",["lodash","rEditor/utils/multiSelectHandler"],function(a,b){"use strict";var c="wysiwyg.viewer.components.BoxSlideShow",d="wysiwyg.viewer.components.StripContainerSlideShow";return{components:{canBeShownOnAllStates:function(a,e){var f={multiCompHandler:this.multiselect.canBeMasterChild,singleCompHandler:this.documentServices.layouters.canBeMasterChild};return e?b.call(this,a,e,f):b.call(this,a,c,f)||b.call(this,a,d,f)},toggleShowOnAllStates:function(a,e){return e||(e=this.components.canBeShownOnAllStates(a,c)?c:d),b.call(this,a,e,{multiCompHandler:this.multiselect.toggleShowOnAllStates,singleCompHandler:this.documentServices.layouters.toggleMasterChild})},isShownOnAllStates:function(a,e){var f={multiCompHandler:this.multiselect.isShownOnAllStates,singleCompHandler:this.documentServices.layouters.isMasterChild};return e?b.call(this,a,e,f):b.call(this,a,c,f)||b.call(this,a,d,f)}}}}),define("rEditor/app/APISections/copyPasteWrapper",["lodash","core","experiment!boxSlideShow"],function(a,b,c){
"use strict";function f(a){var b={};if(c&&this.components.canBeShownOnAllStates(a)){var d=e.getSlideShowParent(this,a),f=e.getSlideShowSlideParent(this,a);if(f){b.originalParent=f,b.originalGrandParent=d;var g=this.components.layout.getRelativeToStructure(a),h=this.components.layout.getRelativeToStructure(f);b.relativeToParentLayout={x:g.x-h.x,y:g.y-h.y}}}return b}function g(b,d){if(c&&b.originalGrandParent&&this.components.is.slidesContainer(b.originalGrandParent)){var e=this.components.get.byXYRelativeToStructure(d.x,d.y);return!!a.find(e,b.originalGrandParent)}return!1}function h(a,b){return g.call(this,a,b)?e.findCurrentSlide(this,a.originalGrandParent):null}function i(b,c){return g.call(this,b,c)?a.isEqual(e.findCurrentSlide(this,b.originalGrandParent),b.originalParent)?null:b.relativeToParentLayout:null}function j(b){if(a.isEmpty(b))return!1;var c=this.isMobileEditor(),d=this.pages.data.get(this.pages.getCurrentPageId()).isLandingPage,e=a.some(b.components,"isShowOnAllPages");return!(c||d&&e)}function k(b){return a.has(b,"x")&&a.has(b,"y")}function l(b){return a.includes(d,b)}function m(b,c,d){var e=this.pages.getCurrentPageId(),f=[],g=this.components.asArray(b.components),j=this.siteSegments.getPagesContainer(),m=this.siteSegments.layout.get(j);c=k(c)?c:null;var n=this.pasteLogic.pasteContext.getPastePosition(this,b.snugLayoutRelativeToStructure,e);return a.forEach(g,function(b){var g=b.serializedComp,j=l(g.componentType),k=this.pages.getReference(j?"masterPage":e),o=h.call(this,b,n);if(o){var p=this.components.layout.getRelativeToStructure(o);c=c||{},c.x=n.x-p.x,c.y=n.y-p.y,k=o}var q=a.clone(c),r=a.clone(n);q?j&&(q.y+=m.y):(j||(r.y-=m.y),q=r),g.layout.x=q.x+b.positionRelativeToSnug.x,g.layout.y=q.y+b.positionRelativeToSnug.y,d&&(g.layout.x-=g.layout.width/2,g.layout.y-=g.layout.height/2);var s=i.call(this,b,n);s&&(g.layout.x=s.x,g.layout.y=s.y);var t=this.components.add(k,g);f.push(t)},this),f}function n(a){return this.components.is.duplicatable(a)}function o(b){var c=this.components.layout.getRelativeToStructure(b),d=this.pages.getCurrentPageId();this.pasteLogic.pasteContext.setPasteData(c,d,this.ui.scroll.getScroll());var e={snugLayoutRelativeToStructure:c,components:a.map(b,function(b){var d=this.components.serialize(b),e=this.components.style.getId(b);e&&(d.style=e),d.layout=this.components.layout.getRelativeToStructure(b);var g=this.components.getType(b);this.copyComponentPlugins[g]&&(d=this.copyComponentPlugins[g](b,d));var h=f.call(this,b);return a.merge({serializedComp:d,positionRelativeToSnug:{x:d.layout.x-c.x,y:d.layout.y-c.y},isShowOnAllPages:this.components.isShowOnAllPages(b)},h)},this)};return e}function p(b){var c=this.pages.getCurrentPageId(),d=[],e=this.siteSegments.getPagesContainer(),g=this.siteSegments.layout.get(e);return a.forEach(b,function(b){var e=this.components.serialize(b),i=l(e.componentType),j=this.components.layout.getRelativeToStructure(b).bounding,k=this.components.style.getId(b);k&&(e.style=k),this.pasteLogic.duplicateContext.setPasteData(j,c,this.ui.scroll.getScroll());var m=this.pasteLogic.duplicateContext.getPastePosition(this,j,c);i||(m.y-=g.y),e.layout.x=m.x,e.layout.y=m.y;var n=this.pages.getReference(i?"masterPage":c),o=a.merge({serializedComp:e},f.call(this,b)),p=h.call(this,o,m);p&&(n=p);var q=this.components.getType(b);this.copyComponentPlugins[q]&&(e=this.copyComponentPlugins[q](b,e));var r=this.components.add(n,e);d.push(r)},this),d}var d=["wysiwyg.viewer.components.tpapps.TPAGluedWidget"],e=b.utils.boxSlideShowUtils;return{components:{copy:function(a){if(a){var c=this.components.asArray(a);if(c=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(c),!n.call(this,c))return void(this.isMobileEditor()&&this.openCantCopyPastePanel());var d=o.call(this,c);this.clipboard.setItem(b.constants.EDITOR_CLIPBOARD_TYPES.COMPONENT,d)}},paste:function(a,c){var d=this.clipboard.getItem(b.constants.EDITOR_CLIPBOARD_TYPES.COMPONENT);if(!j.call(this,d))return void(this.isMobileEditor()&&this.openCantCopyPastePanel());var e=m.call(this,d,a,c);this.editor.state.performingMouseMoveAction||this.waitForChangesApplied(function(){this.selection.selectComponentByCompRef(e)}.bind(this))},duplicate:function(b){if(!b)return[];var c=this.selection.getSelectedComponents(),d=this.components.asArray(b);if(c=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(c),d=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(d),!this.components.is.duplicatable(d))return[];a.isEqual(d,c)&&this.selection.deselectComponents();var e=p.call(this,d);return this.waitForChangesApplied(function(){this.selection.selectComponentByCompRef(e)}.bind(this)),e}}}}),define("rEditor/app/APISections/wixStoresFlowAPI",["lodash","util"],function(a,b){"use strict";return{wixStores:{isSiteInWixStoreTestDrive:function(){return a.includes(b.editorModel.metaSiteFlags,"EComTestDrive")}}}}),define("rEditor/app/APISections/editorUI",[],function(){"use strict";return{ui:{scroll:{getScroll:function(){return this.editor.getScroll()},setScroll:function(a){return this.editor.setScroll(a)},animateScroll:function(a,b,c){this.editor.animateScroll(a,b,c)},addListener:function(a){return this.editor.addScrollListener(a)},removeListener:function(a){return this.editor.removeScrollListener(a)}},stage:{getEditingAreaLayout:function(){return this.editor.getEditingAreaLayout()}},focus:{setOnEditor:function(){this.editor.setFocus()}}}}}),define("rEditor/app/APISections/wixCode",[],function(){"use strict";function b(){return this.editor.state[a]}function c(){this.toggleEditorStateParam(a,!0)}var a="wixCodeLoaded";return{wixCode:{isLoaded:b,setLoaded:c}}}),define("rEditor/app/APISections/columns",["lodash"],function(a){"use strict";function d(b){var c=b,d=a.sum(c),e=100-d;return e&&(c[0]+=e),c}function e(b){var c=a.sum(b);return d(a.map(b,function(a){return Math.round(100*a/c)}))}function f(b,c){var d=this.components.getChildren(b);a.forEach(d,function(a,b){this.components.layout.update(a,{width:c[b]})},this)}function g(b,c){a.isUndefined(c)||this.components.arrangement.moveToIndex(b,c)}function h(b){var c=this.components.getChildren(b),d=a(c).map(this.components.layout.get).pluck("width").value();return e(d)}function i(a){this.components.getChildren(a).length===b&&f.call(this,a,c)}function j(a){var b=h.call(this,a),c=b.reverse();f.call(this,a,c)}function k(b){var c=this.components.getChildren(b),d=a.last(c);return this.components.serialize(d)}function l(b,c,d,e){return c=c||k.call(this,b),this.components.add(b,c,void 0,function(c){g.call(this,c,d),i.call(this,b),this.history.add("added column"),a.isFunction(e)&&this.waitForChangesApplied(e)}.bind(this))}function m(a,b){this.components.data.update(a,{alignment:b})}function n(a){return this.components.data.get(a).alignment}function o(a){this.components.arrangement.moveBackward(a)}function p(a){this.components.arrangement.moveForward(a)}function q(a){return this.components.getChildren(a).length<b}var b=5,c=a.times(b,function(){return 1});return{columns:{addColumn:l,canAdd:q,proportions:{set:f,get:h,flip:j,fix:d,toPercentages:e},columnAlignment:{set:m,get:n},move:{left:o,right:p}}}}),define("rEditor/app/pluginService",["lodash"],function(a){"use strict";var b={},c={DOUBLE_CLICK:"doubleClick"},d=function(c,d,e){a.set(b,[c,d],e)},e=function(c,d){return a.get(b,[c,d])};return{pluginConstants:c,registerPlugin:d,getPlugin:e}}),define("rEditor/app/componentsPlugins",["lodash","core","gfppData","experiment"],function(a,b,c,d){"use strict";function e(e){function g(b){var c=a(b).filter(function(b){var c=e.components.properties.get(b);return a.get(c,"isHidden")}).map("id").value();e.documentMode.ignoreComponentsHiddenProperty(c)}var f=e.pluginService;f.registerPlugin(f.pluginConstants.DOUBLE_CLICK,"wysiwyg.viewer.components.WRichText",function(){e.isMobileEditor()?e.openComponentPanel(b.constants.componentPanels.settings):d.isOpen("newCK")&&!e.text.isEditorReady()||(e.bi.event(b.bi.events.textControls.Text_Panel_opened,{origin:b.constants.USER_ACTIONS.ORIGIN.DOUBLE_CLICK}),e.text.startEditing())}),f.registerPlugin(f.pluginConstants.DOUBLE_CLICK,"wysiwyg.viewer.components.SiteButton",function(d,f){if(!e.isMobileEditor()){var g=c.getComponentMainActionClick(e,f.comp);a.isFunction(g)&&g(e,f.comp,b.constants.USER_ACTIONS.ORIGIN.DOUBLE_CLICK)}}),f.registerPlugin(f.pluginConstants.DOUBLE_CLICK,b.constants.MULTISELECT.TYPE,a.noop),f.registerPlugin(f.pluginConstants.DOUBLE_CLICK,"mobile.core.components.Page",function(a,c){var d=e.siteSegments.getPagesContainerAbsLayout(),f=c.evt.pageX<d.x||c.evt.pageX>d.x+d.width;return f?void e.panelManager.openPanel("rEditor.panels.backgroundPanel"):void e.openComponentPanel(b.constants.componentPanels.design)}),f.registerPlugin("selection","*",g),f.registerPlugin("propertiesChange","*",g)}return{registerComponentsPlugins:e}}),define("rEditor/app/updateThemePlugins/tinyMenu",[],function(){"use strict";return function(a,b){if(b&&b.style&&b.style.properties){var c=b.style.properties,d=b.style.propertiesSource,e=c["alpha-txt"];if(c["alpha-iconcolor"]=c["alpha-iconcolor"]||e,c["alpha-bordercolor"]=c["alpha-bordercolor"]||e,delete c["alpha-txt"],delete c["alpha-txts"],d){var f=d["alpha-txt"];d["alpha-iconcolor"]=d["alpha-iconcolor"]||f,d["alpha-bordercolor"]=d["alpha-bordercolor"]||f,delete d["alpha-txt"],delete d["alpha-txts"]}}}}),define("rEditor/app/updateThemePlugins",["rEditor/app/updateThemePlugins/tinyMenu"],function(a){"use strict";function c(a,c){var d=b[c.skin];d&&d(a,c)}var b={"wysiwyg.viewer.skins.mobile.TinyMenuSkin":a};return{register:function(a){a.theme.styles.registerHook(c)}}}),define("rEditor/app/tooltipTextService",["lodash"],function(a){"use strict";function c(c,d,e){a.isUndefined(b[c])&&(b[c]={}),b[c][d]=e}function d(a,c){return b[a]?b[a][c]||null:null}function e(a){var b=this.selection.getSelectedComponents();return this.tooltipTextService.getComponentTooltipText(b,a)}function f(a,b){var c=this.components.getType(a);return this.tooltipTextService.getTooltipText(c,b)}function g(){b={}}var b={};return{registerTooltipText:c,getTooltipText:d,getSelectedComponentTooltipText:e,getComponentTooltipText:f,clearAllToolTipsText:g}}),define("rEditor/pasteLogic/pasteLogicCalculations",[],function(){"use strict";function b(b){return{x:b.x+a.xOffset,y:b.y+a.yOffset}}function c(b){return{x:b.x+a.newStackOffset.x,y:b.y-a.newStackOffset.y}}function d(b,c,d){var e=a.rightThreshold,f=a.bottomThreshold;return d&&(e=0,f=0),c.x+e>b.rightX||c.y+f>b.stageLayout.bottom+b.scrollTop}function e(a,b,c){var d=a.siteSegments.getPagesContainer(),e=a.siteSegments.layout.get(d);return{x:(e.width-c.width)/2,y:(b.stageLayout.height-c.height)/2+b.scrollTop-e.y}}function f(a,b,c){var d=a.siteSegments.getPagesContainer(),e=a.siteSegments.layout.get(d);return c.y>e.height+b.stageLayout.top}function g(b,c){return c.y>=b.stageLayout.top&&c.y+a.bottomThreshold<=b.stageLayout.bottom-b.stageLayout.top+b.scrollTop}var a={xOffset:40,yOffset:30,newStackOffset:{x:60,y:40},bottomThreshold:80,rightThreshold:80};return{getNextComponentPosition:b,getNewStackComponentPosition:c,cannotFitIntoViewPort:d,getCenteredCompPosition:e,isComponentInViewPort:g,cannotFitIntoPageHeight:f}}),define("rEditor/pasteLogic/ComponentPasteLogic",["lodash","core","rEditor/pasteLogic/pasteLogicCalculations"],function(a,b,c){"use strict";function d(){return a.isEmpty(this.firstCompPosition)}function e(a){return a!==this.lastCompPage}function f(a,b,d){return this.centerOnFirstPaste||e.call(this,d)&&c.cannotFitIntoPageHeight(a,b,this.originalCompPosition)}function g(a,b,d){c.isComponentInViewPort(b,d)||a.ui.scroll.setScroll({scrollLeft:0,scrollTop:d.y})}function h(a){this.lastCompPage||(this.lastCompPage=a),e.call(this,a)&&this.resetPastePosition()}function i(a){return a.y<0}function j(a,b,d,h){var j={};if(f.call(this,a,b,h))j=c.getCenteredCompPosition(a,b,d),i(j)&&(j.y=0);else if(e.call(this,h))j=this.originalCompPosition,g(a,b,j);else{var k=a.ui.scroll.getScroll();j={x:this.originalCompPosition.x,y:this.originalCompPosition.y-this.originalScrollPosition+k.scrollTop}}return this.firstCompPosition=j,j}function k(a){var b=c.getNextComponentPosition(this.lastCompPosition);return c.cannotFitIntoViewPort(a,b)&&(b=c.getNewStackComponentPosition(this.firstCompPosition),this.firstCompPosition=b),b}function l(a){a=a||{},this.originalCompPosition={},this.originalScrollPosition=0,this.firstCompPosition={},this.lastCompPosition={},this.lastCompPage="",this.centerOnFirstPaste=a.centerOnFirstPaste||!1,this.lastScrollPosition=null}return l.prototype.setPasteData=function(a,b,c){this.originalScrollPosition=c.scrollTop,this.originalCompPosition={x:a.x,y:a.y},this.firstCompPosition={x:a.x,y:a.y},this.lastCompPosition={x:a.x,y:a.y},this.lastCompPage=b},l.prototype.resetPastePosition=function(){this.firstCompPosition={},this.lastCompPosition={}},l.prototype.getPastePosition=function(c,e,f){var g=c.ui.scroll.getScroll();this.lastScrollPosition&&!a.isEqual(g,this.lastScrollPosition)&&this.resetPastePosition();var i=b.utils.stageUtils.getViewPort(!0),l=a.pick(e,["width","height"]),m={};return h.call(this,f),m=d.call(this)?j.call(this,c,i,l,f):k.call(this,i),this.lastCompPosition=m,this.lastCompPage=f,this.lastScrollPosition=g,a.clone(m)},l}),define("rEditor/pasteLogic/AddPanelPasteLogic",["rEditor/pasteLogic/ComponentPasteLogic"],function(a){"use strict";function b(){a.call(this,{centerOnFirstPaste:!0}),this.lastCompTypeAdded=""}return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.getPastePosition=function(b,c,d,e){return e!==this.lastCompTypeAdded&&this.resetPastePosition(),this.lastCompTypeAdded=e,a.prototype.getPastePosition.call(this,b,c,d)},b}),define("rEditor/pasteLogic/pasteLogicContext",["lodash","jquery","rEditor/pasteLogic/ComponentPasteLogic","rEditor/pasteLogic/AddPanelPasteLogic"],function(a,b,c,d){"use strict";var e=new c,f=new c,g=new c({centerOnFirstPaste:!0}),h=new d;return{pasteContext:e,duplicateContext:f,addContext:g,addPanelPasteLogic:h}}),define("rEditor/bi/events.json",[],function(){return{QUALAROO_DUMMY_EVENT:{evid:9,fields:{testField:"testValue"}},UPGRADE_EVENT:{evid:519,fields:{origin:"string"}}}}),define("rEditor/bi/errors.json",[],function(){return{QUALAROO_SURVEY_TIMEOUT_NOT_SENT:{errorCode:8,errorName:"QUALAROO_SURVEY_TIMEOUT_NOT_SENT",desc:"qualaroo component was added without a timeout prop",severity:"error"}}}),define("rEditor/bi/bi",["rEditor/bi/events.json","rEditor/bi/errors.json"],function(a,b){"use strict";var c=function(b){b.bi.register("rEditor","event",a)};return{events:a,errors:b,registerEvents:c}}),define("rEditor/app/EditorAPI",["lodash","jquery","react","core","baseUI","panels","util","uiAnimations","mediaServices","compPanels","rEditor/app/panelHelpers","rEditor/app/updateOperationsPlugins","rEditor/app/pluginsRegistrar","userPreferences","savePublish","rEditor/utils/removeUtil","rEditor/app/APISections/concurrentUsersWrapper","rEditor/app/APISections/themeWrapper","rEditor/app/APISections/historyWrapper","rEditor/app/APISections/imageCrop","rEditor/app/APISections/siteWrapper","rEditor/app/APISections/domainWrapper","rEditor/app/APISections/developerMode","rEditor/app/APISections/selectedComponent","rEditor/app/APISections/savePublishWrapper","rEditor/app/APISections/componentsWrapper","rEditor/app/APISections/rulersAPI","rEditor/app/APISections/feedback","rEditor/app/APISections/mainMenuWrapper","rEditor/app/APISections/multiselect","rEditor/app/APISections/leftBarAPI","rEditor/app/APISections/selection","rEditor/app/APISections/databaseEditor","rEditor/app/APISections/welcomeScreensWrapper","rEditor/app/APISections/layoutersWrapper","rEditor/app/APISections/copyPasteWrapper","rEditor/app/APISections/wixStoresFlowAPI","rEditor/app/APISections/editorUI","rEditor/app/APISections/wixCode","rEditor/app/APISections/columns","rEditor/app/pluginService","rEditor/app/componentsPlugins","rEditor/app/updateThemePlugins","rEditor/app/tooltipTextService","rEditor/pasteLogic/pasteLogicContext","rEditor/bi/bi","textControls","blog","experiment"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W){"use strict";function $(){return{topBarHeight:Z.TOPBAR_HEIGHT,previewHeight:"100%",previewWidth:null,languages:["latin"],extraSiteHeight:40,editingAreaLayout:{top:Z.TOPBAR_HEIGHT,left:0}}}function ca(a){var b=a.refs.preview.getDOMNode(),c=b.contentWindow;c.selection?c.selection.empty():c.getSelection&&c.getSelection().removeAllRanges()}function da(b,c){var d=a.pick(b,["top","left","height","width"]);return d.top+=c,d}function ea(b,c){g.keyboardShortcuts.enable(),this.getPreviewMode()||this.applyPreviewScrollToEditorScroll(),a.forEach(this.pageNavigationCallbacks.concat(c),function(a){a&&a(b)})}function fa(b){var c={backgroundColor:"rgba(255, 255, 255, 0.85)"};b.renderPlugins.setCompsToShowOnTop(a.pluck(b.selection.getSelectedComponents(),"id")),b.renderPlugins.setBlockingLayer(c)}function ga(a){var b=null;a.renderPlugins.setCompsToShowOnTop(null),a.renderPlugins.setBlockingLayer(b)}function ha(a){a.editor.setState({pinMode:!0,contextMenu:null})}function ia(a){a.editor.setState({pinMode:!1})}function ja(a){g.bindOwnMethodsDeep(this,this),this.previewReady=!1,this.documentServices=null,this.userPreferences=new n,this.editor=a,this.editorConfig=$(),this.pendingStateChanges={},this.pendingEditorStateUpdateCallbacks=[],this.removePlugins={},this.compNamePlugins={},this.compIconPlugins={},this.cannotRemovePlugins={},this.copyComponentPlugins={},this.pageNavigationCallbacks=[],this.viewerUpdateCallbacks=[this.onViewerChanged],this.goToPreviewCallbacks=[],this.userPreferencesInitCallbacks=[this.initViewToolsFromUserPrefs,this.initUserAddedColors,this.initWelcomeScreen],this.sitePublishedCallbacks=[],this.deviceTypeChangeCallbacks=[],this.registeredHideBubbleOnPreview=!1,this.isSavedInCurrentSession=!1,this.pasteLogic=S,this.mediaServices=i,this.panelManager=f.panelManager,window.testApi&&window.testApi.domSelectors&&(window.testApi.domSelectors.setSearchRoot(this.editor),window.testApi.editorAPI=this,window.testApi.bi=g.automationUtil.bi)}function ka(b,c){var e=b.style;a.isObject(b.style)&&(e=d.styleManager.getStyleIdByDef(c.theme,c.components,b.style,b.componentType)),e&&(b.style=e),a.forEach(b.components,function(a){ka(a,c)})}var X=g.serviceTopology.dashboardUrl.replace(/create\//,"")+"/"||"http://www.wix.com/my-account/",Y=g.serviceTopology.wixStoresMigrationServiceUrl.replace(/ecommerce-migration-web\//,"bi-profile-server/userprofile")||"http://editor.wix.com/_api/wix-bi-profile-server/userprofile",Z=e.uiConstants,_={toolbarEnabled:!0,developerModeEnabled:!1,showHiddenComponents:!0,guidelinesEnabled:!0,sectionsHandlesEnabled:!0,snapToEnabled:!0,rulersEnabled:void 0,rulers:{guidesState:{},selectedGuide:void 0,isHovered:!1}},aa=["latin"],ba=null;return ja.prototype=a.defaultsDeep({},D,y,z,A,B,C,E,r,s,t,u,v,w,x,F,G,I,J,q,K,L,M,N,{onPreviewReady:function(a){this.previewReady=!0,this.setDocumentServices(a),this.bi.event=this.bi.eventWithEditorPresets(this.bi.event),this.onViewerChanged(),this.updateUserPreferencesOnPreviewReady(),this.components.onPreviewReady(this),this.synchronizeSiteSEOToMainPageSEO(),o.setTimerForSaveReminder(this),this.panelManager.initBIHandler(this.bi),this.feedback.init(),this.documentServices.registerToSiteChanged(this.notifyViewerUpdate),this.documentServices.documentMode.enableAction("screenIn",!1),this.documentServices.documentMode.enableBgVideoAutoplay(!1),this.documentServices.generalInfo.isFirstSave()||this.leftBar.collapseMenu(),d.bi.registerEvents(this),this.initPlugins(),this.campaigns.fetchCampaignInfo(),this.documentServices.generalInfo.isFirstSave()&&this.initTemplateCharacterSet(),this.promotions.initPromotions()},isMetaSiteFlagOpen:function(b){return a.includes(g.editorModel.metaSiteFlags,b)},triggerMouseUpOnEditor:function(a){this.editor.onMouseUp(a)},synchronizeSiteSEOToMainPageSEO:function(){var a=this.seo.title.get()||"",b=this.seo.description.get()||"",c=this.seo.keywords.get()||"",d=this.homePage.get(),e=this.pages.data.get(d);e.pageTitleSEO=a,e.descriptionSEO=b,e.metaKeywordsSEO=c,this.pages.data.update(d,e)},initTemplateCharacterSet:function(){function c(b){return a.isEqual(b,aa)}function d(b){return a.includes(b,"arabic")&&a.includes(b,"hebrew")}var b=this.documentServices.theme.fonts.getCharacterSet();if(c(b)||d(b)){var e=this.documentServices.theme.fonts.getLanguageCharacterSet(this.getLanguageCode());if(e)this.documentServices.theme.fonts.updateCharacterSet(e);else{var f=this.documentServices.theme.fonts.getCharacterSetByGeo();this.documentServices.theme.fonts.updateCharacterSet(f)}}},initPanelManager:function(){this.panelManager.registerObserver(this.onPanelsUpdated)},setDocumentServices:function(b){this.documentServices=b;var c={};a.merge(c,this.documentServices,this),a.merge(this,c)},initPlugins:function(){P.registerComponentsPlugins(this),m.register(),Q.register(this)},getLanguageCode:function(){return g.languages.getLanguageCode()},getViewTools:function(){return a.clone(this.editor.state.viewTools)},updateUserPreferencesOnPreviewReady:function(){function h(){b.userPreferencesInitCallbacksInvoked=!0,a.forEach(b.userPreferencesInitCallbacks,function(a){a()})}function i(a){e=e||a===d.constants.USER_PREFS.TYPES.GLOBAL,f=f||a===d.constants.USER_PREFS.TYPES.SITE,e&&(f||g)&&h()}var e,f,b=this,c=this.generalInfo.getSiteId(),g=b.documentServices.generalInfo.isFirstSave();this.userPreferences.loadGlobalPreferences(i.bind(this,d.constants.USER_PREFS.TYPES.GLOBAL)),g||b.userPreferences.loadSitePreferences(c,!1,i.bind(this,d.constants.USER_PREFS.TYPES.SITE))},initWelcomeScreen:function(){this.newEditorWelcomeScreenWrapper.initWelcomeScreen(this)},initViewToolsFromUserPrefs:function(){var b=d.constants.USER_PREFS.VIEW_TOOLS,c={developerModeEnabled:this.userPreferences.site.get(b.DEVELOPER_MODE_ENABLED),developerToolBarEnabled:this.userPreferences.site.get(b.DEVELOPER_TOOLBAR_ENABLED),guidelinesEnabled:this.userPreferences.site.get(b.GUIDELINES_ENABLED),sectionsHandlesEnabled:this.userPreferences.site.get(b.SECTIONS_HANDLES_ENABLED),snapToEnabled:this.userPreferences.site.get(b.SNAPTO_ENABLED),rulersEnabled:this.userPreferences.site.get(b.RULERS_ENABLED),rulers:{guidesState:this.userPreferences.site.get(b.GUIDES_STATE)}};a.defaults(c,_),this.editor.setState({viewTools:c})},initUserAddedColors:function(){var b=this.documentServices.theme.colors.getCustomUsedInSkins(),c=d.constants.USER_PREFS.THEME.COLORS.CUSTOM.USER_ADDED,e=this.userPreferences.session.get(c);e=a.intersection(e,b),this.userPreferences.session.set(c,e)},updatePreviewTop:function(b){var c=a.isUndefined(b)?this.editor.state.hideTools&&!this.editor.state.hideToolsAndMaintainStagePosition:b;this.editorConfig.editingAreaLayout.top=Z.TOPBAR_HEIGHT,c&&(this.editorConfig.editingAreaLayout.top-=Z.OFFSET_TOP_WHEN_TOOLS_HIDDEN),this.isMobileEditor()&&(this.editorConfig.editingAreaLayout.top+=Z.MOBILE_PREVIEW_TOP)},updateEditingAreaLayout:function(b){a.assign(this.editorConfig,{editingAreaLayout:b})},updateConfig:function(){this.editorConfig.previewHeight=this.documentServices.site.getHeight(),this.updatePreviewTop()},onPanelsUpdated:function(){this.editor.setState({openPanels:this.panelManager.getOpenPanels(),helpProps:this.panelManager.getHelpPanelProps()})},notifyViewerUpdate:function(b){this.waitForChangesApplied(function(){a.forEach(this.viewerUpdateCallbacks,function(a){a(b)})}.bind(this))},setStateWaitForViewer:function(b){a.assign(this.pendingStateChanges,b)},setStateUpdateCallback:function(a){this.pendingEditorStateUpdateCallbacks.push(a)},getPendingStateChanges:function(){return a.reduce(this.pendingEditorStateUpdateCallbacks,function(b,c){return a.assign(b,c())},this.pendingStateChanges,this)},onViewerChanged:function(){this.editor.state.editorIsInit||this.setDocumentMode(!1),this.updateConfig();var b=this.getPendingStateChanges();this.pendingStateChanges={},this.pendingEditorStateUpdateCallbacks=[],this.editor.setState(a.defaults({config:this.editorConfig,editorIsInit:!0},b))},registerInitUserPrefsCallback:function(a){this.userPreferencesInitCallbacks.push(a),this.userPreferencesInitCallbacksInvoked&&a()},exitEditor:function(){window.open(X+"?referralInfo=EDITOR","_self")},getUserPreferences:function(){return this.userPreferences},isTpa:function(a){return this.documentServices.tpa.isTpaByCompType(a)},registerToViewerChange:function(a){this.viewerUpdateCallbacks.push(a)},registerToGoToPreview:function(a){this.goToPreviewCallbacks.push(a)},registerRemovePlugin:function(a,b){this.removePlugins[a]=b},registerCannotRemovePlugin:function(a,b){this.cannotRemovePlugins[a]=b},registerCopyComponentPlugin:function(a,b){this.copyComponentPlugins[a]=b},registerPageNavigationCallback:function(a){this.pageNavigationCallbacks.push(a)},registerCompNamePlugin:function(a,b){this.compNamePlugins[a]=b},registerCompIconPlugin:function(a,b){this.compIconPlugins[a]=b},registerSitePublishedCallbacks:function(a){this.sitePublishedCallbacks.push(a)},registerDeviceTypeChangeCallbacks:function(a){this.deviceTypeChangeCallbacks.push(a)},applyPreviewScrollToEditorScroll:function(){if(!this.getPreviewMode()){var a=this.site.getScroll();this.editor.setScroll({scrollLeft:a.x,scrollTop:a.y})}},togglePreview:function(){var a=!this.editor.state.previewMode;this.setDocumentMode(a),this.setRenderPlugins(a,this.isMobileEditor()),W.isOpen("se_hoverBox")&&this.documentServices.components.modes.resetAllActiveModes(),a?this.goToPreview():this.exitPreview()},goToPreview:function(){ca(this.editor),this.panelManager.closeAllPanels(),this.editor.setState({previewMode:!0,contextMenu:null},function(){this.waitForChangesApplied(this.actions.executeAnimationsInPage),a.forEach(this.goToPreviewCallbacks,function(a){a()})}.bind(this)),this.selection.deselectComponents(),g.keyboardShortcuts.setContext(g.keyboardShortcuts.CONTEXTS.PREVIEW)},exitPreview:function(){this.editor.setState({previewMode:!1,floatingBubble:{}},function(){this.applyPreviewScrollToEditorScroll(),g.keyboardShortcuts.setContext(g.keyboardShortcuts.CONTEXTS.EDITOR)}.bind(this))},setRenderPlugins:function(a){this.renderPlugins.allowSiteOverflow(a),this.renderPlugins.setExtraSiteHeight(a||this.isMobileEditor()?0:this.editorConfig.extraSiteHeight),this.renderPlugins.setPreviewTooltipCallback(function(a,b){var c=da(a,this.editorConfig.editingAreaLayout.top);this.showFloatingBubble(b,c),ba=setTimeout(this.hideFloatingBubble,d.constants.PREVIEW.FLOATING_BUBBLE_TIMEOUT)}.bind(this))},setDocumentMode:function(a){this.documentServices.documentMode.enablePlaying(a),this.documentServices.documentMode.enableZoom(a),this.documentServices.documentMode.enableSocialInteraction(!1),this.documentServices.documentMode.enableExternalNavigation(!1),this.documentServices.documentMode.enableSlideShowGalleryClick(a),this.documentServices.documentMode.enableTinyMenuOpening(a),this.documentServices.documentMode.enableRenderFixedPositionContainers(a),this.documentServices.documentMode.enableRenderFixedPositionBackgrounds(a),this.documentServices.documentMode.enableBackToTopButton(a),this.documentServices.documentMode.enablePageProtection(!1),this.documentServices.documentMode.toggleWixAds(a),this.documentServices.documentMode.enableBgVideoAutoplay(a&&this.isDesktopEditor()),this.documentServices.documentMode.enableSiteMembersDialogsOpening(a),this.documentServices.documentMode.enableResetGalleryToOriginalState(a),this.documentServices.documentMode.enableResetComponent(!a),this.documentServices.documentMode.resetBehaviors(a),this.documentServices.documentMode.enableAction("screenIn",a&&this.isDesktopEditor()),this.documentServices.documentMode.enableAction("bgScrub",a&&this.isDesktopEditor()),this.documentServices.documentMode.setExtraSiteHeight(a||this.isMobileEditor()?0:this.editorConfig.extraSiteHeight),this.documentServices.documentMode.enableShouldUpdateJsonFromMeasureMap(!a),this.documentServices.documentMode.allowSiteOverflow(a),this.documentServices.documentMode.setComponentViewMode(a?"preview":"editor"),this.documentServices.documentMode.allowWixCodeInitialization(a),this.documentServices.documentMode.showHiddenComponents(a?!a:this.getViewTools().showHiddenComponents),a||this.documentServices.documentMode.runtime.reset()},getPreviewSize:function(){return this.editor.getPreviewSize()},getPreviewMode:function(){return this.editor.state.previewMode},isCurrentPageLandingPage:function(){var a=this.pages.data.get(this.pages.getCurrentPageId());return a.isLandingPage},isDesktopEditor:function(){return!this.isMobileEditor()},isMobileEditor:function(){return this.editor.state&&this.editor.state.isMobileEditor},openCantCopyPastePanel:function(){var a=this.userPreferences.site.get(d.constants.USER_PREFS.CANT_MAKE_CHANGES.MOBILE_CANT_MAKE_CHANGE_DONT_SHOW_AGAIN);a||this.panelManager.openPanel("mobileEditor.panels.cantMakeChangeMobile",{},!0)},setDesktopEditor:function(){this.setEditorMode(!1)},setMobileEditor:function(){this.setEditorMode(!0)},setEditorMode:function(b,c,d){if(b===this.isMobileEditor())return void(c&&c());a.forEach(this.deviceTypeChangeCallbacks,function(a){a()});var e=b?this.viewMode.VIEW_MODES.MOBILE:this.viewMode.VIEW_MODES.DESKTOP;this.panelManager.closeAllPanels(),this.selection.deselectComponents(),this.viewMode.set(e),this.setRenderPlugins(this.getPreviewMode(),b);var f=b;this.editor.setState({isMobileEditor:f},c),!d&&f&&this.documentServices.history.canUndo()&&this.history.add("mobile structure was updated"),this.documentServices.documentMode.setExtraSiteHeight(this.editor.state.previewMode||f?0:this.editorConfig.extraSiteHeight),this.documentServices.documentMode.resetBehaviors(this.getPreviewMode()),this.documentServices.documentMode.enableAction("screenIn",this.getPreviewMode()&&!b),this.documentServices.documentMode.enableAction("bgScrub",this.getPreviewMode()&&!b),this.documentServices.documentMode.enableBgVideoAutoplay(this.getPreviewMode()&&!b)},isMobileOptimizedSite:function(){return this.documentServices?this.documentServices.mobile.isOptimized():!1},setMobileOptimizedSite:function(a){this.documentServices&&this.documentServices.mobile.enableOptimizedView(a)},groupComponents:function(a){if(!this.components.is.groupedComponent(a)){this.selection.deselectComponents();var b=this.components.groupComponents(a);this.closeCompPanelIfExists(),this.history.add("group components"),this.waitForChangesApplied(function(){this.selection.selectComponentByCompRef(b)}.bind(this))}},getLeftBarButtonsBoundingRect:function(){return this.editor.refs.leftBar?this.editor.refs.leftBar.getButtonsBoundingRect():0},openRightClickMenu:function(a,b){var c={position:{x:a,y:b}};this.editor.setState({contextMenu:c})},closeRightClickMenu:function(){this.editor.setState({contextMenu:null})},closeCompPanelIfExists:function(){var a=this.panelManager.getPanelsOfType("compPanelFrame");a.length&&this.panelManager.closeAllPanelsOfType("compPanelFrame")},toggleShowOnAllPages:function(a){var b;return b=this.components.isShowOnAllPages(a)?this.documentServices.pages.getReference(this.pages.getCurrentPageId()):this.documentServices.siteSegments.getSiteStructure(),this.components.setContainer(a,b)},getCompDragRestrictions:function(a){return a?{horizontallyMovable:this.components.is.horizontallyMovable(a)&&!this.editor.state.isOpenTextEditor&&!this.editor.state.pinMode,verticallyMovable:this.components.is.verticallyMovable(a)&&!this.editor.state.isOpenTextEditor&&!this.editor.state.pinMode}:{}},getCompMoveRestrictions:function(b){var c=this.getCompDragRestrictions(b);return b&&a.assign(c,{canMoveForward:this.components.arrangement.canMoveForward(b),canMoveBackward:this.components.arrangement.canMoveBackward(b)}),c},getCompRestrictions:function(b){var c=this.getCompMoveRestrictions(b);return b&&(a.assign(c,{container:this.components.is.container(b),containable:this.components.is.containable(b),movable:this.components.is.movable(b)&&!this.editor.state.isOpenTextEditor,
alignable:this.components.is.alignable(b),canMoveUp:this.components.is.canMoveUp(b)&&!this.editor.state.isOpenTextEditor,resizable:this.components.is.resizable(b),horizontallyResizable:this.components.is.horizontallyResizable(b)&&!this.components.layout.isPinned(b),verticallyResizable:this.components.is.verticallyResizable(b)&&!this.components.layout.isPinned(b),resizeableSides:this.components.layout.getResizableSides(b),rotatable:this.components.is.rotatable(b)&&!this.components.layout.isPinned(b),removable:this.components.is.removable(b)&&!this.editor.state.isOpenTextEditor,duplicatable:this.components.is.duplicatable(b)&&!this.editor.state.isOpenTextEditor&&!this.components.layout.isPinned(b),isFixed:this.components.is.fixed(b),canBeFixed:this.components.layout.canBeFixedPosition(b),canShowOnAllPages:this.components.canShowOnAllPages(b),canToggleShowOnAllPages:this.components.canToggleShowOnAllPages(b)}),W.isOpen("boxSlideShow")&&(c.canBeShownOnAllStates=this.components.canBeShownOnAllStates(b))),c},getComponentType:function(a){return this.components.getType(a).split(".").pop()},openPagesPanel:k.openPagesPanel,openMobileElementsPanel:k.openMobileElementsPanel,openComponentPanel:function(a,b){b=b||{};var c=this.getComponentType(this.editor.state.selectedComponents),d=this.getPanelPathByType(c,a);this.panelManager.openComponentPanel(d,b)},openCompOutOfGridPanelIfNeeded:function(a){this.components.layout.isCompOutOfPageBounds(a)&&this.openCompOutOfGridPanel()},openCompOutOfGridPanel:k.openCompOutOfGridPanel,openDragToHeaderPanel:k.openDragToHeaderPanel,openOrganizeImagesPanel:k.openOrganizeImagesPanel,openOrganizeSocialIconsPanel:k.openOrganizeSocialIconsPanel,openAviaryPanel:k.openAviaryPanel,openLinkPanel:k.openLinkPanel,openPinModeSizeRestrictionPanel:k.openPinModeSizeRestrictionPanel,getPanelPathByType:function(b,c){var e="compPanels.panels."+b+"."+c;return a.get(j,["panels",b,c])||(this.isTpa(b)?c===d.constants.componentPanels.settings&&(e="tpa.compPanels.tpaSettings"):c===d.constants.componentPanels.animation?e="compPanels.dynamicPanels."+d.constants.componentPanels.animation:c===d.constants.componentPanels.stretching?e="compPanels.dynamicPanels."+d.constants.componentPanels.stretching:c===d.constants.componentPanels.filters?e="compPanels.dynamicPanels."+d.constants.componentPanels.filters:c===d.constants.componentPanels.design&&(e="designPanel."+d.constants.componentPanels.design)),e},openLearnMore:function(a){a&&"string"==typeof a&&console.log("opening learn more with key - ",a)},isPreviewReady:function(){return this.previewReady},registerMouseMoveAction:function(a,b,c){this.editor.registerMouseMoveAction(a,b,c)},isPerformingMouseMoveAction:function(){return this.editor.isPerformingMouseMoveAction()},setPortalChildren:function(b,c){var d=a.cloneDeep(this.editor.state.portalComps);a.isEmpty(c)?delete d[b]:d[b]=c,this.editor.setState({portalComps:d})},hasExternalDesign:function(a){return this.documentServices.tpa.isTpaByCompType(this.components.getType(a))},setAttachCandidate:function(a,b){b?this.editor.setState({attachCandidate:a}):this.setStateWaitForViewer({attachCandidate:a})},setConstraintArea:function(a){this.setStateWaitForViewer({constraintArea:a})},setPageSections:function(b,c){var d=a.clone(this.editor.state.pageSections);a.assign(d,{sections:b,selectedSection:c}),this.editor.setState({pageSections:d})},clearPageSections:function(){this.setPageSections(null,null)},sectionsHandles:{areSectionsHandlesEnabled:function(){return this.editor.state.viewTools.sectionsHandlesEnabled},toggleSectionsHandles:function(a,b){var c=!this.sectionsHandles.areSectionsHandlesEnabled();this.updateEditorViewTools("sectionsHandlesEnabled",c),this.userPreferences.site.set(d.constants.USER_PREFS.VIEW_TOOLS.SECTIONS_HANDLES_ENABLED,c,a,b)}},setSiteScale:function(a,b){this.editor.setSiteScale(a,b)},zoomMode:{enterZoomMode:function(){this.setSiteScale(.5,0),this.documentMode.allowShowingFixedComponents(!1),g.keyboardShortcuts.setContext(g.keyboardShortcuts.CONTEXTS.ZOOM_MODE)},exitZoomMode:function(){this.setSiteScale(1,0),this.documentMode.allowShowingFixedComponents(!0),g.keyboardShortcuts.setContext(g.keyboardShortcuts.CONTEXTS.EDITOR)},isInZoomMode:function(){return 1!==this.editor.state.siteScale}},snapData:{set:function(a,b){b?this.editor.setState({snapData:a}):this.setStateWaitForViewer({snapData:a})},clear:function(a){a?this.editor.setState({snapData:null}):this.setStateWaitForViewer({snapData:null})}},lasso:{setCandidates:function(a){this.editor.setState({lassoCandidates:a})},setLayout:function(a){this.editor.setState({lassoLayout:a})},clear:function(){this.editor.setState({lassoLayout:null,lassoCandidates:[]})}},hoverBox:{set:function(a,b){var c=W.isOpen("exp171")&&!W.isOpen("hoverBoxStateToEditorStageOff");if(c)this.editor.setHoverBox(a,b);else{var d=this.utils.getParentIfCompCanBeSelected(a),e=d?d:a;this.editor.setState({hoveredComp:W.isOpen("boxSlideShow")?e:a,hoverBoxOverlay:!!b})}},clear:function(){var a=W.isOpen("exp171")&&!W.isOpen("hoverBoxStateToEditorStageOff");a?this.editor.clearHoverBox():this.editor.setState({hoveredComp:null,hoverBoxOverlay:!1})}},clipboard:{types:d.constants.EDITOR_CLIPBOARD_TYPES,setItem:function(b,c){var d=a.cloneDeep(this.editor.state.clipboard);d[b]=c,this.editor.setState({clipboard:d})},getItem:function(a){return this.editor.state.clipboard[a]}},clipboardContainsComp:function(){return!!this.clipboard.getItem(d.constants.EDITOR_CLIPBOARD_TYPES.COMPONENT)},text:{startEditing:function(){if(CKEDITOR&&!CKEDITOR.wixDocumentServices&&(CKEDITOR.wixDocumentServices=this),!this.editor.state.isOpenTextEditor){var b=this.selection.getSelectedComponents();if(this._textCompForEdit=a.first(b),U.migrationUtils.isOldTextComponent(this._textCompForEdit,this)){this.bi.error(d.bi.errors.OLD_TEXT_MIGRATION),U.migrationUtils.migrateComponent(this._textCompForEdit,this);var c=this;this.waitForChangesApplied(function(){c.editor.setState({isOpenTextEditor:!0})})}else this.editor.setState({isOpenTextEditor:!0})}},stopEditing:function(){function a(a,b){if(b){var c=a.components.data.get(b);if(c){var d=c.text;U.dataUtils.isEmptyHtmlText(d)&&a.components.remove(b)}}}if(this.editor.state.isOpenTextEditor)if(W.isOpen("newCK"))this.editor.setState({isOpenTextEditor:!1});else{var b=this;this.renderPlugins.setHideTextComponent(null),this.waitForChangesApplied(function(){a(b,b._textCompForEdit),b.editor.setState({isOpenTextEditor:!1}),delete b._textCompForEdit})}},setCurrentTextEditor:function(a){this._currentTextEditor=a},getEditor:function(){return this._currentTextEditor},getTextCompForEdit:function(){return this._textCompForEdit},isEditingText:function(){return!!this.editor.state.isOpenTextEditor},undo:function(){this._currentTextEditor.editor.undoManager.undo()},redo:function(){this._currentTextEditor.editor.undoManager.redo()},isEditorReady:function(){return this._currentTextEditor&&"ready"===this._currentTextEditor.editor.status}},account:{isUserOwner:function(){var a=g.editorModel.permissionsInfo;return a&&a.ownerId===a.loggedInUserId},isUserContributor:function(){return!this.account.isUserOwner()},openConnectDomain:function(b,c){var d=this.generalInfo.isFirstSave();c=a.isBoolean(c)?c:!this.generalInfo.isSitePublished();var e=this.site.isPremium();this.panelManager.openPanel("savePublish.panels.connectDomain",{isFirstSave:d,isFirstPublish:c,isPremium:e,title:"PREMIUM_PUBLISH_TITLE",subtitle:e?"PREMIUM_PUBLISH_SUBTITLE":"CONNECT_DOMAIN_DIALOG_FREE_SUBTITLE",flowId:b},!0)},openSettings:function(){var a="49cebc11-f15c-4cf8-82d9-2c36c5397520";this.panelManager.openPanel("rEditor.panels.siteSettingsPanel",{helpId:a})},openRevisions:function(){var a=!!this.userPreferences.site.get(d.constants.USER_PREFS.SITE_REVISIONS.SITE_HISTORY_DONT_SHOW_AGAIN);if(a)this.account.openSiteHistory();else{var b=this;this.panelManager.openPanel("panels.messagePanels.siteRevisionsPanel",{onButtonClick:function(a){a&&b.account.openSiteHistory()}})}},manage:function(){var a=this.documentServices.generalInfo.getMetaSiteId();window.open(X+"sites/"+a+"/?referralInfo=EDITOR")},openSiteHistory:function(){var a=this.documentServices.generalInfo.getMetaSiteId();window.open(X+"history/"+a+"/?forceHttp&isEdited=true&referralInfo=EDITOR")},upgrade:function(a){var b=a.replace(/edhtml_/,"")||"unknown";this.bi.event(T.events.UPGRADE_EVENT,{origin:b});var c=this.documentServices.generalInfo.getMetaSiteId(),d=a?"referralAdditionalInfo="+a:"",e=g.serviceTopology.premiumServerUrl||"https://premium.wix.com";e+="/wix/api/premiumStart?"+d+"&siteGuid="+c,window.open(e)},getEditorVersionsInfo:function(){return window.editorVersionsInfo||null}},help:{openHelpCenter:function(a,b,c,d){console.error("editorAPI.help.openHelpCenter is deprecated. Use panelManager.openHelpCenter instead"),this.panelManager.openHelpCenter(a,b,c,d)}},mobile:{mobileOnlyComponents:{enableBackToTopButton:function(a){this.documentServices.mobile.mobileOnlyComponents.enableBackToTopButton(a)}},hiddenComponents:{get:function(b){var c=this.documentServices.mobile.hiddenComponents.get(b);return a.filter(c,function(a){var c=this.documentServices.components.get.byId(a,b,this.documentServices.viewMode.VIEW_MODES.DESKTOP);return!this.documentServices.components.is.group(c)},this)}}},utils:{isSameRef:function(b,c){var d=this.components.asArray(b),e=this.components.asArray(c);if(this.multiselect.isMultiselect(d)||this.multiselect.isMultiselect(e)){if(d.length!==e.length)return!1;var f=a.sortBy(d,"id"),g=a.sortBy(e,"id"),h=a.every(f,function(a,b){return this.documentServices.utils.isSameRef(a,g[b])},this);return h}return this.documentServices.utils.isSameRef(a.first(d),a.first(e))},isPage:function(a){var b=this.components.asArray(a);return this.multiselect.isMultiselect(b)?!1:this.documentServices.utils.isPage(b[0])},getParentIfCompCanBeSelected:function(a){return this.components.is.selectable(a)?null:this.components.getContainer(a)},findAncestorMatchesCondition:function(a,b){if(!a)return null;for(var c=this.components.getContainer(a);c&&!b(c);)c=this.components.getContainer(c);return c}},siteName:{validate:function(a){var b=this.documentServices.siteName.validate(a),c={};return c[this.documentServices.siteName.ERRORS.SITE_NAME_IS_EMPTY]="SAVE_SITE_NAME_IS_EMPTY",c[this.documentServices.siteName.ERRORS.SITE_NAME_IS_NOT_STRING]="SITE_NAME_IS_NOT_STRING",c[this.documentServices.siteName.ERRORS.SITE_NAME_INVALID_CHARS]="SAVE_SITE_NAME_INVALID_CHARS",c[this.documentServices.siteName.ERRORS.SITE_NAME_ENDS_WITH_HYPHEN]="SAVE_SITE_NAME_ENDS_WITH_HYPHEN",c[this.documentServices.siteName.ERRORS.SITE_NAME_TOO_SHORT]="SAVE_SITE_NAME_TOO_SHORT",c[this.documentServices.siteName.ERRORS.SITE_NAME_TOO_LONG]="SAVE_SITE_NAME_TOO_LONG",c[this.documentServices.siteName.ERRORS.SITE_NAME_ALREADY_EXISTS]="SAVE_SITE_NAME_ALREADY_EXISTS",b.errorMessage=c[b.errorCode],b},set:function(a){this.documentServices.siteName.set(a),this.domain.isDomainConnected()||this.documentServices.generalInfo.setPublicUrl(this.domain.getFreeDomainPrefix()+a)},sanitize:function(a){return this.documentServices.siteName.sanitize(a)},rename:function(a,c,d){var e=g.serviceTopology.editorServerRoot||"//editor.wix.com/html/editor/web";e+="/meta-site-proxy/rename/"+this.documentServices.generalInfo.getMetaSiteId(),b.ajax(e,{type:"POST",data:{newName:a},success:function(b){return b.success?(this.documentServices.siteName.set(a),this.domain.isDomainConnected()||this.documentServices.generalInfo.setPublicUrl(this.domain.getFreeDomainPrefix()+a),void(c&&c())):void d(b)}.bind(this),error:function(){d&&d()}})}},updateEditorViewTools:function(b,c){var d=b;a.isString(b)&&(d={},d[b]=c);var e=a.defaults(d,this.getViewTools());this.editor.setState({viewTools:e})},toolbar:{isToolbarEnabled:function(){return this.editor.state.viewTools.toolbarEnabled},toggleToolbar:function(){this.updateEditorViewTools("toolbarEnabled",!this.toolbar.isToolbarEnabled())}},developerToolBar:{isEnabled:function(){return this.editor.state.viewTools.developerToolBarEnabled},toggle:function(){var a=!this.developerToolBar.isEnabled();this.updateEditorViewTools("developerToolBarEnabled",a),this.userPreferences.site.set(d.constants.USER_PREFS.VIEW_TOOLS.DEVELOPER_TOOLBAR_ENABLED,a)}},grid:{guidelines:{isGuidelinesEnabled:function(){return this.editor.state.viewTools.guidelinesEnabled},toggleGuidelines:function(a,b){var c=!this.grid.guidelines.isGuidelinesEnabled();this.updateEditorViewTools("guidelinesEnabled",c),this.userPreferences.site.set(d.constants.USER_PREFS.VIEW_TOOLS.GUIDELINES_ENABLED,c,a,b)}},snapTo:{isSnapToEnabled:function(){return this.editor.state.viewTools.snapToEnabled},toggleSnapTo:function(a,b){var c=!this.grid.snapTo.isSnapToEnabled();this.updateEditorViewTools("snapToEnabled",c),this.userPreferences.site.set(d.constants.USER_PREFS.VIEW_TOOLS.SNAPTO_ENABLED,c,a,b)}}},pages:{add:function(a,b){return b&&(b.data.pageUriSEO=this.pages.data.pageUriSEO.getValid("",b.data.pageUriSEO)),this.documentServices.pages.add(a,b)},navigateTo:function(a,b){this.selection.deselectComponent(),g.keyboardShortcuts.disable(),this.documentServices.pages.navigateTo(a,ea.bind(this,a,b))},navigateToAndScroll:function(a,b,c){this.selection.deselectComponent(),this.documentServices.pages.navigateToAndScroll(a,b,c)},getCurrentPageTitle:function(){if(!this.documentServices)return null;var a=this.documentServices.pages.getCurrentPageId(),b=this.documentServices.pages.data.get(a);return b&&b.title||""},remove:function(a,b){this.selection.deselectComponents(),p.removePage(this,this.documentServices,this.removePlugins,a,b)},beforePageRemoveHook:function(a,b){var d,c=this.homePage.get();c===a&&(d=this.mainMenu.getFirstNonHomePageMenuItem(),d&&(this.homePage.set(d.pageData.id),c=d.pageData.id.replace(/^#/,""))),this.documentServices.pages.navigateTo(c,b)},isPageExist:function(a){return this.pages.doesPageExist(a)},isHomePage:function(a){return a===this.homePage.get()},serialize:function(a,b){var c=this.documentServices.pages.serialize(a,!0);return b&&ka(c,this),c},data:{update:function(a,b){b.isLandingPage&&this.selection.deselectComponent(),b.pageUriSEO&&(b.pageUriSEO=this.pages.data.pageUriSEO.getValid(a,b.pageUriSEO)),b=d.utils.updateDataUtil.fixData(b),this.documentServices.pages.data.update(a,b),l.updatePagePlugins.run(this,a)}},background:{update:function(a,b,c){b=d.utils.updateDataUtil.fixData(b),this.documentServices.pages.background.update(a,b,c)}},transitions:{set:function(a){this.documentServices.pages.transitions.set(a),this.history.add("page transition")}}},siteSegments:{getRefs:function(){var a=this.documentServices.siteSegments;return[a.getFooter(),a.getHeader(),a.getPagesContainer(),a.getSiteStructure()]},getPagesContainerAbsLayout:function(){var a=this.siteSegments.getPagesContainer();return this.components.layout.getRelativeToScreen(a)}},pluginService:O,tooltipTextService:R,homePage:{set:function(a){this.documentServices.homePage.set(a),l.setHomePagePlugins.run(this,a)}},openEditorVersionInfoPanel:function(){this.panelManager.openPanel("rEditor.panels.editorVersionInfoPanel")},styles:{openApplyStylePanel:function(a){this.panelManager.openPanel("rEditor.panels.applyStylePanel",{selectedComp:a,editorAPI:this})}},bi:{eventWithEditorPresets:function(b){return function(c,d){c=a.defaults({},c,{src:38,endpoint:"editor",sampleRatio:0}),d=d||{};var e=g.editorModel.permissionsInfo;if(e){var f=e.ownerId,h=a.pluck(e.loggedInUserRoles,"role").join(",");d=a.assign({},d,{ownerId:f,roles:h})}b(c,d)}},getComponentsBIParams:function(b){return a.map(b,function(b){var c={};if(b){c.component_id=b.id;var d=this.components.getType(b);c.component_type=d,d&&this.isTpa(d)&&a.assign(c,this.bi.getTpaComponentBIParams(b))}return c},this)},getTpaComponentBIParams:function(a){var b={},c=this.components.data.get(a)||{},d=this.tpa.app.getData(c.applicationId);b.app_id=d.appDefinitionId,b.instance_id=a.id,b.app_site_id=d.instanceId,b.widget_id=c.widgetId;var e="TPAWidget"===c.type,f=this.tpa.app.isLastAppComp(c.applicationId),g=f||!(e||this.tpa.app.isMultiSectionInstalled(c.applicationId));return b.is_last_tpa=g?1:0,b},reportBI:function(b,c){var d=this;a.forEach(c,function(a){a.is_last=a.is_last||a===this,d.bi.event(b,a)},c[c.length-1])}},campaigns:{fetchCampaignInfo:function(){var a=this,c="http://"+window.location.host+"/_api/wix/salesSystemResolver";b.getJSON(c,function(b,c){"success"===c&&b&&(a.campaignInfo={id:b.data.campaignId,type:b.data.type})})},getActiveCampaignInfo:function(){return this.campaignInfo},isActiveCampaign:function(b){return this.campaigns.getActiveCampaignInfo()?a.includes(this.campaigns.getActiveCampaignInfo().id,b.id):!1},getDiscountValue:function(b){var c=this.campaigns.getActiveCampaignInfo(),d=c.id.split("_");return 1===d.length?b.defaultDiscount:a.last(d)},personalSale:{isActiveCampaign:function(){return this.campaigns.isActiveCampaign(d.constants.CAMPAIGNS.PERSONAL_SALE)||this.campaigns.isActiveCampaign(d.constants.CAMPAIGNS.SEASONAL_CAMPAIGN)},getDiscountValue:function(){return this.campaigns.getDiscountValue(d.constants.CAMPAIGNS.PERSONAL_SALE)},getAssetPath:function(){return d.constants.CAMPAIGNS.PERSONAL_SALE.assetPath}}},newEditorWelcomeScreenWrapper:H,promotions:{initPromotions:function(){this.promotions.music.init()},music:{init:function(){var a=this.promotions.music;(W.isOpen("musicPromotionFixed")||W.isOpen("musicPromotionRotation"))&&(a.didUserRegisterWithMusicCategory(function(b){a.isMusicCategory=b,a.isActive()&&a.displayPopup()}),this.tpa.app.registerOnInstalled(d.constants.MUSIC_PROMO.APP_DEFINITION_ID,a.displayPopup))},isActive:function(){if(W.isOpen("musicPromotionFixed")||W.isOpen("musicPromotionRotation")){var b=this.generalInfo.getSiteOriginalTemplateId(),c=a.includes(d.constants.MUSIC_PROMO.TEMPLATE_IDS,b),e=this.tpa.app.isInstalled(d.constants.MUSIC_PROMO.APP_DEFINITION_ID);return c||e||this.promotions.music.isMusicCategory}return!1},displayPopup:function(){this.panelManager.openPanel("panels.focusPanels.musicPromotionPanel")},didUserRegisterWithMusicCategory:function(c){var d=Y+"?fields=post_reg_category,post_reg_sub_category&accept=json";b.ajax(d).complete(function(b,d){if("success"===d){var e=b.responseJSON,f=e.payload&&e.payload.fields,g=a.find(f,{name:"post_reg_category"});c(g&&g.value&&a.includes(g.value.toLowerCase(),"music"))}else c(!1)})}}},showFloatingBubble:function(b,c,d,e){var f=a.clone(this.editor.state.floatingBubble);f.value=b,f.targetLayout=c,f.props=d,f.shouldNotHideOnMouseLeaveTarget=e,this.editor.setState({floatingBubble:f})},hideFloatingBubble:function(){this.editor.setState({floatingBubble:{}}),clearTimeout(ba)},isMouseOverBubble:function(){return this.editor.state.mouseOverBubble},showComponentPreviewRect:function(a){this.editor.setState({pinPreviewRectStyle:a})},hideComponentPreviewRect:function(){var b=this.editor.state.pinPreviewRectStyle;a.assign(b,{opacity:0}),this.editor.setState({pinPreviewRectStyle:b})},pinMode:{open:function(a){this.panelManager.openComponentPanel("compPanels.dynamicPanels.pinnedDockPanel",{origin:a,selectedComponents:this.editor.state.selectedComponents}),fa(this),ha(this)},close:function(){this.panelManager.closePanelByName("compPanels.dynamicPanels.pinnedDockPanel"),this.hideComponentPreviewRect(),ga(this),ia(this)},closeAndCheckSizeRestrictions:function(){this.pinMode.close(),this.pinMode.checkSizeRestrictionsAndShowPopup()},checkSizeRestrictionsAndShowPopup:function(){if(!this.getPreviewMode()){var b=this.components.layout.getDock(this.editor.state.selectedComponents);if(!a.isUndefined(b)){var c=g.pinModeUtils.getDockedDirection(b),d=this.components.layout.get(this.editor.state.selectedComponents);g.pinModeUtils.checkSizeRestrictions(c,d)&&this.openPinModeSizeRestrictionPanel({state:"on pin",title:"Notification_Box_PinToScreen_ElementTooLarge_postPin_Title",content:"Notification_Box_PinToScreen_ElementTooLarge_postPin_Message"})}}},isPinModeOpen:function(){return this.editor.state.pinMode}},getSiteScale:function(){return this.editor.state.siteScale},triggerMouseUp:function(a){this.editor.onMouseUp(a)},isVerticalScrollbarHidden:function(){var a=document.body.clientHeight>window.innerHeight;return!a||a&&document.body.clientWidth===window.innerWidth},toggleEditorStateParam:function(a,b){var c={};c[a]="undefined"==typeof b?!this.editor.state[a]:b,this.editor.setState(c)},toggleMouseOverBubble:function(a){this.toggleEditorStateParam("mouseOverBubble",a)},toolsControl:{toggleHalfOpacityTools:function(a){this.toggleEditorStateParam("halfOpacityTools",a)},toggleHideToolsBtnBlink:function(a){this.toggleEditorStateParam("shouldHideToolsBtnBlink",a)},toggleHideTools:function(b,c){c=a.isBoolean(c)?c:this.editor.state.hideToolsAndMaintainStagePosition;var e="undefined"==typeof b?!this.editor.state.hideTools:b,f="panels.toolPanels.linkPanel",g=this.panelManager.getOpenPanels();return this.hideFloatingBubble(),c||this.updatePreviewTop(e),this.editor.setState({hideToolsAndMaintainStagePosition:e?c:e,hideTools:e,editorConfig:this.editorConfig,halfOpacityTools:!1,shouldHideToolsBtnBlink:!1}),e&&a(g).reject({frameType:d.constants.PANEL_TYPES.COMP}).reject({name:f}).forEach(function(a){this.panelManager.closePanelByName(a.name)},this).value(),e}},blog:{add:function(a,b){V.installApp(this,a||"MediaLeftPage",b)}}}),ja}),define("rEditor/rootComps/keyboard/config/topContextShortcuts",["lodash"],function(a){"use strict";var b=function(a){a.preventDefault()},c={esc:b,"ctrl + t, command + t":b,"ctrl + y, command + y":b,"ctrl + d, command + d":b,"ctrl + s, command + s":b,"ctrl + ], command + ]":b,"ctrl + [, command + [":b,"ctrl + shift + ], command + shift + ]":b,"ctrl + shift + [, command + shift + [":b,backspace:b,"ctrl + left, command + left":b,"ctrl + right, command + right":b,"ctrl + shift + left, command + shift + left":b,"ctrl + shift + right, command + shift + right":b,"ctrl + m, command + m":b,"ctrl + shift + m, command + shift + m":b};return{init:a.once(a.noop),shortcuts:c}}),define("rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap",["core"],function(a){"use strict";var b=a.constants.KEYBOARD_SPECIAL_KEY.value,c=a.constants.KEYBOARD_SPECIAL_KEY.label;return{editor:{SELECT_ALL:{key:b+" + a",label:""},GROUP_COMPONENTS:{key:b+" + g",label:""},UNGROUP_COMPONENTS:{key:b+" + shift + g",label:""},COPY:{key:b+" + c",label:c+" + C"},PASTE:{key:b+" + v",label:c+" + V"},CUT:{key:b+" + x",label:c+" + X"},DUPLICATE:{key:b+" + d",label:c+" + D"},UNDO:{key:b+" + z",label:c+" + Z"},REDO:{key:[b+" + y",b+" + shift + z"].join(","),label:c+" + Y"},DELETE:{key:["del","backspace"].join(","),label:"Del"},SAVE:{key:b+" + s",label:c+" + S"},SAVE_AS_TEMPLATE:{key:b+" + alt + t",label:""},SELECT_NEXT_COMP:{key:b+" + m",label:""},SELECT_PREV_COMP:{key:b+" + shift + m",label:""},CLOSE_PANELS:{key:"esc",label:""},MOVE_RIGHT:{key:"right",label:""},SHIFT_RIGHT:{key:"shift + right",label:""},MOVE_LEFT:{key:"left",label:""},SHIFT_LEFT:{key:"shift + left",label:""},MOVE_UP:{key:"up",label:""},SHIFT_UP:{key:"shift + up",label:""},MOVE_DOWN:{key:"down",label:""},SHIFT_DOWN:{key:"shift + down",label:""},SEND_FORWARD:{key:b+" + right",label:c+" + →"},SEND_TO_FRONT:{key:b+" + shift + right",label:c+" + Shift + →"},SEND_BACKWARD:{key:b+" + left",label:c+" + ←"},SEND_TO_BACK:{key:b+" + shift + left",label:c+" + Shift + ←"},TOGGLE_PREVIEW:{key:b+" + p",label:c+" + P"},PUBLISH_SITE:{key:b+" + shift + p",label:c+" + Shift + P"},HIDE_TOOLS:{key:"shift + f",label:"Shift + F"}},preview:{EXIT_PREVIEW:{key:"esc",label:""},TOGGLE_PREVIEW:{key:b+" + p",label:c+" + P"},PUBLISH_SITE:{key:b+" + shift + p",label:c+" + Shift + P"}},topBar:{CLOSE_DROP_PANEL:{key:"esc",label:""}},imageCrop:{APPLY:{key:"enter",label:"Enter"},CANCEL:{key:"esc",label:"Esc"}}}}),define("rEditor/rootComps/topBar/menuBar/menuBarItemsDefinitions",["lodash","core","util","panels","savePublish","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","experiment"],function(a,b,c,d,e,f,g){"use strict";function l(a,b,c){var e=h&&h.generalInfo&&h.generalInfo.isFirstSave();e?d.panelManager.openPanel(j,{title:b,messageBody:c},!0):a()}function m(b,c,d,e){var f=e?a.cloneDeep(c):c;f.fields.status=b?1:0,e&&f.fields.category&&(f.fields.category+=e),h.bi.event(f.type,f.fields),d.call(h)}function n(a,c){var e=c||null,f={panel_name:e,origin:b.constants.BI.HELP.ORIGIN.TOPBAR,learn_more:!1};d.panelManager.openHelpCenter(a,null,null,f)}function o(){var j=h.account.getEditorVersionsInfo()||{},o={SITE_BAR:{label:c.translate("TOPBAR_Site_Label"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"site"}},getCounter:function(){return p()?void 0:h.feedback.getNewCommentsCounter()}},EDIT_BAR:{label:c.translate("TOPBAR_Edit_Label"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"edit"}}},VIEW_BAR:{label:c.translate("Topbar_Tools_Label"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"view"}}},SETTINGS:{action:function(){l(function(){h.bi.event(b.bi.events.topbar.top_bar_open_settings_click),h.account.openSettings()},"TOPBAR_SITE_SETTINGS_SAVE_FIRST_MSG_TITLE","TOPBAR_SITE_SETTINGS_SAVE_FIRST_MSG_BODY")},label:c.translate("TOPBAR_Settings_Label"),bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"settings"}}},HELP_BAR:{label:c.translate("TOPBAR_HELP_TOOLTIP_TITLE"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"help"}}},HELP_CENTER:{label:c.translate("TOPBAR_HELP_EDITOR_HELP"),action:function(){var a=h.isDesktopEditor(),b=a?"58406e7a-1ad0-4105-8e37-c053b529f9d8":"f8b24a99-cefd-4c55-adda-aa66ec643259";n(b,k.EDITOR)},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_center"}}},HELP_KB_SHORTCUTS:{separator:!0,label:c.translate("TOPBAR_HELP_KB_SHORTCUTS"),action:function(){n("5a3238e6-ebe9-4aca-a7a2-1c717598e334",k.KEYBOARD_SHORTCUTS)},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_kb_shortcuts"}}},HELP_CONNECT_DOMAIN:{label:c.translate("TOPBAR_HELP_CONNECT_DOMAIN"),action:function(){n("a06941d9-7683-4ced-bce3-bd2cc3c7d6e9",k.CONNECT_DOMAIN)},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_connect_domain"}}},HELP_SEO:{separator:!0,label:c.translate("TOPBAR_HELP_SEO"),action:function(){n("ab2c2a83-5bc0-435e-ab82-f2c1036580a7",k.SEO)},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_seo"}}},HELP_FEEDBACK:{label:c.translate("Topbar_HELP_FEEDBACK"),action:function(){var a=h.getLanguageCode(),b=i.HELP_URLS.FEEDBACK;b=b.replace("{$lang}","en"===a?"www":a),window.open(b)},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_feedback"}}},SAVE:{label:c.translate("TOPBAR_Site_Save"),action:function(){e.save(h,{origin:"top_bar_site_menu"})},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"save"}}},VIEW_SITE:{label:c.translate("TOPBAR_SITE_VIEWSITE"),action:function(){if(!o.VIEW_SITE.disabledChecker()){var a=h.site.getSitePublicUrl();return window.open(a),!0}return!1},disabledChecker:function(){return!h||!h.generalInfo||!h.generalInfo.isSitePublished()},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"view_site"}}},PREVIEW:{label:c.translate("TOPBAR_PREVIEW_TOOLTIP_TITLE"),action:h.togglePreview,bi:[{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"preview"}},{type:b.bi.events.preview.PREVIEW_CLICK,fields:{origin:"menubar"}}]},FEEDBACK:{label:c.translate("TOPBAR_GetFeedback_Label"),action:function(){l(d.panelManager.openPanel.bind(null,"panels.focusPanels.feedbackPanel"),"TOPBAR_SITE_FEEDBACK_SAVE_FIRST_MSG_TITLE","TOPBAR_SITE_FEEDBACK_SAVE_FIRST_MSG_BODY")},getCounter:h.feedback.getNewCommentsCounter,bi:[{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"feedback"}},{type:b.bi.events.preview.PREVIEW_CLICK,fields:{origin:"menubar"}}],visibilityFunc:function(){return!q()&&h.account.isUserOwner()}},PUBLISH:{label:c.translate("TOPBAR_Site_Publish"),action:function(){e.saveAndPublish(h,"top_bar_site_menu_publish")},bi:[{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"publish"}},{type:b.bi.events.publish.PUBLISH_CLICK,fields:{origin:"menubar"}}]},EDITOR_MODE_SWITCH:{separator:!0,labelFunc:function(){return h&&h.isMobileEditor()?c.translate("Topbar_Site_Desktop_Editor"):c.translate("Topbar_Site_Mobile_Editor")},action:function(){h.setEditorMode(!h.isMobileEditor())},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"editor_mode_switch"}}},REVISIONS:{label:c.translate("TOPBAR_Site_Site_Revisions"),action:function(){l(h.account.openRevisions,"TOPBAR_SITE_HISTORY_SAVE_FIRST_MSG_TITLE","TOPBAR_SITE_HISTORY_SAVE_FIRST_MSG_BODY")},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"revisions"}}},SITE_DASHBOARD:{label:c.translate("TOPBAR_SITE_DASHBOARD"),action:function(){l(h.account.manage,"TOPBAR_SITE_SETTINGS_SAVE_FIRST_MSG_TITLE","TOPBAR_SITE_DASHBOARD_SAVE_FIRST_MSG_BODY")},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"site_dashboard"}}},EXIT:{label:c.translate("TOPBAR_Site_Logout"),action:h.exitEditor,bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"logout"}}},UNDO:{label:c.translate("TOPBAR_Edit_Undo"),shortcutLabel:f.editor.UNDO.label,action:h.history.undo,bi:{type:b.bi.events.topbar.top_bar_EDIT_menu_click,fields:{category:"undo"}}},REDO:{label:c.translate("TOPBAR_Edit_Redo"),shortcutLabel:f.editor.REDO.label,action:h.history.redo,bi:{type:b.bi.events.topbar.top_bar_EDIT_menu_click,fields:{category:"redo"}}},CUT:{label:c.translate("TOPBAR_Edit_Cut"),shortcutLabel:f.editor.CUT.label,compActionRestrictionNames:["duplicatable","removable"],action:function(){h.selectedComponent.sendSelectedComponentBI(b.bi.events.topbar.top_bar_EDIT_menu_click,{category:"cut"}),h.selectedComponent.cut(),h.history.add("component - cut")}},COPY:{label:c.translate("TOPBAR_Edit_Copy"),shortcutLabel:f.editor.COPY.label,compActionRestrictionNames:["duplicatable"],action:function(){h.selectedComponent.sendSelectedComponentBI(b.bi.events.topbar.top_bar_EDIT_menu_click,{category:"copy"}),h.selectedComponent.copy()}},PASTE:{label:c.translate("TOPBAR_Edit_Paste"),shortcutLabel:f.editor.PASTE.label,compActionRestrictionNames:["duplicatable"],action:function(){h.components.paste(),h.history.add("component - paste")},bi:{type:b.bi.events.topbar.top_bar_EDIT_menu_click,fields:{category:"paste"}}},DUPLICATE:{label:c.translate("TOPBAR_Edit_Duplicate"),shortcutLabel:f.editor.DUPLICATE.label,compActionRestrictionNames:["duplicatable"],action:function(){h.selectedComponent.sendSelectedComponentBI(b.bi.events.topbar.top_bar_EDIT_menu_click,{category:"duplicate"}),h.selectedComponent.duplicate(),h.history.add("component - duplicate")}},DELETE:{labelFunc:function(){return h.isDesktopEditor()?c.translate("TOPBAR_Edit_Delete"):c.translate("TOPBAR_Edit_HIDE")},shortcutLabel:f.editor.DELETE.label,compActionRestrictionNames:["removable"],action:function(){h.selectedComponent.sendSelectedComponentBI(b.bi.events.topbar.top_bar_EDIT_menu_click,{category:"delete"}),h.selectedComponent.remove(),h.history.add("component - remove")}},TOOLBAR:{label:c.translate("TOPBAR_VIEW_TOOLBAR_TITLE"),isCheckbox:!0,menuPropsKey:"toolbarEnabled",action:function(a,b){m(!h.toolbar.isToolbarEnabled(),o.TOOLBAR.biData,h.toolbar.toggleToolbar,b?"(Image)":null)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"toolbar",status:null}}},RULERS:{label:c.translate("TOPBAR_VIEW_RULERS"),isCheckbox:!0,menuPropsKey:"rulersEnabled",visibilityFunc:function(){return g.isOpen("rulers")},action:function(b,c){var d=a.cloneDeep(o.RULERS.biData);d.fields.editor_view_mode=h.isMobileEditor()?"mobile":"desktop",m(!h.rulers.isRulersEnabled(),d,h.rulers.toggleRulers,c?"(Image)":null)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"rulers",status:null,editor_view_mode:null}}},GUIDELINES:{label:c.translate("TOPBAR_VIEW_GRIDLINES_TITLE"),isCheckbox:!0,isDisabled:function(){return!h.isDesktopEditor();
},menuPropsKey:"guidelinesEnabled",action:function(a,b){m(!h.grid.guidelines.isGuidelinesEnabled(),o.GUIDELINES.biData,h.grid.guidelines.toggleGuidelines,b?"(Image)":null)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"guidelines",status:null}}},SNAP:{label:c.translate("TOPBAR_VIEW_SNAP_TITLE"),isCheckbox:!0,menuPropsKey:"snapToEnabled",action:function(a,b){m(!h.grid.snapTo.isSnapToEnabled(),o.SNAP.biData,h.grid.snapTo.toggleSnapTo,b?"(Image)":null)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"snap",status:null}}},SECTIONS:{label:c.translate("TOPBAR_VIEW_SECTIONS"),isCheckbox:!0,menuPropsKey:"sectionsHandlesEnabled",visibilityFunc:function(){return h.isDesktopEditor()},action:function(a,b){m(!h.sectionsHandles.areSectionsHandlesEnabled(),o.SECTIONS.biData,h.sectionsHandles.toggleSectionsHandles,b?"(Image)":null)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"sectionshandles",status:null}}}};return g.isOpen("exp171")&&!g.isOpen("imageOptimizationOff")&&(o.IMAGE_OPTIMIZATION={label:c.translate("TOPBAR_SITE_IMAGE_QUALITY"),action:function(){d.panelManager.openPanel("panels.focusPanels.siteImageOptimizationPanel",{panelName:"panels.focusPanels.siteImageOptimizationPanel"})},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"image_optimization"}}}),g.isOpen("developerModeToggle")&&(o.SECTIONS.separator=!0,o.DEVELOPER_MODE={label:c.translate("TOPBAR_VIEW_DEVELOPER_MODE_TITLE"),isCheckbox:!0,menuPropsKey:"developerModeEnabled",action:function(){h.developerMode.toggle()},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"dev_mode",status:null}}},o.PROPERTIES_TOOLBAR={label:c.translate("TOPBAR_VIEW_DEVELOPER_MODE_PROPERTIES_PANEL_TITLE"),isCheckbox:!0,visibilityFunc:function(){return h.developerMode.isEnabled()},menuPropsKey:"developerToolBarEnabled",action:function(){h.developerToolBar.toggle()},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"properties_panel",status:null}}},o.HIDDEN_ELEMENTS={label:c.translate("TOPBAR_VIEW_DEVELOPER_MODE_HIDDEN_ELEMENTS_TITLE"),isCheckbox:!0,visibilityFunc:function(){return h.developerMode.isEnabled()},menuPropsKey:"showHiddenComponents",action:function(a){h.documentMode.showHiddenComponents(a),h.updateEditorViewTools("showHiddenComponents",a)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"show_hidden_components",status:null}}}),h.account.isUserOwner()&&(o.UPGRADE={label:c.translate(g.isOpen("spanishUpgradeText")?"UPGRADE_FOR_SPAIN_ONLY":"TOPBAR_Upgrade_Label"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"upgrade"}}},h.wixStores.isSiteInWixStoreTestDrive()||(o.UPGRADE_ITEM={label:c.translate(g.isOpen("spanishUpgradeText")?"UPGRADE_FOR_SPAIN_ONLY":"TOPBAR_Upgrade_Label"),separator:!0,className:"menu-bar-item-upgrade",action:function(){l(h.account.upgrade.bind(h,"edhtml_TOP_BAR_SITE_MENU_UPGRADE"),"TOPBAR_SITE_UPGRADE_SAVE_FIRST_MSG_TITLE","TOPBAR_SITE_UPGRADE_SAVE_FIRST_MSG_BODY")},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"upgrade"}}},o.CONNECT_DOMAIN={label:c.translate("TOPBAR_SITE_CONNECT_DOMAIN"),action:function(){h.generalInfo.isFirstSave()?e.save(h):h.account.openConnectDomain(b.constants.CONNECT_DOMAIN.FLOWS.TOP_BAR)},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"connect_domain"}}})),p()&&(o.BACK_TO_OLD_EDITOR={label:c.translate("Topbar_oldeditor_link"),action:function(){j.isEligibleForSwitch?d.panelManager.openPanel("panels.messagePanels.switchToOldEditorConfirmationPanel",{title:"Notification_Box_ToOldEditor_Title"}):n("85aae89a-84f6-4967-b866-e5c39c91d635",k.BACK_TO_OLD_EDITOR)},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"back_to_old_editor"}},visibilityFunc:p}),o}function p(){var a=h.account.getEditorVersionsInfo()||{};return!a.isNewUser&&"none"===a.userOverride&&a.isEligibleForSwitch&&!h.isSavedInCurrentSession}function q(){var a=h.account.getEditorVersionsInfo()||{};return a.isEligibleForSwitch&&!h.isSavedInCurrentSession&&!h.generalInfo.isTemplate()}var h=null,i=b.constants,j="savePublish.panels.save.saveYourSitePanel",k={EDITOR:"editor",KEYBOARD_SHORTCUTS:"kb_shortcuts",SEO:"seo",CONNECT_DOMAIN:"connect_domain",BACK_TO_OLD_EDITOR:"back_to_old_editor"},r={init:a.once(function(b){h=b;var c=o();a.merge(r,c)})};return r}),define("rEditor/rootComps/keyboard/config/topBarShortcuts",["lodash","util","rEditor/rootComps/topBar/menuBar/menuBarItemsDefinitions"],function(a,b,c){"use strict";function e(){a.forEach(c,function(a){a&&a.shortcut&&(d[a.shortcut]=a.action)})}var d={};return{init:a.once(function(a){c.init(a),e()}),shortcuts:d}}),define("rEditor/rootComps/keyboard/actions/customActions/column",[],function(){"use strict";return{x:function(a,b,c){0>c?a.columns.move.left(b):c>0&&a.columns.move.right(b)}}}),define("rEditor/rootComps/keyboard/actions/customActions",["rEditor/rootComps/keyboard/actions/customActions/column"],function(a){"use strict";return{"wysiwyg.viewer.components.Column":a}}),define("rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions",["lodash","core","uiAnimations","experiment","rEditor/rootComps/keyboard/actions/customActions"],function(a,b,c,d,e){"use strict";function g(a,b,c){return"x"===c&&a.components.is.horizontallyMovable(b)||"y"===c&&a.components.is.verticallyMovable(b)}function h(a,b){var c=a.components.getType(a.selection.getSelectedComponents()),d=e[c];return d&&d[b]}function i(b){var c=b.pages.getCurrentPageId(),d=b.components.getAllComponents(c),e=a.filter(d,function(b){return!a.includes(f,b.id)});return e}function j(b,c,e){var f=a.findIndex(c,{id:e}),g=f+1===c.length,h=g?0:f+1;return d.isOpen("boxSlideShow")&&!b.components.is.selectable(c[h])?j(b,c,c[h].id):c[h]}function k(b,c,e){var f=a.findIndex(c,{id:e}),g=0===f?c.length-1:f-1;return d.isOpen("boxSlideShow")&&!b.components.is.selectable(c[g])?k(b,c,c[g].id):c[g]}function l(a,b){var c=a.height/2;return Math.max(b-c,0)}function m(a,d){var e=b.utils.stageUtils.getStageLayout(),f=a.components.layout.getRelativeToScreen(d);c.scrollTo({y:l(e,f.y)})}function n(a,b){a.selection.selectComponentByCompRef(b),m(a,b)}var f=["PAGES_CONTAINER","SITE_PAGES"],o=a.debounce(function(a){a.bi.event(b.bi.events.editBox.MOVE_COMPONENT,{origin:"keyboard"})},300);return{selectNextComponent:function(a){var b=a.selection.getSelectedComponentId();if(b){var c=j(a,i(a),b);n(a,c)}},selectPreviousComponent:function(a){var b=a.selection.getSelectedComponentId();if(b){var c=k(a,i(a),b);n(a,c)}},moveComponent:function(b,c,d){var e=b.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(b.selection.getSelectedComponents()),f=h(b,c);return f?f(b,a.first(e),d):e&&g(b,e,c)&&b.waitForChangesApplied(function(){var f=b.components.layout.getRelativeToStructure(e),g=a.clone(f);g[c]+=d,10===d?g[c]=10*Math.floor(g[c]/10):-10===d&&(g[c]=10*Math.ceil(g[c]/10)),b.components.layout.updateRelativeToStructure(e,g),o(b)}),e}}}),define("rEditor/rootComps/keyboard/util/editorDebugShortcutsUtil",["core","lodash","savePublish"],function(a,b,c){"use strict";function e(a){var e={},f=b(window.editorModel.runningExperiments).pick(function(a){return"new"===a}).keys().value();e["ctrl + alt + shift + v"]=a.openEditorVersionInfoPanel.bind(a),e["ctrl + alt + shift + e"]=function(){window.alert("Active Experiments:\n"+f.join("\n"))};var g=window.location.search&&window.location.search.toLowerCase(),h=b.includes(g,"debug=")||b.includes(g,"isqa=true");return h&&(e[d+" + shift + alt + s"]=c.configureSave,e[d+" + shift + alt + p"]=c.configurePublish.bind(c,a)),e}var d=a.constants.KEYBOARD_SPECIAL_KEY.value;return e}),define("rEditor/rootComps/keyboard/util/sendBIAndActionUtil",["core","lodash"],function(a,b){"use strict";function c(a,c){b.assign(c,a)}function d(a,d,e){if(a&&d){var f=a.selection.getSelectedComponents(),g=a.bi.getComponentsBIParams(f);b.forEach(g,c.bind(null,e)),b.isEmpty(g)&&e&&g.push(e),a.bi.reportBI(d,g)}}return d}),define("rEditor/rootComps/keyboard/config/editorShortcuts",["lodash","core","util","panels","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions","rEditor/rootComps/keyboard/util/editorDebugShortcutsUtil","rEditor/rootComps/keyboard/util/sendBIAndActionUtil"],function(a,b,c,d,e,f,g,h){"use strict";function k(b){var c={};c[j.GROUP_COMPONENTS.key]=m.bind(null,b),c[j.UNGROUP_COMPONENTS.key]=n.bind(null,b),c[j.COPY.key]=l.bind(null,b),c[j.CUT.key]=p.bind(null,b),c[j.DUPLICATE.key]=o.bind(null,b),c[j.MOVE_RIGHT.key]=q.bind(null,b,"x",1),c[j.MOVE_LEFT.key]=q.bind(null,b,"x",-1),c[j.MOVE_UP.key]=q.bind(null,b,"y",-1),c[j.MOVE_DOWN.key]=q.bind(null,b,"y",1),c[j.SHIFT_RIGHT.key]=q.bind(null,b,"x",10),c[j.SHIFT_LEFT.key]=q.bind(null,b,"x",-10),c[j.SHIFT_UP.key]=q.bind(null,b,"y",-10),c[j.SHIFT_DOWN.key]=q.bind(null,b,"y",10);var d=g(b);a.merge(c,d),a.merge(i,c)}function l(a){var c=b.bi.events.rightClickMenu,d=a.selection.getSelectedComponents(),e=a.components.layout.isPinned(d)?1:0;if(a.selectedComponent.copy(),d){var f=a.components.getType(d);h(a,c.COPY,{origin:"keyboard",is_component_pinned:e,component_type:f})}}function m(a,b){var c=a.selection.getSelectedComponents();a.components.is.groupable(c)&&a.multiselect.isMultiselect(c)&&a.groupComponents(c),b.preventDefault()}function n(a,b){var c=a.selection.getSelectedComponents();a.components.is.group(c)&&a.components.ungroup(c),b.preventDefault()}function o(a){var c=b.bi.events.rightClickMenu,d=a.selection.getSelectedComponents(),e=a.components.layout.isPinned(d)?1:0;a.selectedComponent.duplicate(),a.history.add("component - duplicate"),h(a,c.DUPLICATE,{origin:"keyboard",is_component_pinned:e})}function p(a){var c=b.bi.events.rightClickMenu,d=a.selection.getSelectedComponents(),e=a.components.layout.isPinned(d)?1:0;a.selectedComponent.cut(),a.history.add("component - cut"),h(a,c.CUT,{origin:"keyboard",is_component_pinned:e})}function q(a,b,c,d){d&&d.preventDefault(),f.moveComponent(a,b,c)}var i={},j=e.editor;return{init:function(a){k(a)},shortcuts:i}}),define("rEditor/rootComps/keyboard/config/previewShortcuts",["util","lodash","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap"],function(a,b,c){"use strict";function e(a){a.preventDefault()}function f(a,b){b.preventDefault(),a.togglePreview()}var d={};return{init:b.once(function(a){d[c.preview.EXIT_PREVIEW.key]=a.togglePreview,d[c.preview.TOGGLE_PREVIEW.key]=f.bind(this,a),d[c.preview.PUBLISH_SITE.key]=e}),shortcuts:d}}),define("rEditor/rootComps/keyboard/config/pinModeShortcuts",["lodash","core","util","panels","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions","rEditor/rootComps/keyboard/util/editorDebugShortcutsUtil"],function(a,b,c,d,e,f,g){"use strict";function j(c){var d=b.bi.events.rightClickMenu,e={};e[i.GROUP_COMPONENTS.key]=l,e[i.UNGROUP_COMPONENTS.key]=l,e[i.COPY.key]=k.bind(null,c,d.COPY,{is_component_pinned:1}),e[i.CUT.key]=k.bind(null,c,d.CUT,{is_component_pinned:1}),e[i.DUPLICATE.key]=k.bind(null,c,d.DUPLICATE,{is_component_pinned:1}),e[i.MOVE_RIGHT.key]=l,e[i.MOVE_LEFT.key]=l,e[i.MOVE_UP.key]=l,e[i.MOVE_DOWN.key]=l,e[i.SHIFT_RIGHT.key]=l,e[i.SHIFT_LEFT.key]=l,e[i.SHIFT_UP.key]=l,e[i.SHIFT_DOWN.key]=l;var f=g(c);a.merge(e,f),a.merge(h,e)}function k(b,c,d){if(b&&c){var e=b.selection.getSelectedComponents(),f=b.bi.getComponentsBIParams(e);a.forEach(f,m.bind(null,d)),a.isEmpty(f)&&d&&f.push(d),b.bi.reportBI(c,f)}}function l(a){a.preventDefault()}function m(b,c){a.assign(c,b)}var h={},i=e.editor;return{init:function(a){j(a)},shortcuts:h}}),define("rEditor/rootComps/keyboard/util/commonKeyboardActions",["core","savePublish","rEditor/rootComps/keyboard/util/sendBIAndActionUtil"],function(a,b,c){"use strict";function d(b){var d=a.bi.events.editor.undo_redo_component_change;b.history.undo(),c(b,d,{type:"undo",origin:"keyboard"})}function e(b){var d=a.bi.events.editor.undo_redo_component_change;b.history.redo(),c(b,d,{type:"redo",origin:"keyboard"})}function f(a){b.save(a,{origin:"keyboard"})}function g(a){b.saveAsTemplate(a,function(){console.log("Saved successfully as Template.")})}function h(c,d){d.preventDefault(),c.bi.event(a.bi.events.publish.PUBLISH_CLICK,{origin:"keyboard"}),b.saveAndPublish(c,"keyboard_publish")}return{undoFromKeyboard:d,redoFromKeyboard:e,saveSiteFromKeyboard:f,saveSiteAsTemplateFromKeyboard:g,publishSiteFromKeyboard:h}}),define("rEditor/rootComps/keyboard/config/zoomModeShortcuts",["lodash","rEditor/rootComps/keyboard/util/commonKeyboardActions","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap"],function(a,b,c){"use strict";function f(c){var f={};f[e.UNDO.key]=b.undoFromKeyboard.bind(null,c),f[e.REDO.key]=b.redoFromKeyboard.bind(null,c),f[e.SAVE.key]=b.saveSiteFromKeyboard.bind(null,c),f[e.SAVE_AS_TEMPLATE.key]=b.saveSiteAsTemplateFromKeyboard.bind(null,c),f[e.PUBLISH_SITE.key]=b.publishSiteFromKeyboard.bind(null,c),a.assign(d,f)}var d={},e=c.editor;return{init:function(a){f(a)},shortcuts:d}}),define("rEditor/rootComps/keyboard/config/imageCropShortcuts",["lodash","core","util","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions"],function(a,b,c,d){"use strict";function g(b){var c={};c[f.APPLY.key]=h.bind(null,b),c[f.CANCEL.key]=i.bind(null,b),a.merge(e,c)}function h(c){var d=c.selection.getSelectedComponents(),e=c.selection.getSelectedComponentData().crop;c.imageCrop.updateCrop(),c.imageCrop.toggleCropMode(!1),c.waitForChangesApplied(function(){var f=c.components.data.get(d).crop,g=!a.isEqual(e,f);c.bi.event(b.bi.events.imageCrop.apply_crop,{is_changed:g,origin:"enter"})})}function i(a){a.imageCrop.toggleCropMode(!1)}var e={},f=d.imageCrop;return{init:function(a){g(a)},shortcuts:e}}),define("rEditor/rootComps/keyboard/config/baseEditorShortcuts",["lodash","core","util","panels","experiment!hideAllTools","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions","rEditor/rootComps/keyboard/util/editorDebugShortcutsUtil","rEditor/rootComps/keyboard/util/commonKeyboardActions","rEditor/rootComps/keyboard/util/sendBIAndActionUtil"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function m(b){var c={};c[l.SELECT_ALL.key]=b.selection.selectAll,c[l.PASTE.key]=o.bind(null,b),c[l.UNDO.key]=i.undoFromKeyboard.bind(null,b),c[l.REDO.key]=i.redoFromKeyboard.bind(null,b),c[l.DELETE.key]=q.bind(null,b),c[l.SAVE.key]=i.saveSiteFromKeyboard.bind(null,b),c[l.SAVE_AS_TEMPLATE.key]=i.saveSiteAsTemplateFromKeyboard.bind(null,b),c[l.SELECT_NEXT_COMP.key]=r.bind(null,b),c[l.SELECT_PREV_COMP.key]=s.bind(null,b),c[l.CLOSE_PANELS.key]=t.bind(null,b),c[l.SEND_TO_FRONT.key]=n.toFront.bind(null,b),c[l.SEND_TO_BACK.key]=n.toBack.bind(null,b),c[l.SEND_FORWARD.key]=n.forward.bind(null,b),c[l.SEND_BACKWARD.key]=n.backward.bind(null,b),c[l.TOGGLE_PREVIEW.key]=p.bind(null,b),c[l.PUBLISH_SITE.key]=i.publishSiteFromKeyboard.bind(null,b),e&&(c[l.HIDE_TOOLS.key]=u.bind(null,b));var d=h(b);a.merge(c,d),a.merge(k,c)}function o(c){var e=b.bi.events.rightClickMenu,f=c.clipboard.getItem(b.constants.EDITOR_CLIPBOARD_TYPES.COMPONENT);if(f){var g=a.pluck(f.components,"serializedComp.layout"),h=c.components.layout.isPinnedBySerializedLayout(g)?1:0;d.panelManager.closeAllPanels(),c.components.paste(),c.history.add("component - paste"),j(c,e.PASTE,{origin:"keyboard",is_component_pinned:h})}}function p(a,c){c.preventDefault(),a.bi.event(b.bi.events.preview.PREVIEW_CLICK,{origin:"keyboard"}),a.togglePreview()}function q(a){var c=a.selection.getSelectedComponents(),d=a.components.layout.isPinned(c)?1:0;a.closeRightClickMenu(),a.closeCompPanelIfExists(),a.selectedComponent.remove(),a.history.add("component - remove"),j(a,b.bi.events.editor.component_removed,{removal_method:"keyboard",is_component_pinned:d})}function r(a){a.panelManager.closeAllPanels(),g.selectNextComponent(a)}function s(a){a.panelManager.closeAllPanels(),g.selectPreviousComponent(a)}function t(a){var c=d.panelManager,f=c.getOpenPanels();f.length>0?c.closeAllPanelsOfType(["leftPanelFrame","compPanelFrame","focusPanelFrame","messagePanelFrame","pagesPanelFrame","toolPanelFrame","tpaSettingsPanelFrame"]):c.getHelpPanelProps()?c.closeHelpCenter():a.selection.isComponentSelected()?a.selection.deselectComponents():e&&(a.toolsControl.toggleHideTools(!1),a.bi.event(b.bi.events.editor.hide_tools.show_controls,{origin:"shortcut"}))}function u(a){var c=a.toolsControl.toggleHideTools(),d=c?"hide_controls":"show_controls";a.bi.event(b.bi.events.editor.hide_tools[d],{origin:"shortcut"})}var k={},l=f.editor,n={toFront:function(a){var c=a.selection.getSelectedComponents();a.components.arrangement.moveToFront(c),j(a,b.bi.events.rightClickMenu.BRING_TO_FRONT,{origin:"keyboard"})},toBack:function(a){var c=a.selection.getSelectedComponents();a.components.arrangement.moveToBack(c),j(a,b.bi.events.rightClickMenu.SEND_TO_BACK,{origin:"keyboard"})},forward:function(a){var c=a.selection.getSelectedComponents();a.components.arrangement.moveForward(c),j(a,b.bi.events.rightClickMenu.MOVE_FORWARD,{origin:"keyboard"})},backward:function(a){var c=a.selection.getSelectedComponents();a.components.arrangement.moveBackward(c),j(a,b.bi.events.rightClickMenu.MOVE_BACKWARDS,{origin:"keyboard"})}};return{init:function(a){m(a)},shortcuts:k}}),define("rEditor/rootComps/keyboard/config/shortcutsConfig",["util","lodash","rEditor/rootComps/keyboard/config/topContextShortcuts","rEditor/rootComps/keyboard/config/topBarShortcuts","rEditor/rootComps/keyboard/config/editorShortcuts","rEditor/rootComps/keyboard/config/previewShortcuts","rEditor/rootComps/keyboard/config/pinModeShortcuts","rEditor/rootComps/keyboard/config/zoomModeShortcuts","rEditor/rootComps/keyboard/config/imageCropShortcuts","rEditor/rootComps/keyboard/config/baseEditorShortcuts"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function l(a,b){return function(){return b(),a.apply(null,arguments)}}function m(a,c){return b.mapValues(a,function(a){return l(a,c)})}function n(a,b){k.registerContext(k.CONTEXTS.TOP_CONTEXT,m(c.shortcuts,b),a);var l=k.extendContext(k.CONTEXTS.TOP_CONTEXT,m(j.shortcuts,b));k.registerContext(k.CONTEXTS.BASE_EDITOR,l,a);var n=k.extendContext(k.CONTEXTS.TOP_CONTEXT,m(f.shortcuts,b));k.registerContext(k.CONTEXTS.PREVIEW,n,a);var o=k.extendContext(k.CONTEXTS.BASE_EDITOR,m(e.shortcuts,b));k.registerContext(k.CONTEXTS.EDITOR,o,a);var p=k.extendContext(k.CONTEXTS.BASE_EDITOR,m(g.shortcuts,b));k.registerContext(k.CONTEXTS.PIN_MODE,p,a);var q=k.extendContext(k.CONTEXTS.EDITOR,m(d.shortcuts,b));k.registerContext(k.CONTEXTS.TOP_BAR,q,a);var r=k.extendContext(k.CONTEXTS.TOP_CONTEXT,m(i.shortcuts,b));k.registerContext(k.CONTEXTS.IMAGE_CROP,r,a);var s=k.extendContext(k.CONTEXTS.TOP_CONTEXT,m(h.shortcuts,b));k.registerContext(k.CONTEXTS.ZOOM_MODE,s,a)}var k=a.keyboardShortcuts;return{init:b.once(function(a){c.init(a),f.init(a),j.init(a),g.init(a),i.init(a),h.init(a),e.init(a),d.init(a),n(a,a.closeRightClickMenu)})}}),define("rEditor/rootComps/topBar/config/topBarData.json",[],function(){return{EDIT:[{comp:"WIX_LOGO",orientation:"left"},{comp:"SEPARATOR",orientation:"left"},{comp:"PAGES_LIST",orientation:"left"},{comp:"SEPARATOR",orientation:"left"},{comp:"MENU",orientation:"left"},{comp:"WIXSTORES_MIGRATION_UPGRADE_SITE",orientation:"left"},{comp:"SEPARATOR",orientation:"right"},{comp:"ZOOMOUT",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"UNDO",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"REDO",orientation:"right"},{comp:"REDO_SEPARATOR",orientation:"right"},{comp:"EDITOR_MODE_SWITCH",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"SAVE",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"PREVIEW",orientation:"right"},{comp:"PUBLISH",orientation:"right"}],PREVIEW:[{comp:"WIX_LOGO",orientation:"left"},{comp:"SEPARATOR",orientation:"left"},{comp:"MOBILE_NON_OPTIMIZED_NOTIFICATION",orientation:"center"},{comp:"PREVIEW_NOTIFICATION",orientation:"center"},{comp:"SEPARATOR",orientation:"right"},{comp:"EDITOR_MODE_SWITCH",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"PREVIEW_SAVE",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"BACK_TO_EDITOR",orientation:"right"}]}}),define("rEditor/rootComps/topBar/menuBar/config/topBarMenuData.json",[],function(){return[{key:"SITE_BAR",children:[{key:"SAVE",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SAVE",style:{width:192,minHeight:396},title:"TOPBAR_SITE_SAVE_PROMOTION_TITLE",message:"TOPBAR_SITE_SAVE_PROMOTION_TEXT",symbol:"menubarSaveSitePromotion"}}},{key:"PREVIEW",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"PREVIEW",style:{width:192,minHeight:396},title:"TOPBAR_SITE_PREVIEW_PROMOTION_TITLE",message:"TOPBAR_SITE_PREVIEW_PROMOTION_TEXT",symbol:"menubarPreviewSitePromotion"}}},{key:"FEEDBACK",experimentOff:"feedmeIntegrationOff",experiment:"exp171",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"FEEDBACK",style:{width:192,minHeight:396},title:"TOPBAR_GetFeedback_Promotion_Title",message:"TOPBAR_GetFeedback_Promotion_Text",symbol:"menubarfeedbackPromotion"}}},{key:"PUBLISH",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"PUBLISH",style:{width:192,minHeight:396},title:"TOPBAR_SITE_PUBLISH_PROMOTION_TITLE",message:"TOPBAR_SITE_PUBLISH_PROMOTION_TEXT",symbol:"menubarPublishSitePromotion"}}},{key:"VIEW_SITE",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"VIEW-SITE",style:{width:192,minHeight:396},title:"TOPBAR_SITE_VIEW_SITE_PROMOTION_TITLE",message:"TOPBAR_SITE_VIEW_SITE_PROMOTION_TEXT",symbol:"menubarViewPublishedPromotion"}}},{key:"CONNECT_DOMAIN",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"CONNECT-DOMAIN",style:{width:192,minHeight:396},title:"TOPBAR_SITE_CONNECT_PROMOTION_TITLE",message:"TOPBAR_SITE_CONNECT_PROMOTION_TEXT",symbol:"menubarConnectDomainPromotion"}}},{key:"UPGRADE_ITEM",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"UPGRADE",style:{backgroundColor:"#ebdbf6",width:192,minHeight:396},title:"TOPBAR_SITE_UPGRADE_PROMOTION_TITLE",message:"TOPBAR_SITE_UPGRADE_PROMOTION_TEXT",symbol:"menubarUpgradePromotionLight"}}},{key:"EDITOR_MODE_SWITCH",rightPanel:{DESKTOP:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"MOBILE-SWITCH",style:{width:192,minHeight:396},title:"TOPBAR_SITE_MOBILE_PROMOTION_TITLE",message:"TOPBAR_SITE_MOBILE_PROMOTION_TEXT",symbol:"menubarSwitchToMobilePromotion"}},MOBILE:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"DESKTOP-SWITCH",style:{width:192,minHeight:396},title:"TOPBAR_SITE_DESKTOP_PROMOTION_TITLE",message:"TOPBAR_SITE_DESKTOP_PROMOTION_TEXT",symbol:"menubarSwitchToDesktopPromotion"}}}},{key:"IMAGE_OPTIMIZATION",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"IMAGE-OPTIMIZATION",style:{width:192,minHeight:396},title:"TOPBAR_SITE_IMAGE_QUALITY_PROMOTION_TITLE",message:"TOPBAR_SITE_IMAGE_QUALITY_PROMOTION_TEXT",symbol:"imageOptimizationPromotion"}}},{key:"SITE_DASHBOARD",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SITE-DASHBOARD",style:{width:192,minHeight:396},title:"TOPBAR_SITE_DASHBOARD",message:"TOPBAR_SITE_DASHBOARD_PROMOTION_TEXT",symbol:"menubarMySitesPromotion"}}},{key:"SETTINGS",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SETTINGS",style:{width:192,minHeight:396},title:"TOPBAR_SITE_SETTINGS_PROMOTION_TITLE",message:"TOPBAR_SITE_SETTINGS_PROMOTION_TEXT",symbol:"menubarSiteSettingsPromotion"}}},{key:"REVISIONS",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"REVISIONS",style:{width:192,minHeight:396},title:"TOPBAR_SITE_HISTORY_PROMOTION_TITLE",message:"TOPBAR_SITE_HISTORY_PROMOTION_TEXT",symbol:"menubarSiteHistoryPromotion"}}},{key:"BACK_TO_OLD_EDITOR",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"BACK-TO-OLD-EDITOR",style:{width:192,minHeight:396},title:"Topbar_oldeditor_promotion_title",message:"topbar_oldeditor_promotion_text2",symbol:"menubarBackToOldEditorPromotionNew"}}},{key:"EXIT",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"EXIT-EDITOR",style:{width:192,minHeight:396},title:"TOPBAR_SITE_EXIT_PROMOTION_TITLE",message:"TOPBAR_SITE_EXIT_PROMOTION_TEXT",symbol:"menubarExitEditorPromotion"}}}],rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SAVE",style:{width:192,minHeight:396},title:"TOPBAR_SITE_SAVE_PROMOTION_TITLE",message:"TOPBAR_SITE_SAVE_PROMOTION_TEXT",symbol:"menubarSaveSitePromotion"}}},{key:"VIEW_BAR",children:[{key:"TOOLBAR",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"TOOLBAR",style:{width:192,minHeight:315},title:"TOPBAR_VIEW_TOOLBAR_TITLE",message:"TOPBAR_VIEW_TOOLBAR_BODY",symbol:"menubarToolbarPromotion"}}},{key:"RULERS",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"RULERS",style:{width:192,minHeight:315},title:"TOPBAR_VIEW_RULERS_TITLE",message:"TOPBAR_VIEW_RULERS_BODY",symbol:"menubarRulersPromotion"}}},{key:"GUIDELINES",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"GUIDELINES",style:{width:192,minHeight:315},title:"TOPBAR_VIEW_GRIDLINES_TITLE",message:"TOPBAR_VIEW_GRIDLINES_BODY",symbol:"menubarGuidesPromotion"}}},{key:"SNAP",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SNAP",style:{width:192,minHeight:315},title:"TOPBAR_VIEW_SNAP_TITLE",message:"TOPBAR_VIEW_SNAP_BODY",symbol:"menubarSnapToObjectPromotion"}}},{key:"SECTIONS",experimentOff:"exp171",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SECTIONS",style:{width:192,minHeight:315},title:"TOPBAR_SECTIONS_TITLE",message:"TOPBAR_SECTIONS_BODY",symbol:"menubarSectionHandlesPromotion"}}},{key:"DEVELOPER_MODE",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"DEVELOPER_MODE",style:{width:192,minHeight:315},title:"TOPBAR_VIEW_DEVELOPER_MODE_TITLE",message:"TOPBAR_VIEW_DEVELOPER_MODE_BODY",symbol:"menubarToolbarPromotion"}}},{key:"PROPERTIES_TOOLBAR",experimentOff:"zoomModeSectionsRedesign",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"PROPERTIES_TOOLBAR",style:{width:192,minHeight:315},title:"TOPBAR_VIEW_DEVELOPER_MODE_PROPERTIES_PANEL_TITLE",message:"TOPBAR_VIEW_DEVELOPER_MODE_PROPERTIES_PANEL_BODY",symbol:"menubarToolbarPromotion"}}},{key:"HIDDEN_ELEMENTS",experimentOff:"zoomModeSectionsRedesign",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"HIDDEN_ELEMENTS",style:{width:192,minHeight:315},title:"TOPBAR_VIEW_DEVELOPER_MODE_HIDDEN_ELEMENTS_TITLE",message:"TOPBAR_VIEW_DEVELOPER_MODE_HIDDEN_ELEMENTS_BODY",symbol:"menubarToolbarPromotion"}}}],rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"TOOLBAR",style:{width:192,minHeight:315},title:"TOPBAR_VIEW_TOOLBAR_TITLE",message:"TOPBAR_VIEW_TOOLBAR_BODY",symbol:"menubarToolbarPromotion"}}},{key:"HELP_BAR",children:[{key:"HELP_CENTER",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"HELP-CENTER",style:{width:192,minHeight:297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_CENTER_PROMOTION_TITLE",message:"TOPBAR_HELP_CENTER_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{key:"HELP_KB_SHORTCUTS",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"KB-SHORTCUTS",style:{width:192,minHeight:297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_QUESTION_PROMOTION_TITLE",message:"TOPBAR_HELP_QUESTION_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{key:"HELP_CONNECT_DOMAIN",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"CONNECT-DOMAIN",style:{width:192,minHeight:297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_CONNECT_PROMOTION_TITLE",message:"TOPBAR_HELP_CONNECT_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{key:"HELP_SEO",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SEO",style:{width:192,minHeight:297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_SEO_PROMOTION_TITLE",message:"TOPBAR_HELP_SEO_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{key:"HELP_FEEDBACK",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"FEEDBACK",style:{width:192,minHeight:297},classes:{graphics:"graphics-help-center"},title:"Topbar_HELP_FEEDBACK_PROMOTION_TITLE",message:"Topbar_HELP_FEEDBACK_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}}],rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"HELP-CENTER",style:{width:192,minHeight:297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_CENTER_PROMOTION_TITLE",message:"TOPBAR_HELP_CENTER_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{category:"UPGRADE",upgradePanels:{DEFAULT:{key:"UPGRADE",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"UPGRADE-POPUP","class":"right-check-panel-upgrade",style:{backgroundColor:"transparent",width:131,padding:"25px 0"},symbol:"menubarUpgradePromotionDark"}}}}}]}),define("rEditor/rootComps/topBar/buttons/mixins/topBarButtonProgressMixin",["core"],function(a){"use strict";return{isInProgress:function(){return this.props.progressStatus===a.constants.PROGRESS_STATUS.IN_PROGRESS},isProgressDone:function(){return this.isDoneSuccessfully()||this.isDoneUnSuccessfully()},isDoneSuccessfully:function(){return this.props.progressStatus===a.constants.PROGRESS_STATUS.DONE_SUCCESS},isDoneUnSuccessfully:function(){return this.props.progressStatus===a.constants.PROGRESS_STATUS.DONE_FAILED}}}),define("rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin",["react","baseUI"],function(a,b){"use strict";var c=b.tooltipManager;return{getTooltipElement:function(){var b=this.props.tooltipData;return b&&b.presenter?a.createElement(b.presenter,b.props):b||!1},getTooltipInteractiveMode:function(){var a=this.props.tooltipData;return a&&a.interactive},hideTooltip:function(a){var b=a||this.props.tooltipData&&this.props.tooltipData.id;c.hide(b)}}}),define("rEditor/rootComps/topBar/dropPanels/topBarDropPanel.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{className:"top-bar-drop-panel "+(this.props.dropPanelClass||"")},a.createElement("div",{className:"drop-panel-left-side"},this.getLeftContent()),this.hasRightContent()?a.createElement("div",{className:"drop-panel-right-side",key:"rightContent"},this.getRightContent()):null,this.props.bottomContent?a.createElement("div",{className:"drop-panel-bottom-side",key:"bottomContent"},this.props.bottomContent):null)}}),define("rEditor/rootComps/topBar/dropPanels/topBarDropPanel",["react","jquery","lodash","util","rEditor/rootComps/topBar/dropPanels/topBarDropPanel.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"topBarDropPanel",propTypes:{leftContent:a.PropTypes.object.isRequired,bottomContent:a.PropTypes.object,rightContentOptions:a.PropTypes.object,dropPanelClass:a.PropTypes.string,closeHandle:a.PropTypes.func},getInitialState:function(){return{displayedRightContentKey:"main"}},componentWillReceiveProps:function(a){var b=c.keys(this.props.rightContentOptions),d=c.keys(a.rightContentOptions),e=c.intersection(d,b);e.length!==b.length&&this.setState({displayedRightContentKey:"main"})},getLeftContent:function(){return a.addons.cloneWithProps(this.props.leftContent,{onMenuItemHover:this.onSubMenuItemHover,closeDropDownHandle:this.props.closeHandle})},getRightContent:function(){return this.props.rightContentOptions[this.state.displayedRightContentKey]},hasRightContent:function(){return!!this.props.rightContentOptions},onSubMenuItemHover:function(a){a.rightPanel&&this.setState({displayedRightContentKey:a.key})},render:e
})}),define("rEditor/rootComps/topBar/buttons/topBarButton/topBarButton.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(d){var e=this.isDoneSuccessfully();return a.createElement("div",{className:"wrapper-to-perserve-ref"},a.createElement(c.button2,{key:"buttonContent-"+this.props.iconSymbol,label:this.props.label,style:this.props.buttonStyle,symbolName:this.props.iconSymbol,customLabelClass:"top-bar-button-label",className:b.keys(b.pick({"top-bar-button-content":!0,"icon-and-label":this.props.iconSymbol&&this.props.label,invisible:e},b.identity)).join(" "),onClick:this.onClick,onMouseOver:this.handleMouseOverButton,onMouseLeave:this.handleMouseLeftButton}),e?a.createElement(c.symbol,{key:"successSymbol",name:"topBarButtonVSign",className:"button-symbol vSign"}):null,this.isInProgress()?a.createElement("div",{key:"progressIndicator",className:"progress-indicator"}):null)}function e(){var b=this.getTooltipElement();return a.createElement(c.tooltip,{id:this.props.tooltipData&&this.props.tooltipData.id,value:b,interactive:this.getTooltipInteractiveMode(),disabled:!b||this.state.isDropDownDisplayed},d.apply(this,[b]))}return function(){return a.createElement("div",{className:this.getClasses(),style:this.props.style},e.apply(this,[]),this.state.isDropDownDisplayed?a.createElement(c.bubble,b.assign({},{key:"topBarButtonDropDown"},this.getDropDownProps())):null)}}),define("rEditor/rootComps/topBar/buttons/topBarButton/topBarButton",["react","lodash","core","util","baseUI","rEditor/rootComps/topBar/buttons/mixins/topBarButtonProgressMixin","rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin","rEditor/rootComps/topBar/dropPanels/topBarDropPanel","rEditor/rootComps/topBar/buttons/topBarButton/topBarButton.rt"],function(a,b,c,d,e,f,g,h,i){"use strict";return a.createClass({displayName:"topBarButton",mixins:[a.addons.PureRenderMixin,f,d.singlePassDOMReadWriteMixin,c.mixins.editorAPIMixin,c.mixins.biMixin,g],propTypes:{label:a.PropTypes.string,classes:a.PropTypes.string,iconSymbol:a.PropTypes.string,dropPanelProps:a.PropTypes.object,actions:a.PropTypes.array,bi:a.PropTypes.oneOfType([a.PropTypes.array,a.PropTypes.object]),biFunc:a.PropTypes.func,progressStatus:a.PropTypes.string,isDisabled:a.PropTypes.bool,onMenuOpened:a.PropTypes.func,onMenuClosed:a.PropTypes.func,buttonStyle:a.PropTypes.object},getInitialState:function(){return{isDropDownDisplayed:!1,isMouseOverButton:!1}},getDefaultProps:function(){return{buttonStyle:{}}},getClasses:function(){var a="top-bar-button "+this.props.classes;return this.state.isDropDownDisplayed&&(a+=" top-bar-button-selected"),(this.isInProgress()||this.props.isDisabled)&&(a+=" disabled-button"),a},onClick:function(){if(!this.props.isDisabled){this.props.dropPanelContent&&this.toggleDropDown(),this.hideTooltip();var a=this.getEditorAPI(),c=a.selection.getSelectedComponents(),d=a.bi.getComponentsBIParams(c);this.props.actions&&b.forEach([].concat(this.props.actions),function(a){a()}),this.sendButtonBI(d)}},handleMouseOverButton:function(){this.setState({isMouseOverButton:!0})},handleMouseLeftButton:function(){this.setState({isMouseOverButton:!1})},getDropDownId:function(){return"top-bar-dropdown-"+(this.props.label||this.props.iconSymbol)},getDropDownProps:function(){if(!this.isMounted())return{};var a=this.getDropDownContent();return{id:this.getDropDownId(),value:a,width:"1000px",interactive:!0,closeTriggers:[e.uiConstants.TOOLTIP.TRIGGERS.MOUSE_LEAVE],className:"top-bar-drop-down",overridePositionAdjustments:this.props.dropPanelProps&&this.props.dropPanelProps.overridePositionAdjustments,targetNode:this.getDOMNode(),hideMethod:this.handleDropDownWantsToClose,mouseLeftTargetNode:!this.state.isMouseOverButton,timeoutForMouseOverBubble:500}},getDropDownContent:function(){var b=this.getDropPanelLeftContent(),c={main:this.getDropPanelRightContent()};return b?a.createElement(h,{closeHandle:this.closeDropDown,leftContent:b,rightContentOptions:c,dropPanelClass:this.props.dropPanelProps&&this.props.dropPanelProps.dropPanelClass}):null},getDropPanelLeftContent:function(){var b=this.props.dropPanelContent,c=this.props.dropPanelProps;return b?(c.closeHandle=this.closeDropDown,a.createElement(b,this.props.dropPanelProps)):null},getDropPanelRightContent:function(){var d=this.props.dropPanelProps&&this.props.dropPanelProps.dropPanelPromotion;if(d){var e=b.cloneDeep(d.props);return e=b.merge({moduleName:d.type},e),a.DOM.div({className:d.classes},[a.createElement(c.lazyComponent,e)])}return null},openDropDown:function(){this.setState({isDropDownDisplayed:!0,isMouseOverButton:!0}),this.props.onMenuOpened&&this.props.onMenuOpened()},closeDropDown:function(){this.setState({isDropDownDisplayed:!1}),this.props.onMenuClosed&&this.props.onMenuClosed()},toggleDropDown:function(){this.state.isDropDownDisplayed?this.closeDropDown():this.openDropDown()},handleDropDownWantsToClose:function(){this.isMounted()&&!this.state.isMouseOverButton&&this.closeDropDown()},sendButtonBI:function(a){if(this.props.bi){var c=[].concat(this.props.bi);b.forEach(c,function(a){a.type&&this.sendBI(a.type,a.fields)},this)}this.props.biFunc&&this.props.biFunc(a)},measurePhase:function(){return this.props.measurePhase?this.props.measurePhase():null},patchPhase:function(a){this.props.patchPhase&&this.props.patchPhase(a)},render:i})}),define("rEditor/utils/menuItemsRepository",["lodash"],function(a){"use strict";function b(b,c){if(c){c=c.toLowerCase();var d=function(a){return 0===a.label.toLowerCase().indexOf(c)},e=function(b){var c;return a.forEach(b,function(a){if(d(a))return c=a,!1;var b=e(a.items);return b?(c=b,!1):void 0}),c};return e(b)}}function c(b,c){c=c.toLowerCase();var d=function(a){return-1!==a.label.toLowerCase().indexOf(c)},e=function(b){if(!b||0===b.length)return b;var c=[];return a.forEach(b,function(b){var f=d(b),g=e(b.items),h=g&&g.length>0;if(f||h){var i=a.clone(b,!1);i.items=g,c.push(i)}}),c};return e(b)}return{findFirstFilteredItem:b,filterItems:c}}),define("rEditor/rootComps/topBar/buttons/pagesNavButton/pagesNavButton.rt",["react/addons","lodash","util","baseUI","experiment!autoTextDirection","pLoader!santa:utils"],function(a,b,c,d,e,f){"use strict";function g(){var b=this.getTooltipElement();return a.createElement(d.tooltip,{id:"pageNavButtonTooltip",value:b,interactive:this.getTooltipInteractiveMode(),disabled:!b||this.state.isFiltering},a.createElement("div",{className:this.props.classes+(this.state.isFiltering?"":" pages-nav-button-bg")+"\n                "+(this.props.isSmallVersion?"mini-":"")+"page-nav-with-label",onClick:this.onClick},this.state.isFiltering?null:a.createElement("div",{key:"page-name",className:"top-bar-page-navigation-select",style:{height:"100%"}},this.props.isSmallVersion?null:a.createElement("div",{key:"graphics",className:"page-navigation-button-graphics"},a.createElement(d.symbol,{name:"pages"})),a.createElement("span",{className:(this.props.isSmallVersion?"mini-":"")+"top-bar-page-navigation-pageName"},this.props.isSmallVersion?"":c.translate("Pages_Menu_Title_Title")+":"," ",a.createElement("span",{dir:e?f.textDirectionUtil.getDirection(c.browserUtil.isIE(),this.props.label):"ltr"},this.getPageName())),this.props.isSmallVersion?null:a.createElement("span",{key:"arrow",className:"top-bar-page-navigation-arrow"},a.createElement(d.symbol,{name:"pagesArrow"}))),this.state.isFiltering?a.createElement("div",{key:"page-filter",className:"top-bar-page-navigation-select"},a.createElement("div",{className:"page-navigation-button-graphics"},a.createElement(d.symbol,{name:"pagesSearch"})),a.createElement(d.autoCompleteTextInput,{ref:"filterInput",dir:e?f.textDirectionUtil.getDirection(c.browserUtil.isIE(),this.props.label):"ltr",className:"top-bar-page-filter",placeholder:c.translate("TOPBAR_FIND_PAGE"),cancelIcon:"topBarButtonCancel",complete:this.completePageName,onChange:this.filterChanged,onKeyDown:this.onKeyDown})):null))}return function(){return g.apply(this,[])}}),define("rEditor/rootComps/topBar/buttons/pagesNavButton/pagesNavButton",["lodash","react","core","panels","rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin","rEditor/utils/menuItemsRepository","rEditor/rootComps/topBar/buttons/pagesNavButton/pagesNavButton.rt"],function(a,b,c,d,e,f,g){"use strict";function j(){return this.getEditorAPI().isDesktopEditor()?i:h}var h="rEditor.panels.pagesPanelMobile",i="rEditor.panels.pagesPanel";return b.createClass({displayName:"topBarPageNavButton",propTypes:{isSmallVersion:b.PropTypes.bool,bi:b.PropTypes.object,tooltipData:b.PropTypes.object,clickCallback:b.PropTypes.func},mixins:[c.mixins.editorAPIMixin,c.mixins.biMixin,e],keyCodes:{ENTER:13,ESC:27},getInitialState:function(){return{isFiltering:!1,filter:""}},completePageName:function(a){var b=this.getEditorAPI().mainMenu.getMenuItemsTreeForMainMenu(),c=f.findFirstFilteredItem(b,a);return c?c.label:null},getPageName:function(){return this.getEditorAPI().pages.getCurrentPageTitle()},onClick:function(){this.props.clickCallback&&this.props.clickCallback(),this.openFilteredPagesPanel()},openFilteredPagesPanel:function(){this.openWithFilter(this.state.filter),this.hideTooltip("pageNavButtonTooltip"),this.props.bi&&this.props.bi.type&&this.sendBI(this.props.bi.type,this.props.bi.fields)},filterChanged:function(a){this.openWithFilter(a)},openWithFilter:function(a){this.setState({isFiltering:!0,filter:a}),this.openPagesPanel(a)},navigateToFirst:function(){var a=this.getEditorAPI().mainMenu.getMenuItemsTreeForMainMenu(),b=f.findFirstFilteredItem(a,this.state.filter);b&&b.pageData&&(this.getEditorAPI().pages.navigateTo(b.pageData.id),this.closePagesPanel(),this.closeFiltering())},closeFiltering:function(){this.setState({isFiltering:!1,filter:""})},onKeyDown:function(a){a.keyCode===this.keyCodes.ENTER&&this.state.filter?this.navigateToFirst():a.keyCode===this.keyCodes.ESC&&(this.closePagesPanel(),this.closeFiltering())},componentWillReceiveProps:function(){this.isPagesPanelOpen()||this.closeFiltering()},componentDidUpdate:function(a,b){this.state.isFiltering&&!b.isFiltering&&this.refs.filterInput.focus()},isPagesPanelOpen:function(){var b=d.panelManager.getOpenPanels();return!!a.find(b,{name:j.call(this)})},openPagesPanel:function(b){var c=d.panelManager.getOpenPanels(),e=j.call(this),f={filter:b,pageAdded:function(){this.closeFiltering(),this.openPagesPanel("")}.bind(this),subpagesOpened:function(){this.closeFiltering()}.bind(this)};a.find(c,{name:e})?d.panelManager.updatePanelProps(e,f):d.panelManager.openPanel(e,f)},closePagesPanel:function(){var b=d.panelManager.getOpenPanels(),c=j.call(this);a.find(b,{name:c})&&d.panelManager.closePanelByName(c)},render:g})}),define("rEditor/rootComps/topBar/buttons/topBarNotification/topBarNotification.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return this.props.isShown?a.createElement("div",{key:"topBarNotification",className:this.props.classes+" top-bar-notification"},a.createElement("div",{},this.getMessage())):null}}),define("rEditor/rootComps/topBar/buttons/topBarNotification/topBarNotification",["react","util","rEditor/rootComps/topBar/buttons/topBarNotification/topBarNotification.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"topBarNotification",propTypes:{message:a.PropTypes.string,measurePhase:a.PropTypes.func,patchPhase:a.PropTypes.func},mixins:[b.singlePassDOMReadWriteMixin],emptyMessage:["","",""],getMessage:function(){var b=this.getMessageParts(),c=this.getMessageLinkPart(b[1]);return a.createElement("div",{},[b[0],c,b[2]])},getMessageParts:function(){var a=this.props.message;if(a){var b=this.getAnchorIndexes(a),c=a.substring(0,b[0]),d=a.substring(b[1]+"</a>".length),e=a.substring(b[0]+"<a>".length,b[1]);return[c,e,d]}return this.emptyMessage},getAnchorIndexes:function(a){if(!a)return[0,0];var b=a.indexOf("<a>"),c=a.indexOf("</a>");return(0>b||0>c)&&(b=a.length,c=a.length),[b,c]},getMessageLinkPart:function(b){return b?a.DOM.a({onClick:this.linkAction},b):""},linkAction:function(){this.props.action()},measurePhase:function(){return this.props.measurePhase?this.props.measurePhase():null},patchPhase:function(a){this.props.patchPhase&&this.props.patchPhase(a)},render:c})}),define("rEditor/rootComps/topBar/menuBar/menuBarPanelsDefinitions",["lodash","core","util","savePublish","experiment!spanishUpgradeText"],function(a,b,c,d,e){"use strict";function i(b,d){var e=b.campaigns.personalSale.getDiscountValue(),f=a.template(c.translate(d));return f({discount:e})}function j(a){var b=null,c=p(a);return b=c?k(a):n(a)}function k(a){return null===f&&(f=[{buttonText:c.translate("TOPBAR_UPGRADE_BUTTON_SAVE_SITE"),action:function(){d.save(a)}}]),f}function l(a){var b="TOPBAR_UPGRADE_FREE_ROW_BUTTON_1",d="";return d=a.campaigns.personalSale.isActiveCampaign()?i(a,"TOPBAR_UPGRADE_POPUP_PERSONAL_SALE_BUTTON_DYNAMIC"):c.translate("TOPBAR_UPGRADE_FREE_ROW_BUTTON_2"),{offerButtonText:d,leftButtonText:c.translate(b)}}function m(a){var b="edhtml_TOP_BAR_UPGRADE_MENU_GET_YEARLY_UNLIMITED";return a.campaigns.personalSale.isActiveCampaign()&&(b="edhtml_TOP_BAR_UPGRADE_MENU_PS"),b}function n(a){if(null===g){var c=b.bi.events.topbar,d=l(a),e=m(a);g=[{buttonText:d.leftButtonText,action:o.bind(null,a,c.top_bar_compare_plans_click,"edhtml_TOP_BAR_UPGRADE_MENU_COMPARE_PLANS")},{buttonText:d.offerButtonText,action:o.bind(null,a,c.top_bar_get_yearly_unlimited_click,e)}]}return g}function o(a,b,c){a.bi.event(b),a.account.upgrade(c)}function p(a){return a&&a.generalInfo&&a.generalInfo.isFirstSave()}function q(a,b){b=b||"left",a=s(a);var c=h[a];return c&&c[b]?c[b].panel:null}function r(a,b,c){c=c||"left",a=s(a);var d=h[a];return d&&d[c]?d[c].propsGetter(b):null}function s(b){return a.includes(["SITE_BAR","EDIT_BAR","VIEW_BAR","HELP_BAR"],b)?"ACTIONS_PANEL":b}var f=null,g=null,h={ACTIONS_PANEL:{left:{panel:"rEditor.panels.topBar.menuActionsPanel",propsGetter:function(){return{}}}},UPGRADE:{left:{panel:"rEditor.panels.topBar.checkListPanel",propsGetter:function(b){var d=p(b),f="";return f=b.campaigns.personalSale.isActiveCampaign()?i(b,"TOPBAR_UPGRADE_POPUP_PERSONAL_SALE_LABEL_DYNAMIC"):c.translate(e?"UPGRADE_TO_YEARLY_FOR_SPAIN_ONLY":"TOPBAR_UPGRADE_FREE_US_TITLE"),{type:"upgrade","class":"left-check-panel-upgrade",title:f,comment:d?c.translate("TOPBAR_UPGRADE_SAVE_FIRST_TEXT"):null,description:a.map(["TOPBAR_UPGRADE_FREE_US_LINE_1","TOPBAR_UPGRADE_FREE_US_LINE_2","TOPBAR_UPGRADE_FREE_US_LINE_3","TOPBAR_UPGRADE_FREE_US_LINE_4"],c.translate)}}},bottom:{panel:"rEditor.panels.topBar.checkListPanel",propsGetter:function(a){var b=j(a);return{type:"upgrade","class":"bottom-check-panel-upgrade",footerButtons:b}}}}};return{getMenuPanelProps:r,getMenuPanelType:q}}),define("rEditor/rootComps/topBar/dropPanels/content/menuBarContent.rt",["react/addons","lodash","core"],function(a,b,c){"use strict";function d(){var d=this.getPanelProps(),e=this.getPanelClass();return a.createElement("div",{},a.createElement(c.lazyComponent,b.assign({},{moduleName:e},d)))}return function(){return a.createElement("div",{},this.props.selectedMenu?a.createElement("div",{key:"menuActions"},d.apply(this,[])):null)}}),define("rEditor/rootComps/topBar/dropPanels/content/menuBarContent",["lodash","react","rEditor/rootComps/topBar/menuBar/menuBarPanelsDefinitions","rEditor/rootComps/topBar/dropPanels/content/menuBarContent.rt"],function(a,b,c,d){"use strict";return b.createClass({displayName:"menuBarContent",propTypes:{content:b.PropTypes.string.isRequired,editorAPI:b.PropTypes.object.isRequired,selectedMenu:b.PropTypes.object,closeDropDownHandle:b.PropTypes.func},getPanelProps:function(){var b=null,d=this.props.selectedMenu.key;if(d){b=a.clone(this.props);var e=c.getMenuPanelProps(d,this.props.editorAPI,this.props.content);b=a.merge(b,e)}return b},getPanelClass:function(){var a=this.props.selectedMenu.key;return a?c.getMenuPanelType(a,this.props.content):null},render:d})}),define("rEditor/rootComps/topBar/dropPanels/content/menuBarRightContent.rt",["react/addons","lodash","core"],function(a,b,c){"use strict";return function(){return this.props.panel?a.createElement("div",{className:"promotion",key:"promotionPanel"},a.createElement(c.lazyComponent,b.assign({},{moduleName:this.props.panel.type},b.merge(this.props.panel.props,{editorAPI:this.props.editorAPI,action:this.props.action,bi:this.props.bi})))):null}}),define("rEditor/rootComps/topBar/dropPanels/content/menuBarRightContent",["react","rEditor/rootComps/topBar/dropPanels/content/menuBarRightContent.rt"],function(a,b){"use strict";return a.createClass({displayName:"menuBarRightContent",render:b})}),define("rEditor/rootComps/topBar/menuBar/menuBar.rt",["react/addons","lodash","uiAnimations","baseUI"],function(a,b,c,d){"use strict";function e(a,b,c){this.onMouseOverMenuItem(c)}function f(b,c,d){return a.createElement("li",{ref:"menuItem"+d,className:c["class"],key:c.key,onMouseOver:e.bind(this,b,c,d)},a.createElement("a",{},this.getMenuItemLabel(c.key)),c.counter?a.createElement("div",{key:c.key+"counter",className:"counter"},c.counter):null)}function g(){var c=this.getMenuItems();return a.createElement.apply(this,["ul",{className:b.keys(b.pick({"menubar-items":!0},b.identity)).join(" "),onMouseLeave:this.onMouseLeave},b.map(c,f.bind(this,c))])}return function(){return a.createElement("div",{ref:"menuBar",className:this.props.classes},g.apply(this,[]),a.createElement(c.topBarMenuPanelAnimation,{outAnimationDuration:this.state.mouseOverMenu?0:.2},null!==this.state.indexOfOpenMenu?a.createElement(d.bubble,b.assign({},{key:"menuBarDropDown"},this.getDropDownProps())):null))}}),define("rEditor/rootComps/topBar/menuBar/menuBar",["react","lodash","core","util","baseUI","rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin","rEditor/rootComps/topBar/menuBar/menuBarItemsDefinitions","rEditor/rootComps/topBar/dropPanels/content/menuBarContent","rEditor/rootComps/topBar/dropPanels/content/menuBarRightContent","rEditor/rootComps/topBar/dropPanels/topBarDropPanel","rEditor/rootComps/topBar/menuBar/menuBar.rt"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function n(a){var b=d.keyboardShortcuts.CONTEXTS.TOP_BAR,c=d.keyboardShortcuts.extendContext(b,{esc:function(){null!==a.state.indexOfOpenMenu&&a.closeDropDown()},left:function(){var c,b=a.state.indexOfOpenMenu;c=0===b?a.getNumberOfMenuItems()-1:a.state.indexOfOpenMenu-1,a.openDropDown(c)},right:function(){var b=a.state.indexOfOpenMenu,c=(b+1)%a.getNumberOfMenuItems();a.openDropDown(c)}});d.keyboardShortcuts.registerContext(d.keyboardShortcuts.CONTEXTS.MENU_BAR,c)}function o(c,d,e){var f;return f=d.isMobileEditor()?c.MOBILE||c:c.DESKTOP||c,a.createElement(i,b.assign({panel:f,editorAPI:d},e))}function p(a){a&&a.openHandlePID&&(window.clearTimeout(a.openHandlePID),a.openHandlePID=null)}var l=300,m=500;return a.createClass({displayName:"menuBar",mixins:[c.mixins.editorAPIMixin],propTypes:{menuItems:a.PropTypes.array.isRequired,viewTools:a.PropTypes.object.isRequired,tooltipData:a.PropTypes.object,onMenuOpened:a.PropTypes.func,onMenuClosed:a.PropTypes.func},getInitialState:function(){return this.openHandlePID=null,{indexOfOpenMenu:null,mouseOverMenu:!1}},componentDidMount:function(){n(this)},componentWillUnmount:function(){d.keyboardShortcuts.unregisterContext(d.keyboardShortcuts.CONTEXTS.MENU_BAR),this.isMenuBarKeyboardContextActive()&&d.keyboardShortcuts.setContext(this.lastKeyboardContext)},componentDidUpdate:function(a,b){var c=this.state.indexOfOpenMenu!==b.indexOfOpenMenu&&null===this.state.indexOfOpenMenu,e=this.state.indexOfOpenMenu!==b.indexOfOpenMenu&&null===b.indexOfOpenMenu;c?(d.keyboardShortcuts.getContext()===d.keyboardShortcuts.CONTEXTS.MENU_BAR&&d.keyboardShortcuts.setContext(this.lastKeyboardContext),this.props.onMenuClosed&&this.props.onMenuClosed()):e&&this.props.onMenuOpened&&this.props.onMenuOpened()},isMenuBarKeyboardContextActive:function(){return d.keyboardShortcuts.getContext()===d.keyboardShortcuts.CONTEXTS.MENU_BAR},getMenuItems:function(){return b.map(this.props.menuItems,function(a,b){return{key:a.key,"class":this.getMenuItemClasses(a.key,b),counter:this.getMenuItemCounter(a.key)}},this)},getMenuItemClasses:function(a,b){var c=[];return a=a&&a.toLowerCase()||"",c.push("upgrade"!==a?"menu-bar-title":"menu-bar-upgrade-title"),"help"===a&&c.push("top-bar-help-title"),b===this.state.indexOfOpenMenu&&c.push("menu-bar-selected-item"),c.join(" ")},getMenuItemLabel:function(a){return g[a].label},getMenuItemCounter:function(a){return b.isFunction(g[a].getCounter)&&g[a].getCounter()},getNumberOfMenuItems:function(){return this.props.menuItems.length},getDropDownProps:function(){var a=this.state.indexOfOpenMenu;return this.isMounted()?{key:"menuDropDown-"+a,value:this.getDropDownContent(a),width:"1000px",closeTriggers:this.getDropDownTooltipCloseTriggers(),className:"top-bar-drop-down",overridePositionAdjustments:{type:e.uiConstants.TOOLTIP.ALIGNMENT.LEFT,value:70},targetNode:this.refs["menuItem"+a].getDOMNode(),hideMethod:this.handleDropDownWantsToClose,mouseLeftTargetNode:!this.state.mouseOverMenu,timeoutForMouseOverBubble:m}:{}},handleDropDownWantsToClose:function(){this.isMounted()&&!this.state.mouseOverMenu&&this.setState({indexOfOpenMenu:null})},getDropDownTooltipCloseTriggers:function(){return[e.uiConstants.TOOLTIP.TRIGGERS.MOUSE_LEAVE]},getDropDownContent:function(b){var c=this.getDropDownBottomContent(b),d=this.getDropDownLeftContent(b,this.props.viewTools),e=this.getMenuRightContentOptions(b);return a.createElement(j,{closeHandle:this.closeDropDown,bottomContent:c,leftContent:d,rightContentOptions:e,dropPanelClass:"menubar-drop-panel"})},getDropDownBottomContent:function(b){var c=this.props.menuItems[b];return a.createElement(h,{content:"bottom",selectedMenu:c,closeDropDownHandle:this.closeDropDown,editorAPI:this.getEditorAPI()})},getDropDownLeftContent:function(b,c){var d=this.props.menuItems[b];return a.createElement(h,{content:"left",selectedMenu:d,action:g[d.key].action,viewTools:c,closeDropDownHandle:this.closeDropDown,editorAPI:this.getEditorAPI()})},getMenuRightContentOptions:function(a){var c=this.getEditorAPI(),d=this.props.menuItems[a],e={};return e.main=o(d.rightPanel,c),b.forEach(d.children,function(a){if(a&&g[a.key]&&a.rightPanel){var b=this.handleClickOnRightPanel.bind(this,a),d=g[a.key].bi,f={action:b,bi:d};e[a.key]=o(a.rightPanel,c,f)}},this),e},handleClickOnRightPanel:function(a){var c=g[a.key],d=c.action;if(d){var e=d.apply(null,b.rest(arguments))!==!1;!c.isCheckbox&&e&&this.closeDropDown()}},openDropDown:function(a){null===this.state.indexOfOpenMenu&&(this.lastKeyboardContext=d.keyboardShortcuts.getContext(),d.keyboardShortcuts.setContext(d.keyboardShortcuts.CONTEXTS.MENU_BAR)),this.setState({indexOfOpenMenu:a})},closeDropDown:function(){this.setState({indexOfOpenMenu:null})},onMouseOverMenuItem:function(a){var b=!this.state.mouseOverMenu,c=null!==this.state.indexOfOpenMenu,d=b&&!c,e=c&&this.state.indexOfOpenMenu!==a;if(b&&this.setState({mouseOverMenu:!0}),d){p(this);var f=this;this.openHandlePID=setTimeout(function(){f.isMounted()&&f.openDropDown(a)},l)}else e&&this.openDropDown(a)},onMouseLeave:function(){p(this),this.setState({mouseOverMenu:!1})},render:k})}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(d,e,f){return a.createElement("li",{key:f},a.createElement("div",{className:b.keys(b.pick({check:!d,"check-purple":d},b.identity)).join(" ")},a.createElement(c.symbol,{name:"check"})),a.createElement("div",{className:"text"},e))}function e(a,b,c){this.onClick(b.action)}function f(d,f,g){return a.createElement(c.button,{className:b.keys(b.pick({"action-button":!d,"action-button-purple1":d&&g%2===0,"action-button-purple2":d&&g%2!==0},b.identity)).join(" "),label:f.buttonText,shouldTranslate:!1,key:"key-"+f.buttonText,onClick:e.bind(this,d,f,g)})}function g(){var c="upgrade"===this.props.type;return a.createElement.apply(this,["div",{className:this.props["class"]},this.props.title?a.createElement("div",{key:"title",className:"title"},this.props.title):null,1===b.size(this.props.description)?a.createElement("div",{key:"single",className:"description"},this.props.description):null,b.size(this.props.description)>1?a.createElement("div",{key:"multiple",className:"description"},a.createElement.apply(this,["ul",{},b.map(this.props.description,d.bind(this,c)),this.props.comment?a.createElement("li",{key:"comment",className:"comment"},this.props.comment):null])):null,b.map(this.props.footerButtons,f.bind(this,c))])}return function(){return g.apply(this,[])}}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel",["react","rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel.rt"],function(a,b){"use strict";return a.createClass({displayName:"checkListPanel",propTypes:{editorAPI:a.PropTypes.object.isRequired,closeDropDownHandle:a.PropTypes.func.isRequired},onClick:function(a){a&&a(this.props.editorAPI),this.props.closeDropDownHandle()},render:b})}),define("rEditor/rootComps/topBar/dropPanels/editorModesPanel.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:"editor-modes-panel"},a.createElement("div",{className:"editor-modes-panel-top-part"},a.createElement("div",{},a.createElement(c.radioList,{options:[{label:"TOPBAR_MobileDesktop_Desktopview",symbolName:"desktop",className:"editor-mode-option-desktop",symbolClass:"editor-mode-option-symbol",value:"desktop"},{label:"TOPBAR_MobileDesktop_MobileView",symbolName:"mobile",className:"editor-mode-option-mobile",symbolClass:"editor-mode-option-symbol",value:"mobile"}],value:this.props.desktopModeSelected?"desktop":"mobile",onChange:this.setEditorMode,highlightOnHover:!0}))),a.createElement("div",{className:"optimized-view-row"},a.createElement(c.toggle,{label:"TOPBAR_MobileDesktop_MobileOptimized",labelAfterSymbol:!0,value:this.props.isMobileOptimized,onChange:this.toggleOptimized})))}}),define("rEditor/rootComps/topBar/dropPanels/editorModesPanel",["react","lodash","core","util","rEditor/rootComps/topBar/dropPanels/editorModesPanel.rt"],function(a,b,c,d,e){"use strict";var f="EDITOR_MODES_SWITCH";return a.createClass({displayName:"editorModesPanel",propTypes:{editorAPI:a.PropTypes.object.isRequired,isMobileOptimized:a.PropTypes.bool.isRequired,desktopModeSelected:a.PropTypes.bool.isRequired,closeHandle:a.PropTypes.func},biData:{desktop:{editor_view_mode:"desktop"},mobile:{editor_view_mode:"mobile"}},getDefaultProps:function(){return{closeHandle:b.noop}},componentDidMount:function(){this.registerKeyboardShortcuts(),this.lastKeyboardContext=d.keyboardShortcuts.getContext(),d.keyboardShortcuts.setContext(f)},componentWillUnmount:function(){d.keyboardShortcuts.setContext(this.lastKeyboardContext)},setEditorMode:function(a){var b=this.props.editorAPI;"desktop"===a?(this.sendModeChangeBI(b,this.biData.desktop),b.setDesktopEditor()):(this.sendModeChangeBI(b,this.biData.mobile),b.setMobileEditor()),this.props.closeHandle&&this.props.closeHandle()},toggleOptimized:function(){var a=this.props.isMobileOptimized,b=!a;this.sendToggleBI(this.props.editorAPI.getPreviewMode(),b),this.props.editorAPI.setMobileOptimizedSite(b)},sendToggleBI:function(a,b){var d=c.bi.events.topbar.mobile_view_mode_toggle,e=a?"top bar preview":"top bar editor",f={origin:e,status:b?1:0};this.props.editorAPI.bi.event(d,f)},sendModeChangeBI:function(a,b){if(a){var d=c.bi.events.topbar.top_bar_editor_view_mode_click;a.getPreviewMode()&&(d=c.bi.events.topbar.top_bar_preview_page_editor_view_mode_click),a.bi.event(d,b)}},registerKeyboardShortcuts:function(){var a=this,b={esc:function(){a.props.closeHandle()}};d.keyboardShortcuts.registerContext(f,b)},render:e})}),define("rEditor/rootComps/topBar/topBarWidgetsDefinitions",["jquery","lodash","util","core","rEditor/rootComps/topBar/config/topBarData.json","rEditor/rootComps/topBar/menuBar/config/topBarMenuData.json","rEditor/rootComps/topBar/buttons/topBarButton/topBarButton","rEditor/rootComps/topBar/buttons/pagesNavButton/pagesNavButton","rEditor/rootComps/topBar/buttons/topBarNotification/topBarNotification","rEditor/rootComps/topBar/menuBar/menuBar","rEditor/rootComps/topBar/menuBar/menuBarPanelsDefinitions","rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel","rEditor/rootComps/topBar/dropPanels/editorModesPanel","baseUI","panels","savePublish","experiment","experiment!spanishUpgradeText"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";function t(a,b){function f(){h(),u(a,b)}function g(){a.areActionsLocked||a.lockActions()}function h(){a.unlockActions()}function i(){e.toggleEditorStateParam(c,d.constants.PROGRESS_STATUS.IDLE)}var c="previewingStatus",e=a.getEditorAPI();e.wixCode.isLoaded()?(g(),e.toggleEditorStateParam(c,d.constants.PROGRESS_STATUS.IN_PROGRESS),e.wixCode.saveAPI.save().then(f)["catch"](h).done(i)):f()}function u(a,b){a.areActionsLocked||(a.lockActions(),a.getEditorAPI().togglePreview(),setTimeout(a.unlockActions,b||1))}function v(a){return c.media.getMediaUrl("rEditor/topBar/"+a)}function w(a){return!a||a.generalInfo&&a.generalInfo.isFirstSave()}function x(b){var c=a(b.refs.topBarSideWrapperLeft.getDOMNode()),d=a(b.refs.topBarSideWrapperRight.getDOMNode());return{leftWidth:c.width(),rightWidth:d.width()}}function y(b,c){var d=a(b.refs.topBarSideWrapperCenter.getDOMNode());d.css({left:c.leftWidth,right:c.rightWidth,width:"auto"})}function z(b,c,d,e){e=e||0;var f=c===s.RIGHT?"topBarSideWrapperRight":"topBarSideWrapperLeft",g=b.refs[f].getDOMNode();return a(g.childNodes[d]).width()||e}function A(b,c){var d=b.refs.topBarBackToEditorButton;c=J.PREVIEW.measuredWidth+J.PUBLISH.measuredWidth,d&&c>0&&a(d.getDOMNode()).width(c)}function E(a){var b="save-button-tooltip";return{compClass:g,actions:null,compProps:function(c,e,f,g){var h=c.state.appearance>=c.APPEARANCE.SAVE_AND_MOBILE_CHANGE_ICONS,i=c.getEditorAPI(),j=g&&"PREVIEW"===g.toUpperCase(),k=j?d.bi.events.topbar.top_bar_Preview_Page_Save_click:C("save"),l=w(i),m=l?"-notSaved":"";return J.SAVE.actions=J.SAVE.actions||[p.save.bind(p,i,{origin:"top_bar"})],{label:h?null:"TOPBAR_Site_Save",iconSymbol:h?"save":null,classes:["top-bar-menu-item","top-bar-save",L(e),M(e,f)].join(" "),actions:J.SAVE.actions,isDisabled:p.isPublishInProgress()||p.isSaveInProgress(),progressStatus:c.props.savingStatus,tooltipData:D((a?b:b)+m,!0,"TOPBAR_SAVE_TOOLTIP_TITLE","TOPBAR_SAVE_TOOLTIP_BODY",l?null:"TOPBAR_SAVE_TOOLTIP_LINK",l?null:function(){i.account.openRevisions()}),bi:k}}}}function F(a){return{compClass:"div",compProps:function(b,c){var d=!a||a(b,c);return{className:["top-bar-separator","top-bar-menu-item",L(c),d?"":"hidden"].join(" ")}}}}function G(a){a.panelManager.closeAllPanels(),a.toolsControl.toggleHideTools(!0,!0),setTimeout(function(){a.zoomMode.enterZoomMode(),a.bi.event(d.bi.events.topbar.top_bar_zoom_mode_click,{editor_view_mode:a.isMobileEditor()?"mobile":"desktop"})},400)}function H(a){a.setEditorMode(!a.isMobileEditor())}function I(){return q.isOpen("exp171")&&!q.isOpen("zoomModeSectionsRedesignOff")?{compClass:g,actions:null,bi:[C("zoomout"),{type:d.bi.events.preview.PREVIEW_CLICK,fields:{origin:"topbar"}}],compProps:function(a,b,c){var d=a.getEditorAPI();return J.ZOOMOUT.actions=J.ZOOMOUT.actions||[G.bind(null,d)],J.ZOOMOUT.classes=J.ZOOMOUT.classes||["top-bar-menu-item","top-bar-preview-icon",M(b,c),L(b)].join(" "),{iconSymbol:"zoomOut",actions:J.ZOOMOUT.actions,classes:J.ZOOMOUT.classes,tooltipData:D("topBarZoomOutTooltipID",!1,"TOPBAR_ZoomOut_Tooltip_Title","TOPBAR_ZoomOut_Tooltip_Body"),bi:J.ZOOMOUT.bi,ref:"topBarZoomOutButton"}}}:null}function K(a,c,e){var f={type:c,origin:"topbar"};b.isEmpty(e)?e=[f]:b.forEach(e,function(a){b.assign(a,f)}),a.bi.reportBI(d.bi.events.editor.undo_redo_component_change,e)}function L(a){var b="top-bar-menu-item-";return a&&a===s.RIGHT?b+"right":b+"left"}function M(a,b){var c=[];return a===s.LEFT&&0===b?c.push("top-bar-item-right-margin"):a===s.RIGHT&&0===b?c.push("top-bar-item-left-margin"):c.push("top-bar-item-margin"),
c}var s={LEFT:"left",RIGHT:"right"},B=function(){var a=null;return function(b){return null===a&&(a={onMenuOpened:b.onMenuOpened,onMenuClosed:b.onMenuClosed}),a}}(),C=function(){var a={};return function(b){return a[b]||(a[b]={type:d.bi.events.topbar.top_bar_click,fields:{category:b}}),a[b]}}(),D=function(){var a={};return function(b,c,d,e,f,g){var h=a[b];return h||(h={presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:b,interactive:c,props:{title:d,text:e,link:f,linkAction:g}},a[b]=h),h}}(),J={WIX_LOGO:{compClass:g,compProps:function(a,b){return{iconSymbol:"wixLogo",classes:["top-bar-wix-logo",L(b)].join(" "),bi:C("wix_logo")}}},PAGES_LIST:{compClass:h,compProps:function(a,c,d){var e=a.state.appearance>=a.APPEARANCE.TRIM_PAGES_NAV_BUTTON,f=B(a);return b.assign({},f,{label:"pages",isSmallVersion:e,classes:["top-bar-menu-item",M(c,d),L(c)].join(" "),tooltipData:D("pagesTooltipID",!1,null,"TOPBAR_PAGES_TOOLTIP_TITLE"),bi:C("pages")})}},REDO_SEPARATOR:F(function(a){return a.state.appearance<a.APPEARANCE.HIDE_REDO}),SEPARATOR:F(),ZOOMOUT:I(),UNDO:{compClass:g,actions:null,biFunc:null,classes:null,compProps:function(a,b,c){var d=a.getEditorAPI(),e=J.UNDO;return e.actions=e.actions||[d.history.undo],e.biFunc=e.biFunc||K.bind(null,d,"undo"),e.classes=e.classes||["top-bar-undo",M(b,c),L(b)].join(" "),{iconSymbol:"undo2",classes:J.UNDO.classes,actions:J.UNDO.actions,tooltipData:D("topBarUndoTooltipID",!1,null,"TOPBAR_UNDO_TOOLTIP_TITLE"),biFunc:J.UNDO.biFunc}}},REDO:{compClass:g,actions:null,biFunc:null,compProps:function(a,c,d){var e=a.getEditorAPI();J.REDO.actions=J.REDO.actions||[e.history.redo],J.REDO.biFunc=J.REDO.biFunc||K.bind(null,e,"redo");var f=a.state.appearance>=a.APPEARANCE.HIDE_REDO;return{iconSymbol:"redo2",classes:b.compact(["top-bar-redo","top-bar-responsive-1024",M(c,d),L(c)],f?"hidden":"").join(" "),actions:J.REDO.actions,tooltipData:D("topBarRedoTooltipID",!1,null,"TOPBAR_REDO_TOOLTIP_TITLE"),biFunc:J.REDO.biFunc}}},PREVIEW:{compClass:g,actions:null,measuredWidth:0,bi:[C("preview"),{type:d.bi.events.preview.PREVIEW_CLICK,fields:{origin:"topbar"}}],compProps:function(a,b,c){var d=a.state.appearance>=a.APPEARANCE.PREVIEW_CHANGE_TO_ICON;return q.isOpen("developerModeToggle")?J.PREVIEW.actions=J.PREVIEW.actions||[t.bind(null,a,500)]:J.PREVIEW.actions=J.PREVIEW.actions||[u.bind(null,a,500)],J.PREVIEW.classes=J.PREVIEW.classes||["top-bar-menu-item","top-bar-preview-icon",M(b,c),L(b)].join(" "),{label:d?null:"TOPBAR_PREVIEW_TOOLTIP_TITLE",iconSymbol:d?"preview":null,actions:J.PREVIEW.actions,classes:J.PREVIEW.classes,progressStatus:a.props.previewingStatus,tooltipData:D("topBarPreviewTooltipID",!1,"TOPBAR_PREVIEW_TOOLTIP_TITLE","TOPBAR_PREVIEW_TOOLTIP_BODY"),bi:J.PREVIEW.bi,ref:"topBarPreviewButton",measurePhase:function(d){J.PREVIEW.measuredWidth=z(a,b,c,d)}}}},EDITOR_MODE_SWITCH:{compClass:g,getDropPanelProps:function(){var a={};return function(b,c,d,e){var f=(b?"mobile-":"desktop-")+(c?"optimized-":"non-optimized-")+d,g=a[f];return g||(g={overridePositionAdjustments:{type:n.uiConstants.TOOLTIP.ALIGNMENT.RIGHT,value:70},desktopModeSelected:!b,isMobileOptimized:c,editorAPI:e,dropPanelPromotion:{type:"rEditor.panels.topBar.promotionPanel",classes:"promotion editor-mode-switch-promotion",props:{menuKey:"editor-mode-switch",key:"editor-mode-switch",title:"TOPBAR_MOBILE_PROMOTION_TITLE",message:"TOPBAR_MOBILE_PROMOTION_BODY",image:v(d>=2?"mobileDesktopIllustration@x2.png":"mobileDesktopIllustration.png"),classes:{graphics:"editor-mode-switch-graphics",title:"editor-mode-switch-title",message:"editor-mode-switch-message"}}},dropPanelClass:"editor-modes-panel-container"},a[f]=g),g}}(),compProps:function(a,d,e,f){var g=c.browserUtil.getDevicePixelRatio(),h=a.props.isMobileEditor?"desktop":"mobile",i=a.state.appearance>=a.APPEARANCE.SAVE_AND_MOBILE_CHANGE_ICONS,j=B(a),k=q.isOpen("oneClickEditorModeToggle"),l=a.getEditorAPI();return b.assign({},j,{iconSymbol:h,classes:[i?"mini-editor-mode-switch":"editor-mode-switch",M(d,e),L(d)].join(" "),actions:k?[H.bind(null,l)]:null,dropPanelContent:k?null:m,dropPanelProps:J.EDITOR_MODE_SWITCH.getDropPanelProps(a.props.isMobileEditor,a.props.isMobileOptimized,g,l),tooltipData:D("editorModeSwitchTooltipId-"+f,!1,"TOPBAR_MOBILE_TOOLTIP_TITLE","TOPBAR_MOBILE_TOOLTIP_BODY"),bi:C("editor_view_mode")})}},PUBLISH:{compClass:g,label:"TOPBAR_Site_Publish",measuredWidth:0,actions:null,bi:[C("publish"),{type:d.bi.events.publish.PUBLISH_CLICK,fields:{origin:"topbar"}}],classes:null,compProps:function(a,b,c){var d=a.getEditorAPI(),e=d.generalInfo&&d.generalInfo.isSitePublished()||!1,f="publish-button-tooltip-id-"+(e?"published":"notPublished");return J.PUBLISH.actions=J.PUBLISH.actions||[function(){a.areActionsLocked||p.saveAndPublish(d,"top_bar_publish")}],J.PUBLISH.classes=J.PUBLISH.classes||[L(b),"top-bar-item-margin","top-bar-textual-button"].join(" "),{label:J.PUBLISH.label,right:!1,classes:J.PUBLISH.classes,actions:J.PUBLISH.actions,isDisabled:p.isPublishInProgress()||p.isSaveInProgress(),progressStatus:a.props.publishingStatus,tooltipData:D(f,!0,e?"TOPBAR_POSTPUBLISH_TOOLTIP_TITLE":"TOPBAR_PREPUBLISH_TOOLTIP_TITLE",e?"TOPBAR_POSTPUBLISH_TOOLTIP_BODY":"TOPBAR_PREPUBLISH_TOOLTIP_BODY",e?"SAVE_PUBLISH_BUTTON_VIEW":null,e?function(){var a=d.site.getSitePublicUrl();window.open(a)}:null),bi:J.PUBLISH.bi,ref:"topBarPublishButton",measurePhase:function(d){J.PUBLISH.measuredWidth=z(a,b,c,d)}}}},SAVE:E(!1),PREVIEW_SAVE:E(!0),WIXSTORES_MIGRATION_UPGRADE_SITE:{compClass:g,compProps:function(a,b,c){var e=a.getEditorAPI();return e.wixStores.isSiteInWixStoreTestDrive()?{label:"TOPBAR_Site_Migration_Upgrade",classes:["top-bar-menu-item","top-bar-wixstores-migration-upgrade-button",L(b),M(b,c)].join(" "),actions:[function(){o.panelManager.openPanel("wixStore.migration.wixStoreSwitchPopup",{},!0),e.bi.event(d.bi.events.wixstores.WIXSTORES_MIGRATION_UPGRADE_CLICKED,{origin:"top panel"})}]}:null}},MENU:{compClass:j,compProps:function(a){var d=B(a),e=a.getMenuBarItems(f),g=b.assign({},d,{menuItems:e,viewTools:a.props.viewTools,classes:"top-bar-menu-item-left menu-bar",onMenuOpened:a.onMenuOpened,onMenuClosed:a.onMenuClosed,tooltipData:D("topBarMenuTooltipId",!1,null,"TOPBAR_MENU_TOOLTIP_TITLE"),bi:C("menu")});if(r){var h=b.find(g.menuItems,{key:"SITE_BAR"}),i=b.find(h.children,{key:"UPGRADE_ITEM"}).rightPanel;i.props.title=c.translate("UPGRADE_FOR_SPAIN_ONLY"),i.props.message=c.translate("TOPBAR_SITE_UPGRADE_PROMOTION_TEXT"),i.props.shouldTranslate=!1}return g}},BACK_TO_EDITOR:{compClass:g,actions:null,bi:{type:d.bi.events.topbar.top_bar_Preview_Page_Back_to_Editor_click,fields:{origin:"thumb"}},compProps:function(a,b){return J.BACK_TO_EDITOR.actions=J.BACK_TO_EDITOR.actions||[u.bind(null,a,500)],{label:"TOPBAR_BACK_TO_EDITOR",right:!0,classes:[L(b),"top-bar-item-back-to-editor"].join(" "),actions:J.BACK_TO_EDITOR.actions,bi:J.BACK_TO_EDITOR.bi,ref:"topBarBackToEditorButton",patchPhase:A.bind(null,a)}}},MOBILE_NON_OPTIMIZED_NOTIFICATION:{compClass:i,action:null,compProps:function(a,b){var d=J.MOBILE_NON_OPTIMIZED_NOTIFICATION;return d.action=d.action||function(){var b=a.getEditorAPI();b.togglePreview(),b.openMobileElementsPanel({mobileElementId:"mobileView"})},{classes:[M(b),L(b)].join(" "),isShown:a.props.isMobileEditor&&!a.props.isMobileOptimized,message:c.translate("mobile_preview_notification_text1")+" <a>"+c.translate("mobile_preview_notification_link")+"</a> "+c.translate("mobile_preview_notification_text2"),action:d.action}}},PREVIEW_NOTIFICATION:{compClass:i,compProps:function(a,b,d,e){var f=a.props.isMobileEditor&&!a.props.isMobileOptimized,g="PREVIEW"===e.toUpperCase();return{classes:[M(b),L(b)].join(" "),isShown:g&&!f,message:c.translate("Topbar_PREVIEW_TITLE"),measurePhase:x.bind(null,a),patchPhase:y.bind(null,a)}}}};return{ORIENTATION:s,TOP_BARS:e,widgetMapping:J}}),define("rEditor/rootComps/topBar/util/campaignUtil",["lodash","core","util"],function(a,b,c){"use strict";function d(b){return a.chain(b).find({key:"SITE_BAR"}).get("children").find({key:"UPGRADE_ITEM"}).value()}function e(b){return a.find(b,{key:"UPGRADE"})}function f(b){var d=b.campaigns.personalSale.getAssetPath(),e=b.campaigns.personalSale.getDiscountValue(),f=[d,"menubarSitePanel_"+e+".svg"].join("/"),g=a.template(c.translate("TOPBAR_UPGRADE_POPUP_PERSONAL_SALE_LABEL_DYNAMIC"));return{symbol:"",image:c.media.getAssetUrl(f),message:g({discount:e}),title:c.translate("TOPBAR_SITE_UPGRADE_PROMOTION_TITLE"),shouldTranslate:!1}}function g(a){var b=a.campaigns.personalSale.getAssetPath(),d=a.campaigns.personalSale.getDiscountValue(),e=[b,"menubarUpgradePanel_"+d+".svg"].join("/");return{symbol:"",image:c.media.getAssetUrl(e)}}function h(b,c){var h=d(c),i=e(c);a.assign(h.rightPanel.props,f(b)),a.assign(i.rightPanel.props,g(b))}return{updateMenuBarItemsAccordingToPersonalSaleCampaign:h}}),define("rEditor/rootComps/topBar/zoomModeBar.rt",["react/addons","lodash","baseUI","symbols","uiAnimations","util","rEditor/rootComps/topBar/buttons/topBarButton/topBarButton"],function(a,b,c,d,e,f,g){"use strict";function h(){this.exitZoomMode()}return function(){return a.createElement(e.contentSlideCSS,{distance:"60px"},this.inZoomMode()?a.createElement("div",{className:"zoom-bar-wrapper",key:"zoomModeBarWrapper",ref:"zoomModeBarWrapper",style:{width:"calc("+(100*this.getSiteScale()+"% - "+this.getVerticalScrollWidth())+")",left:"calc(50% - "+this.getVerticalScrollWidth()+")"}},a.createElement("div",{className:b.keys(b.pick({"zoom-mode-bar":!0},b.identity)).join(" "),key:"zoom-mode-bar"},a.createElement("div",{className:"left-zoom-bar",onClick:h.bind(this)},a.createElement("span",{className:"zoom-bar-text"},f.translate("TOPBAR_Exit_ZoomOut")),a.createElement(g,{iconSymbol:"zoomClose",classes:"zoom-bar-symbol",actions:[this.exitZoomMode]})),a.createElement("div",{className:"right-zoom-bar"},a.createElement(g,{iconSymbol:"undo2",classes:"zoom-bar-btn-seperator top-bar-item-margin",actions:[this.callUndo],tooltipData:this.getTooltipData("topBarUndoTooltipID","TOPBAR_UNDO_TOOLTIP_TITLE")}),a.createElement(g,{iconSymbol:"redo2",classes:"zoom-bar-btn-seperator top-bar-item-margin",actions:[this.callRedo],tooltipData:this.getTooltipData("topBarRedoTooltipID","TOPBAR_REDO_TOOLTIP_TITLE")}),a.createElement(g,{iconSymbol:"zoomBarHelp",classes:"zoom-bar-btn",actions:[this.openHelp],tooltipData:this.getTooltipData("zoomBarHelpTooltipID","gfpp_tooltip_help")})))):null)}}),define("rEditor/rootComps/topBar/zoomModeBar",["jquery","react","lodash","core","util","baseUI","panels","rEditor/rootComps/topBar/zoomModeBar.rt"],function(a,b,c,d,e,f,g,h){"use strict";return b.createClass({displayName:"zoomModeBar",mixins:[d.mixins.editorAPIMixin],exitZoomMode:function(){var a=this.getEditorAPI();this.getEditorAPI().zoomMode.exitZoomMode(),a.bi.event(d.bi.events.topbar.zoombar.zoom_mode_bar_exit_zoom_mode,{editor_view_mode:a.isMobileEditor()?"mobile":"desktop"}),setTimeout(function(){a.toolsControl.toggleHideTools(!1,!0)},300)},inZoomMode:function(){return this.getEditorAPI().zoomMode.isInZoomMode()},callUndo:function(){this.getEditorAPI().history.undo()},callRedo:function(){this.getEditorAPI().history.redo()},getSiteScale:function(){return this.getEditorAPI().getSiteScale()},openHelp:function(){var a="DESKTOP"===this.getEditorAPI().viewMode.get()?"00d369ed-aedf-4fbd-b11c-3fcc51459cef":"65ff699a-dc0c-4c42-b2af-8df5e022d350";g.panelManager.openHelpCenter(a)},getTooltipData:function(a,b){return{presenter:f.popoverTemplates.titleBodyAndLinkTooltip,id:a,props:{text:b}}},getVerticalScrollWidth:function(){return 0===e.uiUtils.getScrollbarWidth()?"0px":"6px"},render:h})}),define("rEditor/rootComps/topBar/topBar.rt",["react/addons","lodash","experiment!topBarB","experiment!hideAllTools","baseUI","symbols","rEditor/rootComps/topBar/zoomModeBar","experiment!zoomModeSectionsRedesignOff","experiment!exp171"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(){this.toggleHideTools()}return function(){return a.createElement("div",{className:this.topBarClassName+" "+(c?"top-bar-b":""),onClick:this.handleTopBarClick,onContextMenu:this.props.onContextMenu},a.createElement("div",{className:b.keys(b.pick({"top-bar-editor":!0,"top-bar-preview-show":this.props.previewMode,"is-hidden":this.props.isHidden,"is-hidden-completely":i&&!h&&this.hideForZoomMode()},b.identity)).join(" "),style:{zIndex:this.state.zIndex}},this.props.previewMode?a.createElement("div",{"data-target":this.topBarClassName,key:"top-bar-preview",className:"top-bar-container top-bar-preview"},this.getTopBarByMode("PREVIEW")):null,this.props.previewMode?null:a.createElement("div",{"data-target":this.topBarClassName,key:"top-bar-edit",className:"top-bar-container top-bar-edit"},this.getTopBarByMode("EDIT")),this.props.isEnabled?null:a.createElement("div",{className:"top-bar-overlay",key:"overlay"})),i&&!h?a.createElement(g,{key:"zoomModeBar"}):null,!d||this.props.previewMode||this.props.isMobileEditor?null:a.createElement(e.tooltip,{value:this.getHideToolsTooltip(),key:"hideAllTools"},a.createElement("div",{onClick:j.bind(this),style:{zIndex:this.state.zIndex},className:b.keys(b.pick({"hide-tools-button":!0,"tools-hidden":this.props.isHidden,"stand-out":this.props.shouldHideToolsBtnBlink},b.identity)).join(" ")},a.createElement(f.symbol,{className:"hide-tools-symbol",name:"hideToolsArrow"}))))}}),define("rEditor/rootComps/topBar/topBar",["jquery","react","lodash","core","util","rEditor/rootComps/topBar/topBarWidgetsDefinitions","rEditor/rootComps/topBar/util/campaignUtil","experiment","rEditor/rootComps/topBar/topBar.rt"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){return a>0?1:0>a?-1:0}function l(a){return c.filter(a.children,function(a){return(!a.experiment||h.isOpen(a.experiment))&&(!a.experimentOff||!h.isOpen(a.experimentOff))})}var k=null;return b.createClass({displayName:"topBar",topBarClassName:"top-bar",mixins:[d.mixins.editorAPIMixin,e.outerClickMixin,e.singlePassDOMReadWriteMixin],propTypes:{height:b.PropTypes.number.isRequired,isEnabled:b.PropTypes.bool,isMobileEditor:b.PropTypes.bool.isRequired,isMobileOptimized:b.PropTypes.bool.isRequired,previewMode:b.PropTypes.bool.isRequired,viewTools:b.PropTypes.object.isRequired,previewingStatus:b.PropTypes.string.isRequired,savingStatus:b.PropTypes.string.isRequired,publishingStatus:b.PropTypes.string.isRequired,onTopBarClicked:b.PropTypes.func,isHidden:b.PropTypes.bool},TOP_BAR_REFS:{LEFT_SIDE:"topBarSideWrapperLeft",RIGHT_SIDE:"topBarSideWrapperRight",CENTER:"topBarSideWrapperCenter"},MIN_GAP_BETWEEN_LEFT_AND_RIGHT_CONTAINERS:30,APPEARANCE:{FULL:0,SAVE_AND_MOBILE_CHANGE_ICONS:1,PREVIEW_CHANGE_TO_ICON:2,HIDE_REDO:3,TRIM_PAGES_NAV_BUTTON:4,HIDE_UPGRADE_IN_MENU:5},MINIMAL_APPEARANCE_INDEX:5,areActionsLocked:!1,getInitialState:function(){return{appearance:this.APPEARANCE.FULL,zIndex:void 0}},shouldComponentUpdate:function(a){return!a.performingMouseMoveAction},lockActions:function(){this.areActionsLocked=!0},unlockActions:function(){this.areActionsLocked=!1},measurePhase:function(){var b=this.didWindowSizeChange();return k=a(window).width(),b},patchPhase:function(a){0!==a&&this.updateTopBarWidth(a)},componentDidUpdate:function(a,b){var c=j(b.appearance-this.state.appearance);0!==c&&this.updateTopBarWidth(c)},toggleHideTools:function(){var a=this.getEditorAPI(),b=a.toolsControl.toggleHideTools(),c=b?d.bi.events.editor.hide_tools.hide_controls:d.bi.events.editor.hide_tools.show_controls;a.bi.event(c,{origin:"handle"})},getHideToolsTooltip:function(){return this.props.isHidden?"Toolbars_show_hover_label":"Toolbars_hide_hover_label"},updateTopBarWidth:function(a){var b=this.state.appearance;a>0&&(b=this.APPEARANCE.FULL);var c=this.getNonOverlappingAppearanceIndex(b);c!==this.state.appearance&&this.setState({appearance:c})},didWindowSizeChange:function(){var b=a(window).width();return j(b-k)},getNonOverlappingAppearanceIndex:function(a){if(!this.props.previewMode){var b=this.getGapBetweenLeftAndRightContainers(),c=b<this.MIN_GAP_BETWEEN_LEFT_AND_RIGHT_CONTAINERS;c&&(a=Math.min(a+1,this.MINIMAL_APPEARANCE_INDEX))}return a},getGapBetweenLeftAndRightContainers:function(){var b=a(this.refs[this.TOP_BAR_REFS.LEFT_SIDE].getDOMNode()),c=a(this.refs[this.TOP_BAR_REFS.RIGHT_SIDE].getDOMNode()),d=c.offset().left,e=b.offset().left+b.width();return d-e},onOuterClick:function(){if(e.keyboardShortcuts.getContext()===e.keyboardShortcuts.CONTEXTS.TOP_BAR){var a=e.keyboardShortcuts.CONTEXTS;e.keyboardShortcuts.setContext(this.props.previewMode?a.PREVIEW:a.EDITOR)}},handleTopBarClick:function(a){this.getEditorAPI().imageCrop.toggleCropMode(!1),this.isClickOnTopBarEmptySpace(a)&&this.setTopBarKeyboardContext(),this.props.onTopBarClicked&&this.props.onTopBarClicked()},isClickOnTopBarEmptySpace:function(a){var b=a.target.dataset;return b&&b.target===this.topBarClassName},setTopBarKeyboardContext:function(){e.keyboardShortcuts.setContext(e.keyboardShortcuts.CONTEXTS.TOP_BAR)},getTopBarByMode:function(a){var b=f.TOP_BARS[a],c=this.sortTopBarItemsByOrientation(b),d=this.createTopBarItems(c.left,this.createLeftTopBarItem,a,"left"),e=this.createTopBarItems(c.center,this.createLeftTopBarItem,a,"center"),g=this.createTopBarItems(c.right.reverse(),this.createRightTopBarItem,a,"right");return[].concat(e,d,g)},sortTopBarItemsByOrientation:function(a){var b={left:[],right:[],center:[]};return c.forEach(a,function(a){var c=this.getWidgetDefinitionByKey(a);c&&(a.orientation===f.ORIENTATION.LEFT?b.left.push(c):a.orientation===f.ORIENTATION.RIGHT?b.right.push(c):b.center.push(c))},this),b},getWidgetDefinitionByKey:function(a){return f.widgetMapping[a.comp]},createTopBarItems:function(a,b,d,e){var f=c.map(a,function(a,c){return b(a,c,d)});return this.createElementsWrapper(f,d,e)},createElementsWrapper:function(a,c,d){var e="topbar-side-"+c+"-"+d,f={displayName:"topBarSideWrapper",className:"top-bar-side-wrapper",key:e};return"right"===d?(f.style={right:0},f.ref=this.TOP_BAR_REFS.RIGHT_SIDE):"left"===d?(f.style={left:0},f.ref=this.TOP_BAR_REFS.LEFT_SIDE):"center"===d&&(f.style={width:"100%",textAlign:"center"},f.ref=this.TOP_BAR_REFS.CENTER),b.createElement("div",f,a)},createLeftTopBarItem:function(a,b,c){return this.createDynamicMenuItem(a,f.ORIENTATION.LEFT,b,c)},createRightTopBarItem:function(a,b,c){return this.createDynamicMenuItem(a,f.ORIENTATION.RIGHT,b,c)},createDynamicMenuItem:function(a,d,e,g){if(a&&a.compClass){d=d||f.ORIENTATION.LEFT;var h=a.compProps(this,d,e,g);if(h){var i=c.assign(h,{key:this.createTopBarWidgetKey(d,g,e)});return b.createElement(a.compClass,i)}}return null},createTopBarWidgetKey:function(a,b,c){return["topbar-w",a,b,c].join("-")},getMenuBarItems:function(a){var b=c.cloneDeep(a),d=this.popUpgradePackagesEntry(b),e=this.getEditorAPI();if(d&&this.isUpgradeShowing()){var f=d.upgradePanels.DEFAULT;f&&b.push(f)}return e.campaigns.personalSale.isActiveCampaign()&&this.isUpgradeShowing()&&g.updateMenuBarItemsAccordingToPersonalSaleCampaign(e,b),c.forEach(b,function(a){a.children=l(a)}),b},isUpgradeShowing:function(){var a=this.isUserPermittedToUpgrade()&&!this.getEditorAPI().wixStores.isSiteInWixStoreTestDrive();return a?this.isUpgradeSupportedInAppearanceState():!1},isUserPermittedToUpgrade:function(){return this.getEditorAPI().account.isUserOwner()},isUpgradeSupportedInAppearanceState:function(){return this.state.appearance<this.APPEARANCE.HIDE_UPGRADE_IN_MENU},onMenuOpened:function(){this.setState({zIndex:1750})},onMenuClosed:function(){this.setState({zIndex:void 0})},popUpgradePackagesEntry:function(a){return c.first(c.remove(a,function(a){return a&&"UPGRADE"===a.category}))},hideForZoomMode:function(){return this.getEditorAPI().editor.state.hideToolsAndMaintainStagePosition},render:i})}),define("rEditor/rootComps/leftBar/leftBarButton/leftBarButton.rt",["react/addons","lodash","symbols"],function(a,b,c){"use strict";return function(){return a.createElement("li",{className:this.getButtonClasses(),onClick:this.handleOnClick},this.shouldShowSelectedSvg()?a.createElement(c.symbol,b.assign({},{key:"selectedSvg"},this.getSelectedButtonSvgProps())):null,a.createElement(c.symbol,{name:this.props.symbolName,className:"icon"}),a.createElement("span",{className:"mask"}),a.createElement("span",{className:"text"},this.props.label),this.props.notificationCount>0?a.createElement("span",{key:"notificationCount",className:"notifications"},this.props.notificationCount):null)}}),define("rEditor/rootComps/leftBar/leftBarButton/leftBarButton",["lodash","react","core","rEditor/rootComps/leftBar/leftBarButton/leftBarButton.rt","symbols"],function(a,b,c,d){"use strict";var e="/left_bar_button_clicked";return b.createClass({displayName:"leftBarButton",mixins:[c.mixins.editorAPIMixin],propTypes:{className:b.PropTypes.string.isRequired,symbolName:b.PropTypes.string.isRequired,label:b.PropTypes.string.isRequired,isSelected:b.PropTypes.bool.isRequired,isMobileEditor:b.PropTypes.bool.isRequired,onClick:b.PropTypes.func.isRequired,isMenuCollapsed:b.PropTypes.bool,notificationCount:b.PropTypes.number.isRequired,isFirstPanel:b.PropTypes.bool,collapseOnClick:b.PropTypes.bool,isButtonOpen:b.PropTypes.bool},getInitialState:function(){return{wasButtonClicked:this.props.isMenuCollapsed&&this.props.isButtonOpen&&this.getEditorAPI().getUserPreferences().site.get(this.props.className+e)}},getButtonClasses:function(){var a=[];return a.push("left-bar-item"),a.push(this.props.className),this.props.isSelected&&a.push("selected"),this.props.isFirstPanel&&a.push("first-panel"),this.props.collapseOnClick&&!this.state.wasButtonClicked&&a.push("wait-for-click"),a.join(" ")},handleOnClick:function(){this.props.collapseOnClick&&(this.setState({wasButtonClicked:!0}),this.getEditorAPI().getUserPreferences().site.set(this.props.className+e,!0)),this.props.onClick&&this.props.onClick()},getSelectedButtonSvgProps:function(){var a,b;return this.props.isFirstPanel?(a="leftBarButtonEarTop",b="ear-top"):(a="leftBarButtonEarMiddle",b="ear-middle"),{name:a,className:"ear "+b}},shouldShowSelectedSvg:function(){return this.props.isMenuCollapsed&&this.props.isSelected},render:d})}),define("rEditor/rootComps/leftBar/leftBar.rt",["react/addons","lodash","rEditor/rootComps/leftBar/leftBarButton/leftBarButton","util"],function(a,b,c,d){"use strict";function e(a){this.checkOverlap(b.clone(a))}function f(){this.resetQuickTip()}function g(a,b,c){this.handleOnClick(a.panelName,a.panelProps)}function h(b,e){return a.createElement(c,{key:b.panelName,label:d.translate(b.label),isMenuCollapsed:this.isMenuCollapsed(),className:b.className,symbolName:b.symbolName,isMobileEditor:this.props.isMobileEditor,isSelected:this.state.activePanelName===b.panelName,onClick:g.bind(this,b,e),isFirstPanel:0===e,collapseOnClick:b.collapseOnClick,",":!0,isButtonOpen:b.isButtonOpen,notificationCount:this.getNotificationCount(b.panelName)})}return function(){return a.createElement("div",{className:b.keys(b.pick({"left-bar":!0,"is-hidden":this.props.isHidden,"half-opacity":this.props.halfOpacityTools,"menu-collapsed-wrapper":this.isMenuCollapsed()},b.identity)).join(" "),style:{left:this.getLeftOffset()},onContextMenu:this.props.onContextMenu,onMouseMove:e.bind(this),onMouseEnter:f.bind(this),ref:"checkOverlapTarget"},a.createElement.apply(this,["ul",{ref:"buttons",className:b.keys(b.pick({"left-bar-items":!0,"menu-collapsed":this.isMenuCollapsed(),"menu-opened":this.isMenuOpened()},b.identity)).join(" ")},b.map(this.getMenuItems(),h.bind(this))]))}}),define("rEditor/rootComps/leftBar/config/leftBarData",["util"],function(a){"use strict";return{desktop:[{panelName:"rEditor.panels.backgroundPanel",panelProps:{},label:"LEFTBAR_BACKGROUND_LABEL",className:"bg-panel",symbolName:"leftBarBackgroundPanel"},{panelName:"addPanelInfra.addPanel",panelProps:{},label:"LEFTBAR_ADD_LABEL",className:"add-panel",symbolName:"leftBarAddPanel"},{panelName:"tpa.compPanels.appMarketPanel",panelProps:{urlParams:{openMarketOrigin:"market_button"},openPanelBiEvent:a.bi.events.OPEN_MARKET_CLICK,openPanelBiParams:{referral_info:"market_button"}},label:"app_market_button_text",className:"app-market-panel",symbolName:"leftBarAppMarketPanel"},{panelName:"rEditor.panels.myMediaPanel",panelProps:{},label:"LEFTBAR_MY_UPLOADS_LABEL",className:"my-uploads-panel",symbolName:"leftBarMyUploadsPanel"}],mobile:[{panelName:"rEditor.panels.backgroundPanel",panelProps:{},label:"LEFTBAR_BACKGROUND_LABEL",className:"bg-panel",symbolName:"leftBarBackgroundPanel"},{panelName:"mobileEditor.mobileElementsPanel",panelProps:{},label:"mobile_elements_panel_title",className:"mobile-elements-panel",symbolName:"mobileView"},{panelName:"mobileEditor.hiddenItemsPanel",panelProps:{},label:"mobile_hidden_items_panel_title",className:"hidden-items-panel",symbolName:"hiddenComp"}]}}),define("rEditor/rootComps/mixins/findOverlappedComponentMixin",["lodash","jquery","react","util","core","baseUI","experiment!hideAllToolsQuickTip"],function(a,b,c,d,e,f,g){"use strict";var h=3e3,i=15e3,j=70;return{intersectionComp:null,hideQuickTipTimer:null,getComponentsLayoutByMouseEvent:function(b){var c=this.getEditorAPI(),d=c.components,e=c.selection.getComponentsUnderClick(b.pageX,b.pageY);return a.map(e,function(a){return d.layout.getRelativeToScreenConsideringScroll(a).bounding})},calcOverlapPercentage:function(a,b){var c=d.math.getSquaresIntersection(b,{x:a.offsetLeft,y:a.offsetTop-this.getEditorAPI().editorConfig.editingAreaLayout.top,width:a.offsetWidth,height:a.offsetHeight});return c?(this.intersectionComp=b,c.width*c.height/(b.height*b.width)*100):0},isOverlapping:function(a){var b=this.getComponentsLayoutByMouseEvent(a),c=0,d=this.refs.checkOverlapTarget;if(!d)return!1;var e=d.getDOMNode();for(var f in b)if(b.hasOwnProperty(f)&&(c=this.calcOverlapPercentage(e,b[f]),c>j))return!0;return!1},hideQuickTip:function(){clearTimeout(this.hideQuickTipTimer),this.getEditorAPI().toolsControl.toggleHalfOpacityTools(!1),this.getEditorAPI().hideFloatingBubble()},showQuickTip:function(a){var d=this.getEditorAPI(),g=b(window).width()/2,h=a.pageX<g?2:-2,i=c.createElement(f.popoverTemplates.quickTip,{text:"toolbars_hide_tooltip_text",linkActionText:"toolbars_hide_tooltip_link",linkAction:this.quickTipLinkAction,linkMouseEnter:this.quickTipLinkMouseEnter,linkMouseLeave:this.quickTipLinkMouseLeave,symbol:"idea-bulb",closeAction:this.quickTipCloseAction}),j={height:100,width:this.intersectionComp.width,top:a.pageY-d.ui.scroll.getScroll().scrollTop,left:this.intersectionComp.x+h},k={noArrow:!0,shake:!0,behindPopUps:!0,hideMethod:d.toolsControl.toggleHalfOpacityTools.bind(this,!1),alignment:f.uiConstants.TOOLTIP.ALIGNMENT.RIGHT},l=!0;d.showFloatingBubble(i,j,k,l),d.bi.event(e.bi.events.editor.hide_tools.show_controls_tooltip_appearance)},moveQuickTip:function(){var a=this.getEditorAPI(),d=b(window).width()/2,e=284,g=c.createElement(f.popoverTemplates.quickTip,{text:"toolbars_show_tooltip_text",symbol:"idea-bulb",closeAction:this.quickTipCloseAction}),h={height:a.editorConfig.editingAreaLayout.top+30,width:e,top:0,left:d-e/2},i={noArrow:!0,behindPopUps:!0,shouldHaveTransition:!0},j=!0;a.showFloatingBubble(g,h,i,j),a.toolsControl.toggleHideToolsBtnBlink(!0)},quickTipCloseAction:function(){var a=this.getEditorAPI();this.hideQuickTip(),a.bi.event(e.bi.events.editor.hide_tools.show_controls_tooltip_close);var b=a.userPreferences.session.get("hideToolsQuickTipShown")||0;a.userPreferences.session.set("hideToolsQuickTipShown",b+1)},quickTipLinkAction:function(){var a=this.getEditorAPI(),b=a.toolsControl;b.toggleHalfOpacityTools(!1),b.toggleHideTools(!0),a.bi.event(e.bi.events.editor.hide_tools.hide_controls,{origin:"tooltip"}),this.moveQuickTip(),a.userPreferences.site.set("hideToolsQuickTipShown",!0)},quickTipLinkMouseEnter:function(){this.getEditorAPI().toolsControl.toggleHalfOpacityTools(!0)},quickTipLinkMouseLeave:function(){this.getEditorAPI().toolsControl.toggleHalfOpacityTools(!1)},decideWhetherToHideQuickTip:function(){this.getEditorAPI().isMouseOverBubble()?(clearTimeout(this.hideQuickTipTimer),this.hideQuickTipTimer=setTimeout(this.decideWhetherToHideQuickTip,i)):this.hideQuickTip()},resetQuickTip:function(){this.setState({quickTipAlreadyShown:!1})},checkOverlap:function(a){var b=this.getEditorAPI(),c=b.userPreferences.session,d=b.userPreferences.site,e=d.get("hideToolsQuickTipShown")||c.get("hideToolsQuickTipShown")>4;g&&(e||this.state.quickTipAlreadyShown||!this.isOverlapping(a)||(this.showQuickTip(a),this.setState({quickTipAlreadyShown:!0}),this.hideQuickTipTimer=setTimeout(this.decideWhetherToHideQuickTip,i)))},componentDidMount:function(){var b=this.getEditorAPI(),c={leading:!1};b.registeredHideBubbleOnPreview||(b.registerToGoToPreview(this.hideQuickTip),b.registeredHideBubbleOnPreview=!0),this.checkOverlap=a.throttle(this.checkOverlap,h,c)}}}),define("rEditor/rootComps/leftBar/leftBar",["lodash","react","jquery","core","panels","baseUI","rEditor/rootComps/leftBar/leftBar.rt","rEditor/rootComps/leftBar/config/leftBarData","rEditor/rootComps/mixins/findOverlappedComponentMixin","experiment!enableMyUploadsButton"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k={panelName:"rEditor.panels.myMediaPanel",panelProps:{},label:"LEFTBAR_MY_UPLOADS_LABEL",className:"my-uploads-panel",symbolName:"leftBarMyUploadsPanel"};return b.createClass({displayName:"leftBar",mixins:[d.mixins.editorAPIMixin,i],propTypes:{leftBarState:b.PropTypes.object.isRequired,isMobileEditor:b.PropTypes.bool.isRequired,openPanels:b.PropTypes.array.isRequired,isEnabled:b.PropTypes.bool.isRequired,isHidden:b.PropTypes.bool},getInitialState:function(){return{activePanelName:void 0}},componentDidMount:function(){this.props.isHidden&&c(this.getDOMNode()).css({left:this.getLeftOffset()})},shouldComponentUpdate:function(b,c){return!a.isEqual(this.props,b)||!a.isEqual(this.state,c)},getMenuItems:function(){var b=[],c=this.props.leftBarState.superApps,d=[];return j&&d.push(k),b=this.props.isMobileEditor?h.mobile.concat(d,a.sortBy(c.mobile,"order")):h.desktop.concat(d,a.sortBy(c.desktop,"order")),b.forEach(function(a,b){a.panelProps=a.panelProps||{},a.panelProps.panelIndex=b}),a.compact(b)},getNotificationCount:function(a){return this.props.leftBarState.notifications[a]||0},componentWillReceiveProps:function(b){var c=a.find(b.openPanels,{frameType:"leftPanelFrame"});c?(this.setState({activePanelName:c.name}),this.props.leftBarState.isCollapsed||this.getEditorAPI().leftBar.collapseMenu()):this.setState({activePanelName:void 0})},handleOnClick:function(a,b){var c=this.getEditorAPI();this.props.isEnabled&&a!==this.state.activePanelName&&(c.leftBar.collapseMenu(),e.panelManager.openPanel(a,b),b.openPanelBiEvent&&c.bi.event(b.openPanelBiEvent,b.openPanelBiParams)),c.hideFloatingBubble()},isMenuCollapsed:function(){return this.props.leftBarState.isCollapsed},isMenuOpened:function(){return!!this.state.activePanelName},getButtonsBoundingRect:function(){return this.isMenuCollapsed()?f.uiConstants.LEFTBAR_BTN_WIDTH_COLLAPSED:this.refs.buttons.getDOMNode().getBoundingClientRect()},getLeftOffset:function(){var a="-1000px",b=8;if(this.props.isHidden){if(this.isMounted()){var c=this.getDOMNode().offsetWidth;return-(c+b)+"px"}return a}return""},render:g})}),define("rEditor/rootComps/mixins/hiddenableMixin",["jquery","lodash","util"],function(a,b,c){"use strict";var d=c.singlePassDOMReadWriteMixin;return{mixins:[d],componentWillMount:function(){this.lastCustomXPosition=null,this.shouldCompSlideRight=!0},componentWillReceiveProps:function(b){!b.toolsHidden&&this.props.toolsHidden&&this.state.isCustomPosition&&a(this.getDOMNode()).css({left:this.lastCustomXPosition})},measurePhase:function(){return this.shouldCompSlideRight=this.shouldSlideRight(),this.getComponentPosition(this.lastCustomXPosition)},patchPhase:function(b){a(this.getDOMNode()).css(b)},shouldSlideRight:function(){var b=a(this.getDOMNode()),c=b.offset().left,d=b.width()/2,e=a(window).width()/2;return c+d>e},updateLastCustomXPosition:function(a){this.lastCustomXPosition=a},getHiddenableClasses:function(){return{"hide-tools":this.props.toolsHidden,
"show-tools":!this.props.toolsHidden,"slide-right":this.shouldCompSlideRight,"slide-left":!this.shouldCompSlideRight,"half-opacity":this.props.halfOpacityTools}}}}),define("rEditor/rootComps/mixins/keepInViewportMixin",["jquery","lodash","util","core"],function(a,b,c,d){"use strict";return{fitPositionToScreen:function(a,b,d){var e=this.getDragLimits(b),f=this.getDOMNode(),g=f.getBoundingClientRect(),h=g.top,i=a||g.left,j=e.x[1]-g.width-d+b,k=c.math.ensureWithinLimits(i,e.x[0],j),l=c.math.ensureWithinLimits(h,e.y[0],e.y[1]);return{left:k,top:l}},getDragLimits:function(a){var b=d.utils.stageUtils.getStageLayout(),c=d.constants.PANELS.PANEL_SIZE_TO_KEEP_IN_VIEW,e=this.getDOMNode(),f=e.clientHeight;return{x:[b.left+a,b.right-a],y:[b.top+a,b.bottom+f-c]}}}}),define("rEditor/rootComps/toolBar/toolSelector.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:b.keys(b.pick(this.getClasses(),b.identity)).join(" "),style:{position:"relative"}},this.state.isMenuDisplayed?a.createElement("div",{className:b.keys(b.pick(this.getDropDownClasses(),b.identity)).join(" "),key:"menuDropDown",onMouseLeave:this.hideMenu},this.props.children):null,a.createElement(c.tooltip,{disabled:!this.props.tooltip,value:this.props.tooltip,className:this.props.tooltipClass,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:this.props.disabled},b.identity)).join(" "),onClick:this.displayMenu},a.createElement(c.symbol,{name:this.props.symbol}))),this.props.children&&this.props.children.length>1?a.createElement("div",{key:"smallIndicator",className:"small-indicator"}):null)}}),define("rEditor/rootComps/toolBar/toolSelector",["react","lodash","rEditor/rootComps/toolBar/toolSelector.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"toolSelector",propTypes:{symbol:a.PropTypes.string.isRequired,columns:a.PropTypes.number,onShow:a.PropTypes.func,tooltipClass:a.PropTypes.string,disabled:a.PropTypes.bool},getInitialState:function(){return{isMenuDisplayed:!1}},getDefaultProps:function(){return{columns:3,disable:!1}},displayMenu:function(){this.props.disabled||(this.setState({isMenuDisplayed:!0}),b.isFunction(this.props.onShow)&&this.props.onShow())},hideMenu:function(){var a=this;setTimeout(function(){a.setState({isMenuDisplayed:!1})},300)},getDropDownClasses:function(){var a={"drop-down":!0,disabled:this.props.disabled};return a["grid-"+this.props.columns+"-col"]=!0,a},getClasses:function(){var a={"tool-selector":!0};if(this.props.className){var c=this.props.className.split(" ");b.forEach(c,function(b){a[b]=!0})}return this.props.disabled&&(a.disabled=!0),a},render:c})}),define("rEditor/rootComps/toolBar/toolbarTop.rt",["react/addons","lodash","baseUI","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","core","rEditor/rootComps/toolBar/toolSelector"],function(a,b,c,d,e,f){"use strict";function g(a,b,c){this.moveForward()}function h(a,b,c){this.moveBackward()}function i(a,b,c){this.moveToFront()}function j(a,b,c){this.moveToBack()}function k(a,b,c){this.align("left")}function l(a,b,c){this.align("center")}function m(a,b,c){this.align("right")}function n(a,b,c){this.align("top")}function o(a,b,c){this.align("middle")}function p(a,b,c){this.align("bottom")}function q(a,b,c){this.distribute("horizontal")}function r(a,b,c){this.distribute("verticalAndHorizontal")}function s(a,b,c){this.distribute("vertical")}function t(a,b,c){this.matchSize("width")}function u(a,b,c){this.matchSize("heightAndWidth")}function v(a,b,c){this.matchSize("height")}function w(){var w=this.props.restrictions,x=e.bi,y=d.editor;return a.createElement("div",{},a.createElement("div",{className:"inner button-grid"},a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_copy",y.COPY.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!w.duplicatable},b.identity)).join(" "),onClick:this.handleCopy},a.createElement(c.symbol,{name:"toolbarCopy"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_paste",y.PASTE.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!this.props.pasteEnabled},b.identity)).join(" "),onClick:this.handlePaste},a.createElement(c.symbol,{name:"toolbarPaste"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_duplicate",y.DUPLICATE.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!w.duplicatable},b.identity)).join(" "),onClick:this.handleDuplicate},a.createElement(c.symbol,{name:"toolbarDuplicate"}))),a.createElement(c.tooltip,{value:this.getDeleteTooltipText(),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!w.removable},b.identity)).join(" "),onClick:this.handleDelete},this.isMobileEditor()?null:a.createElement(c.symbol,{key:"deleteSymbol",name:"toolbarDelete"}),this.isMobileEditor()?a.createElement(c.symbol,{key:"hideSymbol",name:"gfpp_hide"}):null))),a.createElement("div",{className:"seperator"}),a.createElement("div",{className:"inner button-grid"},a.createElement(f,{disabled:!(w.canMoveForward||w.canMoveBackward),symbol:"toolbarMoveForward",columns:2,tooltip:this.getInfoTooltip("toolbar_tooltip_arrange","toolbar_tooltip_arrange_info"),tooltipClass:"control-tooltip-small"},a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_arrange_move_forward",y.SEND_FORWARD.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!w.canMoveForward},b.identity)).join(" "),onClick:g.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarMoveForward"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_arrange_move_backward",y.SEND_BACKWARD.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!w.canMoveBackward},b.identity)).join(" "),onClick:h.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarMoveBackward"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_arrange_bring_to_front",y.SEND_TO_FRONT.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!w.canMoveForward},b.identity)).join(" "),onClick:i.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarMoveToFront"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_arrange_send_to_back",y.SEND_TO_BACK.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!w.canMoveBackward},b.identity)).join(" "),onClick:j.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarMoveToBack"})))),a.createElement(f,{disabled:!this.isAlignEnabled(),symbol:"toolbarAlignRight",columns:3,onShow:this.reportBI.bind(this,x.events.toolbar.TOOL_BAR_ALIGNMENT_CLICK,{}),tooltip:this.getInfoTooltip("toolbar_tooltip_align","toolbar_tooltip_align_info"),tooltipClass:"control-tooltip-small"},a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_align_left"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:k.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarAlignLeft"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_align_center"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:l.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarAlignCenter"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_align_right"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:m.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarAlignRight"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_align_top"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:n.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarAlignTop"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_align_middle"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:o.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarAlignMiddle"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_align_bottom"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:p.bind(this,w,x,y)},a.createElement(c.symbol,{name:"toolbarAlignBottom"})))),a.createElement(f,{key:"distributeButtons",disabled:!this.isDistributeEnabled(),symbol:"distribute-vertical-btn-bld",columns:3,onShow:this.reportBI.bind(this,x.events.toolbar.TOOL_BAR_DISTRIBUTION_CLICK,{}),tooltip:this.getInfoTooltip("toolbar_tooltip_distribute","toolbar_tooltip_distribute_info"),tooltipClass:"control-tooltip-small"},a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_distribute_horizontally"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:q.bind(this,w,x,y)},a.createElement(c.symbol,{name:"distribute-horizontal-btn-bld"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_distribute_both"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:r.bind(this,w,x,y)},a.createElement(c.symbol,{name:"distribute-hw-btn-bld"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_distribute_vertically"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:s.bind(this,w,x,y)},a.createElement(c.symbol,{name:"distribute-vertical-btn-bld"})))),a.createElement(f,{key:"matchSizeButtons",disabled:!this.isMatchSizeEnabled(),symbol:"mech-to-height-btn-bld",columns:3,onShow:this.reportBI.bind(this,x.events.toolbar.TOOL_BAR_MATCH_SIZE_CLICK,{}),tooltip:this.getInfoTooltip("toolbar_tooltip_match_size","toolbar_tooltip_match_size_info"),tooltipClass:"control-tooltip-small"},a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_match_size_width"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:t.bind(this,w,x,y)},a.createElement(c.symbol,{name:"mech-to-width-btn-bld"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_match_size_both"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:u.bind(this,w,x,y)},a.createElement(c.symbol,{name:"mech-hw-btn-bld"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_match_size_height"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:v.bind(this,w,x,y)},a.createElement(c.symbol,{name:"mech-to-height-btn-bld"}))))))}return function(){return w.apply(this,[])}}),define("rEditor/rootComps/toolBar/toolbarTop",["react","lodash","baseUI","panels","core","util","rEditor/rootComps/toolBar/toolbarTop.rt","experiment"],function(a,b,c,d,e,f,g,h){"use strict";var i=e.bi;return a.createClass({displayName:"toolbarTop",mixins:[e.mixins.editorAPIMixin],propTypes:{restrictions:a.PropTypes.object,selectedComponent:a.PropTypes.arrayOf(a.PropTypes.object)},shouldComponentUpdate:function(a){return!b.isEqual(a,this.props)},getShortcutTooltip:function(b,d){return a.createElement(c.popoverTemplates.keyboardShortcutTooltip,{label:b,shortcut:d})},getDeleteTooltipText:function(){var a=this.isMobileEditor()?"toolbar_tooltip_hide":"toolbar_tooltip_delete";return this.props.restrictions.removable?this.getShortcutTooltip(a,f.translate("toolbar_tooltip_delete_shortcut")):this.getDisabledDeleteTooltipText(a,f.translate("toolbar_tooltip_delete_shortcut"))},getDisabledDeleteTooltipText:function(a,b){var c=this.getEditorAPI(),d=c.tooltipTextService.getComponentTooltipText(this.props.selectedComponent,"DELETE");return d?d:this.getShortcutTooltip(a,b)},getInfoTooltip:function(b,d){return a.createElement(c.popoverTemplates.titleBodyAndLinkTooltip,{title:b,text:d})},handleCopy:function(){if(this.props.restrictions.duplicatable){var a=this.getEditorAPI(),c=a.bi.getComponentsBIParams(this.props.selectedComponent);b.forEach(c,this.assignToolbarSpecificBI.bind(null,"origin")),a.bi.reportBI(i.events.rightClickMenu.COPY,c),this.getEditorAPI().components.copy(this.props.selectedComponent)}},handlePaste:function(){if(this.props.pasteEnabled){var a=this.getEditorAPI(),c=a.bi.getComponentsBIParams(this.props.selectedComponent);b.forEach(c,this.assignToolbarSpecificBI.bind(null,"origin")),d.panelManager.closeAllPanels(),a.components.paste(),a.history.add("component - paste"),a.bi.reportBI(i.events.rightClickMenu.PASTE,c)}},handleDuplicate:function(){if(this.props.restrictions.duplicatable){var a=this.getEditorAPI(),c=a.selection.getSelectedComponents(),d=a.bi.getComponentsBIParams(c);b.forEach(d,this.assignToolbarSpecificBI.bind(null,"origin")),a.components.duplicate(c),a.history.add("component - duplicate"),a.bi.reportBI(i.events.rightClickMenu.DUPLICATE,d)}},handleDelete:function(){if(this.props.restrictions.removable){var a=this.getEditorAPI(),c=a.bi.getComponentsBIParams(this.props.selectedComponent);b.forEach(c,this.assignToolbarSpecificBI.bind(null,"removal_method")),a.components.remove(this.props.selectedComponent),a.history.add("component - remove"),a.bi.reportBI(i.events.editor.component_removed,c)}},isMobileEditor:function(){return this.getEditorAPI().isMobileEditor()},moveToFront:function(){var a=this.getEditorAPI();a.components.arrangement.moveToFront(this.props.selectedComponent),a.bi.event(i.events.rightClickMenu.BRING_TO_FRONT,{origin:"toolbar"})},moveForward:function(){var a=this.getEditorAPI();a.components.arrangement.moveForward(this.props.selectedComponent),a.bi.event(i.events.rightClickMenu.MOVE_FORWARD,{origin:"toolbar"})},moveToBack:function(){var a=this.getEditorAPI();a.components.arrangement.moveToBack(this.props.selectedComponent),a.bi.event(i.events.rightClickMenu.SEND_TO_BACK,{origin:"toolbar"})},moveBackward:function(){var a=this.getEditorAPI();a.components.arrangement.moveBackward(this.props.selectedComponent),a.bi.event(i.events.rightClickMenu.MOVE_BACKWARDS,{origin:"toolbar"})},isAlignEnabled:function(){var a=!h.isOpen("se_screenWidthOff")&&h.isOpen("exp171");return a?!!this.props.selectedComponent&&b.every(e.constants.COMP_ALIGNMENT_OPTIONS,this.getEditorAPI().components.alignment.canAlign.bind(this,this.props.selectedComponent)):this.props.restrictions.alignable},align:function(a){var b=this.getEditorAPI();b.components.alignment.align(this.props.selectedComponent,a),b.bi.event(i.events.toolbar.TOOL_BAR_ALIGNMENT_MENU_CLICK,{category:a})},isDistributeEnabled:function(){var a=!h.isOpen("se_screenWidthOff")&&h.isOpen("exp171");return a?!!this.props.selectedComponent&&b.every(e.constants.COMP_ALIGNMENT_OPTIONS,this.getEditorAPI().components.multiComponents.canDistribute.bind(this,this.props.selectedComponent)):this.getEditorAPI().multiselect.count(this.props.selectedComponent)>2},distribute:function(a){var b=this.getEditorAPI();b.components.multiComponents.distribute(this.props.selectedComponent,a),b.bi.event(i.events.toolbar.TOOL_BAR_DISTRIBUTION_MENU_CLICK,{category:a})},isMatchSizeEnabled:function(){var a=!h.isOpen("se_screenWidthOff")&&h.isOpen("exp171");return a?!!this.props.selectedComponent&&b.every(e.constants.COMP_MATCH_SIZE_OPTIONS,this.getEditorAPI().components.multiComponents.canMatchSize.bind(this,this.props.selectedComponent)):this.getEditorAPI().multiselect.isMultiselect(this.props.selectedComponent)},matchSize:function(a){var b=this.getEditorAPI();b.components.multiComponents.matchSize(this.props.selectedComponent,a),b.bi.event(i.events.toolbar.TOOL_BAR_MATCH_SIZE_MENU_CLICK,{category:a})},assignToolbarSpecificBI:function(a,c){var d={};d[a]="toolbar",b.assign(c,d)},reportBI:function(a,b){this.getEditorAPI().bi.event(a,b)},render:g})}),define("rEditor/rootComps/toolBar/toolBar.rt",["react/addons","lodash","baseUI","util","rEditor/rootComps/toolBar/toolbarTop"],function(a,b,c,d,e){"use strict";function f(a,c){this.checkOverlap(b.clone(c))}function g(a){this.resetQuickTip()}function h(a,b){this.startDrag(b,this.getDragLimits())}function i(a,b){this.rotateComponent("rotationInDegrees",b)}function j(a,b){this.resizeComponent("width",b)}function k(a,b){this.resizeComponent("height",b)}function l(a,b){this.moveComponent("x",b)}function m(a,b){this.moveComponent("y",b)}function n(){var n=this.compLayout;return a.createElement("div",{className:b.keys(b.pick(this.getClasses(),b.identity)).join(" "),onMouseMove:f.bind(this,n),onMouseEnter:g.bind(this,n),ref:"checkOverlapTarget",onContextMenu:this.props.onContextMenu},a.createElement("div",{className:"header"},a.createElement("div",{className:"drag-zone",onMouseDown:h.bind(this,n)},a.createElement("span",{className:"drag-handle"},a.createElement(c.symbol,{name:"toolbarDragHandle"}))),a.createElement("button",{className:"help",onClick:this.onHelp},"?"),a.createElement("span",{className:"close",onClick:this.onClose},a.createElement(c.symbol,{name:"toolbarClose"}))),a.createElement("div",{className:"header-seperator"}),a.createElement(e,{restrictions:this.restrictions,selectedComponent:this.props.selectedComponent,pasteEnabled:this.isPasteEnabled()}),a.createElement("div",{className:"seperator"}),a.createElement("div",{className:"inner form"},a.createElement("label",{"data-input-title":"input_rotation",className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_rotation",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{},a.createElement(c.symbol,{name:"toolbarRotation"}))),a.createElement(c.stepper,{className:"small degrees",disabled:!this.restrictions.rotatable,min:-(1/0),max:1/0,value:parseInt(n.rotationInDegrees,10),units:"°",onChange:i.bind(this,n)}))),a.createElement("div",{className:"seperator"}),a.createElement("div",{className:"inner form"},a.createElement("span",{className:"layout-title"},d.translate("toolbar_size")),a.createElement("label",{className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_width",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"label",style:{paddingRight:"4px"}},d.translate("toolbar_width")+":")),a.createElement(c.stepper,{disabled:!this.restrictions.horizontallyResizable,className:"small",value:parseInt(n.width,10),min:-(1/0),max:1/0,onChange:j.bind(this,n)})),a.createElement("label",{className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_height",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"label"},d.translate("toolbar_height")+":")),a.createElement(c.stepper,{disabled:!this.restrictions.verticallyResizable,className:"small",min:-(1/0),max:1/0,value:parseInt(n.height,10),onChange:k.bind(this,n)}))),a.createElement("div",{className:"seperator"}),a.createElement("div",{className:"inner form"},a.createElement("span",{className:"layout-title"},d.translate("toolbar_position")),a.createElement("label",{"data-input-title":"input_x",className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_x_position",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"label"},d.translate("toolbar_x")+":")),a.createElement(c.stepper,{disabled:!this.restrictions.horizontallyMovable,className:"small",min:-(1/0),max:1/0,value:parseInt(n.bounding.x,10),onChange:l.bind(this,n)})),a.createElement("label",{"data-input-title":"input_y",className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_y_position",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"label"},d.translate("toolbar_y")+":")),a.createElement(c.stepper,{disabled:!this.restrictions.verticallyMovable,className:"small",min:-(1/0),max:1/0,value:parseInt(n.bounding.y,10),onChange:m.bind(this,n)}))),a.createElement("div",{className:"seperator",key:"seperator-inner-form"}),a.createElement("div",{className:"inner form",key:"inner-form"},this.restrictions.canBeFixed?null:a.createElement("div",{key:"containable"},a.createElement("span",{className:"layout-title show-on-all-pages-title"},d.translate("toolbar_show_on_all_pages")),a.createElement("label",{className:"row show-on-all-pages-row"},a.createElement(c.toggle,{name:"switch",className:"show-on-all-pages",key:"showOnAllPages",disabled:null===this.props.selectedComponent||!this.restrictions.canToggleShowOnAllPages,value:this.isShowOnAllPages(),onChange:this.handleShowOnAllPages,size:"medium"}))),this.restrictions.canBeFixed?a.createElement("div",{key:"canBeFixed"},a.createElement("span",{className:"layout-title show-on-all-pages-title"},d.translate("toolbar_fixed_position")),a.createElement("label",{className:"row show-on-all-pages-row"},a.createElement(c.toggle,{name:"switch",className:"show-on-all-pages",key:"fixedPosition",value:this.restrictions.isFixed,onChange:this.handleFixed,size:"medium"}))):null))}return function(){return n.apply(this,[])}}),define("rEditor/rootComps/toolBar/toolBar",["react","lodash","jquery","util","panels","core","baseUI","rEditor/rootComps/mixins/findOverlappedComponentMixin","rEditor/rootComps/mixins/hiddenableMixin","rEditor/rootComps/mixins/keepInViewportMixin","rEditor/rootComps/toolBar/toolBar.rt"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function p(a,b,c){return a[b]+c-a.bounding[b]}function q(a){var b=this.getEditorAPI(),c=b.components.layout.isHorizontallyStretchedToScreen(a);this.getLayout=c?b.components.layout.getRelativeToScreen:b.components.layout.getRelativeToStructure,this.updateLayout=c?b.components.layout.updateRelativeToScreen:b.components.layout.updateRelativeToStructure,this.updateLayoutProportionally=c?b.components.layout.updateRelativeToScreenAndPreserveProportions:b.components.layout.updateRelativeToStructureAndPreserveProportions}function r(a){var b=c(a).height(),d=(window.innerHeight-b)/2;return{right:m,top:d}}var l=f.bi,m=84,n=10,o={rotationInDegrees:0,width:0,height:0,x:0,y:0,bounding:{x:0,y:0}};return a.createClass({displayName:"toolBar",mixins:[f.mixins.editorAPIMixin,d.draggableMixin,i,j,h],propTypes:{selectedComponent:a.PropTypes.arrayOf(a.PropTypes.object),toolsHidden:a.PropTypes.bool},getInitialState:function(){var a=this.getEditorAPI();return this.props.selectedComponent?(q.call(this,this.props.selectedComponent),this.compLayout=this.getLayout(this.props.selectedComponent),this.restrictions=a.getCompRestrictions(this.props.selectedComponent)):this.updateNoSelectedComponent(),{}},componentWillReceiveProps:function(a){var b=a.selectedComponent,c=this.getEditorAPI();b?(q.call(this,b),this.compLayout=this.getLayout(b),this.restrictions=c.getCompRestrictions(b)):this.updateNoSelectedComponent()},getComponentPosition:function(a){return this.state.isCustomPosition?this.fitPositionToScreen(a,n,m):r(this.getDOMNode())},onDragEnd:function(){this.updateLastCustomXPosition(this.draggable.nodePosition.x)},getClasses:function(){return b.assign({"rootcomp-toolbar":!0,hidden:this.props.hidden},this.getHiddenableClasses())},updateNoSelectedComponent:function(){this.compLayout=o,this.restrictions={}},resizeComponent:function(a,b){this.getEditorAPI().bi.event(l.events.editBox.RESIZE,{origin:"toolbar"}),this.setComponentLayoutChange(a,b)},moveComponent:function(a,b){this.getEditorAPI().bi.event(l.events.editBox.MOVE_COMPONENT,{origin:"toolbar"}),this.setComponentLayoutChange(a,b)},rotateComponent:function(a,b){var c=parseInt(b,10);0===c?this.getEditorAPI().bi.event(l.events.editBox.CANCEL_ROTATE_COMPONENT):this.getEditorAPI().bi.event(l.events.editBox.ROTATE_COMPONENT,{origin:"toolbar",value:c}),this.setComponentLayoutChange(a,b)},setComponentLayoutChange:function(a,c){var d=this.getEditorAPI();if(c=parseInt(c,10),isNaN(c))return void this.forceUpdate();"y"!==a&&"x"!==a||(c=p(this.compLayout,a,c));var e=d.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(this.props.selectedComponent),f=this.getLayout(e);if(f[a]!==c){var g={};if(g[a]=c,d.multiselect.isMultiselect(e)||d.components.is.group(e)){var h=f.width/f.height,i=d.components.layout.getProportionStructure(e);"height"===a?g.width=c*h:"width"===a&&(g.height=c/h),g=b.mapValues(g,b.round),this.updateLayoutProportionally(e,g,i,!0)}else this.updateLayout(e,g,!0);d.history.add("toolbar - set selected component layout - "+a)}},onClose:function(){this.getEditorAPI().toolbar.toggleToolbar()},onHelp:function(){var a={origin:f.constants.BI.HELP.ORIGIN.TOOLBAR,component:this.getEditorAPI().selection.getSelectedComponentType(),learn_more:!1};e.panelManager.openHelpCenter("4ab49cd7-2ea4-4873-904e-f65d17d2f1dd",null,null,a)},handleShowOnAllPages:function(){var a=this.getEditorAPI();if(this.props.selectedComponent&&this.restrictions.canShowOnAllPages){var b=a.components.toggleShowOnAllPages(this.props.selectedComponent);a.bi.event(l.events.rightClickMenu.SHOW_ON_ALL_PAGES,{new_status:b,origin:"toolbar"})}},isShowOnAllPages:function(){if(null===this.props.selectedComponent||void 0===this.props.selectedComponent)return!1;var a=this.getEditorAPI();return a.components.isShowOnAllPages(this.props.selectedComponent)},handleFixed:function(){this.getEditorAPI().selectedComponent.toggleFixedPosition()},isPasteEnabled:function(){var a=this.getEditorAPI();return a.clipboardContainsComp()&&a.isDesktopEditor()&&!a.components.layout.isPinned(this.props.selectedComponent)},render:k})}),define("rEditor/rootComps/gfpp/gfppModel",["lodash","gfppData","experiment"],function(a,b,c){"use strict";function j(b,c,d){return a.isFunction(b)?b(c,d):b}function k(b,c,d){return b?(b=a.cloneDeep(b),a.forEach(b,function(b){a.forEach(b,function(f,g){a.includes(e,g)||(b[g]=j(f,c,d))})}),b):null}function l(a,b,c){var d=b.isMobileEditor(),e=d?a.mobileMainActions:a.mainActions;return e=j(e,b,c),k(e,b,c)}function m(a,b,c){var d=b.isMobileEditor(),e=d?a.mobileExtraActions:a.extraActions;return e=j(e,b,c),k(e,b,c)}function n(b,c,d){var e=c.isMobileEditor(),g=e?b.mobileEnabledActions:b.enabledActions;g=a.clone(j(g,c,d)||[]),g=a.union(g,f);var h=j(b.presetActions,c,d);return h=a.merge({},a.pick(i,g),a.pick(h,g)),k(h,c,d)}function o(c,d){var e=c.isMobileEditor();return d.helpId=e?d.mobileHelpId:d.helpId,d.isSelected=a.isUndefined(d.isSelected)?b.utils.isHelpPanelOpen(d.helpId):d.isSelected,d}function p(b,c){return a.last(b.components.getType(c).split("."))}function q(a,c){var d=p(a,c),e=b.getComponentData(d)||h,f=l(e,a,c),g=m(e,a,c),i=n(e,a,c);return i.help&&(i.help=o(a,i.help)),i=r(i,a,c),{mainActions:f,extraActions:g,presetActions:i}}function r(b,e,f){var g=[];if(b[d.ACTIONS.HIDE]&&(e.components.is.removable(f)||g.push(d.ACTIONS.HIDE)),b[d.ACTIONS.ANIMATION]){var h=a.some(d.ANIMATION_TYPES,function(a){return e.components.is.animatable(f,a)});h&&e.multiselect.areComponentsOfSamePage(f)||g.push(d.ACTIONS.ANIMATION)}if(b[d.ACTIONS.STRETCH]){var i=!c.isOpen("se_screenWidthOff")&&c.isOpen("exp171")&&e.components.layout.canBeStretched(f)&&!e.isMobileEditor();i||g.push(d.ACTIONS.STRETCH)}return b[d.ACTIONS.PIN_MODE]&&(e.components.layout.isPinned(f)||g.push(d.ACTIONS.PIN_MODE)),g.length?a.omit(b,g):b}var d=b.consts,e=["onClick","template","onTemplatePropsChange"],f=[d.ACTIONS.PIN_MODE,d.ACTIONS.STRETCH],g=[d.ACTIONS.SETTINGS,d.ACTIONS.LAYOUT,d.ACTIONS.ANIMATION,d.ACTIONS.HELP].concat(f),h={enabledActions:g},i={settings:{isSelected:b.utils.getPanelStateFn("settings"),tooltip:"gfpp_tooltip_settings",icon:"settings",onClick:b.utils.getTogglePanelFn("settings")},design:{isSelected:b.utils.getPanelStateFn("design"),tooltip:"gfpp_tooltip_design",icon:"design",onClick:b.utils.getTogglePanelFn("design")},layout:{isSelected:b.utils.getPanelStateFn("layout"),tooltip:"gfpp_tooltip_layout",icon:"layout",onClick:b.utils.getTogglePanelFn("layout")},filters:{isSelected:b.utils.getPanelStateFn("filters"),tooltip:"gfpp_tooltip_image_filters",icon:"filters",onClick:b.utils.getTogglePanelFn("filters",{origin:"gfpp"})},stretch:{isSelected:b.utils.getPanelStateFn("stretching"),tooltip:"gfpp_tooltip_stretch",icon:"gfpp_stretch",onClick:b.utils.getTogglePanelFn("stretching")},stretchForColumns:{isSelected:b.utils.getPanelStateFn("stretching"),tooltip:"gfpp_tooltip_stretch",icon:"gfpp_stretch",onClick:b.utils.getTogglePanelFn("stretching")},upgrade:{isSelected:!1,tooltip:"gfpp_tooltip_upgrade",icon:"",onClick:b.utils.getTogglePanelFn("upgrade")},crop:{isSelected:!1,isDisabled:function(a,c){return!b.utils.isCropAllowed(a,c)},tooltip:function(a,c){return b.utils.isCropAllowed(a,c)?"gfpp_tooltip_crop":"gfpp_tooltip_crop_disabled"},icon:"effects",onClick:function(a,c){b.utils.isCropAllowed(a,c)&&b.utils.openImageCrop(a,c)}},aviary:{isSelected:!1,tooltip:"gfpp_tooltip_imageeffects",icon:"effects",onClick:b.utils.openAviaryPanel},animation:{isSelected:b.utils.getPanelStateFn("animation"),isApplied:!1,tooltip:"gfpp_tooltip_animation",tooltip_active:"gfpp_tooltip_applied_animation",icon:"animation",onClick:b.utils.getTogglePanelFn("animation")},link:{isSelected:b.utils.getPanelStateFn("link"),isApplied:b.utils.getDataDefinedFn("link"),tooltip:"gfpp_tooltip_linkto",tooltip_active:"gfpp_tooltip_applied_linkto",icon:"link",onClick:b.utils.openLinkPanel},hide:{isSelected:!1,tooltip:"gfpp_tooltip_mobile_hide",icon:"gfpp_hide",onClick:function(a){a.selectedComponent.remove(),a.history.add("component - remove")}},help:{tooltip:"gfpp_tooltip_help",icon:"gfpp_help",mobileHelpId:"b6d9a270-f9c5-4837-995b-c3818b13a643"},pinMode:{isSelected:b.utils.getPanelStateFn("panels.pinnedDockPanel"),tooltip:"gfpp_tooltip_PinToScreen",icon:"gfpp_pin",className:"gfpp-pin",onClick:function(a){a.pinMode.open("gfpp")}}};return{getData:q}}),define("rEditor/rootComps/rightClickMenu/util/rcmDataParser",["lodash","rEditor/rootComps/gfpp/gfppModel","experiment","experiment!boxSlideShow","experiment!layoutTractor"],function(a,b,c,d,e){"use strict";function g(){return{enabled:!0}}function h(a){return f.components.is.duplicatable(a)&&!f.components.layout.isPinned(a)}function i(a){return h(a)?{enabled:!0}:null}function j(a){return h(a)?{enabled:!0}:null}function k(a){if(a)return null;var b=!!f.clipboard.getItem(f.clipboard.types.COMPONENT);return{enabled:b}}function l(a){return h(a)?{enabled:!0}:null}function m(a){var b=f.components.is.styleCanBeApplied(a);return b?{enabled:!0}:null}function n(a){var b=f.hasExternalDesign(a);return b?null:{enabled:!0}}function o(a){var b=f.hasExternalDesign(a);if(b)return null;var c=!!f.clipboard.getItem(f.clipboard.types.COMPONENT_DESIGN);return{enabled:c}}function q(b){var c=f.getCompMoveRestrictions(b),d=c.canMoveBackward||c.canMoveForward,e=f.components.is.fixed(b)&&a.includes(p,f.components.getType(b));return!d||e?null:{type:"subItems",enabled:!0,subItems:r(b)}}function r(a){var b=f.getCompMoveRestrictions(a);return{moveToFront:{icon:{svgName:"bringToFront"},enabled:b.canMoveForward},moveToBack:{icon:{svgName:"sendToBack"},enabled:b.canMoveBackward},moveForward:{icon:{svgName:"moveForward"},enabled:b.canMoveForward},moveBackward:{icon:{svgName:"moveBackward"},enabled:b.canMoveBackward}}}function s(a,b){var c=t(b);return c.length>1||1===c.length&&f.utils.isPage(a)?{type:"subItems",shouldShowCount:!0,enabled:!0,subItems:c}:null}function t(b){return a(b).reject(function(b){return a.includes(["SITE_PAGES","PAGES_CONTAINER"],b.id)||f.utils.isPage(b);
}).map(function(a){return{component:a,key:"overlappingSubItem_"+a.id,icon:f.components.getIconInfo(a),label:f.components.getDisplayName(a),enabled:!0}}).value()}function u(a){var b=f.tpa.isTpaByCompType(f.components.getType(a)),c=f.components.is.removable(a);return b||c?{enabled:c,operationKey:"DELETE"}:null}function v(a){return{value:d?f.components.isShownOnAllStates(a):!1,enabled:d?f.components.canBeShownOnAllStates(a):!1,operationKey:"SHOW_ON_ALL_SLIDES"}}function w(a){var b=f.components.is.fixed(a),c=f.tpa.isTpaByCompType(f.components.getType(a)),d=c&&b;return f.components.canToggleShowOnAllPages(a)||d?{value:d||f.components.isShowOnAllPages(a),enabled:!d,operationKey:"SHOW_ON_ALL_PAGES"}:null}function x(a){return f.components.layout.canBeFixedPosition(a)?{value:f.components.is.fixed(a),enabled:!0}:null}function y(a,b){return b||!f.components.is.pinnable(a)?null:{value:f.components.is.fixed(a),enabled:!0}}function z(){return e?{enabled:!0}:null}function A(d){var e=b.getData(f,d),g=["settings","design","layout","upgrade","aviary","animation","link"];c.isOpen("exp171")&&!c.isOpen("imageCropFiltersOff")&&(g.splice(a.indexOf(g,"animation"),0,"filters"),g[a.indexOf(g,"aviary")]="crop");var h=(e.mainActions||[]).concat(a(e.presetActions).pick(g).toArray().value());return a.transform(h,function(b,c){c.onClick&&b.push({shouldTranslate:a.isBoolean(c.shouldTranslate)?c.shouldTranslate:!0,item:{enabled:!c.isDisabled,label:c.label||c.tooltip},onClick:function(){c.onClick(f,d),f.closeRightClickMenu()}})},[])}function B(a,b,c){return a?{undo:g(),copy:j(a),paste:k(c),cut:i(a),duplicate:l(a),copyDesign:n(a),pasteDesign:o(a),arrange:q(a),overlappingItems:s(a,b),remove:u(a),showOnAllPages:w(a),showOnAllStates:v(a),fixedPosition:x(a),gfppItems:A(a),styleCanBeApplied:m(a),pin:y(a,c),layoutTractor:z()}:{paste:k(c),undo:g()}}var f,p=["wysiwyg.viewer.components.tpapps.TPAGluedWidget"],C={buildMenuItems:function(a,b,c){return f=a,B(c,b,f.isMobileEditor())},buildShowOnAllPagesItem:function(a,b){return f=a,w(b)},buildFixedPositionItem:function(a,b){return f=a,x(b)},buildArrangeMenu:function(a,b){return f=b,q(a)}};return C}),define("rEditor/rootComps/rightClickMenu/customActions/stripColumnsContainer",[],function(){"use strict";return[{label:"Add Column",enabled:function(a,b){return a.columns.canAdd(b)},onClick:function(a,b){a.columns.addColumn(b)}}]}),define("rEditor/rootComps/rightClickMenu/customActions/column",[],function(){"use strict";return[{label:"RightClick_Menu_Move_Column_Left_Label",enabled:function(a,b){return a.components.arrangement.canMoveBackward(b)},onClick:function(a,b){a.columns.move.left(b)}},{label:"RightClick_Menu_Move_Column_Right_Label",enabled:function(a,b){return a.components.arrangement.canMoveForward(b)},onClick:function(a,b){a.columns.move.right(b)}}]}),define("rEditor/rootComps/rightClickMenu/customActions",["rEditor/rootComps/rightClickMenu/customActions/stripColumnsContainer","rEditor/rootComps/rightClickMenu/customActions/column"],function(a,b){"use strict";return{"wysiwyg.viewer.components.StripColumnsContainer":a,"wysiwyg.viewer.components.Column":b}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemBasic.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){var d=this.isEnabled();return a.createElement("li",{className:b.keys(b.pick({"item-basic":!0,disabled:!d,hoverable:d},b.identity)).join(" "),onClick:d?this.props.onClick:function(){},onContextMenu:d?this.props.onClick:function(){},onMouseEnter:this.props.onMouseEnter||b.noop,onMouseLeave:this.props.onMouseLeave||b.noop},this.props.item.icon?a.createElement("span",{className:"icon",key:"icon"},this.props.item.icon.svgName?a.createElement(c.symbol,{name:this.props.item.icon.svgName,key:"svg"}):null,this.props.item.icon.css?a.createElement("span",{style:this.getImageIconStyle(),key:"style"}):null):null,a.createElement("span",{className:"label"},this.translateIfNeeded(this.props.item.label)))}return function(){return d.apply(this,[])}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemBasic",["react","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemBasic.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"rcmItemBasic",mixins:[c.translationMixin],getImageIconStyle:function(){return b.merge({},this.props.item.icon.css,{backgroundImage:"url("+this.props.item.icon.src+")"})},isEnabled:function(){return b.isFunction(this.props.enabled)?this.props.enabled():this.props.item.enabled},render:d})}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement(c.tooltip,{value:this.getTooltipText(),alignment:"right",disabled:!this.getTooltipText()},a.createElement("li",{className:b.keys(b.pick({"item-shortcut":!0,disabled:!this.props.item.enabled,hoverable:this.props.item.enabled},b.identity)).join(" "),onClick:this.props.item.enabled?this.props.onClick:function(){},onContextMenu:this.props.item.enabled?this.props.onClick:function(){}},this.props.item.icon?a.createElement("span",{className:"icon",key:"icon"},this.props.item.icon.svgName?a.createElement(c.symbol,{name:this.props.item.icon.svgName,key:"svg"}):null):null,a.createElement("span",{className:"label label-shortcut"},this.translateIfNeeded(this.props.label)),a.createElement("span",{className:"action action-shortcut"},this.props.shortcut)))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut",["react","core","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"rcmItemWithShortcut",mixins:[d.translationMixin,b.mixins.editorAPIMixin],getTooltipText:function(){var a=this.getEditorAPI(),b=a.tooltipTextService.getSelectedComponentTooltipText(this.props.item.operationKey);return b},render:e})}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItems.rt",["react/addons","lodash","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut"],function(a,b,c){"use strict";return function(){return a.createElement("li",{className:b.keys(b.pick({disabled:!this.props.item.enabled,hoverable:this.props.item.enabled},b.identity)).join(" ")},a.createElement("span",{className:"label label-sub-item"},a.createElement("span",{},this.translateIfNeeded(this.props.label)),this.props.item.shouldShowCount?a.createElement("span",{key:"count"}," ("+a.Children.count(this.props.children)+")"):null),a.createElement("span",{className:"action action-expand"}),a.createElement("div",{className:"rightClickMenu subMenu"},a.createElement("ul",{},this.props.children)))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItems",["react","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItems.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"rcmItemWithSubItems",mixins:[c.translationMixin],render:d})}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItemsRecursive.rt",["react/addons","lodash","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut"],function(a,b,c){"use strict";return function(){return a.createElement("li",{className:b.keys(b.pick({disabled:!this.props.item.enabled,hoverable:this.props.item.enabled},b.identity)).join(" "),onClick:this.props.onClick},a.createElement("span",{className:"label label-sub-item"},a.createElement("span",{},this.translateIfNeeded(this.props.label)),this.props.item.shouldShowCount?a.createElement("span",{key:"count"}," ("+a.Children.count(this.props.children)+")"):null),a.createElement("span",{className:b.keys(b.pick({action:!0,"action-expand":this.props.items.length>0},b.identity)).join(" ")}),a.createElement("div",{className:"rightClickMenu subMenu"},a.createElement("ul",{},this.getChildren())))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItemsRecursive",["react","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItemsRecursive.rt"],function(a,b,c,d){"use strict";var e=a.createClass({displayName:"rcmItemWithSubItems",mixins:[c.translationMixin],getChildren:function(){return b.map(this.props.items,function(b){return a.createElement(e,b)})},render:d});return e}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithToggle.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement(c.tooltip,{value:this.getTooltipText(),alignment:"right",disabled:!this.getTooltipText()},a.createElement("li",{className:b.keys(b.pick({disabled:!this.props.item.enabled},b.identity)).join(" ")},a.createElement("span",{className:"label label-toggle"},this.translateIfNeeded(this.props.label)),a.createElement(c.toggle,b.assign({},{className:this.props.className+" action",value:this.props.value,onChange:this.props.item.enabled?this.props.onChange:b.noop,size:this.props.size},{disabled:!this.props.item.enabled}))))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithToggle",["react","core","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithToggle.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"rcmItemWithToggle",mixins:[d.translationMixin,b.mixins.editorAPIMixin],getTooltipText:function(){var a=this.getEditorAPI(),b=a.tooltipTextService.getSelectedComponentTooltipText(this.props.item.operationKey);return b},render:e})}),define("rEditor/rootComps/rightClickMenu/rightClickMenu.rt",["react/addons","lodash","rEditor/rootComps/rightClickMenu/menuItems/rcmItemBasic","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItems","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItemsRecursive","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithToggle","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","experiment!rightClickDebug","experiment!applyStyle"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(b,d,e,f,g,h,i){return a.createElement(c,{shouldTranslate:h.shouldTranslate,item:h.item,label:h.item.label,key:h.item.label,onClick:h.onClick})}function l(d,e,f,g,h,i,j){return a.createElement(c,{key:i.label,item:i,onClick:i.onClick.bind(null,e,h),enabled:b.isFunction(i.enabled)&&i.enabled.bind(null,e,h)})}function m(a,b,c,d,e,f,g){this.openApplyToDialog(f)}function n(b,d,e,f,g,h,i){return a.createElement(c,{key:"rcmApplyStyle",label:"RightClick_Menu_Copy_Design_Label",item:this.getApplyToInfoItem(),onClick:m.bind(this,b,d,e,f,g,h,i)})}function o(b,d,e,f,g,h,i){return a.createElement(c,{item:h,label:h.label,key:h.key,onClick:this.onOverlappingItemClick.bind(this,h),shouldTranslate:!1,onMouseEnter:this.onOverlappingItemMouseEnter.bind(this,h),onMouseLeave:this.onOverlappingItemMouseLeave})}function p(b,c,d,e,g,h,i){return a.createElement(f,{shouldTranslate:!1,key:h.id,label:"Debug - "+c.components.getDisplayName(h)+" - "+h.id,item:{enabled:!0},items:this.getDebugItems(h)})}function q(a,b,c,d,e,f,g){this.exportDebugInfo(f)}function r(b,d,e,f,g,h,i){return a.createElement(c,{shouldTranslate:!1,item:this.getExportDebugInfoItem(h),key:h.id+".debugInfo",onClick:q.bind(this,b,d,e,f,g,h,i)})}function s(){var c=this.state.menuItems,f=this.getEditorAPI(),m=h.editor,q=this.getCustomActions(),s=b.first(this.props.selectedComponents);return a.createElement("div",{style:{top:this.state.position.y,left:this.state.position.x},className:b.keys(b.pick(this.getClasses(),b.identity)).join(" "),onContextMenu:this.onRightClick,key:"rcm"},this.props.selectedComponents?null:a.createElement("ul",{key:"noCompSelectedItems"},c.paste?a.createElement(d,{item:c.paste,label:"RightClick_Menu_Paste_Label",shortcut:m.PASTE.label,onClick:this.pasteComponent,key:"noCompSelectedPaste"}):null),this.props.selectedComponents?a.createElement("div",{key:"selectedCompItems"},b.isEmpty(c.gfppItems)?null:a.createElement.apply(this,["ul",{key:"gfppItems","data-section":"gfppItems"},b.map(c.gfppItems,k.bind(this,c,f,m,q,s))]),q.length?a.createElement.apply(this,["ul",{key:"customActions"},b.map(q,l.bind(this,c,f,m,q,s))]):null,a.createElement.apply(this,["ul",{},a.createElement(d,{item:c.undo,label:"TOPBAR_Edit_Undo",shortcut:m.UNDO.label,onClick:this.undo}),c.cut?a.createElement(d,{item:c.cut,label:"RightClick_Menu_Cut_Label",shortcut:m.CUT.label,onClick:this.cutComponent,key:"rcmCut"}):null,c.copy?a.createElement(d,{item:c.copy,label:"RightClick_Menu_Copy_Label",shortcut:m.COPY.label,onClick:this.copyComponent,key:"rcmCopy"}):null,j&&c.styleCanBeApplied?b.map(this.props.selectedComponents,n.bind(this,c,f,m,q,s)):null,c.paste?a.createElement(d,{item:c.paste,label:"RightClick_Menu_Paste_Label",shortcut:m.PASTE.label,onClick:this.pasteComponent,key:"rcmPaste"}):null,c.duplicate?a.createElement(d,{item:c.duplicate,label:"RightClick_Menu_Duplicate_Label",shortcut:m.DUPLICATE.label,onClick:this.duplicateComponent,key:"rcmDuplicate"}):null]),c.arrange||c.overlappingItems?a.createElement("ul",{key:"rcmArrangeOverlapping"},c.overlappingItems?a.createElement.apply(this,[e,{label:"RightClick_Menu_Overlapping_Items_Label",item:c.overlappingItems,key:"rcmOverlapping"},b.map(c.overlappingItems.subItems,o.bind(this,c,f,m,q,s))]):null,c.arrange?a.createElement(e,{item:c.arrange,label:"RightClick_Menu_Arrange_Label",key:"rcmArrange",onMouseOver:this.onArrangeHover},a.createElement(d,{item:c.arrange.subItems.moveToFront,label:"RightClick_Menu_Bring_to_Front_Label",shortcut:m.SEND_TO_FRONT.label,onClick:this.moveToFront}),a.createElement(d,{item:c.arrange.subItems.moveToBack,label:"RightClick_Menu_Send_to_Back_Label",shortcut:m.SEND_TO_BACK.label,onClick:this.moveToBack}),a.createElement(d,{item:c.arrange.subItems.moveForward,label:"RightClick_Menu_Move_Forward_Label",shortcut:m.SEND_FORWARD.label,onClick:this.moveForward}),a.createElement(d,{item:c.arrange.subItems.moveBackward,label:"RightClick_Menu_Move_Backward_Label",shortcut:m.SEND_BACKWARD.label,onClick:this.moveBackward})):null):null,c.remove?a.createElement("ul",{key:"rcmRemove"},a.createElement(d,{item:c.remove,label:this.getEditorAPI().isMobileEditor()?"RightClick_Menu_Mobile_Hide_Label":"RightClick_Menu_Delete_Label",shortcut:"Del",onClick:this.removeComponent})):null,c.pin?a.createElement("ul",{key:"rcmPin"},c.pin?a.createElement(d,{item:c.pin,label:this.getPinLabel(),value:c.pin.value,onClick:this.handlePinClick,key:"rcmPin"}):null):null,c.layoutTractor?a.createElement("ul",{key:"layoutTractor"},a.createElement(d,{item:c.layoutTractor,shouldTranslate:!1,label:"Layout Tractor (UI)",onClick:this.openLayoutTractor})):null,c.showOnAllPages||c.fixedPosition||c.showOnAllStates.enabled?a.createElement("ul",{key:"rcmShowOnAllPagesFixPosition"},c.showOnAllPages?a.createElement(g,{size:"medium",item:c.showOnAllPages,className:"show-on-all-pages",label:"RightClick_Menu_Show_On_All_Pages_Label",value:c.showOnAllPages.value,onChange:this.toggleShowOnAllPages,key:"rcmShowOnAllPages"}):null,c.fixedPosition?a.createElement(g,{size:"medium",item:c.fixedPosition,label:"RightClick_Menu_Fixed_Position_Label",value:c.fixedPosition.value,onChange:this.toggleFixedPosition,key:"rcmFixPosition"}):null):null,i?a.createElement.apply(this,["ul",{key:"debug"},b.map(this.props.selectedComponents,p.bind(this,c,f,m,q,s)),b.map(this.props.selectedComponents,r.bind(this,c,f,m,q,s))]):null):null)}return function(){return this.state.menuItems?s.apply(this,[]):null}}),define("rEditor/rootComps/rightClickMenu/rightClickMenu",["react","lodash","jquery","core","rEditor/rootComps/rightClickMenu/util/rcmDataParser","rEditor/rootComps/rightClickMenu/customActions","util","experiment!boxSlideShow","experiment","rEditor/rootComps/rightClickMenu/rightClickMenu.rt"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function o(a,c){return b.findIndex(c,function(c){return b.isEqual(c,a)})>-1}function p(a,c){var d=k.selection.getComponentsUnderClick(a,c);return h?b.reject(d,function(a){return!k.components.is.selectable(a)}):d}function q(a,c,d){return b.map(b.keys(c),function(e){var f=c[e],g=d.concat(e);return{key:e,label:e,onClick:function(b){console.log(a,g.join("."),f),b.stopPropagation()},items:b.isString(f)||b.isNumber(f)?[]:q(a,f,g),item:{enabled:!0}}})}function r(a,b,c){var d=c,e=b.outerHeight(),f=d+e;if(f>a.bottomY){var g=d-e;return g<a.y?a.y:g}return d}function s(a,b,c){var d=c,e=b.outerWidth(),f=d+e;if(f-window.pageXOffset>a.rightX){var g=d-e;return g<a.x?d+a.x:g}return d}function t(a,b){var c=d.utils.stageUtils.getViewPort(),e=s(c,a,b.x),f=r(c,a,b.y);return{x:e,y:f}}function u(a,e){var f=d.utils.stageUtils.getViewPort(),g=a.find(".subMenu");if(0===g.length)return!1;var h=c(b.max(g,function(a){return c(a).outerWidth()}));return e.x+a.outerWidth()+h.outerWidth()>f.rightX}function v(a){var b=this.state.menuItems;b.arrange=e.buildArrangeMenu(a,this.getEditorAPI()),this.setState({menuItems:b})}function w(a,b){a.components.layout.unDock(b),a.components.layout.setFixed(b,!1),a.bi.event(d.bi.events.pinToScreen.UNPIN,{origin:"rcm",component_type:a.getComponentType(b)}),g.keyboardShortcuts.setContext(g.keyboardShortcuts.CONTEXTS.EDITOR)}var k,l=d.bi,m="rcm",n="RCMOpensPinPanel";return a.createClass({displayName:"rightClickMenu",mixins:[d.mixins.editorAPIMixin,g.outerClickMixin],compType:null,propTypes:{selectedComponents:a.PropTypes.array},onOuterClick:function(){k.closeRightClickMenu()},getInitialState:function(){return k=this.getEditorAPI(),this.shouldMeasureRCMRelativeToViewPort=!0,{position:this.props.position,openSubMenuToLeft:!1,menuItems:this.getAllMenuItems(this.props.selectedComponents,this.props.position)}},componentDidMount:function(){this.updatePositionRelativeToViewPort(),this.compType=k.components.getType(this.props.selectedComponents),k.bi.event(l.events.rightClickMenu.RIGHT_CLICK_MENU_OPEN,{component:this.compType})},getAllMenuItems:function(a,b){var c=p(b.x,b.y);return e.buildMenuItems(k,c,a)},rebuildItemsForSameComponent:function(a){var c=b.pick({showOnAllPages:e.buildShowOnAllPagesItem(k,a),fixedPosition:e.buildFixedPositionItem(k,a)},function(a,c){return!b.isEqual(a,this.state.menuItems[c])},this);if(!b.isEmpty(c)){var d=b.assign({},this.state.menuItems,c);this.setState({menuItems:d})}},componentWillReceiveProps:function(a){if(a.selectedComponents){var c=b.isEqual(a.selectedComponents,this.props.selectedComponents);c?this.rebuildItemsForSameComponent(a.selectedComponents):(this.shouldMeasureRCMRelativeToViewPort=!0,this.setState({menuItems:this.getAllMenuItems(a.selectedComponents,a.position)}))}},componentDidUpdate:function(){this.shouldMeasureRCMRelativeToViewPort&&this.updatePositionRelativeToViewPort()},componentWillUnmount:function(){k.bi.event(l.events.rightClickMenu.RIGHT_CLICK_MENU_CLOSE,{origin:m,component:this.compType})},updatePositionRelativeToViewPort:function(){var a=c(this.getDOMNode()),b=t(a,this.state.position),d=u(a,this.state.position);this.shouldMeasureRCMRelativeToViewPort=!1,this.setState({position:b,openSubMenuToLeft:d})},onOverlappingItemMouseEnter:function(a){k.bi.event(l.events.rightClickMenu.OVERLAPPING_ITEMS_HOVER,{component:o(a.component,this.props.selectedComponents)?"selected":"other"}),k.hoverBox.set(a.component,!0)},onOverlappingItemMouseLeave:function(){k.hoverBox.clear()},getClasses:function(){return{rightClickMenu:!0,"open-sub-menu-left":this.state.openSubMenuToLeft,"fixed-position":this.getEditorAPI().components.layout.isShowOnFixedPosition(this.props.selectedComponents)}},onRightClick:function(a){a.preventDefault()},undo:function(){this.getEditorAPI().history.undo(),k.closeRightClickMenu()},cutComponent:function(){var a=k.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"origin")),k.selectedComponent.cut(),k.closeRightClickMenu(),k.history.add("cut component via rightClickMenu"),k.bi.reportBI(l.events.rightClickMenu.CUT,a)},copyComponent:function(){var a=k.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"origin")),k.selectedComponent.copy(),k.closeRightClickMenu(),k.bi.reportBI(l.events.rightClickMenu.COPY,a)},pasteComponent:function(){var a=k.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"origin"));var c=k.ui.scroll.getScroll(),d={x:this.props.position.x-k.site.getXPos()+c.scrollLeft,y:this.props.position.y-k.components.layout.get(k.siteSegments.getPagesContainer()).y+c.scrollTop};k.components.paste(d,!0),k.closeRightClickMenu(),k.history.add("paste component via rightClickMenu"),k.bi.reportBI(l.events.rightClickMenu.PASTE,a)},duplicateComponent:function(){var a=k.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"origin")),k.selectedComponent.duplicate(),k.closeRightClickMenu(),k.history.add("duplicate component via rightClickMenu"),k.bi.reportBI(l.events.rightClickMenu.DUPLICATE,a)},copyDesign:function(){k.selectedComponent.copyStyle(),k.bi.event(l.events.rightClickMenu.COPY_DESIGN,{category:"",component:""})},pasteDesign:function(){k.selectedComponent.pasteStyle(),k.bi.event(l.events.rightClickMenu.PASTE_DESIGN,{category:"",component:""})},lockComponent:function(){k.selectedComponent.lock(),k.closeRightClickMenu(),k.bi.event(l.events.rightClickMenu.LOCK,{category:"",component:""})},removeComponent:function(){var a=k.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"removal_method")),k.selectedComponent.remove(function(){k.history.add("removed component via rightClickMenu")}),k.closeRightClickMenu(),k.bi.reportBI(l.events.editor.component_removed,a)},assignRCMSpecificBI:function(a,c){var d={};d[a]=m,b.assign(c,d)},toggleShowOnAllPages:function(){k.components.toggleShowOnAllPages(this.props.selectedComponents),k.waitForChangesApplied(function(){var a=k.components.isShowOnAllPages(this.props.selectedComponents);k.bi.event(l.events.rightClickMenu.SHOW_ON_ALL_PAGES,{new_status:a,origin:m})}.bind(this))},toggleShowOnAllStates:function(){k.components.toggleShowOnAllStates(this.props.selectedComponents);var a=this.state.menuItems;a.showOnAllStates.value=!a.showOnAllStates.value,this.setState({menuItems:a})},toggleFixedPosition:function(){k.selectedComponent.toggleFixedPosition(),k.waitForChangesApplied(function(){var a=k.components.is.fixed(this.props.selectedComponents),b=k.components.getType(this.props.selectedComponents[0]);k.bi.event(l.events.rightClickMenu.FIXED_POSITION,{origin:m,new_status:a,component:b})}.bind(this))},handlePinClick:function(){k.closeRightClickMenu();var a=k.components.layout.isPinned(this.props.selectedComponents);i.isOpen(n)?k.pinMode.open(a?"rcm_reopen":"rcm"):a?w(k,this.props.selectedComponents):k.pinMode.open("rcm")},moveForward:function(){k.components.arrangement.moveForward(this.props.selectedComponents),v.call(this,this.props.selectedComponents),k.bi.event(l.events.rightClickMenu.MOVE_FORWARD,{origin:m})},moveBackward:function(){k.components.arrangement.moveBackward(this.props.selectedComponents),v.call(this,this.props.selectedComponents),k.bi.event(l.events.rightClickMenu.MOVE_BACKWARDS,{origin:m})},moveToFront:function(){k.components.arrangement.moveToFront(this.props.selectedComponents),v.call(this,this.props.selectedComponents),k.bi.event(l.events.rightClickMenu.BRING_TO_FRONT,{origin:m})},moveToBack:function(){k.components.arrangement.moveToBack(this.props.selectedComponents),v.call(this,this.props.selectedComponents),k.history.add("component - move to back"),k.bi.event(l.events.rightClickMenu.SEND_TO_BACK,{origin:m})},onArrangeHover:function(){k.bi.event(l.events.rightClickMenu.ARRANGE_HOVER,{origin:m})},onOverlappingItemClick:function(a){k.selection.selectComponentByCompRef(a.component),k.selection.setIsHiddenComponentDraggedNext(!0),k.bi.event(l.events.rightClickMenu.OVERLAPPING_ITEM_CLICK,{component:o(a.component,this.props.selectedComponents)?"selected":"other"})},getDebugItems:function(a){var b=k.components.serialize(a);return q(a.id,b,["structure"])},getExportDebugInfoItem:function(a){return{label:"Debug - export ["+a.id+"] to console",enabled:!0}},exportDebugInfo:function(a){var c=k.components.serialize(a);window.selectedComp=b.cloneDeep(c),console.log("Exported ["+a.id+"] to window.selectedComp"),k.closeRightClickMenu()},getApplyToInfoItem:function(){return{label:"RightClick_Menu_Copy_Design_Label",enabled:!0}},openApplyToDialog:function(a){k.bi.event(d.bi.events.applyStyle.COPY_STYLE_RCM_CLICK,{component_id:a.id,component_type:k.components.getType(a)}),k.styles.openApplyStylePanel(a)},getPinLabel:function(){if(i.isOpen(n))return"RightClick_Menu_PinToScreen";var a=k.components.layout.isPinned(k.selection.getSelectedComponents());return a?"RightClick_Menu_UnPinElement":"RightClick_Menu_PinToScreen"},openLayoutTractor:function(){k.panelManager.openComponentPanel("compPanels.dynamicPanels.layoutTractor",{selectedComponents:this.props.selectedComponents}),k.closeRightClickMenu()},getCustomActions:function(){return f[k.components.getType(this.props.selectedComponents)]||[]},render:j})}),define("rEditor/rootComps/panels/openedPanels.rt",["react/addons","lodash","core","uiAnimations","panels"],function(a,b,c,d,e){"use strict";function f(d,e){return a.createElement(c.lazyComponent,b.assign({},{moduleName:d.name,key:d.name,onLoad:this.forceUpdate.bind(this)},this.getPanelProps(d)))}return function(){return a.createElement("div",{className:"opened-panels"},a.createElement.apply(this,[d.panelsAnimation,{},this.props.editorState.helpProps?a.createElement(e.frames.helpPanelFrame,b.assign({},{key:"helpPanel",isMobileEditor:this.props.editorState.isMobileEditor},this.props.editorState.helpProps)):null,b.map(this.props.openPanels,f.bind(this))]))}}),define("rEditor/rootComps/panels/openedPanels",["react","core","lodash","rEditor/rootComps/panels/openedPanels.rt"],function(a,b,c,d){"use strict";function e(a){var c=a.key;return b.lazyComponent.isLoaded(a.name)&&(c+="-loading"),c}return a.createClass({displayName:"openedPanels",propTypes:{editorState:a.PropTypes.object.isRequired,openPanels:a.PropTypes.array},getPanelProps:function(a){return c.assign({},a.props,{editorState:this.props.editorState,key:e(a.props)})},render:d})}),define("rEditor/rootComps/portal/portal.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{id:"portal"},this.getChildren())}}),define("rEditor/rootComps/portal/portal",["react","lodash","rEditor/rootComps/portal/portal.rt"],function(a,b,c){"use strict";function d(c,d){return b.map(c,function(c){return a.createElement(c.reactClass,b.assign(c.props,{origin:d}))})}return a.createClass({displayName:"Portal (AKA Comps Day-Care)",propTypes:{comps:a.PropTypes.object},getChildren:function(){return b.reduce(this.props.comps,function(a,b,c){return a.concat(d(b,c))},[])},render:c})}),define("rEditor/utils/mouseMoveActions/mouseMoveActionTypes",[],function(){"use strict";return{DRAG:"DRAG",SPACER:"SPACER",ROTATE:"ROTATE",RESIZE:"RESIZE",SECTION_DRAG:"SECTION_DRAG",LASSO:"LASSO",DRAG_ATTEMPT:"DRAG_ATTEMPT"}}),define("rEditor/rootComps/gfpp/gfppButton.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){var b=this.translateIfNeeded;return a.createElement("li",{className:"gfpp-btn "+this.props.className,onClick:this.onClick},this.props.icon?a.createElement(c.symbol,{key:"gfppButtonIcon",name:this.props.icon}):null,this.props.label?a.createElement("span",{key:"gfppButtonLabel",className:"gfpp-label"},b(this.props.label)):null)}return function(){return a.createElement(c.tooltip,{value:this.props.tooltip,styleType:"small",disabled:!this.props.tooltip,shouldTranslate:this.props.shouldTranslate},d.apply(this,[]))}}),define("rEditor/rootComps/gfpp/gfppButton",["react","lodash","core","util","rEditor/rootComps/gfpp/gfppButton.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"GFPP Button",propTypes:{selectedComponent:a.PropTypes.arrayOf(a.PropTypes.object).isRequired},mixins:[c.mixins.editorAPIMixin],translateIfNeeded:function(a){return b.isBoolean(this.props.shouldTranslate)&&!this.props.shouldTranslate?a:d.translate(a)},onClick:function(){var a=this.getEditorAPI(),d=this.props.selectedComponent;if(a.components.is.exist(d)){var e=(d.length?b.first(d):d).id,f=a.components.getType(d);this.props.onClick(a,d,c.constants.USER_ACTIONS.ORIGIN.GFPP),a.bi.event(c.bi.events.gfpp.GFPP_BUTTON_CLICK,{action_name:this.props.label||this.props.tooltip,component_id:e,component_type:f,icon:this.props.tooltip})}},render:e})}),define("rEditor/rootComps/gfpp/gfppCustomButton",["react"],function(a){"use strict";return a.createClass({displayName:"gfppCustomButton",render:function(){return a.createElement(this.props.template,this.props)}})}),define("rEditor/rootComps/gfpp/gfppButtonGenerator",["react","lodash","rEditor/rootComps/gfpp/gfppButton","rEditor/rootComps/gfpp/gfppCustomButton"],function(a,b,c,d){"use strict";return a.createClass({displayName:"gfppButtonGenerator",render:function(){return a.createElement(this.props.template?d:c,b.assign({},this.props))}})}),define("rEditor/rootComps/gfpp/gfpp.rt",["react/addons","lodash","uiAnimations","baseUI","rEditor/rootComps/gfpp/gfppButtonGenerator"],function(a,b,c,d,e){"use strict";function f(c,d){return a.createElement(e,b.assign({},{key:c.icon||c.label||c.tooltip,className:b.keys(b.pick({selected:c.isSelected,disabled:c.isDisabled},b.identity)).join(" ")},this.getButtonProps(c)))}return function(){return a.createElement(c.gfppAnimation,{},a.createElement.apply(this,["ul",b.assign({},{id:"gfpp",ref:"gfpp",className:b.keys(b.pick({gfpp:!0},b.identity)).join(" "),key:this.getKey(),onMouseDown:this.stopEventPropagation,onMouseUp:this.stopEventPropagation,onDoubleClick:this.stopEventPropagation,onContextMenu:this.stopEventPropagation,onMouseMove:this.stopEventPropagation,onClick:this.stopEventPropagation},this.getTopLevelProps()),b.map(this.state.mainButtons,f.bind(this))]))}}),define("rEditor/rootComps/gfpp/gfpp",["lodash","react","core","panels","pLoader!santa:utils","rEditor/rootComps/gfpp/gfppModel","rEditor/rootComps/gfpp/gfpp.rt","jquery","experiment"],function(a,b,c,d,e,f,g,h,i){"use strict";function k(){var b=j.slice(0);return i.isOpen("switchLayoutDesignOrder")&&l(b),i.isOpen("exp171")&&!i.isOpen("imageCropFiltersOff")&&(b.splice(a.indexOf(b,"animation"),0,"filters"),b[a.indexOf(b,"aviary")]="crop"),b}function l(b){var c=a.indexOf(b,"layout"),d=a.indexOf(b,"design"),e=b[c];b[c]=b[d],b[d]=e}function m(b,c){var d=a.map(c,function(a){return b[a]});return a.compact(d)}function n(a,b){var c=f.getData(a,b),d=c.mainActions||[],e=c.extraActions||[],g=m(c.presetActions,k()),h=d.concat(g).concat(e);return{mainButtons:h}}function o(b,e){return function(){var f=a.get(b.selection.getSelectedComponentData(),"appPartName"),g=b.selection.getSelectedComponentType(),h={component:f||g,origin:c.constants.BI.HELP.ORIGIN.GFPP,learn_more:!1};d.panelManager.openHelpCenter(e,null,null,h)}}var j=["settings","layout","design","upgrade","aviary","animation","link","hide","stretch","stretchForColumns","help","pinMode"];return b.createClass({displayName:"GFPP",mixins:[c.mixins.editorAPIMixin],propTypes:{selectedComponent:b.PropTypes.arrayOf(b.PropTypes.object).isRequired},getInitialState:function(){return n(this.getEditorAPI(),this.props.selectedComponent)},componentWillReceiveProps:function(a){this.setState(n(this.getEditorAPI(),a.selectedComponent))},getTopLevelProps:function(){return a.pick(this.props,["style"])},getButtonProps:function(b){return b.isApplied&&a.assign(b,{label:b.label_active||b.label,icon:b.icon_active||b.icon,tooltip:b.tooltip_active||b.tooltip}),b.helpId&&a.isUndefined(b.onClick)&&(b.onClick=o(this.getEditorAPI(),b.helpId)),b.selectedComponent=this.props.selectedComponent,b},getSize:function(){if(this.refs.gfpp){var b=e.domMeasurements.getBoundingRect(this.refs.gfpp.getDOMNode());return a.pick(b,["width","height"]);
}},stopEventPropagation:function(a){a.stopPropagation()},getKey:function(){return a.first([].concat(this.props.selectedComponent)).id+"_"+a.size([].concat(this.props.selectedComponent))},render:g})}),define("rEditor/rootComps/selectionBox/selectionBoxCommons",["lodash","experiment"],function(a,b){"use strict";function c(b,c,e){for(var f=a.first(c);f&&!d(e,f);)f=b.components.getContainer(f);return f}function d(b,c){return a.some(b,function(a){return a(c)})}function e(a,b){return b&&a.components.layout.isShowOnFixedPosition(b)?"fixed":"absolute"}function f(c,d,f,g){var h=0,i=0;a.size(f)>1&&(h=2,i=2*h);var j=d.bounding,k={position:e(c,f),top:d.bounding.y-g-h,left:d.bounding.x-g-h,width:j.width+i,height:j.height+i};if(b.isOpen("se_editBoxPerformance")){var l="translate3d("+(j.x-g-h)+"px,"+(j.y-g-h)+"px,0)";k.top=0,k.left=0,k.WebkitTransform=l,k.transform=l}return k}return{getPosition:e,getBoundingStyle:f,findFirstContainerMatchingConditions:c}}),define("rEditor/rootComps/selectionBox/controllers/tabsController.rt",["react/addons","lodash","util"],function(a,b,c){"use strict";function d(a,b){this.onTabClicked(a.modeId)}function e(b,e){return a.createElement("div",{className:"modes-tab "+this.getModeActivityClass(b.modeId),onMouseDown:d.bind(this,b,e),key:b.modeId},"\n        ",c.translate(this.getModeLabelKey(b.type)),"\n    ")}return function(){return a.createElement.apply(this,["div",{className:"controllers-container "+(this.props.className||"")},a.createElement("div",{className:"modes-tab "+this.getModeActivityClass("REGULAR"),onMouseDown:this.onRegulerClicked},"\n        ",c.translate(this.getModeLabelKey("NORMAL")),"\n    "),b.map(this.getComponentModes(),e.bind(this))])}}),define("rEditor/rootComps/selectionBox/controllers/tabsController",["react","lodash","core","rEditor/rootComps/selectionBox/controllers/tabsController.rt"],function(a,b,c,d){"use strict";var e={NORMAL:"HOVER_BOX_STATE_REGULAR",HOVER:"HOVER_BOX_STATE_HOVER"};return a.createClass({displayName:"tabsController",mixins:[c.mixins.editorAPIMixin],propTypes:{focusedContainer:a.PropTypes.object.isRequired},getComponentModes:function(){return this.getEditorAPI().components.modes.getModes(this.props.focusedContainer)},onRegulerClicked:function(){var a=this.getEditorAPI(),c=a.components.modes.getComponentActiveModeIds(this.props.focusedContainer);b.isEmpty(c)?a.selection.selectComponentByCompRef(this.props.focusedContainer):this.resetSelectedModes()},onTabClicked:function(a){var b=this.getEditorAPI(),c=b.components.modes.isModeActive(a);c?b.selection.selectComponentByCompRef(this.props.focusedContainer):this.changeToMode(a)},resetSelectedModes:function(){var a=this.getEditorAPI();a.components.modes.deactivateAllComponentModes(this.props.focusedContainer)},changeToMode:function(a){var b=this.getEditorAPI();b.components.modes.activateComponentMode(this.props.focusedContainer,a)},getModeLabelKey:function(a){return a=a||"",e[a.toUpperCase()]},isModeActive:function(a){return this.getEditorAPI().components.modes.isModeActive(a)},getModeActivityClass:function(a){var b=this.getEditorAPI().components.modes.getComponentActiveModeIds(this.props.focusedContainer);return 0===b.length&&"REGULAR"===a?"active-mode-tab":this.isModeActive(a)?"active-mode-tab":"nonactive-mode-tab"},render:d})}),define("rEditor/rootComps/selectionBox/controllers/dropDownController.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{},"Hello RT!")}}),define("rEditor/rootComps/selectionBox/controllers/dropDownController",["react","lodash","rEditor/rootComps/selectionBox/controllers/dropDownController.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"dropDownContoller",render:c})}),define("rEditor/rootComps/selectionBox/controllers/paginationController.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{})}}),define("rEditor/rootComps/selectionBox/controllers/paginationController",["react","lodash","rEditor/rootComps/selectionBox/controllers/paginationController.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"paginationController",render:c})}),define("rEditor/rootComps/selectionBox/controllers/labelController.rt",["react/addons","lodash","util"],function(a,b,c){"use strict";return function(){return a.createElement("label",{className:"label-controller "+b.keys(b.pick({active:this.props.active,bottom:this.props.bottom},b.identity)).join(" ")},"\n    ",this.props.translate?c.translate(this.props.label):this.props.label,"\n")}}),define("rEditor/rootComps/selectionBox/controllers/labelController",["react","lodash","rEditor/rootComps/selectionBox/controllers/labelController.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"labelController",propTypes:{label:a.PropTypes.string.isRequired,translate:a.PropTypes.bool,active:a.PropTypes.bool,bottom:a.PropTypes.bool},getDefaultProps:function(){return{active:!0,translate:!0,bottom:!1}},render:c})}),define("rEditor/rootComps/selectionBox/navControls.rt",["react/addons","lodash","util","baseUI","rEditor/rootComps/selectionBox/controllers/tabsController","rEditor/rootComps/selectionBox/controllers/dropDownController","rEditor/rootComps/selectionBox/controllers/paginationController","rEditor/rootComps/selectionBox/controllers/labelController"],function(a,b,c,d,e,f,g,h){"use strict";return function(){return a.createElement("div",{onMouseDown:this.stopEventPropagation,onMouseUp:this.stopEventPropagation,onDoubleClick:this.stopEventPropagation,onContextMenu:this.stopEventPropagation,onMouseMove:this.stopEventPropagation,style:this.getCalculatedStyle()},this.props.navType===d.uiConstants.NAVIGATION_TYPES.TABS?a.createElement(e,{key:"tabsController",focusedContainer:this.props.focusedContainer,className:this.getControllerClass()}):null,this.props.navType===d.uiConstants.NAVIGATION_TYPES.DROPDOWN?a.createElement(f,{key:"dropDownController"}):null,this.props.navType===d.uiConstants.NAVIGATION_TYPES.PAGINATION?a.createElement(g,{key:"paginationController"}):null,this.props.navType===d.uiConstants.NAVIGATION_TYPES.LABEL?a.createElement(h,b.assign({},{key:"labelController"},this.props.content)):null)}}),define("rEditor/rootComps/selectionBox/navControls",["react","lodash","core","baseUI","rEditor/rootComps/selectionBox/navControls.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"navControls",mixins:[c.mixins.editorAPIMixin],propTypes:{navType:a.PropTypes.string.isRequired,content:a.PropTypes.object.isRequired,focusedContainer:a.PropTypes.object.isRequired,boundingContainerStyle:a.PropTypes.object},stopEventPropagation:function(a){a.stopPropagation()},getControllerClass:function(){var a=this.getCalculatedStyle();return a.top<0?"comp-top":"comp-bottom"},getCalculatedStyle:function(){var a={top:this.props.style&&this.props.style.top||0,left:this.props.style&&this.props.style.left||0,position:"absolute"};return a},render:e})}),define("rEditor/rootComps/selectionBox/focusBox.rt",["react/addons","lodash","rEditor/rootComps/selectionBox/navControls"],function(a,b,c){"use strict";function d(d){var e=this.getNavControlsContent();return a.createElement("div",{className:"focus-frame "+b.keys(b.pick({"fade-frame":this.fadeFrame()},b.identity)).join(" "),style:d},e&&this.props.showNavControl?a.createElement(c,{key:"navControls",ref:"navControls",style:this.props.navControlsStyle,navType:this.getNavType(),content:e,focusedContainer:this.props.focusedContainer,boundingContainerStyle:d}):null,this.props.gridLines?a.createElement("svg",{key:"gridLines",className:"grid-lines"},this.props.gridLines.left?a.createElement("line",{key:"leftBack",x1:this.props.gridLines.left,y1:"0",x2:this.props.gridLines.left,y2:"100%",className:"line back"}):null,this.props.gridLines.left?a.createElement("line",{key:"leftFront",x1:this.props.gridLines.left,y1:"0",x2:this.props.gridLines.left,y2:"100%",className:"line front"}):null,this.props.gridLines.right?a.createElement("line",{key:"rightBack",x1:this.props.gridLines.right,y1:"0",x2:this.props.gridLines.right,y2:"100%",className:"line back"}):null,this.props.gridLines.right?a.createElement("line",{key:"rightFront",x1:this.props.gridLines.right,y1:"0",x2:this.props.gridLines.right,y2:"100%",className:"line front"}):null):null)}function e(){var b=this.getFocusedContainerLayout();return a.createElement("div",{className:"focusbox"},d.apply(this,[b]))}return function(){return e.apply(this,[])}}),define("rEditor/rootComps/selectionBox/focusBox",["react","lodash","core","baseUI","rEditor/rootComps/selectionBox/selectionBoxCommons","rEditor/rootComps/selectionBox/focusBox.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"focusBox",mixins:[c.mixins.editorAPIMixin],PropTypes:{focusedContainer:a.PropTypes.object.isRequired,gridLines:a.PropTypes.object,selectedComponents:a.PropTypes.oneOfType([a.PropTypes.object,a.PropTypes.arrayOf(a.PropTypes.object)]).isRequired},getFocusedContainerLayout:function(){var a=this.getEditorAPI(),b=a.components.layout.getRelativeToScreen(this.props.focusedContainer);return e.getBoundingStyle(a,b,[this.props.focusedContainer],0)},fadeFrame:function(){return this.props.focusedContainer.id!==b.first(this.props.selectedComponents).id},getNavControlsSize:function(){if(this.refs.navControls){var a=this.refs.navControls.getDOMNode();return{height:a.offsetHeight,width:a.offsetWidth}}},getNavType:function(){return this.getEditorAPI().components.is.focusBoxNavType(this.props.focusedContainer)},getNavControlsContent:function(){return this.getEditorAPI().components.is.focusBoxNavContent(this.props.focusedContainer)},render:f})}),define("rEditor/utils/mouseMoveActions/baseResize",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","util"],function(a,b,c,d){"use strict";function t(a){return s[a]}function u(a){return r[a]}function v(a){return{x:a.pageX,y:a.pageY}}function w(b){var c=n.components.getType(b),d=a.has(q,c);return d}function x(b){var c=n.components.getType(b),d=q[c],e=a.isFunction(d)?d(g):!!d,f=a.pick(r,["topRight","topLeft","bottomRight","bottomLeft"]),h=a.includes(f,l);return!i&&h&&e}function y(){return n.components.layout.isPinned(g)?!1:w(g)?x(g):(i||n.components.is.group(g)||n.multiselect.isMultiselect(g))&&n.components.is.proportionallyResizable(g)}function z(a){var b=v(a),c=t(j),d=n.components.layout.getRelativeToScreen(g);m=y(),h=new f.Resize(d,b,c,m),o=n.components.layout.getProportionStructure(g,c)}function A(a){var b=k.getClosestLayoutDistance(n,a,l);Math.abs(b.x)<5&&(l.right?(y()&&a.height&&(a.height+=b.x),a.width+=b.x):l.left&&(y()&&a.height&&(a.height-=b.x),a.x+=b.x,a.width-=b.x)),Math.abs(b.y)<5&&(l.top?(y()&&a.width&&(a.width-=b.y),a.y+=b.y,a.height-=b.y):l.bottom&&(y()&&a.width&&(a.width+=b.y),a.height+=b.y))}function B(a){if(l.right)a.width-=a.width%5;else if(l.left){var b=a.x%5;a.x-=b,a.width+=b}if(l.top){var c=a.y%5;a.y-=c,a.height+=c}else l.bottom&&(a.height-=a.height%5)}function C(a){var b=k.getSnapData(a,l);n.snapData.set(b)}function D(b,c){n=b,g=n.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(c.comps);var d=a.map(g,"id");n.renderPlugins.setCompsToShowOnTop(d),i=c.evt.shiftKey,j=c.directionName,k=new e(n,c.comps),l=u(c.directionName),z(c.evt)}function E(a){var b=v(a);i!==a.shiftKey&&(i=a.shiftKey,z(a));var c=h.getLayout(b);n.getViewTools().snapToEnabled&&0===c.rotationInDegrees&&A(c),m?n.components.layout.updateRelativeToScreenAndPreserveProportions(g,c,o):n.components.layout.updateRelativeToScreen(g,c,!0),n.waitForChangesApplied(function(){if(k){var b=n.components.layout.getRelativeToScreen(g);a.altKey?B(b):n.getViewTools().snapToEnabled&&0===b.rotationInDegrees&&C(b)}})}function F(){if(k=null,n.snapData.clear(),n.renderPlugins.setCompsToShowOnTop(null),n.history.add("Resize component"),n.components.layout.isPinned(g)){var a=n.components.layout.getDock(g),b=d.pinModeUtils.getDockedDirection(a),c=n.components.layout.get(g);d.pinModeUtils.checkSizeRestrictions(b,c)&&n.openPinModeSizeRestrictionPanel({state:"on resize",title:"Notification_Box_PinToScreen_ElementTooLarge_postPin_Title",content:"Notification_Box_PinToScreen_ElementTooLarge_postPin_Message"})}}var g,h,i,j,k,l,m,n,o,e=b.utils.SnapToHandler,f=b.utils.layoutTransitionsUtil,p=["fill","fitWidth"],q={"wysiwyg.viewer.components.WPhoto":function(b){var c=n.components.properties.get(b);return a.includes(p,c.displayMode)},"wysiwyg.viewer.components.SiteButton":!0,"wysiwyg.common.components.imagebutton.viewer.ImageButton":!0,"wysiwyg.viewer.components.ClipArt":!0,"wysiwyg.viewer.components.svgshape.SvgShape":!0,"wysiwyg.viewer.components.MatrixGallery":!0,"tpa.viewer.components.Thumbnails":!0,"wysiwyg.viewer.components.PaginatedGridGallery":!0,"wysiwyg.viewer.components.SlideShowGallery":!0,"wysiwyg.viewer.components.Video":!0,"wysiwyg.viewer.components.mobile.TinyMenu":!0},r={right:{right:!0},left:{left:!0},top:{top:!0},bottom:{bottom:!0},topRight:{top:!0,right:!0},topLeft:{top:!0,left:!0},bottomRight:{bottom:!0,right:!0},bottomLeft:{bottom:!0,left:!0}},s={right:{x:1,y:0},left:{x:-1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},topRight:{x:1,y:-1},topLeft:{x:-1,y:-1},bottomRight:{x:1,y:1},bottomLeft:{x:-1,y:1}};return{start:D,on:E,end:F,type:c.RESIZE}}),define("rEditor/utils/mouseMoveActions/baseResizeAndPush",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c){"use strict";function h(a){return{x:a.pageX,y:a.pageY}}function i(b,c){f=b,e=c.comps,f.selection.setIsMouseUpSelectionEnabled(!1);var i=a.map(e,"id");f.renderPlugins.setCompsToShowOnTop(i);var j=h(c.evt),k=f.components.layout.getRelativeToScreen(e);g=new d.Resize(k,j,{x:0,y:1},!1)}function j(b){var c=h(b),d=g.getLayout(c),i=f.components.layout.getMinDimensions(e);d.bounding=f.utils.getBoundingLayout(d),d.height>=i.height&&f.components.layout.updateRelativeToScreenAndAdjustLayout(e,a.pick(d,["height","width"]),!0)}function k(){f.renderPlugins.setCompsToShowOnTop(null),f.history.add("Resize component")}var e,f,g,d=b.utils.layoutTransitionsUtil;return{start:i,on:j,end:k,type:c.RESIZE}}),define("rEditor/utils/mouseMoveActions/baseRotate",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c){"use strict";function m(a){n(a),i.components.layout.updateRelativeToScreen(h,a,!0)}function n(a){a.rotationInDegrees<0&&(a.rotationInDegrees+=360);var b=a.rotationInDegrees%k;j>=b?a.rotationInDegrees-=b:b>=k-j&&(a.rotationInDegrees+=k-b)}function o(a){var b=Math.floor(0>f?f+360:f),c=Math.floor(a.rotationInDegrees<0?a.rotationInDegrees+360:a.rotationInDegrees),d=c-b,e=Math.floor(d/l);a.rotationInDegrees=f+e*l,i.components.layout.updateRelativeToScreen(h,a,!0)}function p(b,c){h=c.comps,i=b,i.selection.setIsMouseUpSelectionEnabled(!1);var e=a.map(h,"id");i.renderPlugins.setCompsToShowOnTop(e);var f=i.components.layout.getRelativeToScreen(h),j=a.defaults({y:f.y+i.editorConfig.editingAreaLayout.top,x:f.x+i.editorConfig.editingAreaLayout.left},f),k={x:c.evt.pageX,y:c.evt.pageY};g=new d.Rotate(f,k,j)}function q(a){var b={x:a.pageX,y:a.pageY},c=g.getLayout(b);a.shiftKey?(e||(f=i.components.layout.getRelativeToScreen(h).rotationInDegrees),o(c)):m(c),e=a.shiftKey}function r(){i.waitForChangesApplied(function(){var a=i.components.layout.get(h).rotationInDegrees;i.bi.event(b.bi.events.editBox.ROTATE_COMPONENT,{value:parseInt(a,10),origin:"editBox"})}),i.renderPlugins.setCompsToShowOnTop(null),i.history.add("Rotate component")}var f,g,h,i,d=b.utils.layoutTransitionsUtil,e=!1,j=3,k=90,l=15;return{start:p,on:q,end:r,type:c.ROTATE}}),define("rEditor/utils/mouseMoveActions/baseDoubleClick",["lodash","core","gfppData"],function(a,b,c){"use strict";function d(d,e){var f=d.components.getType(e.comp),g=d.pluginService.getPlugin(d.pluginService.pluginConstants.DOUBLE_CLICK,f);if(a.isFunction(g))g(d,e);else{var h=c.getComponentMainActionClick(d,e.comp);a.isFunction(h)&&h(d,e.comp,b.constants.USER_ACTIONS.ORIGIN.DOUBLE_CLICK)}}return d}),define("rEditor/utils/mouseMoveActions/baseDragAndPush",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c){"use strict";function k(a,b){var c=b.x+b.width<=a.x,d=b.x>=a.x+a.width,e=!(c||d);return e&&b.y+b.height<=a.y}function l(b){var c=g.components.getSiblings(f),d=a(c).map(function(a){return g.components.layout.getRelativeToScreen(a)}).filter(function(a){return k(b,a)}).value();if(0===d.length)return 0;var e=a.max(d,function(a){return a.y+a.height});return e.y+e.height}function m(a){var b=g.components.getContainer(f),c=g.components.layout.getRelativeToScreen(b),d=l(a);return Math.max(d,c.y)}function n(b,c){g=b,f=c.comps,j=c.onDragAndPushEnd;var h=a.map(f,"id");g.renderPlugins.setCompsToShowOnTop(h);var k=a.omit(g.components.layout.getRelativeToScreen(f),"bounding"),l=a.map(f,function(b){return a.omit(g.components.layout.getRelativeToScreen(b),"bounding")});i=m(k);var n={x:c.evt.pageX,y:c.evt.pageY};e=new d.Drag(k,n,l)}function o(b){var c={x:b.pageX,y:b.pageY},d=e.getLayout(c);d.y=Math.max(d.y,i),h=e.getBoundComponentLayouts(d);for(var j=0;j<f.length;j++)g.components.layout.updateRelativeToScreenAndAdjustLayout(f[j],a.pick(h[j],"y"))}function p(){if(h){for(var b=0;b<f.length;b++)g.components.layout.updateRelativeToScreen(f[b],a.pick(h[b],"y"));h=null}g.renderPlugins.setCompsToShowOnTop(null),a.isFunction(j)&&j()}var e,f,g,h,j,d=b.utils.layoutTransitionsUtil,i=0;return{start:n,on:o,end:p,type:c.DRAG}}),define("rEditor/rootComps/selectionBox/groupSelectionFrame.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{},this.ancestorToStyle?a.createElement("div",{key:"markContainer",className:b.keys(b.pick({layout:!0,"secondary-component":!0},b.identity)).join(" "),style:this.boundingContainerStyle}):null)}}),define("rEditor/rootComps/selectionBox/groupSelectionFrame",["react","lodash","core","rEditor/rootComps/selectionBox/selectionBoxCommons","rEditor/rootComps/selectionBox/groupSelectionFrame.rt"],function(a,b,c,d,e){"use strict";function f(a,b){var c=a.multiselect.isMultiselect(b);return!c&&a.components.is.groupedComponent(b)}function g(a,b){return f(a,b)?d.findFirstContainerMatchingConditions(a,b,[a.components.is.group]):null}return a.createClass({displayName:"groupSelectionFrame",mixins:[c.mixins.editorAPIMixin],PropTypes:{selectedComponents:a.PropTypes.oneOfType([a.PropTypes.object,a.PropTypes.arrayOf(a.PropTypes.object)]).isRequired},componentWillUpdate:function(){var a=this.getEditorAPI();if(this.ancestorToStyle=g(a,this.props.selectedComponents),this.ancestorToStyle){var b=a.components.layout.getRelativeToScreen(this.ancestorToStyle);this.boundingContainerStyle=d.getBoundingStyle(a,b,this.props.selectedComponents,1)}},render:e})}),define("rEditor/rootComps/selectionBox/editBox.rt",["react/addons","lodash","core","baseUI","util","rEditor/rootComps/selectionBox/groupSelectionFrame","rEditor/rootComps/selectionBox/navControls"],function(a,b,c,d,e,f,g){"use strict";function h(c,d,e,f,g,h){return a.createElement("div",{className:b.keys(b.pick({layout:!0,"secondary-component":e,"show-on-all-pages":this.isCompShowOnAllPages(g)},b.identity)).join(" "),key:h,style:this.getSubComponentStyle(g)})}function i(b,c,d,e){var f=this.getPaddingStyle();return a.createElement("div",{className:"padding-wrapper",key:"paddingWrapper",style:f.wrapper},a.createElement("div",{className:"left-padding",style:f.left},a.createElement("div",{className:"min-indicator-margin",style:{top:this.getMarginLabelTop()}},this.possibleLayoutActionsMap.resizable&&this.isHorizontallyStretchedToScreen?a.createElement("span",{className:"indicator resizing",key:"resizeBoundingStyleLeft"},this.getMarginValue("left"),"\n                "):null)),a.createElement("div",{className:"right-padding",style:f.right},a.createElement("div",{className:"min-indicator-margin",style:this.layout.x<56?{right:0,position:"absolute",top:this.getMarginLabelTop()}:{top:this.getMarginLabelTop()}},this.possibleLayoutActionsMap.resizable&&this.isHorizontallyStretchedToScreen?a.createElement("span",{className:"indicator resizing",key:"resizeBoundingStyleRight"},this.getMarginValue("right"),"\n                "):null)))}function j(c,e,f,g){var h=this.getComponentData(this.props.selectedComponents);return a.createElement(d.tooltip,{id:this.getLinkedToTooltipId(h),key:this.getLinkedToTooltipId(h),value:this.getLinkDescriptionFromData(h),alignment:"right",delay:"500",width:"260px",marginsFromElement:9,disabled:!this.shouldShowLinkedToTooltip(e,h),shouldTranslate:!1,openTriggers:[d.uiConstants.TOOLTIP.TRIGGERS.IMMEDIATE,d.uiConstants.TOOLTIP.TRIGGERS.MOUSE_ENTER]},a.createElement("div",{className:b.keys(b.pick({layout:!0,"secondary-component":e,"show-on-all-pages":this.isCompShowOnAllPages(this.props.selectedComponents)},b.identity)).join(" "),style:e?this.getBoundingStyle():this.getLayoutStyle()},!this.isHorizontallyStretchedToScreen&&c.top&&c.left?a.createElement("span",{className:this.getResizeHandleCursorClass("TOP_LEFT")+" handle handle-resize-corner top left","data-direction-name":"topLeft",onMouseDown:this.startResize,key:"resizeTopLeft"}):null,c.top?a.createElement("span",{className:this.getResizeHandleCursorClass("TOP")+" handle handle-resize-side top","data-direction-name":"top",onMouseDown:this.startResize,key:"resizeTopCenter"}):null,!this.isHorizontallyStretchedToScreen&&c.top&&c.right?a.createElement("span",{className:this.getResizeHandleCursorClass("TOP_RIGHT")+" handle handle-resize-corner top right","data-direction-name":"topRight",onMouseDown:this.startResize,key:"resizeTopRight"}):null,c.right?a.createElement("span",{className:this.getResizeHandleCursorClass("RIGHT")+" handle handle-resize-side right","data-direction-name":"right",onMouseDown:this.startResize,key:"resizeMiddleRight"}):null,!this.isHorizontallyStretchedToScreen&&c.bottom&&c.right?a.createElement("span",{className:this.getResizeHandleCursorClass("BOTTOM_RIGHT")+" handle handle-resize-corner bottom right","data-direction-name":"bottomRight",onMouseDown:this.startResize,key:"resizeBottomRight"}):null,c.bottom?a.createElement("span",{className:this.getResizeHandleCursorClass("BOTTOM")+" handle handle-resize-side bottom","data-direction-name":"bottom",onMouseDown:this.startResize,key:"resizeBottomCenter"}):null,!this.isHorizontallyStretchedToScreen&&c.bottom&&c.left?a.createElement("span",{className:this.getResizeHandleCursorClass("BOTTOM_LEFT")+" handle handle-resize-corner bottom left","data-direction-name":"bottomLeft",onMouseDown:this.startResize,key:"resizeBottomLeft"}):null,c.left?a.createElement("span",{className:this.getResizeHandleCursorClass("LEFT")+" handle handle-resize-side left","data-direction-name":"left",onMouseDown:this.startResize,key:"resizeMiddleLeft"}):null,c.rotate?a.createElement("span",{className:"handle handle-rotate",onMouseDown:this.startRotate,key:"rotate",ref:"rotate"},a.createElement(d.symbol,{name:"rotate"})):null,c.rotate&&this.isComponentRotated()?a.createElement("span",{className:"handle handle-rotate-cancel",onMouseDown:this.cancelRotation,style:{transform:"rotate("+(360-this.layout.rotationInDegrees)+"deg) translate3d(0,0,0)"},key:"cancelRotate",ref:"cancelRotate"},a.createElement(d.symbol,{name:"rotateCancel"})):null,c.dragAndPush&&!this.isComponentRotated()?a.createElement(d.tooltip,{id:"dragWithAnchorsVerticalTooltip",key:"dragWithAnchorsVerticalTooltip",value:"ONSTAGE_DragHandle_Tooltip",alignment:"top",openTriggers:[],closeTriggers:[]},a.createElement("span",{className:"handle handle-push handle-drag-with-anchors",onMouseEnter:this.showDragWithAnchorsKnobTooltip,onMouseLeave:this.hideDragWithAnchorsKnobTooltip,onMouseDown:this.startDragAndPush,key:"dragWithAnchorsVertical"},a.createElement(d.symbol,{name:"pushAndEnforceAnchors"}))):null,!c.resizeAndPush||this.isComponentRotated()||f?null:a.createElement(d.tooltip,{id:"resizeWithAnchorsBottomTooltip",key:"resizeWithAnchorsBottomTooltip",value:"OnStage_StretchHandle_Tooltip",alignment:"bottom",openTriggers:[],closeTriggers:[]},a.createElement("span",{className:"handle handle-push handle-resize-with-anchors",onMouseEnter:this.showResizeWithAnchorsKnobTooltip,onMouseLeave:this.hideResizeWithAnchorsKnobTooltip,onMouseDown:this.startResizeAndPush,key:"resizeWithAnchorsBottom"},a.createElement(d.symbol,{name:"resizeAndEnforceAnchors"}))),this.possibleLayoutActionsMap.rotatable?a.createElement("span",{className:"indicator",style:{transform:"rotate("+(360-this.layout.rotationInDegrees)+"deg) translate3d(0,0,0)"},key:"rotationIndicator"},Math.floor(this.layout.rotationInDegrees),"°\n        "):null))}function k(){var c=this.getAllowedKnobsMap(),g=this.isMultiselect(),k=this.getEditorAPI().components.is.group(this.props.selectedComponents),l=e.translate;return a.createElement.apply(this,["div",{className:b.keys(b.pick(this.getEditBoxClasses(),b.identity)).join(" "),onContextMenu:this.props.onContextMenu,onDoubleClick:this.onDoubleClick},this.hasSubComponents()?b.map(this.getSubComponents(),h.bind(this,c,g,k,l)):null,a.createElement(f,{selectedComponents:this.props.selectedComponents}),this.shouldShowPadding()?i.apply(this,[c,g,k,l]):null,a.createElement("div",{className:b.keys(b.pick({bounding:!0,"show-on-all-pages":this.isCompShowOnAllPages(this.props.selectedComponents)},b.identity)).join(" "),style:this.getBoundingStyle()},this.possibleLayoutActionsMap.movable?a.createElement("span",{className:"indicator dragging",key:"dragBoundingStyle"}," x: ",parseInt(this.relativeToStructureLayout.bounding.x,10),", y: ",parseInt(this.relativeToStructureLayout.bounding.y,10),"\n        "):null,this.possibleLayoutActionsMap.resizable&&!this.isHorizontallyStretchedToScreen?a.createElement("span",{className:"indicator resizing",key:"resizeBoundingStyle"}," W: ",parseInt(this.relativeToStructureLayout.bounding.width,10),", H: ",parseInt(this.relativeToStructureLayout.bounding.height,10),"\n        "):null),j.apply(this,[c,g,k,l]),this.canBeMovedToFooter()?a.createElement("span",{className:"move-to-footer",key:"moveToFooter",style:this.getMoveToFooterStyle(),onMouseDown:this.moveToFooter},l("OnStage_MoveToFooter_Button"),"\n\n            ",a.createElement(d.symbol,{name:"moveToFooterArrow"})):null])}return function(){return k.apply(this,[])}}),define("rEditor/rootComps/selectionBox/editBox",["react","lodash","core","baseUI","experiment","rEditor/utils/mouseMoveActions/baseResize","rEditor/utils/mouseMoveActions/baseResizeAndPush","rEditor/utils/mouseMoveActions/baseRotate","rEditor/utils/mouseMoveActions/baseDoubleClick","rEditor/utils/mouseMoveActions/baseDragAndPush","util","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","rEditor/rootComps/selectionBox/selectionBoxCommons","rEditor/rootComps/selectionBox/editBox.rt","experiment!boxSlideShow"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";function v(a){return b.some(a,function(a){return b.includes(q,a.id)})}function w(a,b,d){c.utils.mouseScaleHandler.fitMouseCoordinatesToScale(a,b,d)}function x(a,b){var c=a.components.layout.getRelativeToScreen(b);return a.components.layout.isShowOnFixedPosition(b)&&(c.y+=a.editorConfig.editingAreaLayout.top,c.bounding.y+=a.editorConfig.editingAreaLayout.top,c.x+=a.editorConfig.editingAreaLayout.left,c.bounding.x+=a.editorConfig.editingAreaLayout.left),c}function y(a,b,c,d){if(a.isMobileEditor()||a.isCurrentPageLandingPage()||a.components.layout.isShowOnFixedPosition(b))return!1;var e=a.siteSegments.getPagesContainer(),f=a.components.layout.getRelativeToScreen(e),g=f.y+f.height-(c.bounding.y+c.bounding.height),h=g>=0&&p>=g;return h&&!d&&a.components.canShowOnAllPages(b)&&!a.text.isEditingText()}function z(a,b){return a.getCompRestrictions(a.components.is.page(b)?a.siteSegments.getPagesContainer():b)}function A(a){return!a||!b.isUndefined(a.left.px)&&0!==a.left.px?!1:0===a.left.vw}var p=21,q=["SITE_HEADER","SITE_FOOTE/**/R"],r=800,s={px:"px",pct:"%",vw:"%"},t=["TOP_LEFT","TOP","TOP_RIGHT","RIGHT","BOTTOM_RIGHT","BOTTOM","BOTTOM_LEFT","LEFT"],u=["top-left-resize-cursor","top-resize-cursor","top-right-resize-cursor","right-resize-cursor","bottom-right-resize-cursor","bottom-resize-cursor","bottom-left-resize-cursor","left-resize-cursor"];return a.createClass({displayName:"editBox",mixins:[c.mixins.editorAPIMixin],propTypes:{selectedComponents:a.PropTypes.oneOfType([a.PropTypes.object,a.PropTypes.arrayOf(a.PropTypes.object)]).isRequired,focusedContainer:a.PropTypes.object,isPinMode:a.PropTypes.bool,isDim:a.PropTypes.bool,isResizing:a.PropTypes.bool,isDragging:a.PropTypes.bool,isRotating:a.PropTypes.bool},prepareData:function(a){var b=this.getEditorAPI();this.layout=x.call(this,b,a.selectedComponents),this.relativeToStructureLayout=b.components.layout.getRelativeToStructure(a.selectedComponents),this.isShowOnAllPages=b.components.isShowOnAllPages(a.selectedComponents),this.possibleLayoutActionsMap=z(b,a.selectedComponents),this.isHorizontallyStretchedToScreen=b.components.layout.isHorizontallyStretchedToScreen(this.props.selectedComponents)},componentWillMount:function(){this.prepareData(this.props)},getEditBoxClasses:function(){return{"edit-box":!0,"edit-box-for-pin-mode":this.props.isPinMode,"edit-box-dim":this.props.isDim,movable:this.possibleLayoutActionsMap.horizontallyMovable||this.possibleLayoutActionsMap.verticallyMovable,"show-move-to-footer-button":this.shouldShowMoveToFooterButton,horizontallyStretched:this.isHorizontallyStretchedToScreen,"full-stretched":this.isHorizontallyStretchedToScreen&&A(this.layout.docked),dragging:this.props.isDragging,resizing:this.props.isResizing,rotating:this.props.isRotating,"small-width-component":this.layout.width<=50,"multi-select":this.isMultiselect()}},getLayoutStyle:function(a){a=a||this.layout;var b="rotate("+a.rotationInDegrees+"deg)",c={position:m.getPosition(this.getEditorAPI(),this.props.selectedComponents),top:a.y-1,left:a.x-1,width:a.width,height:a.height,transform:b,WebkitTransform:b};if(e.isOpen("se_editBoxPerformance")){var d="translate3d("+(a.x-1)+"px,"+(a.y-1)+"px,0) "+b;c.left=0,c.top=0,c.transform=d,c.WebkitTransform=d}return c},isComponentRotated:function(){return 0!==this.layout.rotationInDegrees},getMoveToFooterStyle:function(a){a=a||this.layout;var b=a.bounding.y+a.bounding.height,c=a.bounding.x+a.bounding.width/2;return{top:b-14,left:c}},getBoundingStyle:function(a){return m.getBoundingStyle(this.getEditorAPI(),a||this.layout,this.props.selectedComponents,1)},shouldShowPadding:function(){var a=!e.isOpen("se_screenWidthOff")&&e.isOpen("exp171"),b=a&&e.isOpen("se_screenWidthEditBox");return b&&this.isHorizontallyStretchedToScreen},getPaddingStyle:function(){var a=this.getEditorAPI().components.layout.isShowOnFixedPosition(this.props.selectedComponents)?"fixed":"absolute",b={top:this.layout.y-1,height:this.layout.height+2,position:a},c={top:0,bottom:0,left:0,width:this.layout.x},d={top:0,bottom:0,left:this.layout.x+this.layout.width,right:0};return{wrapper:b,left:c,right:d}},componentWillReceiveProps:function(a){this.prepareData(a);var b=this.getEditorAPI();this.props.isResizing||this.props.isRotating||this.props.isPinMode||!b.utils.isSameRef(this.props.selectedComponents,a.selectedComponents)?this.shouldShowMoveToFooterButton=!1:this.props.isDragging&&(this.shouldShowMoveToFooterButton=y(b,a.selectedComponents,this.layout,this.isShowOnAllPages))},getResizeHandleCursorClass:function(a){var c=b.indexOf(t,a),d=this.layout.rotationInDegrees+22.5;d>=360&&(d-=360);var e=Math.floor(d/45),f=c+e;f>=u.length&&(f-=u.length);var g=u[f];return g},getAllowedKnobsMap:function(){var a=this.getEditorAPI(),c=this.props.selectedComponents,d=this.possibleLayoutActionsMap,e=a.components.layout.RESIZE_SIDES;return{top:b.includes(d.resizeableSides,e.TOP)&&!v(c),bottom:b.includes(d.resizeableSides,e.BOTTOM)&&!v(c),left:b.includes(d.resizeableSides,e.LEFT),right:b.includes(d.resizeableSides,e.RIGHT),dragAndPush:a.multiselect.containsSiblingsOnly(c)&&(d.verticallyMovable||d.canMoveUp)&&!a.components.layout.isPinned(c),
resizeAndPush:!a.multiselect.isMultiselect(c)&&d.verticallyResizable&&!a.components.layout.isPinned(c),rotate:d.rotatable&&!a.components.layout.isPinned(c)}},startResize:function(a){var d=this.getEditorAPI();w(d,a,this.props.siteScale);var e=a.target.getAttribute("data-direction-name");d.registerMouseMoveAction(f,{evt:b.clone(a),directionName:e,comps:this.props.selectedComponents});var g=d.multiselect.isMultiselect(this.props.selectedComponents)?"multiselect":d.getComponentType(this.props.selectedComponents);d.bi.event(c.bi.events.editBox.RESIZE,{origin:"editBox",handle_value:e,component_type:g}),a.stopPropagation()},startRotate:function(a){var c=this.getEditorAPI();w(c,a,this.props.siteScale),this.getEditorAPI().registerMouseMoveAction(h,{evt:b.clone(a),comps:this.props.selectedComponents}),a.stopPropagation()},cancelRotation:function(a){var b=this.getEditorAPI();w(b,a,this.props.siteScale),b.selection.setIsMouseUpSelectionEnabled(!1),b.components.layout.update(this.props.selectedComponents,{rotationInDegrees:0}),b.bi.event(c.bi.events.editBox.CANCEL_ROTATE_COMPONENT),b.history.add("Rotation canceled"),a.stopPropagation()},canBeMovedToFooter:function(){var a=this.getEditorAPI(),b=!a.components.is.groupedComponent(this.props.selectedComponents),c=a.multiselect.areComponentsOfSamePage(this.props.selectedComponents);return b&&c},startDragAndPush:function(a){var d=this.getEditorAPI();w(d,a,this.props.siteScale);var e=d.components.is.page(this.props.selectedComponents)?[d.siteSegments.getPagesContainer()]:d.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(this.props.selectedComponents);d.registerMouseMoveAction(j,{evt:b.clone(a),comps:e}),d.bi.event(c.bi.events.editBox.DRAG_BY_HANDLE,{component_type:d.getComponentType(this.props.selectedComponents)}),this.hideKnobTooltip("dragWithAnchorsVerticalTooltip"),a.stopPropagation()},startResizeAndPush:function(a){var d=this.getEditorAPI();w(d,a,this.props.siteScale),d.registerMouseMoveAction(g,{evt:b.clone(a),comps:this.props.selectedComponents}),d.bi.event(c.bi.events.editBox.RESIZE_BY_HANDLE,{component_type:d.getComponentType(this.props.selectedComponents)}),this.hideKnobTooltip("resizeWithAnchorsBottomTooltip"),a.stopPropagation()},onDoubleClick:function(a){var b=this.getEditorAPI();if(w(b,a,this.props.siteScale),!b.selection.isMultiSelectKeyPressed(a)){var c={evt:a,comp:this.props.selectedComponents};i(b,c)}},showKnobTooltip:function(a){this.props.isResizing||this.props.isDragging||(this.showTooltipTimeout=setTimeout(function(){d.tooltipManager.show(a)},r))},hideKnobTooltip:function(a){this.showTooltipTimeout&&(clearTimeout(this.showTooltipTimeout),this.showTooltipTimeout=null),d.tooltipManager.hide(a)},showDragWithAnchorsKnobTooltip:function(){this.showKnobTooltip("dragWithAnchorsVerticalTooltip")},showResizeWithAnchorsKnobTooltip:function(){this.showKnobTooltip("resizeWithAnchorsBottomTooltip")},hideDragWithAnchorsKnobTooltip:function(){this.hideKnobTooltip("dragWithAnchorsVerticalTooltip")},hideResizeWithAnchorsKnobTooltip:function(){this.hideKnobTooltip("resizeWithAnchorsBottomTooltip")},moveToFooter:function(a){var b=this.getEditorAPI();w(b,a,this.props.siteScale);var d=b.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(this.props.selectedComponents);b.components.moveToFooter(d),b.bi.event(c.bi.events.editBox.MOVE_TO_FOOTER,{component_type:b.getComponentType(this.props.selectedComponents)}),this.shouldShowMoveToFooterButton=!1,a.stopPropagation()},hasSubComponents:function(){return this.getEditorAPI().components.is.group(this.props.selectedComponents)||this.isMultiselect()},getSubComponentStyle:function(a){var b=x.call(this,this.getEditorAPI(),a);return this.getLayoutStyle(b)},getSubComponents:function(){var a=this.getEditorAPI();return this.isMultiselect()?this.props.selectedComponents:a.components.getChildren(this.props.selectedComponents)},isCompShowOnAllPages:function(a){return this.getEditorAPI().components.isShowOnAllPages(a)||o&&this.getEditorAPI().components.isShownOnAllStates(a)},isMultiselect:function(){return this.getEditorAPI().multiselect.isMultiselect(this.props.selectedComponents)},getRotateKnobRect:function(){return this.layout.rotationInDegrees?this.refs.cancelRotate&&this.refs.cancelRotate.getDOMNode().getBoundingClientRect():this.refs.rotate&&this.refs.rotate.getDOMNode().getBoundingClientRect()},doesAncestorHaveStates:function(){return!!this.getAncestorCompWithStates()},getAncestorCompWithModes:function(){if(this.isMultiselect())return null;for(var a=this.getEditorAPI(),c=b.first([].concat(this.props.selectedComponents));c&&!a.components.modes.getModes(c);)c=a.components.getContainer(c);return c},getMarginLabelTop:function(){return this.layout.height/2-30},getComponentData:function(a){var c=this.getEditorAPI(),d=b.first(a);return c.components.data.get(d)},getLinkedToTooltipId:function(a){return a?"linkedTo-"+a.id:"linkedTo"},getLinkDescriptionFromData:function(b){if(!b)return"";var c=k.translate("mobile_link_notification_tooltip"),e=k.link.getLinkValueAsString(this.getEditorAPI(),b.link);return a.createElement(d.popoverTemplates.iconAndTextTooltip,{text:c+" "+e,icon:"mobileCompWithLink",shouldTranslate:!1})},shouldShowLinkedToTooltip:function(a,b){var c=this.getEditorAPI();return c.viewMode.get()!==c.viewMode.VIEW_MODES.MOBILE?!1:this.props.isDragging||this.props.isResizing||this.props.isRotating?!1:a?!1:b?!!b.link:!1},getMarginValue:function(a){var b=this.layout.docked&&this.layout.docked[a].px>=0?"px":"vw";return this.layout.docked&&this.layout.docked[a][b]+s[b]},render:n})}),define("rEditor/rootComps/compControls/compControls.rt",["react/addons","lodash","rEditor/rootComps/gfpp/gfpp","rEditor/rootComps/selectionBox/focusBox","rEditor/rootComps/selectionBox/editBox","core"],function(a,b,c,d,e,f){"use strict";function g(c,e){return a.createElement(d,b.assign({},{key:"focusBox-"+c.focusedContainer.id,ref:"focusBox-"+c.focusedContainer.id},c))}return function(){return a.createElement.apply(this,["div",{style:{visibility:1===this.props.siteScale?"visible":"hidden"}},this.props.panel?a.createElement(f.lazyComponent,b.assign({},{ref:"compPanel",moduleName:this.props.panel.name,key:f.lazyComponent.isLoaded(this.props.panel.name)?this.props.panel.name:"loading",onLoad:this.forceUpdate.bind(this)},this.getPanelProps())):null,b.map(this.getFocusBoxComps(),g.bind(this)),this.shouldRenderEditBox()?a.createElement(e,{ref:"editBox",key:"editBox",isDragging:this.props.isDragging,isResizing:this.props.isResizing,isRotating:this.props.isRotating,isPinMode:this.props.isPinMode,isDim:this.isDesignPanelOpen(),selectedComponents:this.props.selectedComponents,focusedContainer:this.props.focusedContainer,performingMouseMoveAction:this.props.performingMouseMoveAction,onContextMenu:this.props.onContextMenu,siteScale:this.props.siteScale}):null,this.shouldShowGfpp()?a.createElement(c,{key:"gfpp",ref:"gfpp",style:this.state.gfppStyle,selectedComponent:this.props.selectedComponents}):null])}}),define("rEditor/rootComps/compControls/compControls",["react","lodash","baseUI","core","jquery","rEditor/rootComps/compControls/compControls.rt"],function(a,b,c,d,e,f){"use strict";function l(a,b,c){return c=c||0,Math.abs(a-b)<=c}function m(a,b){return Math.ceil(a-b+j)}function n(a,b){if(!b)return k;var c={top:m(a.y,b.top),bottom:m(b.bottom,a.y+a.height),left:m(a.x,b.left),right:m(b.right,a.x+a.width)};return c}function o(a){var b=a.siteSegments.getPagesContainer();return a.components.layout.getRelativeToScreen(b).x}function p(a){var b=d.utils.stageUtils.getStageLayout();return a.x<=0&&a.width>=b.width}function q(a,c){var d=!b.isEqual(a.hoveredComp,c.hoveredComp),e=!b.isEqual(a.selectedComponents,c.selectedComponents),f=!c.performingMouseMoveAction||a.performingMouseMoveAction!==c.performingMouseMoveAction;return f&&(!d||e)}function r(a,b,e,f){var i,h=this.getEditorAPI();this.isCompRequiresCustomGfppPos(a,this.props.selectedComponents)&&(i=this.props.lastSelectionClickPos);var j=p(a),k=o(h),l=!a.fixedPosition,m=d.utils.stageUtils.getViewPort(l,h.getLeftBarButtonsBoundingRect()),n=this.props.focusedContainer&&this.props.focusedContainer.id!==this.props.selectedComponents[0].id,q=!n&&this.shouldShowFocusBox(this.props.focusedContainer)?this.refs["focusBox-"+this.props.focusedContainer.id].getNavControlsSize():null,r=this.props.focusedContainer&&this.getBoundingLayoutRelativeToScreen(this.props.focusedContainer);return n&&r.height>a.height+2*c.uiConstants.VIEWPORT_VERTICAL_MARGINS&&(m.y=Math.max(m.y,r.y+c.uiConstants.VIEWPORT_VERTICAL_MARGINS),m.height=Math.min(m.height,r.height-2*c.uiConstants.VIEWPORT_VERTICAL_MARGINS),m.bottomY=Math.min(m.bottomY,r.y+r.height-c.uiConstants.VIEWPORT_VERTICAL_MARGINS)),j?g.getFullWidthCompPositions(a,m,b,e,k,q,i):g.getCompControlsPositions(e,q,b,a,m,f,i)}var g=d.utils.compControlsMeasurer,h=["wysiwyg.common.components.anchor.viewer.Anchor"],i=["wysiwyg.viewer.components.WRichText","wysiwyg.viewer.components.HoverBox","wysiwyg.viewer.components.BoxSlideShow","wysiwyg.viewer.components.StripContainerSlideShow"],j=3,k={top:0,bottom:0,left:0,right:0};return a.createClass({displayName:"compControls",mixins:[d.mixins.editorAPIMixin],propTypes:{panel:a.PropTypes.shape({name:a.PropTypes.string,props:a.PropTypes.object}),isDragging:a.PropTypes.bool,isResizing:a.PropTypes.bool,isRotating:a.PropTypes.bool,isSectionDragging:a.PropTypes.bool,selectedComponents:a.PropTypes.arrayOf(a.PropTypes.object).isRequired,focusedContainer:a.PropTypes.object,focusBoxGridLines:a.PropTypes.object,hoveredComp:a.PropTypes.oneOfType([a.PropTypes.bool,a.PropTypes.object]),performingMouseMoveAction:a.PropTypes.bool,lastSelectionClickPos:a.PropTypes.object,onContextMenu:a.PropTypes.func,editingAreaLayout:a.PropTypes.object},getInitialState:function(){return this.panelReady=!1,this.lastMeasuredPanelHeight=0,this.throttledSetCompsStyle=b.throttle(this.setCompsStyle,50,{leading:!1,trailing:!0}),{gfppStyle:{top:0,left:0,visibility:"hidden",position:"absolute"},compPanelStyle:{top:0,left:0,opacity:0,visibility:"hidden"}}},isCompsStyleSet:function(){return!this.props.panel||"hidden"!==this.state.compPanelStyle.visibility&&!!this.lastMeasuredPanelHeight&&0!==this.state.compPanelStyle.left&&0!==this.state.compPanelStyle.top},shouldShowGfpp:function(){return!this.props.isDragging&&!this.props.isResizing&&!this.props.isRotating},getBoundingLayoutRelativeToScreen:function(a){var c=this.getEditorAPI(),d=c.components.layout.getRelativeToScreen(a);return b.assign(d.bounding,{fixedPosition:c.components.layout.isShowOnFixedPosition(a),rotationInDegrees:d.rotationInDegrees})},getCompControlsStyles:function(a,c,d,e,f){var g=this.getEditorAPI(),h=this.props.panel&&(a||!this.isCompsStyleSet()),i=r.call(this,e,d,c,f);if(i.gfppStyle.visibility="inherit",i.gfppStyle.visibility="inherit",h){if(i.compPanelStyle.top+=this.props.editingAreaLayout.top,b.has(i.compPanelStyle,"left")&&(i.compPanelStyle.left+=this.props.editingAreaLayout.left),!e.fixedPosition){var j=g.ui.scroll.getScroll();i.compPanelStyle.top-=j.scrollTop}b.assign(i.compPanelStyle,this.getPanelStyle())}else i=b.pick(i,"gfppStyle","navControlsStyle");return e.fixedPosition?(i.gfppStyle.top+=this.props.editingAreaLayout.top,b.has(i.gfppStyle,"left")&&(i.gfppStyle.left+=this.props.editingAreaLayout.left),i.gfppStyle.position="fixed"):i.gfppStyle.position="absolute",this.props.isPinMode&&(i.gfppStyle.visibility="hidden"),i},getPanelStyle:function(){var a={};return this.panelReady?(a.visibility="inherit",a.opacity=1):(a.visibility="hidden",a.opacity=0),a},isCompRequiresCustomGfppPos:function(a){var d=this.getEditorAPI(),e=b.includes(i,d.components.getType(this.props.selectedComponents));if(e)return!1;var f=c.uiConstants.CUSTOM_GFPP_POS.HEIGHT_TO_APPLY;return a.height>=f},getRotateKnobRect:function(){return this.refs.editBox&&this.refs.editBox.getRotateKnobRect()},isDesignPanelOpen:function(){var a=this.getEditorAPI().panelManager.getOpenPanels();return!!b.find(a,{name:"designPanel.designPanel"})},getRotateKnobMargins:function(a){if(!a.rotationInDegrees)return k;var b=this.getRotateKnobRect();if(!b)return k;var c=this.getEditorAPI().ui.scroll.getScroll(),d=c.scrollTop-this.props.editingAreaLayout.top,e=c.scrollLeft-this.props.editingAreaLayout.left;return b={top:b.top+d,bottom:b.bottom+d,left:b.left+e,right:b.right+e},n(a,b)},setCompsStyle:function(a){var c=this.refs.gfpp?this.refs.gfpp.getSize():null;if(this.props.isPinMode&&(c={width:0,height:0}),c){var d=this.refs.compPanel?this.refs.compPanel.getDOMNode():null;this.lastMeasuredPanelHeight=d?e(d).height():0;var f=this.getBoundingLayoutRelativeToScreen(this.props.selectedComponents),g=this.getRotateKnobMargins(f),h=this.getCompControlsStyles(a,c,d,f,g);this.lastMeasuredPanelHeight||(h.compPanelStyle={top:0,left:0,opacity:0,visibility:"hidden"});var i=b.pick(this.state,b.keys(h)),j=b.every(h,function(a,b){return l(i[b].top,a.top,2)&&l(i[b].left,a.left,2)&&i[b].visibility===a.visibility&&i[b].position===a.position});j||this.setState(h)}},onWindowScroll:function(){this.setCompsStyle()},onWindowResize:function(){this.debouncedSetCompsStyle||(this.debouncedSetCompsStyle=b.debounce(this.setCompsStyle,200)),this.debouncedSetCompsStyle(!0)},shouldShowFocusBox:function(a){var c=b.get(a,"id")===b.first(this.props.selectedComponents).id;return a&&!(this.props.performingMouseMoveAction&&c)},getFocusBoxComps:function(){var a=this.getEditorAPI(),b=this.props.focusedContainer,c=this.props.selectedComponents,d=[];return this.shouldShowFocusBox(b)&&(d.push({focusedContainer:b,selectedComponents:c,showNavControl:!0,navControlsStyle:this.state.navControlsStyle,gridLines:this.props.focusBoxGridLines}),a.components.is.focusParent(b)&&d.push({focusedContainer:a.components.getContainer(b),selectedComponents:c,showNavControl:!1})),d},shouldRenderEditBox:function(){if(!this.props.selectedComponents||this.props.isSectionDragging)return!1;var a=this.getEditorAPI().components.getType(this.props.selectedComponents);return!b.includes(h,a)},componentDidMount:function(){this.throttledSetCompsStyle();var a=this.getEditorAPI();a.ui.scroll.addListener(this.onWindowScroll),window.addEventListener("resize",this.onWindowResize)},componentWillUnmount:function(){var a=this.getEditorAPI();a.ui.scroll.removeListener(this.onWindowScroll),window.removeEventListener("resize",this.onWindowResize)},componentWillReceiveProps:function(a){var c={};b.isEqual(this.props.panel,a.panel)||(c.compPanelStyle={top:0,left:0,opacity:0,visibility:"hidden"},a.panel||(this.panelReady=!1));var d=!this.getEditorAPI().utils.isSameRef(this.props.selectedComponents,a.selectedComponents),e=!this.props.performingMouseMoveAction&&a.performingMouseMoveAction;(d||e)&&(c.gfppStyle={top:0,left:0,visibility:"hidden",position:"absolute"},c.compPanelStyle={top:0,left:0,opacity:0,visibility:"hidden"}),b.isEmpty(c)||this.setState(c)},componentDidUpdate:function(a){q(a,this.props)&&this.throttledSetCompsStyle()},onCompPanelLoaded:function(){this.panelReady=!0,this.throttledSetCompsStyle()},getPanelProps:function(){return b.assign({onCompPanelLoaded:this.onCompPanelLoaded,style:this.state.compPanelStyle,selectedComponent:this.props.selectedComponents},this.props.panel.props)},render:f})}),define("rEditor/rootComps/attachHighlight/attachHighlight.rt",["react/addons","lodash","experiment!attachImprovements"],function(a,b,c){"use strict";return function(){return a.createElement("div",{},c?a.createElement("div",{key:"attach-highlight",className:"attach-highlight"},a.createElement("div",{className:b.keys(b.pick({"highlight-container-exp":!0,master:this.isShowOnAllPages(),box:this.isBoxContainer()},b.identity)).join(" "),style:this.getBoxPosition()},a.createElement("label",{},this.translateIfNeeded(this.getAttachTranslationKey(this.state.compLabel)))),a.createElement("div",{style:this.getAttachOverlayLayoutStyle(),className:"attach-overlay"})):null,c?null:a.createElement("div",{key:"attachImprovements",className:b.keys(b.pick({"highlight-container":!0,master:this.isShowOnAllPages()},b.identity)).join(" "),style:this.getPosition()},a.createElement("label",{},this.translateIfNeeded(this.getAttachTranslationKey(this.state.compLabel)))))}}),define("rEditor/rootComps/attachHighlight/attachHighlight",["react","core","lodash","rEditor/rootComps/attachHighlight/attachHighlight.rt","util","experiment!attachImprovements","rEditor/rootComps/selectionBox/selectionBoxCommons"],function(a,b,c,d,e,f,g){"use strict";function i(a,b){return a.components.layout.getRelativeToScreen(b)}function j(a){var b=a.selection.getSelectedComponents()[0];return i(a,b)}function k(a,b){var c=a.components.layout.getRelativeToScreen(b);return a.components.layout.isShowOnFixedPosition(b)&&(c.y+=a.editorConfig.editingAreaLayout.top,c.bounding.y+=a.editorConfig.editingAreaLayout.top,c.x+=a.editorConfig.editingAreaLayout.left,c.bounding.x+=a.editorConfig.editingAreaLayout.left),c}var h={HeaderContainer:"OnStage_AttachTo_Header",Page:"OnStage_AttachTo_Page",FooterContainer:"OnStage_AttachTo_Footer",Container:"OnStage_AttachTo_Box",HoverBox:"OnStage_AttachTo_Hover_Box",BoxSlideShowSlide:"OnStage_AttachTo_Slide",StripContainerSlideShowSlide:"OnStage_AttachTo_Slide",StripContainer:"OnStage_AttachTo_Strip",Column:"OnStage_AttachTo_Column"},l={displayName:"attachHighlight",mixins:[b.mixins.editorAPIMixin,e.translationMixin],getInitialState:function(){var a=c.last(this.getEditorAPI().components.getType(this.props.comp).split("."));return{compLabel:this.props.comp&&h[a]}},componentWillReceiveProps:function(a){this.setState({compLabel:a.comp&&h[c.last(this.getEditorAPI().components.getType(this.props.comp).split("."))]})},isShowOnAllPages:function(){return this.getEditorAPI().components.isShowOnAllPages(this.props.comp)},getAttachTranslationKey:function(){var a=c.last(this.getEditorAPI().components.getType(this.props.comp).split("."));return h[a]},getPosition:function(){var a=this.getEditorAPI(),b=k(a,this.props.comp),c=g.getPosition(a,this.props.comp);return{top:b.y-2,left:b.x-2,height:b.height,width:b.width,position:c}},render:d};return f&&c.assign(l,{getBoxPosition:function(){var a=i(this.getEditorAPI(),this.props.comp);return{top:a.y,left:a.x,height:a.height,width:a.width}},getAttachOverlayLayoutStyle:function(){var a=j(this.getEditorAPI());return{top:a.y,left:a.x,width:a.width,height:a.height}},isBoxContainer:function(){return"mobile.core.components.Container"===this.getEditorAPI().components.getType(this.props.comp)}}),a.createClass(l)}),define("rEditor/rootComps/constraintArea/constraintArea.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{className:"constraint-area",style:this.getPosition()},a.createElement("div",{className:"box"},a.createElement("label",{},this.translateIfNeeded("mobilemenu_Settings_fixed_area_label"))))}}),define("rEditor/rootComps/constraintArea/constraintArea",["react","core","lodash","util","rEditor/rootComps/constraintArea/constraintArea.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"constraintArea",mixins:[b.mixins.editorAPIMixin,d.translationMixin],getPosition:function(){var a=this.props.area;return{top:a.top,left:a.left,height:a.height,width:a.width}},render:e})}),define("rEditor/rootComps/snapLayer/snapLayer.rt",["react/addons","lodash"],function(a,b){"use strict";function c(c,d){return a.createElement("rect",{className:b.keys(b.pick({"show-on-all-pages":c.isShowOnAllPages},b.identity)).join(" "),x:c.x,y:c.y,height:c.height,width:c.width,key:"rectDrawData"+d})}function d(b,c){return a.createElement("line",{x1:b[0].x,y1:b[0].y,x2:b[1].x,y2:b[1].y,key:"snapLine"+c})}return function(){return this.props.snapData?a.createElement("div",{className:"snap-layer",key:"layer"},a.createElement.apply(this,["svg",{},b.map(this.getRectanglesDrawData(),c.bind(this)),b.map(this.getLines(),d.bind(this))])):null}}),define("rEditor/rootComps/snapLayer/snapLayer",["react","lodash","rEditor/rootComps/snapLayer/snapLayer.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"snapLayer",propTypes:{snapData:a.PropTypes.array},getRectanglesDrawData:function(){var a=b(this.props.snapData).pluck("rectanglesDrawData").flatten().value();return a},getLines:function(){return b.pluck(this.props.snapData,"line")},render:c})}),define("rEditor/rootComps/anchor/anchor.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:"anchorWrapper",style:{top:this.getTopPosition()}},a.createElement("div",{className:"anchor-line before"}),a.createElement("div",{className:"anchor "+(this.props.isSelected?"anchor-selected":"")},a.createElement("div",{className:"anchorContent",onMouseDown:this.onMouseDown,onContextMenu:this.props.onContextMenu,onDoubleClick:this.onDoubleClick},a.createElement(c.symbol,{className:"anchorIcon",name:"anchor"}),a.createElement("div",{className:"anchorName"},this.getAnchorName()),a.createElement(c.symbol,{className:"rightIcon",name:this.isLocked()?"anchorLock":"anchorDragHandle"}))),a.createElement("div",{className:"anchor-line after-with-sections-reorganize"}))}}),define("rEditor/rootComps/anchor/anchor",["react","lodash","core","rEditor/utils/mouseMoveActions/baseDoubleClick","rEditor/rootComps/anchor/anchor.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"anchor",propTypes:{compRef:a.PropTypes.object.isRequired,isSelected:a.PropTypes.bool.isRequired},mixins:[c.mixins.editorAPIMixin],getInitialState:function(){return this.editorAPI=this.getEditorAPI(),{}},getAnchorName:function(){var a=this.editorAPI.components.data.get(this.props.compRef);return a.name},onDoubleClick:function(a){var b={evt:a,comp:[this.props.compRef]};d(this.getEditorAPI(),b)},getTopPosition:function(){return this.editorAPI.components.layout.getRelativeToStructure(this.props.compRef).y},isLocked:function(){return!1},render:e})}),define("rEditor/rootComps/anchor/anchorsContainer.rt",["react/addons","lodash","rEditor/rootComps/anchor/anchor"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c,{key:"anchor"+d,compRef:b,onContextMenu:this.props.onContextMenu,isSelected:this.isSelectedComp(b)})}return function(){return a.createElement.apply(this,["div",{className:b.keys(b.pick({"anchors-container":!0,"mobile-editor":this.editorAPI.isMobileEditor()},b.identity)).join(" ")},b.map(this.getAnchors(),d.bind(this))])}}),define("rEditor/rootComps/anchor/anchorsContainer",["react","lodash","core","rEditor/rootComps/anchor/anchorsContainer.rt"],function(a,b,c,d){"use strict";var e="wysiwyg.common.components.anchor.viewer.Anchor";return a.createClass({displayName:"stageComps",mixins:[c.mixins.editorAPIMixin],getInitialState:function(){return this.editorAPI=this.getEditorAPI(),{}},getAnchors:function(){var a=this.editorAPI.pages.getReference(this.editorAPI.pages.getCurrentPageId());return this.editorAPI.components.get.byType(e,a)},isSelectedComp:function(a){return this.editorAPI.selection.isComponentSelected(a)},render:d})}),define("rEditor/rootComps/selectionBox/hoverBox.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("div",{style:this.getHoverBoxStyles(),className:b.keys(b.pick(this.getClasses(),b.identity)).join(" ")},a.createElement("span",{ref:"label",className:b.keys(b.pick(this.getLabelClasses(),b.identity)).join(" "),style:this.getHoverBoxLabelStyles()},this.isCompPinned()?a.createElement(c.symbol,{name:"pinModeIndicator",key:"pinModeIndicator",className:b.keys(b.pick(this.getIndicatorClasses(),b.identity)).join(" ")}):null,a.createElement("span",{className:"actual-label"},this.getComponentLabel())))}}),define("rEditor/rootComps/selectionBox/hoverBox",["lodash","react","jquery","core","rEditor/rootComps/selectionBox/hoverBox.rt"],function(a,b,c,d,e){"use strict";function f(a,b){var c=a.components.layout.getRelativeToScreen(b);return a.components.layout.isShowOnFixedPosition(b)&&(c.y+=a.editorConfig.editingAreaLayout.top,c.bounding.y+=a.editorConfig.editingAreaLayout.top,c.x+=a.editorConfig.editingAreaLayout.left,c.bounding.x+=a.editorConfig.editingAreaLayout.left),c}function g(a,b){return a.outerWidth()/b.outerWidth()<2}function h(a,b){var c=d.utils.stageUtils.getViewPort();return a.offset().left-b.width()>c.x}function i(a,b){return"SITE_FOOTER"===b.id||"SITE_HEADER"===b.id||b.id===a.pages.getCurrentPageId()}function j(a,b){return g(a,b)?h(a,b)?k.LEFT:k.RIGHT:k.INNER}var k={INNER:"inner",LEFT:"left",RIGHT:"right"},l=2;return b.createClass({displayName:"hoverBox",mixins:[d.mixins.editorAPIMixin],getInitialState:function(){return{labelPosition:k.INNER,shouldCalculateLabelPosition:!0}},componentWillMount:function(){this.isMovable=this.getEditorAPI().components.is.verticallyMovable(this.props.hoveredComp)||this.getEditorAPI().components.is.horizontallyMovable(this.props.hoveredComp)},componentDidMount:function(){if(this.state.shouldCalculateLabelPosition){var a=c(this.getDOMNode()),b=c(this.refs.label.getDOMNode());this.setState({labelPosition:j(a,b),shouldCalculateLabelPosition:!1})}},componentDidUpdate:function(){if(this.state.shouldCalculateLabelPosition){var a=c(this.getDOMNode()),b=c(this.refs.label.getDOMNode());this.setState({labelPosition:j(a,b),shouldCalculateLabelPosition:!1})}},componentWillReceiveProps:function(a){a.hoveredComp.id!==this.props.hoveredComp.id&&(this.isMovable=this.getEditorAPI().components.is.verticallyMovable(a.hoveredComp)||this.getEditorAPI().components.is.horizontallyMovable(a.hoveredComp),this.setState({shouldCalculateLabelPosition:!0}))},getComponentLabel:function(){var a=this.getEditorAPI(),b=a.selection.getSelectedComponents(),c=a.utils.isSameRef(b,this.props.hoveredComp);return c?"":a.components.getDisplayName(this.props.hoveredComp)},getHoverBoxStyles:function(){var b=f(this.getEditorAPI(),this.props.hoveredComp),c={top:b.y-1,left:b.x-1,width:b.width,height:b.height};if(b.rotationInDegrees){var d="rotate("+b.rotationInDegrees+"deg)";a.assign(c,{transform:d,WebkitTransform:d})}var e=this.getEditorAPI().components.is.fullWidth(this.props.hoveredComp);return e&&a.assign(c,{borderLeft:0,borderRight:0}),c},getClasses:function(){var a=this.getEditorAPI(),b=this.props.hoveredComp;return{"hover-box":!0,"show-on-all-pages":a.components.isShowOnAllPages(b),"fixed-position":a.components.layout.isShowOnFixedPosition(b),overlay:this.props.overlay}},getHoverBoxLabelStyles:function(){var a=this.getEditorAPI();if(a.components.is.fullWidth(this.props.hoveredComp)){var b=a.isMobileEditor()?0:a.siteSegments.getPagesContainerAbsLayout().x+l;return{left:b}}},getLabelClasses:function(){var a=i(this.getEditorAPI(),this.props.hoveredComp);return{"comp-label":!0,"label-large":a,"label-inner":!a&&this.state.labelPosition===k.INNER,"label-left":!a&&this.state.labelPosition===k.LEFT,"label-right":!a&&this.state.labelPosition===k.RIGHT}},getIndicatorClasses:function(){return{"show-on-all-pages":this.getEditorAPI().components.isShowOnAllPages(this.props.hoveredComp)}},isCompPinned:function(){return this.getEditorAPI().components.layout.isPinned(this.props.hoveredComp)},render:e})}),define("rEditor/rootComps/lasso/lasso.rt",["react/addons","lodash"],function(a,b){"use strict";function c(c,d){return a.createElement("rect",b.assign({},{className:b.keys(b.pick({"lasso-candidate":!0,"show-on-all-pages":this.getEditorAPI().components.isShowOnAllPages(c.component)},b.identity)).join(" "),key:d},c.layout.bounding))}return function(){return a.createElement("div",{className:"lasso-layer"},a.createElement.apply(this,["svg",{className:"lasso-highlights"},a.createElement("rect",b.assign({},{className:"lasso-rect"},this.props.lassoLayout)),b.map(this.props.candidates,c.bind(this))]))}}),define("rEditor/rootComps/lasso/lasso",["react","lodash","core","rEditor/rootComps/lasso/lasso.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"lasso",mixins:[c.mixins.editorAPIMixin],propTypes:{lassoLayout:a.PropTypes.shape({x:a.PropTypes.number,y:a.PropTypes.number,width:a.PropTypes.number,height:a.PropTypes.number}),candidates:a.PropTypes.arrayOf(a.PropTypes.shape({component:a.PropTypes.object,layout:a.PropTypes.object}))},render:d})}),define("rEditor/rootComps/mouseCatcher.rt",["react/addons","lodash","uiConstants","rEditor/rootComps/compControls/compControls","rEditor/rootComps/attachHighlight/attachHighlight","rEditor/rootComps/constraintArea/constraintArea","rEditor/rootComps/snapLayer/snapLayer","rEditor/rootComps/anchor/anchorsContainer","rEditor/rootComps/selectionBox/hoverBox","rEditor/rootComps/lasso/lasso"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(){var b=this.getMarginsIndicatorStyles(this.getCompToShowMarginsIndicator());return a.createElement("div",{key:"marginsIndicator",className:"margins-indicator",style:b.indicator},b.marginLeft?a.createElement("div",{key:"leftMarginIndicator",className:"left",style:{width:b.marginLeft+c.FOCUS_FRAME_BORDER_WIDTH}}):null,b.marginRight?a.createElement("div",{key:"rightMarginIndicator",className:"right",style:{width:b.marginRight-c.FOCUS_FRAME_BORDER_WIDTH}}):null)}return function(){return a.createElement("div",{className:b.keys(b.pick({parentSizeAbs:!0,mouseCatcher:!0,draggable:this.isCompDraggable()},b.identity)).join(" "),onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onDoubleClick:this.onDoubleClick,onContextMenu:this.props.onContextMenu,onMouseMove:this.onMouseMove,onMouseLeave:this.clearHoverBox},this.props.editorState.constraintArea?a.createElement(f,{key:"constraintArea",area:this.props.editorState.constraintArea}):null,this.props.editorState.attachCandidate?a.createElement(e,{key:"attachHighlight",comp:this.props.editorState.attachCandidate}):null,this.props.editorState.lassoLayout?a.createElement(j,{key:"lassoLayout",lassoLayout:this.props.editorState.lassoLayout,candidates:this.props.editorState.lassoCandidates}):null,1===this.props.editorState.siteScale&&this.props.hoveredComp&&this.getEditorAPI().components.is.exist(this.props.hoveredComp)&&!this.props.editorState.pinMode?a.createElement(i,{overlay:this.props.hoverBoxOverlay,hoveredComp:this.props.hoveredComp,key:"hoverBox"}):null,1===this.props.editorState.siteScale&&this.props.selectedComponents?a.createElement(d,{key:"compControls",isDragging:this.props.isDragging,isResizing:this.props.isResizing,isRotating:this.props.isRotating,performingMouseMoveAction:this.props.performingMouseMoveAction,selectedComponents:this.props.selectedComponents,focusedContainer:this.props.focusedContainer,focusBoxGridLines:this.props.focusedContainer&&this.getFocusBoxGridLines(),hoveredComp:this.props.hoveredComp,lastSelectionClickPos:this.props.editorState.lastSelectionClickPos,panel:this.props.compPanel,editingAreaLayout:this.props.editingAreaLayout,siteScale:this.props.siteScale,isPinMode:this.props.isPinMode,onContextMenu:this.props.onContextMenu,isSectionDragging:this.props.isSectionDragging}):null,a.createElement(g,{key:"snapLayer",snapData:this.props.editorState.snapData}),this.props.editorState.previewMode||!this.props.editorIsInit||this.props.editorState.pinMode?null:a.createElement(h,{key:"anchorsContainer",onContextMenu:this.props.onContextMenu}),this.showMarginsIndicator()?k.apply(this,[]):null)}}),define("rEditor/utils/mouseMoveActions/baseDrag",["core","lodash","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","experiment!attachImprovements"],function(a,b,c,d){"use strict";function A(a){return q=s&&(q||Math.abs(a.pageX-v.x)>2||Math.abs(a.pageY-v.y)>2)}function B(a){if(x){var b=x.getClosestLayoutDistance(u,a.bounding,p);Math.abs(b.x)<5&&(a.x+=b.x,a.bounding.x+=b.x),Math.abs(b.y)<5&&(a.y+=b.y,a.bounding.y+=b.y)}}function C(a){a.x-=a.x%5,a.y-=a.y%5}function D(a){if(x){var b=x.getSnapData(a.bounding,p);u.snapData.set(b)}}function E(a){var c=b.some(a,function(a){return u.components.is.groupedComponent(a)},this);return!c}function F(a){return b.map(a,function(a){var b={component:a,attachUtil:new f(u,{comp:a,layout:u.components.layout.getRelativeToScreen(a)
},f.TYPES.COMP)};return b})}function G(a,c){if(a&&!a.isShiftPressed)return!0;var d=!1;if(a&&a.isShiftPressed&&!b.isEmpty(c))for(var e=H(c),f=a.x-u.editorConfig.editingAreaLayout.left,g=a.y-u.editorConfig.editingAreaLayout.top,h=0;h<e.length&&!d;h++){var i=e[h];d=d||I(f,g,i)}return d}function H(a){return b.map(a,function(a){return u.components.layout.getRelativeToScreen(a)})}function I(a,b,c){return c&&a>=c.x&&a<=c.x+c.width&&b>=c.y&&b<=c.y+c.height}function J(a){var b=w?w:v;return{x:Math.abs(b.x-a.x),y:Math.abs(b.y-a.y)}}function K(a){var b=J(a);return b.x>e||b.y>e}function L(){return m&&!u.multiselect.isMultiselect(l)}function M(c,d){c=b.isArray(c)?c:[c],d=b.isArray(d)?d:[d];var e=u.components.getType(c),f=u.components.getType(b.first(d)),g=b(d).map(u.components.getType).every(function(a){return a===f}),h=g?f:"MultiSelect";u.bi.event(a.bi.events.editBox.ATTACH_TO,{component_type:e,target_component:h})}function N(){if(m){var a=[],c=b.map(o,function(b){var c=b.attachUtil.getCurrentAttachCandidate(),d=b.component;if(c){var e=u.components.setContainer(d,c);return a.push(c),e}return d});M(c,a),u.selection.selectComponentByCompRef(c)}}function O(a){if(m){var b={x:a.clientX,y:a.clientY},c=n.getCurrentAttachCandidate(null,b);if(c){var d=u.components.setContainer(l,c);u.selection.selectComponentByCompRef(d),M(d,c)}}}function P(a,c){if(u=u||a,q=!1,l=c.selectedComp,v=c.initMousePosition,w=null,y=u.components.is.horizontallyMovable(c.selectedComp),z=u.components.layout.getRelativeToScreen(l),!c.initMousePosition||!G(v,l))return void(s=!1);s=!0;var e=u.components.layout.getRelativeToScreen(l),p=b.map(l,function(a){return u.components.layout.getRelativeToScreen(a)});m=E(l),u.multiselect.isMultiselect(l)?o=F(l):n=d?new g(u,{layout:e,comp:l},f.TYPES.COMP):new f(u,{layout:e,comp:l},f.TYPES.COMP),t=new j(u,l),x=new h(u,l),k=new i.Drag(z,v,p)}function Q(c){var d={x:c.pageX,y:c.pageY};if(A(c)){if(u.selection.setIsMouseUpSelectionEnabled(!1),!r){var e=b.map(l,"id");u.renderPlugins.setCompsToShowOnTop(e),r=!0}var f={x:c.pageX,y:c.pageY,isShiftPressed:c.shiftKey},g=k.getLayout(f);u.multiselect.isMultiselect(l)&&(g=a.utils.updateLayoutUtil.getLayoutRelativeToScreenAfterConstraints(u,l,g,z)),y||(g.x=z.x),c.altKey?C(g):u.getViewTools().snapToEnabled&&(K(d)?u.snapData.clear():(g.bounding=u.utils.getBoundingLayout(g),B(g),D(g)));var h;if(L()){var i={x:c.clientX,y:c.clientY};h=n.getCurrentAttachCandidate(null,i),n.highlightAttachCandidate(h),t.highlightDragConstraints()}for(var j=k.getBoundComponentLayouts(g),m=0;m<l.length;m++)u.components.layout.updateRelativeToScreen(l[m],j[m],!0)}w=d}function R(b){if(A(b)){u.multiselect.isMultiselect(l)?N():(O(b),n.highlightAttachCandidate(null)),t.removeHighlightDragConstraints(),x=null,u.snapData.clear(),u.history.add("Dragged component"),u.openCompOutOfGridPanelIfNeeded(l);var c=u.multiselect.isMultiselect(l)?"multiselect":u.getComponentType(l);u.bi.event(a.bi.events.editBox.MOVE_COMPONENT,{origin:"editBox",component_type:c})}u.renderPlugins.setCompsToShowOnTop(null),r=!1,v=null}var k,l,m,n,o,t,u,v,w,x,y,z,e=15,f=a.utils.AttachHandler,g=a.utils.AttachHandlerExperimentAttachImprovements,h=a.utils.SnapToHandler,i=a.utils.layoutTransitionsUtil,j=a.utils.DragConstraintsHandler,p={top:!0,right:!0,bottom:!0,left:!0,centerX:!0,centerY:!0},q=!1,r=!1,s=!1;return{start:P,on:Q,end:R,type:c.DRAG}}),define("rEditor/utils/mouseMoveActions/dragAttempt",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","experiment"],function(a,b,c,d){"use strict";function j(a,b){return a>=i||b>=i}function k(a,b){h=a,e=!1,f=b.initMousePosition,g=b.selectedComp}function l(a){var b=Math.abs(a.pageX-f.x),c=Math.abs(a.pageY-f.y);e=e||j(b,c),e&&h.selection.setIsMouseUpSelectionEnabled(!1)}function m(){e&&h.components.layout.isPinned(g)&&!h.pinMode.isPinModeOpen()&&(d.isOpen("OpenPinPanelOnDrag")&&h.pinMode.open("on_drag"),h.bi.event(b.bi.events.pinToScreen.DRAG_ATTEMPT,{component_type:h.getComponentType(g)}))}var e,f,g,h,i=5;return{start:k,on:l,end:m,type:c.DRAG_ATTEMPT}}),define("rEditor/utils/lassoMouseMoveActions/lassoDrag",["core","lodash","util","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c,d){"use strict";function q(a){if(k)return!0;var b=a.pageY-l.editorConfig.editingAreaLayout.top,c=a.pageX-l.editorConfig.editingAreaLayout.left,d=Math.abs(c-j.x),e=Math.abs(b-j.y);return k=d>f&&e>f}function r(a){var b=a.pageY-l.editorConfig.editingAreaLayout.top,c=a.pageX-l.editorConfig.editingAreaLayout.left,d=Math.min(c,j.x),e=Math.min(b,j.y),f=Math.max(c,j.x),g=Math.max(b,j.y);return{x:d,y:e,width:f-d,height:g-e}}function s(a){var b=l.components.layout.getRelativeToScreen(a);return"wysiwyg.viewer.components.WRichText"===l.components.getType(a)&&t(a,b),{component:a,layout:b}}function t(a,b){var c=l.components.layout.getEffectiveTextDimensions(a);return c&&(b.width=c.width,b.height=c.height,b.bounding.width=c.width,b.bounding.height=c.height,b.x+=c.dx,b.y+=c.dy,b.bounding.x+=c.dx,b.bounding.y+=c.dy),b}function u(a){return l.components.is.fullWidth(a.component)||l.components.layout.isHorizontallyStretchedToScreen(a.component)?"fullWidth":"standard"}function v(a,b){return b.y<=a.bounding.y&&b.y+b.height>=a.bounding.y+a.bounding.height}function w(a,c){l=a;var d=l.pages.getCurrentPageId();n=c.selectedComponents;var f=e.concat(b.pluck(n,"id")),q=l.components.getAllComponents(d,function(a){return!b.includes(f,a.id)&&!l.components.is.page(a)});m=c.prevSelectedComps,o=m!==n&&c.initMousePosition.isSpecialKeyPressed,p=l.selection.isSingleSelectionComponent(n),j=b.clone(c.initMousePosition),j.y-=l.editorConfig.editingAreaLayout.top,j.x-=l.editorConfig.editingAreaLayout.left,k=!1,h=[],i=b.pick(j,["x","y"]),g=b(q).map(s).groupBy(u).value()}function x(a){if(q(a)){p&&(l.selection.deselectComponent(),p=!1),o&&(l.selection.selectComponentByCompRef(m),o=!1),i=r(a),h=b.filter(g.standard,function(a){return c.layoutUtils.isLayoutContainedWithinRect(a.layout.bounding,i)},this);var d=b.filter(g.fullWidth,function(a){return v(a.layout,i)},this);h=h.concat(d),l.lasso.setCandidates(h),l.lasso.setLayout(i)}}function y(d){var e=c.browserUtil.isSpecialKeyPressed(d);if(!b.isEmpty(h)){var f=b.map(h,"component");f.length>1&&(f=b.reject(f,l.selection.isSingleSelectionComponent)),(f.length>1||1===f.length&&m&&m.length>0)&&l.bi.event(a.bi.events.selection.MULTISELECT,{num_of_elements_selected:f.length,selection_method:"lasso"}),l.closeCompPanelIfExists(),e?l.selection.addComponentToSelectionByRef(f):l.selection.selectComponentByCompRef(f)}l.lasso.clear(),l.bi.event(a.bi.events.selection.LASSO,{num_of_elements_selected:h.length,special_key:e})}var g,h,i,j,k,l,m,n,o,p,e=["SITE_PAGES","PAGES_CONTAINER","SITE_HEADER","SITE_FOOTER"],f=4;return{start:w,on:x,end:y,type:d.LASSO}}),define("rEditor/rootComps/mouseCatcher",["react","jquery","lodash","rEditor/rootComps/mouseCatcher.rt","core","panels","util","rEditor/utils/mouseMoveActions/baseDrag","rEditor/utils/mouseMoveActions/dragAttempt","rEditor/utils/lassoMouseMoveActions/lassoDrag","experiment!activateLassoOnContainers"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function m(a,b){return p(a,b)?h:i}function o(a,b){return a.selection.isHiddenComponentDraggedNext()?!1:a.components.is.siteSegment(b)||a.components.is.page(b)?!0:k?!a.selection.isComponentSelected(b)&&a.components.is.container(b):!a.selection.isComponentSelected(b)&&a.components.is.container(b)&&a.components.is.fullWidth(b)}function p(a,b){var c=a.getCompDragRestrictions(b);return c.horizontallyMovable||c.verticallyMovable}function q(a,b,c){var d=a.selection.getComponentUnderClickToBeSelected(b.clientX,b.clientY,!1,c);return a.selection.isComponentSelected(d)}function r(a,b,c){var d=a.selection.getSelectedComponents();if(a.selection.isSelectedCompUnderCursorAndBeneathSiteSegment(d,b))return!1;var e=a.selection.getComponentUnderClickToBeSelected(b.clientX,b.clientY,!1,c),f=g.browserUtil.isSpecialKeyPressed(b);return f||o(a,e)}function s(a,b){var d=a.selection.getSelectedComponents(),e=a.components.getType(b);return(!a.selection.isComponentSelected(b)||a.multiselect.isMultiselect(d))&&!c.includes(l,e)}function t(a){return!!a.editor.state.lassoLayout}var l=["wysiwyg.viewer.components.PagesContainer","wysiwyg.viewer.components.PageGroup","wysiwyg.common.components.anchor.viewer.Anchor"],n=1;return a.createClass({displayName:"mouseCatcher",mixins:[e.mixins.editorAPIMixin],propTypes:{selectedComponents:a.PropTypes.oneOfType([a.PropTypes.object,a.PropTypes.arrayOf(a.PropTypes.object)]),focusedContainer:a.PropTypes.object,config:a.PropTypes.object,onContextMenu:a.PropTypes.func,performingMouseMoveAction:a.PropTypes.bool,hoveredComp:a.PropTypes.oneOfType([a.PropTypes.bool,a.PropTypes.object]),isDragging:a.PropTypes.bool,isResizing:a.PropTypes.bool,isRotating:a.PropTypes.bool,isPinMode:a.PropTypes.bool,compPanel:a.PropTypes.object,editingAreaLayout:a.PropTypes.object},componentWillMount:function(){this.compsBeforeSelection=null,this.shouldStartDragging=!1,this.shouldStartLasso=!1,this.initMousePosition=null},componentDidMount:function(){b(this.getDOMNode()).on("mouseenter",this.onMouseEnter)},componentWillUnmount:function(){b(this.getDOMNode()).off("mouseenter",this.onMouseEnter)},componentWillReceiveProps:function(a){var b=this.getEditorAPI(),c=m(b,a.selectedComponents);this.shouldStartDragging&&c?b.registerMouseMoveAction(c,{initMousePosition:this.initMousePosition,selectedComp:b.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(a.selectedComponents)}):this.shouldStartLasso&&b.registerMouseMoveAction(j,{initMousePosition:this.initMousePosition,prevSelectedComps:this.compsBeforeSelection,selectedComponents:a.selectedComponents}),this.shouldStartDragging=!1,this.shouldStartLasso=!1},onMouseDown:function(a){var b=this.getEditorAPI();e.utils.mouseScaleHandler.fitMouseCoordinatesToScale(b,a,this.props.siteScale),this.initMousePosition={x:a.pageX,y:a.pageY,isShiftPressed:a.shiftKey,isSpecialKeyPressed:g.browserUtil.isSpecialKeyPressed(a),isAltKeyPressed:a.altKey},this.shouldStartLasso=r(b,a,this.props.siteScale),this.shouldStartDragging=!this.shouldStartLasso&&(!b.selection.isMultiSelectKeyPressed(a)||q(b,a,this.props.siteScale)),b.selection.isHiddenComponentDraggedNext()?b.selection.setIsHiddenComponentDraggedNext(!1):t(b)||(this.compsBeforeSelection=this.props.selectedComponents,b.selection.selectComponentByClick(a,this.props.siteScale)),b.closeRightClickMenu(),f.panelManager.notifyMouseDown(a)},onMouseUp:function(a){var b=this.getEditorAPI();e.utils.mouseScaleHandler.fitMouseCoordinatesToScale(b,a,this.props.siteScale);var c=2===a.button;c||(this.deselectClickedCompIfNeeded(a),b.selection.getIsMouseUpSelectionEnabled()&&!t(b)&&b.selection.selectNonGroupCompUnderCursor(a,this.props.siteScale)),b.selection.setIsMouseUpSelectionEnabled(!1),this.initMousePosition=null},onMouseMove:function(a){this.props.registeredMouseMoveAction||this.updateHoverBox(a),this.props.mouseMoveCallback(a,a.pageX,a.pageY)},onMouseEnter:function(a){a.which!==n&&this.getEditorAPI().triggerMouseUp(c.clone(a))},updateHoverBox:function(a){var b=this.getEditorAPI(),d=c.clone(a);e.utils.mouseScaleHandler.fitMouseCoordinatesToScale(b,d,this.props.siteScale),b.waitForChangesApplied(function(){var a=b.selection.getComponentToBeMarkedByHoverBox(d.clientX,d.clientY,this.props.siteScale),c=this.props.hoverBoxOverlay;!this.props.hoveredComp&&a?s(b,a)&&this.props.setHoverBox(a,c):this.props.hoveredComp&&!a?this.props.clearHoverBox():this.props.hoveredComp&&a&&(s(b,a)?this.props.hoveredComp.id!==a.id&&this.props.setHoverBox(a,c):this.props.clearHoverBox())}.bind(this))},clearHoverBox:function(){this.props.clearHoverBox()},deselectClickedCompIfNeeded:function(a){var b=this.getEditorAPI();if(b.selection.isMultiSelectKeyPressed(a)&&this.initMousePosition){var d=b.selection.getComponentUnderClickToBeSelected(a.clientX,a.clientY,!1,this.props.siteScale),e=!!c.find(this.compsBeforeSelection,d),f=!this.isPointsDistanceBiggerThan(this.initMousePosition,{x:a.pageX,y:a.pageY},2);e&&f&&(b.selection.setIsMouseUpSelectionEnabled(!1),b.selection.deselectComponents(d))}},isPointsDistanceBiggerThan:function(a,b,c){var d=Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2);return Math.sqrt(d)>c},isComponentSelected:function(){return this.getEditorAPI().selection.isComponentSelected()},getComponentLabel:function(){return this.getEditorAPI().getComponentType(this.props.selectedComponents)},isCompDraggable:function(){var a=this.getEditorAPI(),b=this.props.hoveredComp,c=a.selection.getSelectedComponents();return b?s(a,b)&&a.components.is.draggable(b):c?a.components.is.draggable(c):!1},getCompToShowMarginsIndicator:function(){var a=this.getEditorAPI();return this.props.editorState.attachCandidate?this.props.editorState.attachCandidate:this.props.isDragging?a.components.getContainer(this.getEditorAPI().selection.getSelectedComponents()):null},showMarginsIndicator:function(){var a=this.getEditorAPI(),b=this.getCompToShowMarginsIndicator();return b&&a.components.is.showMarginsIndicator(b)},getMarginsIndicatorStyles:function(a){var b=this.getEditorAPI(),c=b.components.layout.getRelativeToScreen(a),d=b.components.layout.getRelativeToStructure(a),e=c.width-d.width,f=b.site.getSiteX(),g=d.x+f-c.x,h=e-g;return{indicator:{top:c.y,left:c.x,width:c.width,height:c.height},marginLeft:Math.max(0,g),marginRight:Math.max(0,h),inlineWidth:d.width}},getFocusBoxGridLines:function(){var a=this.getMarginsIndicatorStyles(this.props.focusedContainer);return{left:a.marginLeft,right:a.marginLeft+a.inlineWidth}},render:d})}),define("rEditor/rootComps/textEditor.rt",["react/addons","lodash","textControls"],function(a,b,c){"use strict";return function(){return a.createElement(c.richTextInput,{ref:"richTextInput",valueLink:{value:this.state.textData,requestChange:this.handleTextChange},themeColors:this.getThemeColors(),themeFonts:this.getThemeFonts(),documentType:this.getDocumentType(),languages:this.getLanguages(),layout:this.getTextEditorLayout(),onHeightChange:this.handleTextHeightChange,fonts:this.getCurrentSelectableFontsWithParams(),hideToolbar:!0,className:"text-editor",onShow:this.handleShowTextEditor,openLinkDialog:this.openLinkDialog,openColorPicker:this.openTextColorPicker,openLanguageSupport:this.openLanguageSupport,selectAllOnInit:!0,isResizing:this.props.isResizing,panelManager:this.getPanelManager(),shouldLimitTextLength:!0})}}),define("rEditor/rootComps/textEditor",["react","lodash","rEditor/rootComps/textEditor.rt","core","textControls","panelUtils","panels"],function(a,b,c,d,e,f,g){"use strict";return a.createClass({displayName:"textEditor",render:c,mixins:[d.mixins.editorAPIMixin,f.linkColorPickerMixin],getComponentData:function(){return this.getEditorAPI().components.data.get(this._textComponent)},setComponentData:function(a){var c=this.getComponentData();b.forOwn(a,function(a,b){c[b]=a}),this.getEditorAPI().components.data.update(this._textComponent,c,!0)},setComponentLayout:function(a){this.getEditorAPI().components.layout.updateRelativeToScreenAndAdjustLayout(this._textComponent,a)},_cacheSelectedComponent:function(){this._textComponent=this.getEditorAPI().text.getTextCompForEdit()},getInitialState:function(){return this._cacheSelectedComponent(),{textData:{text:this.getComponentData().text,linkList:this.getComponentData().linkList}}},getThemeColors:function(){return this.getEditorAPI().theme.colors.getAll()},getThemeFonts:function(){return this.getEditorAPI().theme.fonts.getAll()},getDocumentType:function(){return this.getEditorAPI().generalInfo.getDocumentType()},getLanguages:function(){return this.getEditorAPI().theme.fonts.getCharacterSet()},getTextEditorLayout:function(){var a=this.getEditorAPI(),b=a.components.layout.getRelativeToScreen(this._textComponent),c=a.components.layout.isShowOnFixedPosition(this._textComponent),d={top:b.y,left:b.x,width:b.width,height:b.height,position:c?"fixed":"absolute"};return c&&(d.top+=a.editorConfig.editingAreaLayout.top,d.left+=a.editorConfig.editingAreaLayout.left),d},takeSnapshot:function(){this.snapshotTimeoutHandle&&clearTimeout(this.snapshotTimeoutHandle);var a=this;this.snapshotTimeoutHandle=setTimeout(function(){a.getEditorAPI().history.add("RT:Change"),delete a.snapshotTimeoutHandle},1e3)},handleTextChange:function(a){var b=this.getEditorAPI();this.setComponentData(a),b.waitForChangesApplied(this.takeSnapshot),this.setState({textData:a})},handleTextHeightChange:function(a){this.setComponentLayout({height:a})},getCurrentSelectableFontsWithParams:function(){return e.fontUtils.getCurrentSelectableFontsWithParams(this.getEditorAPI())},handleShowTextEditor:function(a){this._cacheSelectedComponent();var c=this.getEditorAPI(),d=this._textComponent,e=b.now();c.waitForChangesApplied(function(){setTimeout(function(){var e=b.first(c.selection.getSelectedComponents());e===d?(c.renderPlugins.setHideTextComponent(d.id),a&&a(),c.openComponentPanel("textSettingsPanel")):(c.text.stopEditing(),c.closePanelByName("textSettingsPanel"))},Math.max(250-b.now()+e,0))})},componentDidMount:function(){this.getEditorAPI().text.setCurrentTextEditor(this.refs.richTextInput)},componentWillUnmount:function(){clearTimeout(this.panelTimeout),this.snapshotTimeoutHandle&&(clearTimeout(this.snapshotTimeoutHandle),this.getEditorAPI().history.add("RT:Change")),this.getEditorAPI().text.setCurrentTextEditor(null)},openLinkDialog:function(a,b){var c=this.getEditorAPI();c.openLinkPanel({link:a,callback:b})},openTextColorPicker:function(a,b,c,d){this.openColorPicker(b,a,!0,c,d)},openLanguageSupport:function(){g.panelManager.openPanel("panels.toolPanels.languageSupport",{},!0)},getPanelManager:function(){return this.getEditorAPI().panelManager}})}),define("rEditor/rootComps/funTextEditor.rt",["react/addons","lodash","textControls"],function(a,b,c){"use strict";return function(){return this.isReady()?a.createElement(c.richTextInput,{key:"richTextInput",ref:"richTextInput",valueLink:{value:this.getValue(),requestChange:this.handleTextChange},themeColors:this.getThemeColors(),themeFonts:this.getThemeFonts(),documentType:this.getDocumentType(),languages:this.getLanguages(),layout:this.getTextEditorLayout(),fonts:this.getCurrentSelectableFontsWithParams(),hideToolbar:!0,className:"text-editor",openLinkDialog:this.openLinkDialog,openColorPicker:this.openTextColorPicker,openLanguageSupport:this.openLanguageSupport,isResizing:this.props.isResizing,panelManager:this.getPanelManager(),shouldLimitTextLength:!0,isFocusOnInit:!1}):null}}),define("rEditor/rootComps/funTextEditor",["react","lodash","rEditor/rootComps/funTextEditor.rt","textControls","core","panels","panelUtils"],function(a,b,c,d,e,f,g){"use strict";function i(a,c){if(!c)return!1;if(c.length>1)return!1;var d=b.first(c),e=a.components.data.get(d),f=e&&e.type;return"StyledText"===f}var h=!1;return a.createClass({displayName:"funTextEditor",render:c,mixins:[e.mixins.editorAPIMixin,g.linkColorPickerMixin],getThemeColors:function(){return this.getEditorAPI().theme.colors.getAll()},getThemeFonts:function(){return this.getEditorAPI().theme.fonts.getAll()},getDocumentType:function(){return this.getEditorAPI().generalInfo.getDocumentType()},getLanguages:function(){return this.getEditorAPI().theme.fonts.getCharacterSet()},getTextEditorLayout:function(){var a={};if(i(this.getEditorAPI(),this.props.selectedComponents)){var b=this.getEditorAPI(),c=this.getTextComponentFromProps(),d=b.components.layout.getRelativeToScreen(c),e=b.components.layout.isShowOnFixedPosition(c);a={top:d.y,left:d.x,width:d.width,height:d.height,position:e?"fixed":"absolute"},e&&(a.top+=b.editorConfig.editingAreaLayout.top,a.left+=b.editorConfig.editingAreaLayout.left)}return this.props.isOpenTextEditor||(a.visibility="hidden"),a},getCurrentSelectableFontsWithParams:function(){return d.fontUtils.getCurrentSelectableFontsWithParams(this.getEditorAPI())},openLinkDialog:function(a,b){var c=this.getEditorAPI();c.openLinkPanel({link:a,callback:b})},openTextColorPicker:function(a,b,c,d){this.openColorPicker(b,a,!0,c,d)},openLanguageSupport:function(){f.panelManager.openPanel("panels.toolPanels.languageSupport",{},!0)},isReady:function(){return this.getEditorAPI().isPreviewReady()&&window.CKEDITOR&&"loaded"===window.CKEDITOR.status},getComponentDataFromProps:function(a){return this.getEditorAPI().components.data.get(this.getTextComponentFromProps(a))},getTextComponentFromProps:function(a){return a=a||this.props,b.first(a.selectedComponents)},getValue:function(){if(i(this.getEditorAPI(),this.props.selectedComponents)){var a=this.getComponentDataFromProps();return{text:a.text,linkList:a.linkList}}return{text:"",linkList:[]}},getPanelManager:function(){return this.getEditorAPI().panelManager},renderWhenReady:function(){this.isReady()&&this.refs.richTextInput?(this.getEditorAPI().text.setCurrentTextEditor(this.refs.richTextInput),this.forceUpdate()):setTimeout(this.renderWhenReady,100)},deleteTextEditorComponentIfEmpty:function(a){var b=this.getEditorAPI().components.data.get(a);if(b){var c=b.text;d.dataUtils.isEmptyHtmlText(c)&&this.getEditorAPI().components.remove(a)}},componentWillUpdate:function(a){(!b.isEqual(this.props.selectedComponents,a.selectedComponents)||this.props.isOpenTextEditor&&!a.isOpenTextEditor)&&this.stopTextEditing()},componentDidUpdate:function(a){!a.isOpenTextEditor&&this.props.isOpenTextEditor&&(this.getEditorAPI().renderPlugins.setHideTextComponent(this.getTextComponentFromProps().id),this.refs.richTextInput.focus(),this.refs.richTextInput.selectAll(),this.refs.richTextInput.resetUndo(),this.getEditorAPI().openComponentPanel("textSettingsPanel"))},componentDidMount:function(){var a=this.getEditorAPI();this.renderWhenReady(),a.registerToGoToPreview(this.stopTextEditing)},stopTextEditing:function(){if(!h){h=!0;var a=this.getEditorAPI(),b=this;this.getEditorAPI().renderPlugins.setHideTextComponent(null);var c=this.getTextComponentFromProps();a.waitForChangesApplied(function(){b.deleteTextEditorComponentIfEmpty(c),h=!1}),this.getEditorAPI().text.stopEditing()}},handleTextChange:function(a){var b=this.getEditorAPI();this.setComponentData(a),b.waitForChangesApplied(this.takeSnapshot)},setComponentData:function(a){var c=this.getComponentDataFromProps();b.forOwn(a,function(a,b){c[b]=a}),this.getEditorAPI().components.data.update(this.getTextComponentFromProps(),c,!0)},takeSnapshot:function(){this.snapshotTimeoutHandle&&clearTimeout(this.snapshotTimeoutHandle);var a=this;this.snapshotTimeoutHandle=setTimeout(function(){a.getEditorAPI().history.add("RT:Change"),delete a.snapshotTimeoutHandle},1e3)}})}),define("rEditor/rootComps/gridLines/gridLines.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("svg",{className:"gridLines "+b.keys(b.pick({fade:this.props.fade},b.identity)).join(" ")},a.createElement("line",{x1:this.pagesContainerLayout.x,y1:"0",x2:this.pagesContainerLayout.x,y2:"100%",className:"backLine"}),a.createElement("line",{x1:this.pagesContainerLayout.x,y1:"0",x2:this.pagesContainerLayout.x,y2:"100%",className:"frontLine"}),a.createElement("line",{x1:this.pagesContainerLayout.x+this.pagesContainerLayout.width,y1:"0",x2:this.pagesContainerLayout.x+this.pagesContainerLayout.width,y2:"100%",className:"backLine"}),a.createElement("line",{x1:this.pagesContainerLayout.x+this.pagesContainerLayout.width,y1:"0",x2:this.pagesContainerLayout.x+this.pagesContainerLayout.width,y2:"100%",className:"frontLine"}),this.props.showTopBottom?a.createElement("line",{key:"topA",x1:"0",y1:this.pagesContainerLayout.y,x2:"100%",y2:this.pagesContainerLayout.y,className:"backLine"}):null,this.props.showTopBottom?a.createElement("line",{key:"topB",x1:"0",y1:this.pagesContainerLayout.y,x2:"100%",y2:this.pagesContainerLayout.y,className:"frontLine"}):null,this.props.showTopBottom?a.createElement("line",{key:"bottomA",x1:"0",y1:this.pagesContainerLayout.y+this.pagesContainerLayout.height,x2:"100%",y2:this.pagesContainerLayout.y+this.pagesContainerLayout.height,className:"backLine"}):null,this.props.showTopBottom?a.createElement("line",{key:"bottomb",x1:"0",y1:this.pagesContainerLayout.y+this.pagesContainerLayout.height,x2:"100%",y2:this.pagesContainerLayout.y+this.pagesContainerLayout.height,className:"frontLine"}):null)}}),define("rEditor/rootComps/gridLines/gridLines",["react","lodash","core","rEditor/rootComps/gridLines/gridLines.rt"],function(a,b,c,d){"use strict";function e(a,b){var c=a.siteSegments.getPagesContainerAbsLayout();if(!b||1===b)return c;var d={y:c.y*b,width:c.width*b,height:c.height*b},e=c.width-d.width;return d.x=c.x+e/2,d}return a.createClass({displayName:"gridLines",mixins:[c.mixins.editorAPIMixin],propTypes:{siteScale:a.PropTypes.number,fade:a.PropTypes.bool},getDefaultProps:function(){return{siteScale:1,fade:!1}},componentWillMount:function(){this.pagesContainerLayout=e(this.getEditorAPI(),this.props.siteScale)},componentWillReceiveProps:function(){this.pagesContainerLayout=e(this.getEditorAPI(),this.props.siteScale)},render:d})}),define("rEditor/rootComps/rulers/guide.rt",["react/addons","lodash","core","baseUI","uiConstants"],function(a,b,c,d,e){"use strict";function f(a){this.onContainerMouseDown(a)}return function(){return a.createElement("div",{className:this.props.rulerDirection+"-guide-container",style:this.getGuideContainerStyle(),keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("div",{className:this.props.rulerDirection+"-guide",style:this.getGuideStyle()}),a.createElement("div",{ref:"guide",className:this.props.rulerDirection+"-guide-catcher",onClick:this.handleGuideClick,onMouseDown:f.bind(this),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},a.createElement("div",{className:this.getHandlerClasses()})),this.state.isHoverBubble?a.createElement(d.bubble,b.assign({},{ref:"hoverBubble",key:"hoverBubble"},this.getBubbleProps("hover"))):null,this.props.isSelected?a.createElement(d.bubble,b.assign({},{ref:"selectionBubble",key:"selectionBubble"},this.getBubbleProps("selected"))):null)}}),define("rEditor/rootComps/rulers/rulersComputations",["lodash","jquery","core"],function(a,b,c){"use strict";function e(a,b){var c=b.siteSegments.getPagesContainerAbsLayout(),d=0,e="vertical"===a?Math.floor(c.width/100):Math.round((c.height+c.y)/100);return b.isMobileEditor()&&"horizontal"===a&&(e=Math.floor(b.editorConfig.previewHeight+b.editorConfig.editingAreaLayout.top)/100),b.isMobileEditor()||"horizontal"!==a||(d=Math.floor(c.y/100)+1),[d,e]}function f(a,b){for(var c=e(b,a),d=c[0],f=c[1],g=[],h=d;f>=h;h++)g.push(100*h);return g}function g(a){var f,g,h,i,b=a.siteSegments.getPagesContainerAbsLayout(),e=c.utils.stageUtils.getViewPort(!0);f=a.isMobileEditor()?0:-b.x,g=a.isMobileEditor()?b.width:e.stageLayout.width-b.x-d,h=a.isMobileEditor()?0:d,i=a.isMobileEditor()?e.maxBottomY+e.marginBottom:e.bottomY+d;var j=a.isMobileEditor()?e.scrollTop:e.scrollTop+d;return{vertical:{min:f,max:g,minInView:f},horizontal:{min:h,max:i,minInView:j}}}function h(a,b,c,d){var e=g(a);return e="vertical"===b?e.vertical:e.horizontal,d?c<e.minInView||c>e.max:c<e.min||c>e.max}function i(a){var b=c.utils.stageUtils.getViewPort(!0);return a?b.maxBottomY+b.marginBottom:"calc(100% - "+d+"px)"}function j(a,b){return a?b.width:"calc(100% - "+d+"px)"}function k(a,b,c){if("vertical"===b)return c.clientX-a.siteSegments.getPagesContainerAbsLayout().x;var d=c.pageY-a.editorConfig.editingAreaLayout.top+a.site.getScroll().y;return d}function l(a,b){var c=a.siteSegments.getPagesContainerAbsLayout();return a.isMobileEditor()?b:b+c.x}function m(a,c){var d=b(c).offset().top-parseInt(b(c).css("top"),10);return a-d}var d=20;return{getRulerNumbers:f,isGuideOutOfLimits:h,getHorizontalTicksHeight:i,calcNewGuidePosition:k,calcHorizontalDraggingPosition:m,getVerticalTicksWidth:j,getVerticalGuidePosition:l}}),define("rEditor/rootComps/rulers/guide",["react","lodash","jquery","baseUI","core","panels","util","uiConstants","rEditor/rootComps/rulers/guide.rt","rEditor/rootComps/rulers/rulersComputations"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k="guideToolTipTrash",l="smallVApproval";return a.createClass({displayName:"rulers",mixins:[e.mixins.editorAPIMixin,g.draggableMixin],propTypes:{rulerDirection:a.PropTypes.string.isRequired,guidePosition:a.PropTypes.number.isRequired,guideId:a.PropTypes.string.isRequired,isSelected:a.PropTypes.bool,isGuideOutOfLimitsFunc:a.PropTypes.func,isRulersHovered:a.PropTypes.bool,changeDraggingStateFunc:a.PropTypes.func.isRequired},getInitialState:function(){return{isDragging:!1,isHoverBubble:!1,mouseOverGuide:!1,guidePosition:this.props.guidePosition,stepperSymbol:k,stepperValueInvalid:!1,selectedDueToHoverBubbleClick:!1}},componentWillMount:function(){g.keyboardShortcuts.registerContext(this.props.guideId,this.getKeyboardShortcuts())},componentDidMount:function(){this.setGuideSelected()},componentWillReceiveProps:function(){this.setState({stepperValueInvalid:!1})},shouldComponentUpdate:function(a,b){return!this.state.isHoverBubble&&b.isHoverBubble&&this.getEditorAPI().rulers.sendBIEvent("GUIDE_TOOLTIP_APPEAR",{}),!0},componentWillUnmount:function(){g.keyboardShortcuts.unregisterContext(this.props.guideId)},setGuideSelected:function(a){this.getEditorAPI().rulers.sendBIEvent("GUIDE_TOOLTIP_IN_EDIT_MODE",{origin:a});var b=this.getEditorAPI();b.selection.deselectComponent(),g.keyboardShortcuts.setContext(this.props.guideId),b.rulers.setSelectedGuide(this.props.guideId),this.setState({stepperValueInvalid:!1,stepperSymbol:k})},getHandlerClasses:function(){var a=this.props.isSelected?"selected-handler":"";return this.props.rulerDirection+"-guide-handler "+a},getGuideContainerStyle:function(){return"horizontal"===this.props.rulerDirection?{top:this.state.guidePosition}:{left:j.getVerticalGuidePosition(this.getEditorAPI(),this.state.guidePosition)}},getGuideStyle:function(){var a=this.getEditorAPI(),b=a.editorConfig,c=a.getPreviewSize().width,d=a.isMobileEditor()?b.previewHeight+b.editingAreaLayout.top:b.previewHeight;return"horizontal"===this.props.rulerDirection?{left:-c,width:c}:{height:d}},getKeyboardShortcuts:function(){return{del:this.removeGuideViaDelBtn,backspace:this.removeGuideViaDelBtn}},removeGuideViaDelBtn:function(){this.getEditorAPI().rulers.sendBIEvent("GUIDE_DELETED",{origin:"delete_button"}),this.removeGuide()},removeGuide:function(){var a=this.getEditorAPI();a.rulers.removeGuide(this.props.rulerDirection,this.props.guideId)},onDragStart:function(){this.props.changeDraggingStateFunc(!0),this.setState({isDragging:!0,stepperValueInvalid:!1,stepperSymbol:k})},getDragPosition:function(b){var c=a.findDOMNode(this);return"horizontal"===this.props.rulerDirection?j.calcHorizontalDraggingPosition(b.top,c):b.left-this.getEditorAPI().siteSegments.getPagesContainerAbsLayout().x},whileDrag:function(a){this.setState({guidePosition:this.getDragPosition(a)})},onDragEnd:function(a){if(this.props.changeDraggingStateFunc(!1),!this.props.isRulersHovered){var b=this.getEditorAPI();b.rulers.updateEditorRulersState("isHovered",!1)}this.setState({isDragging:!1});var c=this.getDragPosition(a),d=this.changeGuidePosition(c);d||(this.getEditorAPI().rulers.sendBIEvent("GUIDE_DELETED",{origin:"drag_outside"}),this.removeGuide())},getDragLimits:function(){return"horizontal"===this.props.rulerDirection?{lockedX:!0}:{lockedY:!0}},changeGuidePosition:function(a){if(this.props.isGuideOutOfLimitsFunc(a))return!1;this.setState({guidePosition:a}),this.sendDragBIEvent(this.props.guidePosition,a);var b=this.getEditorAPI();return b.rulers.changeGuidePosition(this.props.rulerDirection,this.props.guideId,a),!0},sendDragBIEvent:function(a,b){var c={xCoordinate_new:0,xCoordinate_old:0,yCoordinate_new:0,yCoordinate_old:0};"vertical"===this.props.rulerDirection?(c.xCoordinate_new=b,c.xCoordinate_old=a):(c.yCoordinate_new=b,c.yCoordinate_old=a),this.getEditorAPI().rulers.sendBIEvent("GUIDE_DRAGGED",c)},closeHoverBubble:function(){this.setState({isHoverBubble:!1})},setGuideUnselected:function(){var a=this.getEditorAPI();a.selection.deselectComponent(),
a.rulers.setSelectedGuide(null)},onStepperValueChange:function(a){var b=parseInt(a,10),c=this.changeGuidePosition(b);c?(this.setState({stepperSymbol:l,stepperValueInvalid:!1}),setTimeout(this.setGuideUnselected.bind(this),600)):this.setState({stepperSymbol:k,stepperValueInvalid:!0})},onStepperSteppingValueChange:function(a){var b=parseInt(a,10),c=this.changeGuidePosition(b);this.sendStepperValueChangeBIEvent(a,c),c?this.setState({stepperValueInvalid:!1}):this.setState({stepperValueInvalid:!0})},sendStepperValueChangeBIEvent:function(a,b){var c={type:this.props.rulerDirection,value:a,valid_value:b?"accepted":"denied"};this.getEditorAPI().rulers.sendBIEvent("VALUE_CHANGE_IN_GUIDE_TOOLTIP",c)},stepperSymbolClickFunc:function(){this.state.stepperSymbol===k&&(this.getEditorAPI().rulers.sendBIEvent("GUIDE_DELETED",{origin:"trash_icon"}),this.removeGuide())},stepperClick:function(){this.state.isHoverBubble?(this.setState({isHoverBubble:!1,stepperValueInvalid:!1,stepperSymbol:k,selectedDueToHoverBubbleClick:!0}),this.setGuideSelected("click_on_tooltip")):this.setState({stepperValueInvalid:!1,stepperSymbol:k})},getBubbleProps:function(a){var b="hover"===a?[]:[h.TOOLTIP.TRIGGERS.OUTER_CLICK],c="hover"===a?this.closeHoverBubble:this.setGuideUnselected,d="hover"===a?600:0,e="hover"===a?!this.state.isDragging&&!this.state.mouseOverGuide||this.state.isSelected:null,f="horizontal"===this.props.rulerDirection?void 0:{type:h.TOOLTIP.ALIGNMENT.TOP,value:3},g="horizontal"===this.props.rulerDirection?5:-5;return{value:{classPath:"baseUI.stepperWithSVG",props:{showSymbol:this.props.isSelected,stepperClickFunc:this.stepperClick,symbolClickFunc:this.stepperSymbolClickFunc,symbolName:this.state.stepperSymbol,stepperProps:{min:-99999,max:99999,step:1,selectedUnits:"px",units:"px",afterBlur:this.onStepperValueChange,isInvalidValue:this.state.stepperValueInvalid,valueLink:{value:this.state.guidePosition,requestChange:this.onStepperSteppingValueChange},dynamicInputSize:{characterWidth:14,minWidth:28},inputInFocus:this.state.selectedDueToHoverBubbleClick}}},styleType:h.TOOLTIP.STYLE_TYPE.NORMAL,alignment:h.TOOLTIP.ALIGNMENT.RIGHT,noArrow:!0,targetNode:this.refs.guide.getDOMNode(),closeTriggers:b,hideMethod:c,marginsFromWindow:0,mouseLeftTargetNode:e,marginsFromElement:g,timeoutForMouseOverBubble:d,overridePositionAdjustments:f}},onContainerMouseDown:function(a){a.stopPropagation(),this.startDrag(a,this.getDragLimits())},onMouseLeave:function(){this.setState({mouseOverGuide:!1})},onMouseEnter:function(){this.props.isSelected||this.setState({isHoverBubble:!0,mouseOverGuide:!0})},handleGuideClick:function(a){a.stopPropagation(),this.state.isHoverBubble&&this.setState({isHoverBubble:!1}),this.setGuideSelected("click_on_guide")},render:i})}),define("rEditor/rootComps/rulers/rulers.rt",["react/addons","lodash","core","util","rEditor/rootComps/rulers/guide"],function(a,b,c,d,e){"use strict";function f(b,c){return a.createElement("div",{className:"ruler-number"},b)}function g(b,c){return a.createElement(e,{key:b.guideId,rulerDirection:"vertical",guidePosition:b.guidePosition,guideId:b.guideId,isSelected:this.props.selectedGuide===b.guideId,isGuideOutOfLimitsFunc:this.isGuideOutOfLimits,isRulersHovered:this.isMouseOver,changeDraggingStateFunc:this.changeDraggingState})}function h(b,c){return a.createElement("div",{className:"ruler-number"},b)}function i(b,c){return a.createElement(e,{key:b.guideId,rulerDirection:"horizontal",guidePosition:b.guidePosition,guideId:b.guideId,isSelected:this.props.selectedGuide===b.guideId,isGuideOutOfLimitsFunc:this.isGuideOutOfLimits,isRulersHovered:this.isMouseOver,changeDraggingStateFunc:this.changeDraggingState})}return function(){return a.createElement("div",{className:b.keys(b.pick({rulers:!0,"mobile-editor-rulers":this.getEditorAPI().isMobileEditor()},b.identity)).join(" ")},"vertical"===this.props.rulerDirection?a.createElement.apply(this,["div",{className:"vertical-ticks",key:"vertical-ruler",style:this.getVerticalTicksStyle(),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleRulerClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},a.createElement("div",{className:"rulers-background "+b.keys(b.pick({"rulers-background-hover":this.props.isHovered},b.identity)).join(" ")},a.createElement("div",{className:"rulers-vertical-ticks",style:this.getVerticalTicksStartingPoint()}),a.createElement.apply(this,["div",{className:"ruler-numbers-container",style:this.getVerticalRulerNumbersStyle()},b.map(this.getRulerNumbers(),f.bind(this))])),b.map(this.props.guidesInRuler,g.bind(this))]):null,"horizontal"===this.props.rulerDirection?a.createElement.apply(this,["div",{className:"horizontal-ticks",style:this.getHorizontalTicksStyle(),key:"horizontal-ruler",onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleRulerClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},this.getEditorAPI().isMobileEditor()?null:a.createElement("div",{className:"rulers-separator "+b.keys(b.pick({"rulers-separator-hover":this.props.isHovered},b.identity)).join(" "),key:"rulers-separator"}),a.createElement("div",{className:"rulers-background "+b.keys(b.pick({"rulers-background-hover":this.props.isHovered,"rulers-background-mobile":this.getEditorAPI().isMobileEditor()},b.identity)).join(" ")},a.createElement("div",{className:"rulers-horizontal-ticks",style:this.getHorizontalTicksTop()}),a.createElement.apply(this,["div",{className:"ruler-numbers-container",style:this.getHorizontalRulerNumbersStyle()},b.map(this.getRulerNumbers(),h.bind(this))])),b.map(this.props.guidesInRuler,i.bind(this))]):null)}}),define("rEditor/rootComps/rulers/rulers",["jquery","react","lodash","baseUI","core","panels","rEditor/rootComps/rulers/rulers.rt","rEditor/rootComps/rulers/rulersComputations"],function(a,b,c,d,e,f,g,h){"use strict";return b.createClass({displayName:"rulers",mixins:[e.mixins.editorAPIMixin],propTypes:{rulerDirection:b.PropTypes.string.isRequired,guidesInRuler:b.PropTypes.object.isRequired,selectedGuide:b.PropTypes.string,isHovered:b.PropTypes.bool},getInitialState:function(){return this.isDragging=!1,this.isMouseOver=!1,this.previewHeight=this.getEditorAPI().editorConfig.previewHeight,{isMouseDownEvent:!1}},componentDidMount:function(){this.horizontalTicksHeight=h.getHorizontalTicksHeight(this.getEditorAPI().isMobileEditor())},shouldComponentUpdate:function(a,b){!this.props.isHovered&&a.isHovered&&"vertical"===this.props.rulerDirection&&this.getEditorAPI().rulers.sendBIEvent("RULERS_HOVER",{});var d=this.previewHeight;return this.previewHeight=this.getEditorAPI().editorConfig.previewHeight,a.selectedGuide!==this.props.selectedGuide||a.isHovered!==this.props.isHovered||b.isMouseDownEvent!==this.state.isMouseDownEvent||!c.isEqual(a.guidesInRuler,this.props.guidesInRuler)||d!==this.previewHeight},changeDraggingState:function(a){this.isDragging=a},getRulerNumbers:function(){return h.getRulerNumbers(this.getEditorAPI(),this.props.rulerDirection)},getVerticalRulerNumbersStyle:function(){var a=this.getEditorAPI().siteSegments.getPagesContainerAbsLayout();return{left:this.getEditorAPI().isMobileEditor()?3:a.x+3}},getHorizontalRulerNumbersStyle:function(){var a=this.getEditorAPI().siteSegments.getPagesContainerAbsLayout();return{top:this.getEditorAPI().isMobileEditor()?1:100*Math.floor(a.y/100)+80+1}},getVerticalTicksStyle:function(){var a=this.getEditorAPI(),b=a.siteSegments.getPagesContainerAbsLayout(),c={width:h.getVerticalTicksWidth(a.isMobileEditor(),b)};return a.isMobileEditor()&&(c.left=b.x),c},getHorizontalTicksTop:function(){return this.getEditorAPI().isMobileEditor()?{"background-position":"5px 0"}:{"background-position":"5px -19px"}},getVerticalTicksStartingPoint:function(){var a=this.getEditorAPI().siteSegments.getPagesContainerAbsLayout();return{"background-position":this.getEditorAPI().isMobileEditor()?0:a.x+1}},getHorizontalTicksStyle:function(){return{height:this.horizontalTicksHeight}},isGuideOutOfLimits:function(a,b){return h.isGuideOutOfLimits(this.getEditorAPI(),this.props.rulerDirection,a,b)},handleMouseEnter:function(b){if(!a(b.target).hasClass("vertical-guide")&&!a(b.target).hasClass("horizontal-guide")){this.isMouseOver=!0;var c=this.getEditorAPI();c.rulers.updateEditorRulersState("isHovered",!0)}},handleMouseLeave:function(){if(this.isMouseOver=!1,!this.isDragging){var a=this.getEditorAPI();a.rulers.updateEditorRulersState("isHovered",!1)}},handleMouseDown:function(){this.setState({isMouseDownEvent:!0})},setNewGuide:function(a){var b=this.getEditorAPI(),c={};"vertical"===this.props.rulerDirection?(b.rulers.setVerticalGuide(a),c={xCoordinate:a,yCoordinate:0}):(b.rulers.setHorizontalGuide(a),c={xCoordinate:0,yCoordinate:a}),this.getEditorAPI().rulers.sendBIEvent("RULERS_CLICKED",c)},handleRulerClick:function(a){if(!c.includes(["vertical-guide","horizontal-guide"],a.target.className)&&this.state.isMouseDownEvent){var b=h.calcNewGuidePosition(this.getEditorAPI(),this.props.rulerDirection,a);this.isGuideOutOfLimits(b,!0)||this.setNewGuide(b),this.setState({isMouseDownEvent:!1})}},render:g})}),define("rEditor/rootComps/mobileFrame/mobileFrame.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{className:b.keys(b.pick({"mobile-frame":!0,previewMode:this.props.previewMode},b.identity)).join(" "),style:this.getFrameStyle()},a.createElement("div",{className:"block-layer bottom"}),a.createElement("div",{className:"mobile-frame-top"}),a.createElement("div",{className:"site-shadow",key:"mobile-site-shadow"}),a.createElement("div",{className:"mobile-frame-bottom"}))}}),define("rEditor/rootComps/mobileFrame/mobileFrame",["react","core","rEditor/rootComps/mobileFrame/mobileFrame.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"mobileFrame",propTypes:{displayShadow:a.PropTypes.bool,siteScale:a.PropTypes.number,previewMode:a.PropTypes.bool.isRequired},mixins:[b.mixins.editorAPIMixin],getMobilePreviewLeft:function(){return this.getEditorAPI().site.getXPos()},getFrameStyle:function(){var a={left:this.getMobilePreviewLeft()};return this.props.previewMode||1===this.props.siteScale||(a.height=Math.round(100/this.props.siteScale)+"%",a.transform="scale("+this.props.siteScale+")"),a},render:c})}),define("rEditor/utils/mouseMoveActions/baseSpace",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","experiment"],function(a,b,c,d){"use strict";function n(a,b){var c=b.x+b.width<=a.x,d=b.x>=a.x+a.width,e=!(c||d);return e&&b.y+b.height<=a.y}function o(b){var c=i.components.getSiblings(g),d=a(c).map(function(a){return i.components.layout.getRelativeToScreen(a)}).filter(function(a){return n(b,a)}).value();if(0===d.length)return 0;var e=a.max(d,function(a){return a.y+a.height});return e.y+e.height}function p(a){var b=i.components.getContainer(g),c=i.components.layout.getRelativeToScreen(b),d=o(a);return Math.max(d,c.y)}function q(b,c){i=b,g=c.compsToPush,h=c.snapThreshold||0;var j=a.pluck(g,"id");i.renderPlugins.setCompsToShowOnTop(j);var n=a.omit(i.components.layout.getRelativeToScreen(g),"bounding"),o=a.map(g,function(b){return a.omit(i.components.layout.getRelativeToScreen(b),"bounding")});k=d.isOpen("exp171")&&!d.isOpen("zoomModeSectionsRedesignOff")?c.minY:p(n),l=c.onSpaceEnd,m=c.onSpace;var q={x:c.evt.pageX,y:c.evt.pageY};f=new e.Drag(n,q,o)}function r(b){var c={x:b.pageX,y:b.pageY},d=f.getLayout(c);d.y=Math.max(d.y,k),d.y-h<=k&&(d.y=k),j=f.getBoundComponentLayouts(d);for(var e=0;e<g.length;e++)i.components.layout.updateRelativeToScreenAndAdjustLayout(g[e],a.pick(j[e],"y"));a.isFunction(m)&&m(c.x,c.y)}function s(){if(j){for(var b=0;b<g.length;b++)i.components.layout.updateRelativeToScreen(g[b],a.pick(j[b],"y"));j=null}i.renderPlugins.setCompsToShowOnTop(null),a.isFunction(l)&&l()}var f,g,h,i,j,k,l,m,e=b.utils.layoutTransitionsUtil;return{start:q,on:r,end:s,type:c.SPACER}}),define("rEditor/rootComps/sectionsReorganize/reorganizeSection.rt",["react/addons","lodash","baseUI","core"],function(a,b,c,d){"use strict";return function(){return a.createElement("div",{className:b.keys(b.pick(this.getClass(),b.identity)).join(" "),style:this.getStyle(),onMouseDown:this.onMainActionClick,onClick:this.onClick},a.createElement(c.tooltip,{id:this.props.tooltipId,value:"ONSTAGE_DRAG_STRIP_TOOLTIP",alignment:c.uiConstants.TOOLTIP.ALIGNMENT.LEFT,delay:"0",disabled:this.props.dragging},a.createElement("div",{className:"handle-wrapper",onMouseEnter:this.onMouseEnterHandle,onMouseLeave:this.onMouseLeaveHandle},a.createElement("div",{className:"handle"},a.createElement("div",{className:"graphic"},this.showFullHandleGraphic()?a.createElement(c.symbol,{name:"handle-arrow",className:"top",key:"handleArrowTop"}):null,a.createElement(c.symbol,{name:"handle-dots",className:this.showFullHandleGraphic()?"light":"dark",customDimensions:this.getHandleDimension()}),this.showFullHandleGraphic()?a.createElement(c.symbol,{name:"handle-arrow",className:"bottom",key:"handleArrowBottom"}):null),1===this.props.siteScale?a.createElement("div",{className:"half top",key:"halfTop"},a.createElement("div",{className:"action",onMouseDown:this.onTopActionClick})):null,1===this.props.siteScale?a.createElement("div",{className:"half bottom",key:"halfBottom"},a.createElement("div",{className:"action",onMouseDown:this.onBottomActionClick})):null))),a.createElement("div",{className:"block"},a.createElement("div",{className:"lines left",style:{width:"calc("+100*(1-this.props.siteScale)/2+"vw - "+(this.props.verticalScrollbarHidden?0:5)+"px)"}}),a.createElement("div",{className:"lines right",style:{width:"calc("+100*(1-this.props.siteScale)/2+"vw - "+(this.props.verticalScrollbarHidden?2*d.constants.SECTIONS_REORGANIZE.STRIP_WIDTH:5+d.constants.SECTIONS_REORGANIZE.STRIP_WIDTH)+"px - "+(this.props.verticalScrollbarHidden?0:1)+"vw)"}})),this.props.selected&&this.props.spacing&&this.props.mousePositionY>0?a.createElement("div",{key:"spaceBox",className:"space-box",style:this.getSpaceBoxStyle()}):null)}}),define("rEditor/rootComps/sectionsReorganize/reorganizeSection",["react","core","lodash","baseUI","rEditor/rootComps/sectionsReorganize/reorganizeSection.rt"],function(a,b,c,d,e){"use strict";function i(a){return a>60?6:a>50?5:a>45?4:a>40?3:a>35?2:1}function j(a){return 4*i(a)-2}var f=200,g=4200,h=b.bi.events.sectionReorganize;return a.createClass({displayName:"reorganizeSection",mixins:[b.mixins.editorAPIMixin],getInitialState:function(){return{handleHovered:!1}},componentWillReceiveProps:function(a){this.props.dragging&&!a.dragging&&this.setState({handleHovered:!1})},getClass:function(){return{section:!0,selected:this.isSelected(),hovered:this.isHovered(),scaled:1!==this.props.siteScale}},getStyle:function(){return{top:this.props.layout.y*this.props.siteScale,height:this.props.layout.height*this.props.siteScale}},onClick:function(){window.clearTimeout(this.timeout),this.timeout=null},onMainActionClick:function(a){this.timeout=window.setTimeout(this.props.onMainActionClick.bind(this,c.clone(a)),f),this.hideTooltip(),a.stopPropagation()},onTopActionClick:function(a){this.props.onTopActionClick(a),this.reportBI(h.SPACE_TOP_DRAG),this.hideTooltip(),a.stopPropagation()},onBottomActionClick:function(a){this.props.onBottomActionClick(a),this.reportBI(h.SPACE_BOTTOM_DRAG),this.hideTooltip(),a.stopPropagation()},onMouseEnterHandle:function(){this.setState({handleHovered:!0}),setTimeout(this.hideTooltip,g),this.reportBI(h.HOVER_SECTION_HANDLE)},onMouseLeaveHandle:function(){this.setState({handleHovered:!1}),this.hideTooltip()},hideTooltip:function(){d.tooltipManager.hide(this.props.tooltipId)},isSelected:function(){return this.props.spacing||this.props.draggingAndPushing||this.props.dragging?this.props.selected:this.state.handleHovered},isHovered:function(){return this.props.spacing||this.props.draggingAndPushing||this.props.dragging?this.props.selected:this.props.hovered},showFullHandleGraphic:function(){return this.isSelected()||this.isHovered()},getHandleDimension:function(){var a=j(this.props.layout.height);return{height:a+"px",viewBox:"0 0 10 "+a}},getSpaceBoxStyle:function(){var a=this.props.layout.y+this.props.layout.height,b=this.props.mousePositionY-a;return{bottom:Math.min(0,-1*b),height:Math.abs(b)}},reportBI:function(a){var c=this.getEditorAPI();c.bi.event(a,{page_id:c.pages.getCurrentPageId(),section_size:b.utils.sectionsReorganizeUtil.getSectionSizeForBI(this.props.layout.height)})},render:e})}),define("rEditor/rootComps/sectionsReorganize/sectionsReorganize.rt",["react/addons","lodash","baseUI","rEditor/rootComps/sectionsReorganize/reorganizeSection"],function(a,b,c,d){"use strict";function e(a,c,d){this.checkOverlap(b.clone(d))}function f(a,b){this.resetQuickTip()}function g(a,b,c,d,e){this.startSectionDrag(e,a,c)}function h(a,b,c,d,e){this.startDragAndPush(e,a,c)}function i(a,b,c,d,e){this.startSpacing(e,a,c)}function j(b,c,e,f){return a.createElement(d,{key:"section"+f,section:e,selected:this.isSectionSelected(e),hovered:this.isSectionHovered(e),layout:this.getSectionLayout(e),dragging:this.props.isSectionDragging,spacing:this.state.isSpacing,draggingAndPushing:this.state.isDraggingAndPushing,siteScale:this.props.siteScale,onMainActionClick:g.bind(this,b,c,e,f),onTopActionClick:h.bind(this,b,c,e,f),onBottomActionClick:i.bind(this,b,c,e,f),tooltipId:"reorganize-section-tooltip-"+f,mousePositionY:this.state.spaceY-this.editorAPI.editorConfig.editingAreaLayout.top,verticalScrollbarHidden:c})}function k(){var c=this.getSections(),d=this.editorAPI.isVerticalScrollbarHidden();return a.createElement.apply(this,["div",{className:b.keys(b.pick({"sections-reorganize":!0,"hidden-scrollbar":d,"is-hidden":this.props.isHidden,"half-opacity":this.props.halfOpacityTools,"wide-strip":this.shouldShowWideStrip()},b.identity)).join(" "),onContextMenu:this.props.onContextMenu,onMouseMove:e.bind(this,c,d),key:"sectionsReorganizeWrapper"},c&&c.length?a.createElement("div",{key:"strip",className:"reorganize-strip",ref:"checkOverlapTarget",onMouseEnter:f.bind(this,c,d)}):null,b.map(c,j.bind(this,c,d))])}return function(){return this.getSections().length>1?k.apply(this,[]):null}}),define("rEditor/rootComps/sectionsReorganize/sectionsReorganize",["react","lodash","core","rEditor/utils/mouseMoveActions/baseSpace","rEditor/utils/mouseMoveActions/baseDragAndPush","rEditor/rootComps/mixins/findOverlappedComponentMixin","rEditor/rootComps/sectionsReorganize/sectionsReorganize.rt"],function(a,b,c,d,e,f,g){"use strict";function l(a){return a.height>=h?a:{y:a.y-h/2,height:30}}function m(a){return a.siteSegments.getPagesContainerAbsLayout().y}var h=30,i=.9,j=c.utils.sectionDrag,k=c.bi.events.sectionReorganize;return a.createClass({displayName:"sectionsReorganize",mixins:[c.mixins.editorAPIMixin,f],propTypes:{onContextMenu:a.PropTypes.func,isSectionDragging:a.PropTypes.bool,sections:a.PropTypes.array,selectedSection:a.PropTypes.object,draggedAddPanelComp:a.PropTypes.array,isHidden:a.PropTypes.bool,halfOpacityTools:a.PropTypes.bool},getInitialState:function(){return this.editorAPI=this.getEditorAPI(),this.sectionsCount=0,{isDraggingAndPushing:!1,isSpacing:!1,isDraggingSection:!1,spaceY:0,mousePosition:{x:0,y:0}}},getSections:function(){var a;return this.props.sections?this.props.sections:(a=c.utils.sectionsReorganizeUtil.getPageSections(this.editorAPI),this.sectionsCount<=1&&a.length>1&&this.reportBI(k.SECTION_APPEARANCE),this.sectionsCount=a.length,a)},startDragAndPush:function(a,c,d){this.setState({isDraggingAndPushing:!0}),this.editorAPI.registerMouseMoveAction(e,{evt:b.clone(a),comps:d.comps,onDragAndPushEnd:this.onDragAndPushEndCallback}),this.editorAPI.setPageSections(c,d)},startSpacing:function(a,c,e){var f=this.editorAPI,g=e.comps,h=f.components.layout.getRelativeToStructure(g).y+f.components.layout.get(g).height,i=f.components.getSiblings(g[0]),j=b.filter(i,function(a){var b=f.components.layout.getRelativeToStructure(a);return b.y>=h});b.isEmpty(j)||(f.registerMouseMoveAction(d,{evt:b.clone(a),compsToPush:j,onSpace:this.onSpaceCallback,onSpaceEnd:this.onSpaceEndCallback}),a.stopPropagation(),this.setState({isSpacing:!0}),this.editorAPI.setPageSections(c,e))},onSpaceCallback:function(a,b){this.setState({spaceY:b})},onSpaceEndCallback:function(){this.editorAPI.clearPageSections(),this.setState({isSpacing:!1,spaceY:0})},onDragAndPushEndCallback:function(){this.editorAPI.clearPageSections(),this.setState({isDraggingAndPushing:!1})},startSectionDrag:function(a,b,d){var e=this.editorAPI.ui.scroll.getScroll().scrollTop;this.reportBI(k.SECTION_ZOOM_OUT,{scale:Math.round(100*c.constants.SECTIONS_REORGANIZE.ZOOM_OUT_SCALE)}),this.editorAPI.registerMouseMoveAction(j,{sections:b,evt:a,minY:m(this.editorAPI),draggedSection:d,onDragEnd:this.onSectionDragEnd.bind(this,d,d.position.top),onDragStart:this.onSectionDragStart.bind(this,a,d,b)},!0),this.props.setSiteScale(c.constants.SECTIONS_REORGANIZE.ZOOM_OUT_SCALE,e*c.constants.SECTIONS_REORGANIZE.ZOOM_OUT_SCALE)},onSectionDragStart:function(a,b,c){this.editorAPI.documentMode.allowShowingFixedComponents(!1),this.editorAPI.setPageSections(c,b),this.setState({isDraggingSection:!0})},onSectionDragEnd:function(a,b){a=this.props.selectedSection||a,this.reportBI(k.REORDER_SECTION,{position_before:b,position_after:a.position.top,section_size:c.utils.sectionsReorganizeUtil.getSectionSizeForBI(a.position.bottom-a.position.top)});var d=a.position,e=d.bottom-d.top,f=d.top-(window.innerHeight-e)/2+this.editorAPI.editorConfig.editingAreaLayout.top;this.editorAPI.clearPageSections(),setTimeout(function(){this.reportBI(k.SECTION_ZOOM_IN,{scale:Math.round(100*c.constants.SECTIONS_REORGANIZE.ZOOM_IN_SCALE)}),this.props.setSiteScale(c.constants.SECTIONS_REORGANIZE.ZOOM_IN_SCALE,f,this.editorAPI.documentMode.allowShowingFixedComponents.bind(this,!0))}.bind(this),c.constants.SECTIONS_REORGANIZE.ZOOM_IN_DELAY_MS),this.setState({isDraggingSection:!1})},isSectionSelected:function(a){return this.props.selectedSection&&b.isEqual(a.comps,this.props.selectedSection.comps)},isSectionHovered:function(a){var b=this.state.mousePosition.y-this.editorAPI.editorConfig.editingAreaLayout.top;return b>=a.position.top&&b<=a.position.bottom},shouldShowWideStrip:function(){return this.state.isDraggingSection?!0:this.editorAPI.isPerformingMouseMoveAction()?!1:this.state.mousePosition.x>window.innerWidth*i},updateMousePosition:function(a){this.setState({mousePosition:a})},getSectionLayout:function(a){if(a.layout)return a.layout;if((this.props.isSectionDragging||this.state.isSpacing||this.state.isDraggingAndPushing)&&!b.isEmpty(a.comps)){var c=this.getEditorAPI().components.layout.getRelativeToScreen(a.comps);return c.bounding||c}return l({y:a.position.top,height:a.position.bottom-a.position.top})},reportBI:function(a,c){c=b.assign({page_id:this.editorAPI.pages.getCurrentPageId()},c),this.editorAPI.bi.event(a,c)},render:g})}),define("rEditor/rootComps/sectionsReorganize/sectionControlsButton.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){this.onClick()}return function(){return a.createElement(c.tooltip,{value:this.props.tooltip,styleType:"small",disabled:!this.props.tooltip},a.createElement("div",{className:"section-controls-button "+(this.props.label?"with-label":"")+" "+(this.props.isDisabled?"disabled":""),onClick:d.bind(this),onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},a.createElement(c.symbol,{name:this.props.symbol}),a.createElement("span",{},this.props.label)))}}),define("rEditor/rootComps/sectionsReorganize/sectionControlsButton",["react","lodash","rEditor/rootComps/sectionsReorganize/sectionControlsButton.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"sectionControlsButton",propTypes:{onClick:a.PropTypes.func,tooltip:a.PropTypes.string,symbol:a.PropTypes.string.isRequired,isDisabled:a.PropTypes.bool},onClick:function(){this.isDisabled||this.props.onClick()},render:c})}),define("rEditor/rootComps/sectionsReorganize/sectionControls.rt",["react/addons","lodash","uiConstants","baseUI","util","rEditor/rootComps/sectionsReorganize/sectionControlsButton"],function(a,b,c,d,e,f){"use strict";function g(){var g=this.getSectionStyle();return a.createElement("div",{className:b.keys(b.pick(this.getSectionControlsClasses(),b.identity)).join(" "),style:g},a.createElement("div",{className:"highlight "+(this.props.isDragging?"with-shadow":""),style:this.getHighlightStyle(),onMouseDown:this.props.onDragHandleMouseDown}),this.props.isHeader||this.props.isFooter||this.props.isGap||this.props.isDragging?null:a.createElement("div",{key:"reorder-buttons",className:"section-buttons-wrapper",style:this.getButtonsWrapperStyle()},a.createElement("div",{className:"section-buttons"},a.createElement(f,b.assign({},{onClick:this.props.onUpClicked,tooltip:"ZoomOut_Section_Tooltip_Move_Up",symbol:"sectionMoveUp",",":!0,isDisabled:this.props.isFirstSection},this.getControlButtonProps())),a.createElement(f,b.assign({},{onClick:this.props.onDownClicked,tooltip:"ZoomOut_Section_Tooltip_Move_Down",symbol:"sectionMoveDown",isDisabled:this.props.isLastSection,",":!0},this.getControlButtonProps())),this.props.isMobileEditor?null:a.createElement(f,b.assign({},{key:"duplicate_btn",onClick:this.props.onDuplicateClicked,tooltip:"ZoomOut_Section_Tooltip_Copy_Section",symbol:"sectionDuplicate"},this.getControlButtonProps())),a.createElement(f,b.assign({},{onClick:this.props.onDeleteClicked,tooltip:this.props.isMobileEditor?"ZoomOut_Section_Tooltip_Hide_Section":"ZoomOut_Section_Tooltip_Delete_Section",symbol:this.props.isMobileEditor?"sectionMobileHide":"sectionDelete"},this.getControlButtonProps())))),this.props.isGap?a.createElement("div",{key:"gap-delete",className:"section-buttons-wrapper",style:this.getButtonsWrapperStyle()},a.createElement("div",{className:"section-buttons"},a.createElement(f,b.assign({},{onClick:this.props.onDeleteClicked,symbol:"sectionDelete",label:e.translate("ZoomOut_Delete_Space_Tooltip")},this.getControlButtonProps())))):null,this.props.isHeader||this.props.isFooter?a.createElement("div",{key:"header-footer-info",className:"section-buttons-wrapper",style:this.getButtonsWrapperStyle()},a.createElement("div",{className:"section-buttons"},this.showHeader()?a.createElement(d.tooltip,{key:"header-info",value:"ZoomOut_Header_Tooltip",styleType:"small",alignment:c.TOOLTIP.ALIGNMENT.BOTTOM},a.createElement("div",{className:"header-footer-info",onMouseEnter:this.onHeaderOver},a.createElement(d.symbol,{name:"infoIcon",className:"info-icon"}),a.createElement("span",{className:"info-text"},e.translate("ZoomOut_Header")))):null,this.showFooter()?a.createElement(d.tooltip,{key:"footer-info",value:"ZoomOut_Footer_Tooltip",styleType:"small",alignment:c.TOOLTIP.ALIGNMENT.TOP},a.createElement("div",{className:"header-footer-info",onMouseEnter:this.onFooterOver},a.createElement(d.symbol,{name:"infoIcon",className:"info-icon"}),a.createElement("span",{className:"info-text"},e.translate("ZoomOut_Footer")))):null)):null)}return function(){return g.apply(this,[])}}),define("rEditor/rootComps/sectionsReorganize/sectionControls",["react","lodash","core","rEditor/rootComps/sectionsReorganize/sectionControls.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"sectionControls",propTypes:{isMobileEditor:a.PropTypes.bool,layout:a.PropTypes.object.isRequired,siteScale:a.PropTypes.number.isRequired,showDragHighlight:a.PropTypes.bool,isDragging:a.PropTypes.bool,isSpacing:a.PropTypes.bool,isHeader:a.PropTypes.bool,isFooter:a.PropTypes.bool,onDragHandleMouseDown:a.PropTypes.func,onUpClicked:a.PropTypes.func,onDownClicked:a.PropTypes.func,onDuplicateClicked:a.PropTypes.func,onDeleteClicked:a.PropTypes.func},getDefaultProps:function(){return{isMobileEditor:!1,showDragHighlight:!1}},getInitialState:function(){return{isHoveringControlButton:!1}},componentWillMount:function(){this._setControlButtonHoverState=b.debounce(this.setControlButtonHoverState,100),this.throttledBi=b.throttle(this.bi,50,{leading:!1,trailing:!0})},getSectionControlsClasses:function(){return{"section-controls":!0,"show-highlight":this.props.showDragHighlight||this.state.isHoveringControlButton,"no-drag-handle":this.state.isHoveringControlButton||this.props.isSpacing,"header-footer-blocker":this.props.isHeader||this.props.isFooter}},getSectionStyle:function(){return{top:this.props.layout.y*this.props.siteScale,height:this.props.layout.height*this.props.siteScale}},getHighlightStyle:function(){var a=this.props.isMobileEditor?"320px":"100%",b={width:"calc("+a+" * "+this.props.siteScale+" + 2px)"};return 1===this.props.siteScale&&(b.pointerEvents="none"),b},setControlButtonHoverState:function(a){this.state.isHoveringControlButton!==a&&this.setState({isHoveringControlButton:a})},getControlButtonProps:function(){var a=this;return{onMouseEnter:function(){a._setControlButtonHoverState(!0)},onMouseLeave:function(){a._setControlButtonHoverState(!1)}}},getButtonsWrapperStyle:function(){var a="calc(25% + 100% * "+this.props.siteScale+" + 36px)";return this.props.isMobileEditor&&(a="calc(50% + 320px / 2 * "+this.props.siteScale+" + 36px)"),{height:this.props.layout.height*this.props.siteScale,left:a}},bi:function(a){this.props.editorAPI.bi.event(a,{editor_view_mode:this.props.editorAPI.isMobileEditor()?"mobile":"desktop"})},showHeader:function(){return this.props.isHeader?(this.throttledBi(c.bi.events.sectionReorganize.header_label_appear),!0):!1},showFooter:function(){return this.props.isFooter?(this.throttledBi(c.bi.events.sectionReorganize.footer_label_appear),!0):!1},onHeaderOver:function(){this.throttledBi(c.bi.events.sectionReorganize.header_tooltip_hover)},onFooterOver:function(){this.throttledBi(c.bi.events.sectionReorganize.footer_tooltip_hover)},render:d})}),define("rEditor/rootComps/sectionsReorganize/sectionsReorganizeExp.rt",["react/addons","lodash","baseUI","rEditor/rootComps/sectionsReorganize/sectionControls"],function(a,b,c,d){"use strict";function e(b,c,d,e,f){return a.createElement("line",{key:"separator-"+f,className:"section-separator",x1:e.x1,x2:e.x2,y1:e.y,y2:e.y})}function f(){var f=this.getSections(),g=this.getSpacerProps(f),h=this.getSectionControlsProps(f,g);return a.createElement("div",{className:"sections-reorganize-exp"},a.createElement.apply(this,["svg",{className:"section-separators"},b.map(this.getSeparatorLines(f),e.bind(this,f,g,h))]),h&&!this.state.isSpacing?a.createElement(d,b.assign({},{key:h.layout.y+"_"+h.layout.height,isMobileEditor:this.props.isMobileEditor},h)):null,!g||this.props.isMobileEditor&&1===this.props.siteScale?null:a.createElement("div",{key:"spacer",className:"spacer-handle",style:g.style,onMouseDown:g.onMouseDown},a.createElement(c.symbol,{name:"spacerHandleDots"})))}return function(){return f.apply(this,[])}}),define("rEditor/rootComps/sectionsReorganize/sectionsReorganizeExp",["lodash","react","core","rEditor/utils/mouseMoveActions/baseSpace","rEditor/rootComps/sectionsReorganize/sectionsReorganizeExp.rt"],function(a,b,c,d,e){"use strict";function j(a){return a.siteSegments.getPagesContainerAbsLayout().y}function k(a,b,c){return b>=a.left&&b<=a.right&&c>=a.top&&c<=a.bottom}function l(a,b,d){var e;if(d)e=320*b;else{var f=c.utils.stageUtils.getStageRect();e=(f.right-f.left)*b}var g=a.x*b;return g>=e}function m(a,b,d){var e;if(d)e=320*b;else{var f=c.utils.stageUtils.getStageRect();e=(f.right-f.left)*b}var g=a.x*b;return e>=g}function n(a,b,c,d){var e=b.left;return d&&(e=b.left+(b.width-320)/2),{x:a.clientX-e,y:a.clientY+c-b.top}}function o(b){if(this.props.selectedSection)return a.find(b,function(b){return a.isEqual(b.comps,this.props.selectedSection.comps)},this);var c=this.state.stageMousePosition;if(c)for(var d=0;d<b.length;d++)if(c.y>=b[d].position.top&&c.y<=b[d].position.bottom)return b[d];return null}function p(a){if(this.props.selectedSection)return-1;var b=this.state.stageMousePosition;if(b)for(var c=0;c<a.length-1;c++)if(b.y>a[c].position.bottom&&b.y<a[c+1].position.top)return c;
return-1}function q(b){return this.props.selectedSection&&a.isEqual(b.comps,this.props.selectedSection.comps)}function r(a){if(!this.state.stageMousePosition)return!1;var b=this.state.stageMousePosition.y;return b>=a.position.top&&b<=a.position.bottom}function s(a){var b=r.call(this,a);return b&&l(this.state.stageMousePosition,this.props.siteScale,this.props.isMobileEditor)}function t(b,c){if(this.state.isSpacing&&this.props.selectedSection)return a.findIndex(b,q,this);for(var d=0;d<b.length;d++){var e=d>0?b[d-1]:null;if(c.y<=b[d].position.top+f&&(!e||c.y>e.position.top+f))return d}return-1}function u(b,d){var e=a.clone(b),f=[],g=c.utils.sectionsReorganizeUtil.getHeaderSection(d);e.unshift(g);for(var h=0;h<e.length;h++){var i=e[h],j=h>0?e[h-1]:null;j&&j.position.bottom<i.position.top&&f.push(i.position.top),f.push(i.position.bottom)}return f}function v(b,d){if(!b||d&&d.isSpacerHovered)return null;var e=o.call(this,b);if(!e)return null;var f=a.findIndex(b,e),g=q.call(this,e),h=1!==this.props.siteScale,i=this;return{section:e,siteScale:this.props.siteScale,layout:this.getSectionLayout(e),showDragHighlight:!this.props.isMobileEditor||h,isDragging:g,isSpacing:this.state.isSpacing,tooltipId:"reorganize-section-tooltip",isFirstSection:0===f,isLastSection:f===b.length-1,onDragHandleMouseDown:function(a){i.startSectionDrag(a,b,e)},onDuplicateClicked:function(){c.utils.sectionsReorganizeUtil.duplicateSection(i.getEditorAPI(),b,a.findIndex(b,e));var d=i.getEditorAPI();d.bi.event(c.bi.events.sectionReorganize.reorder_panel_clicked,{editor_view_mode:d.isMobileEditor()?"mobile":"desktop",action_clicked:"duplicate"})},onDeleteClicked:function(){c.utils.sectionsReorganizeUtil.deleteSection(i.getEditorAPI(),b,a.findIndex(b,e)),i.getEditorAPI().history.add("Delete Section");var d=i.getEditorAPI();d.bi.event(c.bi.events.sectionReorganize.reorder_panel_clicked,{editor_view_mode:d.isMobileEditor()?"mobile":"desktop",action_clicked:"delete"})},onUpClicked:function(){i.shiftSection(b,e,-1);var a=i.getEditorAPI();a.bi.event(c.bi.events.sectionReorganize.reorder_panel_clicked,{editor_view_mode:a.isMobileEditor()?"mobile":"desktop",action_clicked:"up"})},onDownClicked:function(){i.shiftSection(b,e,1);var a=i.getEditorAPI();a.bi.event(c.bi.events.sectionReorganize.reorder_panel_clicked,{editor_view_mode:a.isMobileEditor()?"mobile":"desktop",action_clicked:"down"})}}}function w(a,b){return b.y>=a.y&&b.y<=a.y+a.height}function x(b){if(!b)return null;var d=a.clone(b),e=c.utils.sectionsReorganizeUtil.getHeaderSection(this.getEditorAPI());d.unshift(e);var f=p.call(this,d);if(-1===f)return null;var g={y:d[f].position.bottom,height:d[f+1].position.top-d[f].position.bottom},h=this;return{isGap:!0,layout:g,siteScale:this.props.siteScale,onDeleteClicked:function(){h.closeGapBetweenSections(d,f)}}}function y(){var b=this.state.stageMousePosition;if(!b)return null;var f,c=this.getEditorAPI(),d=c.components.layout.getRelativeToScreen(c.siteSegments.getHeader()),e=c.components.layout.getRelativeToScreen(c.siteSegments.getFooter());return w(d,b)?f={layout:d,isHeader:!0,editorAPI:c}:w(e,b)&&(f={layout:e,isFooter:!0,editorAPI:c}),f?a.assign(f,{siteScale:this.props.siteScale}):null}var f=30,g=c.bi.events.sectionReorganize,h=234,i=5;return b.createClass({displayName:"sectionsReorganize",propTypes:{isMobileEditor:b.PropTypes.bool.isRequired,sections:b.PropTypes.array,selectedSection:b.PropTypes.object,isSectionDragging:b.PropTypes.bool,isCompDragging:b.PropTypes.bool,stageLayout:b.PropTypes.number,siteScale:b.PropTypes.number},mixins:[c.mixins.editorAPIMixin],getInitialState:function(){return{isSpacing:!1,stageMousePosition:null}},componentDidMount:function(){this._throttledUpdateMousePosition=a.throttle(this.updateMousePosition,100),window.addEventListener("mousemove",this._throttledUpdateMousePosition)},componentWillUnmount:function(){window.removeEventListener("mousemove",this._throttledUpdateMousePosition)},updateMousePosition:function(b){var d=c.utils.stageUtils.getStageLayout();if(k(d,b.clientX,b.clientY)){var e=this.getEditorAPI();b=a.pick(b,["clientX","clientY"]),c.utils.mouseScaleHandler.fitMouseCoordinatesToScale(e,b,this.props.siteScale);var f=e.ui.scroll.getScroll().scrollTop,g=f/this.props.siteScale;this.setState({stageMousePosition:n(b,d,g,this.props.isMobileEditor)})}else this.state.stageMousePosition&&this.setState({stageMousePosition:null})},getSections:function(){return this.props.sections?this.props.sections:c.utils.sectionsReorganizeUtil.getPageSections(this.getEditorAPI())},getSectionControlsProps:function(a,b){return y.call(this)||x.call(this,a)||v.call(this,a,b)},getSpacerProps:function(b){if((this.props.isCompDragging||this.props.isSectionDragging)&&!this.state.isSpacing)return null;var c=this.state.stageMousePosition;if(!b||!c)return null;var d=t.call(this,b,c),e=m(this.state.stageMousePosition,this.props.siteScale,this.props.isMobileEditor),f=o.call(this,b),g=a.findIndex(b,f),h=f?s.call(this,f):!1;if(-1===d||!e||h)return null;var i=this,j=this.props.isMobileEditor?"320px":"100%";return{style:{top:this.getSectionLayout(b[d]).y*this.props.siteScale,width:"calc("+j+" * "+this.props.siteScale+" + 2px)"},onMouseDown:function(a){i.startSpacing(a,b,d)},isSpacerHovered:d===g}},getSeparatorLines:function(b){var c=u(b,this.getEditorAPI()),d=this.props.stageLayout,e=d.width*this.props.siteScale;this.props.isMobileEditor&&(e=320*this.props.siteScale);var f=(d.width-e)/2;return a(c).map(function(a){return a*=this.props.siteScale,[{x1:f-h,x2:f,y:a},{x1:f+e,x2:f+e+h,y:a}]},this).flatten().value()},closeGapBetweenSections:function(a,b){for(var d=a[b+1].position.top-a[b].position.bottom,e=b+1;e<a.length;e++)c.utils.sectionsReorganizeUtil.shiftSection(this.getEditorAPI(),a[e],-1*d);this.getEditorAPI().history.add("Delete Space")},shiftSection:function(b,d,e){var f=a.findIndex(b,d),g=f+e;if(!(0>g||g>=b.length)){var h=d,i=b[g];-1===e&&(h=b[g],i=d),c.utils.sectionsReorganizeUtil.switchSections(this.getEditorAPI(),b,h,i),this.getEditorAPI().history.add("Move Section")}},startSectionDrag:function(b,d,e){var f=this.getEditorAPI();b=a.clone(b),c.utils.mouseScaleHandler.fitMouseCoordinatesToScale(f,b,this.props.siteScale),f.setPageSections(d,e),f.registerMouseMoveAction(c.utils.sectionDrag,{sections:d,evt:b,minY:j(f),draggedSection:e,onDragEnd:this.onSectionDragEnd.bind(this,e,e.position.top)},!0)},onSectionDragEnd:function(a,b){a=this.props.selectedSection||a,this.reportBI(g.REORDER_SECTION,{position_before:b,position_after:a.position.top,section_size:c.utils.sectionsReorganizeUtil.getSectionSizeForBI(a.position.bottom-a.position.top)}),this.getEditorAPI().clearPageSections()},startSpacing:function(b,e,f){var g=this.getEditorAPI();b=a.clone(b),c.utils.mouseScaleHandler.fitMouseCoordinatesToScale(g,b,this.props.siteScale);for(var h=[],j=f;j<e.length;j++)h=h.concat(e[j].comps);if(!a.isEmpty(h)){var k=0===f?0:e[f-1].position.bottom;g.registerMouseMoveAction(d,{evt:b,minY:k,snapThreshold:Math.round(i/this.props.siteScale),compsToPush:h,onSpaceEnd:this.onSpaceEnd}),this.setState({isSpacing:!0}),g.setPageSections(e,e[f]),g.bi.event(c.bi.events.sectionReorganize.zoom_mode_spacer_drag)}},onSpaceEnd:function(){this.getEditorAPI().clearPageSections(),this.setState({isSpacing:!1}),this.getEditorAPI().history.add("Change Sections Space")},getSectionLayout:function(b){if(b.layout)return b.layout;if((this.props.isSectionDragging||this.state.isSpacing)&&!a.isEmpty(b.comps)){var c=this.getEditorAPI().components.layout.getRelativeToScreen(b.comps);return c.bounding||c}return{y:b.position.top,height:b.position.bottom-b.position.top}},reportBI:function(b,c){var d=this.getEditorAPI();c=a.assign({page_id:d.pages.getCurrentPageId()},c),d.bi.event(b,c)},render:e})}),define("rEditor/rootComps/pinMode/pinMode.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{className:"pin-mode"},a.createElement("div",{className:"preview-rect",style:this.props.style}),a.createElement("div",{className:"blocking-layer",onClick:this.exitPinMode}))}}),define("rEditor/rootComps/pinMode/pinMode",["react","core","lodash","rEditor/rootComps/pinMode/pinMode.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"pinMode",mixins:[b.mixins.editorAPIMixin],render:d,exitPinMode:function(){this.getEditorAPI().pinMode.closeAndCheckSizeRestrictions()}})}),define("rEditor/rootComps/stage/editorStage.rt",["react/addons","lodash","rEditor/rootComps/mouseCatcher","rEditor/rootComps/textEditor","rEditor/rootComps/funTextEditor","core","util","experiment","uiAnimations","rEditor/rootComps/gridLines/gridLines","rEditor/rootComps/rulers/rulers","rEditor/rootComps/mobileFrame/mobileFrame","rEditor/rootComps/sectionsReorganize/sectionsReorganize","rEditor/rootComps/sectionsReorganize/sectionsReorganizeExp","rEditor/rootComps/pinMode/pinMode","experiment!hoverBoxStateToEditorStageOff","experiment!zoomModeSectionsRedesignOff","experiment!exp171"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";function s(b,c){var d=g.translate;return a.createElement("div",{key:"teaser",className:"mobile-optimized-teaser"},a.createElement("h1",{},d("mobile_view_notification_title")),"\n                        ",d("mobile_view_notification_text"),"\n                        ",a.createElement("a",{onClick:this.openEditorModePanel},d("mobile_view_notification_text_link")),"\n                        ",d("mobile_view_notification_text2"),"\n                    ")}function t(){var t=this.getGuides(),u=this.getEditorAPI();return a.createElement("div",{className:b.keys(b.pick({"editor-stage":!0,"tools-hidden":this.props.toolsHidden},b.identity)).join(" "),id:this.props.id},u.isMobileEditor()?a.createElement(l,{key:"mobileFrame",siteScale:this.props.siteScale,displayShadow:!this.isSectionDragging(),previewMode:u.getPreviewMode()}):null,a.createElement("div",{className:"scrollable-editor-stage",ref:"scrollableEditorStage",id:"scrollableEditorStage",onScroll:this._handleScroll},a.createElement("div",{ref:"siteCover",className:"site-cover",style:{height:this.props.siteHeight*this.props.siteScale}},u.isDesktopEditor()&&this.props.editorState.viewTools.guidelinesEnabled&&!this.props.editorState.pinMode?a.createElement(j,{key:"gridlines",siteScale:this.props.siteScale,fade:u.components.is.showMarginsIndicator(this.props.editorState.focusedContainer),showTopBottom:!this.isLandingPage()}):null,a.createElement("div",{className:"scalable",style:this.getScalableAreaStyle()},this.props.editorState.previewMode||!this.props.editorIsInit||this.props.editorState.imageCrop.isOn?null:a.createElement(c,{ref:"mouseCatcher",key:"mouseCatcher",config:this.props.config,editorState:this.props.editorState,onContextMenu:this.props.onContextMenu,editorIsInit:this.props.editorIsInit,isSectionDragging:this.isSectionDragging(),isDragging:this.isDragging(),isResizing:this.isResizing(),isRotating:this.isRotating(),isPinMode:this.props.editorState.pinMode,performingMouseMoveAction:this.props.performingMouseMoveAction,registeredMouseMoveAction:this.props.registeredMouseMoveAction,hoveredComp:h.isOpen("exp171")&&!p&&this.state.hoveredComp||this.props.hoveredComp,hoverBoxOverlay:h.isOpen("exp171")&&!p&&this.state.hoverBoxOverlay||this.props.hoverBoxOverlay,setHoverBox:this.setHoverBox,clearHoverBox:this.clearHoverBox,selectedComponents:this.props.selectedComponents,focusedContainer:this.props.editorState.focusedContainer,mouseMoveCallback:this.props.mouseMoveCallback,compPanel:this.props.panel,editingAreaLayout:this.props.editingAreaLayout,siteScale:this.props.siteScale}),this.props.editorState.imageCrop.isOn?a.createElement(f.lazyComponent,b.assign({},{moduleName:"imageCrop.layer",key:"imageCrop"},{imageCropData:this.props.editorState.imageCrop,imageComponent:this.getImageComponent()})):null,!h.isOpen("newCK")&&this.props.editorState.isOpenTextEditor&&this.props.selectedComponents?a.createElement(d,{key:"textEditor",isResizing:this.isResizing()}):null,h.isOpen("newCK")?a.createElement(e,{key:"funTextEditor",isOpenTextEditor:this.props.editorState.isOpenTextEditor,selectedComponents:this.props.selectedComponents,isResizing:this.isResizing()}):null,this.props.editorState.viewTools.rulersEnabled&&h.isOpen("rulers")?a.createElement(k,{key:"rulers",rulerDirection:"horizontal",guidesInRuler:t.horizontalGuides,selectedGuide:this.props.editorState.viewTools.rulers.selectedGuide,isHovered:this.props.editorState.viewTools.rulers.isHovered}):null),a.createElement("div",{className:"non-scalable"},1!==this.props.siteScale?a.createElement("div",{className:"block-layer",key:"block-layer"},a.createElement("div",{className:"side left transition",style:this.getSideBlockLayerStyle()}),a.createElement("div",{className:"side right transition",style:this.getSideBlockLayerStyle()}),u.isMobileEditor()?null:a.createElement("div",{key:"block-layer-bottom",className:"side bottom",style:{height:"calc(100% - "+this.getSideBlockLayerHeight()+"px)"}}),this.isSectionDragging()||u.isMobileEditor()?null:a.createElement("div",{key:"scaled-site-shadow",className:"shadow",style:this.getBlockShadowStyle()})):null,r||!this.props.editorIsInit||u.isMobileEditor()||this.props.editorState.pinMode||!this.props.editorState.viewTools.sectionsHandlesEnabled?null:a.createElement(m,{key:"sectionsReorganize",ref:"sectionsReorganize",isSectionDragging:this.isSectionDragging(),sections:this.props.pageSections.sections,selectedSection:this.props.pageSections.selectedSection,siteScale:this.props.siteScale,setSiteScale:this.props.setSiteScale,draggedAddPanelComp:this.props.portalComps.addPanel,onContextMenu:this.props.onContextMenu,isHidden:this.props.toolsHidden,halfOpacityTools:this.props.halfOpacityTools}),!r||q||!this.props.editorIsInit||this.props.editorState.pinMode||!u.isMobileEditor()&&1===this.props.siteScale?null:a.createElement(n,{key:"sectionsReorganize",ref:"sectionsReorganize",isMobileEditor:u.isMobileEditor(),sections:this.props.pageSections.sections,selectedSection:this.props.pageSections.selectedSection,isSectionDragging:this.isSectionDragging(),isCompDragging:this.isDragging(),siteScale:this.props.siteScale,isHidden:this.props.toolsHidden,halfOpacityTools:this.props.halfOpacityTools,stageLayout:u.ui.stage.getEditingAreaLayout()})))),a.createElement("div",{className:"fixed-editor-stage",style:{width:"calc(100% - "+g.uiUtils.getScrollbarWidth()+"px)"}},a.createElement("div",{className:"fixed-editor-stage-contents-wrapper "+(1!==this.props.siteScale?"no-pointer-events":"")},a.createElement("div",{className:"scalable",style:this.getScalableAreaStyle()},this.props.editorState.pinMode?a.createElement(o,{ref:"pinMode",key:"pinMode",style:this.props.editorState.pinPreviewRectStyle}):null,this.props.editorState.viewTools.rulersEnabled&&h.isOpen("rulers")?a.createElement(k,{key:"rulers",rulerDirection:"vertical",guidesInRuler:t.verticalGuides,selectedGuide:this.props.editorState.viewTools.rulers.selectedGuide,isHovered:this.props.editorState.viewTools.rulers.isHovered}):null),a.createElement("div",{className:"non-scalable"},u.isMobileEditor()?a.createElement("div",{key:"mobileOpacityLayer",className:"mobile-frame-opacity-layer"}):null,a.createElement(i.panelsAnimation,{},this.shouldDisplayMobileOptimizedTeaser()?s.apply(this,[t,u]):null)))))}return function(){return t.apply(this,[])}}),define("rEditor/rootComps/stage/editorStage",["lodash","react","core","uiAnimations","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","rEditor/rootComps/stage/editorStage.rt","experiment","experiment!boxSlideShow","experiment!zoomModeSectionsRedesignOff","experiment!exp171","experiment!hoverBoxStateToEditorStageOff"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a,b){if(b&&1===b.length){var c=b[0],d=a.components.data.get(c).type;if("Image"===d)return c}return null}return b.createClass({displayName:"EditorStage",mixins:[c.mixins.editorAPIMixin],propTypes:{guidesState:b.PropTypes.object,onStageScroll:b.PropTypes.func,editingAreaLayout:b.PropTypes.object},getInitialState:function(){return{hoveredComp:null,hoverBoxOverlay:!1}},componentWillReceiveProps:function(){g.isOpen("exp171")&&!k&&this.state.hoveredComp&&!this.getEditorAPI().components.is.exist(this.state.hoveredComp)&&this.clearHoverBox()},setHoverBox:function(b,c){var d=this.getEditorAPI();if(g.isOpen("exp171")&&!g.isOpen("hoverBoxStateToEditorStageOff")){var e=d.utils.getParentIfCompCanBeSelected(b),f=h&&e?e:b;a.isEqual(this.state.hoveredComp,f)||this.setState({hoveredComp:f,hoverBoxOverlay:!!c})}else d.hoverBox.set(b,c)},clearHoverBox:function(){g.isOpen("exp171")&&!g.isOpen("hoverBoxStateToEditorStageOff")?this.state.hoveredComp&&this.setState({hoveredComp:null,hoverBoxOverlay:!1}):this.getEditorAPI().hoverBox.clear()},shouldDisplayMobileOptimizedTeaser:function(){var a=this.getEditorAPI();return a.isMobileEditor()&&!a.getPreviewMode()&&!a.isMobileOptimizedSite()},openEditorModePanel:function(){this.getEditorAPI().openMobileElementsPanel({mobileElementId:"mobileView"})},getStageHeight:function(){return this.props.siteHeight},isLandingPage:function(){var a=this.getEditorAPI(),b=a.pages.getCurrentPageId();return a.pages.data.get(b).isLandingPage},isSectionDragging:function(){return this.props.registeredMouseMoveAction&&this.props.registeredMouseMoveAction.type===e.SECTION_DRAG&&this.props.performingMouseMoveAction||!1},isDragging:function(){return this.props.registeredMouseMoveAction&&this.props.registeredMouseMoveAction.type===e.DRAG&&this.props.performingMouseMoveAction},isResizing:function(){return this.props.registeredMouseMoveAction&&this.props.registeredMouseMoveAction.type===e.RESIZE},isRotating:function(){return this.props.registeredMouseMoveAction&&this.props.registeredMouseMoveAction.type===e.ROTATE},getScalableAreaStyle:function(){var a=this.props.siteScale;return 1!==a?{height:this.getStageHeight(),transform:"scale("+a+")",transformOrigin:"center 0"}:void 0},getSideBlockLayerStyle:function(){return this.getEditorAPI().isMobileEditor()?{width:"calc((100% - 320px * "+this.props.siteScale+") / 2)"}:{width:100*(1-this.props.siteScale)/2+"%"}},getSideBlockLayerHeight:function(){return Math.max(0,this.getStageHeight()*this.props.siteScale)},getBlockShadowStyle:function(){var a=100*(1-this.props.siteScale)/2;return{left:a+"%",right:a+"%",height:this.getSideBlockLayerHeight()+"px"}},updateMousePosition:function(a){j&&!i||!this.refs.sectionsReorganize||this.refs.sectionsReorganize.updateMousePosition(a)},getImageComponent:function(){return l(this.getEditorAPI(),this.props.selectedComponents)},getScroll:function(){var a=this.refs.scrollableEditorStage.getDOMNode();return{scrollTop:a.scrollTop,scrollLeft:a.scrollLeft}},setScroll:function(b){var c=this.refs.scrollableEditorStage.getDOMNode();a.isUndefined(b.scrollTop)||(c.scrollTop=b.scrollTop),a.isUndefined(b.scrollLeft)||(c.scrollLeft=b.scrollLeft)},animateScroll:function(a,b,c){var e=this.refs.scrollableEditorStage.getDOMNode();d.scrollTo(a,b,0,e,c)},getGuides:function(){var b=this.getEditorAPI(),c=b.isMobileEditor()?"mobile.":"desktop.",d=a.get(this.props.editorState.viewTools.rulers.guidesState,c);return d?{verticalGuides:d.verticalGuides,horizontalGuides:d.horizontalGuides}:{verticalGuides:[],horizontalGuides:[]}},syncPreviewScroll:function(){var a=this.getScroll();this.getEditorAPI().site.setScroll(a.scrollLeft,a.scrollTop)},_handleScroll:function(a){this.syncPreviewScroll(a),this.props.onStageScroll&&this.props.onStageScroll(a)},getSiteCoverSizes:function(){var a=this.refs.siteCover.getDOMNode();return{width:a.clientWidth,height:a.clientHeight}},render:f})}),define("rEditor/rootComps/prefetch/prefetch.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("link",{rel:"prefetch prerender",href:this.getHref()})}}),define("rEditor/rootComps/prefetch/prefetch",["react","rEditor/rootComps/prefetch/prefetch.rt"],function(a,b){"use strict";return a.createClass({displayName:"prefetch",render:b,getHref:function(){return this.props.base?this.props.base.replace(/\/$/,"")+"/"+this.props.href.replace(/^\//,""):this.props.href}})}),define("rEditor/rootComps/external/qualarooFeedback/qualarooFeedback.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement(c.iframe,{ref:"iframe",className:b.keys(b.pick({hidden:this.props.inPreview||!this.state.shouldShowIframe,minimized:this.state.minimized},b.identity)).join(" "),src:this.state.shouldShowIframe?this.iframeURL:"",id:"qualarooFeedbackIframe"})}}),define("rEditor/rootComps/external/qualarooFeedback/qualarooFeedback",["lodash","react","core","util","rEditor/rootComps/external/qualarooFeedback/qualarooFeedback.rt","rEditor/bi/bi"],function(a,b,c,d,e,f){"use strict";var g=1e3,h=60*g,i="/app/external/qualarooFeedback/survey.html";return b.createClass({displayName:"qualarooFeedback",mixins:[c.mixins.editorAPIMixin,d.postMessageMixin],propTypes:{timeoutInMinutes:b.PropTypes.number.isRequired,inPreview:b.PropTypes.bool.isRequired},getInitialState:function(){var a=d.editorModel.userInfo&&d.editorModel.userInfo.email,b=d.editorModel.editorBase||"/editor-base";return this.iframeURL=b+i+"?email="+a,{shouldShowIframe:!1,minimized:!1}},componentWillMount:function(){if(this.props.timeoutInMinutes){var a=this;this.timeoutHandle=setTimeout(function(){a.setState({shouldShowIframe:!0})},this.props.timeoutInMinutes*h)}else{var b=this.getEditorAPI();b.bi.error(f.errors.QUALAROO_SURVEY_TIMEOUT_NOT_SENT)}},componentDidMount:function(){this.setPostMessageHandlerNamed("qualaroo","qualaroo",this.onMessageFromSurvey)},componentWillUnmount:function(){clearTimeout(this.timeoutHandle)},onMessageFromSurvey:function(a){this.setState({minimized:a.minimized,shouldShowIframe:a.shouldShowIframe})},render:e})}),define("rEditor/rootComps/editor.rt",["react/addons","lodash","rEditor/rootComps/topBar/topBar","rEditor/rootComps/leftBar/leftBar","rEditor/rootComps/toolBar/toolBar","rEditor/rootComps/rightClickMenu/rightClickMenu","rEditor/rootComps/panels/openedPanels","rEditor/rootComps/portal/portal","baseUI","core","uiAnimations","rEditor/rootComps/stage/editorStage","rEditor/rootComps/mobileFrame/mobileFrame","textControls","rEditor/rootComps/prefetch/prefetch","rEditor/rootComps/external/qualarooFeedback/qualarooFeedback","experiment","experiment!QualarooNewEditorSurvey","experiment!hoverBoxStateToEditorStageOff"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){"use strict";function t(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement("div",t({className:"editor-animation-manager-wrapper",id:"editor",tabIndex:"0"},this.getAnimationsEventListeners()),a.createElement("div",{className:b.keys(b.pick({"editor-wrapper":!0,"zoom-mode":1!==this.state.siteScale},b.identity)).join(" "),onMouseMove:this.state.registeredMouseMoveAction&&!this.state.isUsingWindowMouseEvents?this.onMouseMove:b.noop,onMouseUp:this.state.registeredMouseMoveAction&&!this.state.isUsingWindowMouseEvents?this.onMouseUp:b.noop,onMouseDownCapture:this.onMouseDownCapture},this.isPreloaderVisible()?a.createElement("div",{key:"init",className:"preloader"}):null,this.editorAPI.developerMode.isEnabled()?a.createElement(j.lazyComponent,{moduleName:"wixCode.components.wixCodeLoader",key:"wix-code-loader",id:"wix-code-loader",wixCodeLoaded:this.state.wixCodeLoaded}):null,a.createElement("div",{className:b.keys(b.pick({"editor-content-wrapper":!0,"tools-hidden":this.state.hideTools&&!this.state.hideToolsAndMaintainStagePosition},b.identity)).join(" ")},a.createElement(i.splitter,{layout:"vertical",onResize:this.handleEditingAreaResize},this.shouldShowDevModePanels()?a.createElement(i.splitter.Pane,{key:"left-panel-pane",size:"100px",maxSize:"216px"},this.state.wixCodeLoaded?a.createElement(j.lazyComponent,{moduleName:"wixCode.components.Tree",key:"wix-code-tree",id:"wix-code-tree"}):null):null,a.createElement(i.splitter.Pane,{},a.createElement(i.splitter,{layout:"horizontal",collapseDirection:"bottom",startCollapsed:!0,onResize:this.handleEditingAreaResize},a.createElement(i.splitter.Pane,{},a.createElement("div",{ref:"editingArea",id:"editingArea",className:b.keys(b.pick({"editing-area":!0,"mobile-editor":this.editorAPI.isMobileEditor(),"preview-mode":this.editorAPI.getPreviewMode()},b.identity)).join(" ")},a.createElement("div",{className:"preview-frame-cover"},this.editorAPI.isMobileEditor()&&this.editorAPI.getPreviewMode()?a.createElement(m,{key:"mobileFrame",previewMode:this.editorAPI.getPreviewMode()}):null,a.createElement("div",{className:"preview-container"},a.createElement("iframe",{ref:"preview",id:"preview",src:this.getPreviewSource()})),this.state.previewMode?null:a.createElement(l,{id:"stageContainer",ref:"editorStage",key:"editorStage",siteHeight:this.state.editorConfig.previewHeight,config:this.state.editorConfig,editorState:this.state,editorIsInit:this.state.editorIsInit,onContextMenu:this.onContextMenu,hoveredComp:(!q.isOpen("exp171")||s)&&this.state.hoveredComp,hoverBoxOverlay:(!q.isOpen("exp171")||s)&&this.state.hoverBoxOverlay,registeredMouseMoveAction:this.state.registeredMouseMoveAction,performingMouseMoveAction:this.state.performingMouseMoveAction,selectedComponents:this.state.selectedComponents,panel:this.getCompPanel(),editingAreaLayout:this.editorAPI.editorConfig.editingAreaLayout,mouseMoveCallback:this.updateMousePosition,siteScale:this.state.siteScale,setSiteScale:this.setSiteScale,portalComps:this.state.portalComps,pageSections:this.state.pageSections,halfOpacityTools:this.state.halfOpacityTools,toolsHidden:this.state.hideTools,onStageScroll:this._handleStageScroll})),a.createElement(k.leftBarAnimation,{},this.state.previewMode||this.state.pinMode||this.state.imageCrop.isOn?null:a.createElement(d,{leftBarState:this.state.leftBar,ref:"leftBar",openPanels:this.state.openPanels,isMobileEditor:this.state.isMobileEditor,isEnabled:this.state.editorIsInit,key:"leftBar",onContextMenu:this.onContextMenuPreventDefault,halfOpacityTools:this.state.halfOpacityTools,isHidden:this.state.hideTools})),a.createElement(g,{openPanels:this.getNonCompPanels(),editorState:this.state}),b.isEmpty(this.state.portalComps)?null:a.createElement(h,{key:"portalComps",comps:this.state.portalComps}))),this.shouldShowDevModePanels()?a.createElement(i.splitter.Pane,{className:"wix-code-ide-pane",key:"wix-code-ide-pane",minSize:"40px",onClick:this.onIdeClick},this.state.wixCodeLoaded?a.createElement(j.lazyComponent,{moduleName:"wixCode.components.IDE",key:"wix-code-ide",id:"wix-code-ide",wixCodeLoaded:this.state.wixCodeLoaded}):null):null)))),a.createElement("div",{className:"editor-controls"},a.createElement(c,{ref:"topbar",previewMode:this.state.previewMode,isMobileEditor:this.state.isMobileEditor,isMobileOptimized:this.editorAPI.isMobileOptimizedSite(),viewTools:this.state.viewTools,previewingStatus:this.state.previewingStatus,savingStatus:this.state.savingStatus,publishingStatus:this.state.publishingStatus,performingMouseMoveAction:this.state.performingMouseMoveAction,isEnabled:this.state.editorIsInit,height:this.state.editorConfig.topBarHeight,onTopBarClicked:this.editorAPI.onTopBarClicked,onContextMenu:this.onContextMenuPreventDefault,isHidden:this.state.hideTools,shouldHideToolsBtnBlink:this.state.shouldHideToolsBtnBlink}),this.state.viewTools.toolbarEnabled&&!this.state.previewMode?a.createElement(e,{hidden:this.state.pinMode||this.state.imageCrop.isOn,toolsHidden:this.state.hideTools,halfOpacityTools:this.state.halfOpacityTools,key:"toolBar",selectedComponent:this.state.selectedComponents,isEnabled:this.state.editorIsInit,onContextMenu:this.onContextMenuPreventDefault}):null,this.state.viewTools.developerToolBarEnabled&&!this.state.previewMode?a.createElement(j.lazyComponent,{moduleName:"wixCode.components.developerToolBar",key:"developerToolbar",toolsHidden:this.state.hideTools,editedComponents:this.state.selectedComponents,isEnabled:this.state.editorIsInit,onContextMenu:this.onContextMenuPreventDefault,wixCodeLoaded:this.state.wixCodeLoaded}):null,a.createElement(i.tooltipsRenderer,{key:"tooltipsRenderer"}),a.createElement("div",{ref:"floatingBubbleTarget",style:this.getFloatingBubbleTargetStyle(),onMouseLeave:this.onMouseLeaveFloatingBubbleTarget}),this.state.floatingBubble.value&&!this.state.pinMode?a.createElement(i.bubble,b.assign({},{key:"floatingBubble",value:this.state.floatingBubble.value,targetNode:this.getFloatingBubbleTarget(),hideMethod:this.editorAPI.hideFloatingBubble},this.getFloatingBubbleProps())):null,a.createElement(i.dropDown.options,{})),this.state.editorIsInit?null:a.createElement("div",{className:"preloader-overlap",key:"preloader-overlap"}),a.createElement(k.rightClickAppearance,{direction:"top",key:"rightClick"},this.state.contextMenu?a.createElement(f,{key:this.state.contextMenu.position.x+""+this.state.contextMenu.position.y,clipboard:this.state.clipboard,position:this.state.contextMenu.position,editingAreaLayout:this.state.editorConfig.editingAreaLayout,selectedComponents:this.state.selectedComponents}):null),this.getLanguages()?a.createElement(n.themeFontsLoader,{key:"theme-font-loader",themeFonts:this.getThemeFonts(),documentType:this.getDocumentType(),languages:this.getLanguages()}):null,a.createElement(o,{href:"app/external/OrganizeImagesV2/index.html",base:this.getEditorBase()}),a.createElement(o,{href:"app/external/VideoSearch/index.html",base:this.getEditorBase()}),r?a.createElement(p,{id:"qualarooFeedback",key:"qualaroo",inPreview:this.state.previewMode,timeoutInMinutes:.1}):null))}}),define("rEditor/rootComps/editor",["lodash","core","panels","react","jquery","util","baseUI","rEditor/app/EditorAPI","rEditor/rootComps/keyboard/config/shortcutsConfig","uiAnimations","tpa","blog","shoutOut","wixStore","rEditor/rootComps/editor.rt","experiment","experiment!wixstaff","experiment!zoomModeSectionsRedesignOff","experiment!exp171","experiment!hoverBoxStateToEditorStageOff","experiment!concurrentUsersEditing"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){"use strict";function D(a,b){var c=Math.pow(10,b||0);return Math.round(c*a)/c}function E(a,b,c){return Math.min(c,Math.max(b,a))}function F(){(new Image).src="http://fast.fonts.com/t/1.css?apiType=css&projectid=33bd0973-5b82-45be-bb77-837225874dfe"}function H(a){var b=a.match(G);return b&&b.length&&b[1]}function I(a){var b=["DisableNewRelicScripts","DisableNewRelicScriptsSantaEditor","FallbackToSantaTopologyValues"];return a.petri_ovr&&b.map(function(a){return"specs."+a+":true"}).filter(function(b){return-1!==a.petri_ovr.indexOf(b)}).join(";")}function J(b){var c=K(b.href)?A:z,d=f.url.parseUrl(b.href).query,e=I(d),g=new f.UrlBuilder(c+(d.siteId||H(b.href))).param("isEdited","true").param("isSantaEditor","true").param("dsOrigin","Editor1.4").ifParam(e,"petri_ovr",e).ifParam(q,"iswixsite","true").param("lang",f.editorModel.languageCode).paramsObj(a.pick(d,["metaSiteId","ReactSource","SantaVersions","baseVersion","isqa","debug","editorSessionId","experiments","experimentsoff"]));return g.url()}function K(a){return 0===a.indexOf(B)}function L(a){var b=f.translate("GENERAL_Close_Warning_Message");return(a||window.event).returnValue=b,b}function M(a){var b=f.url.parseUrlParams(location);return a.ctrlKey&&"all"===b.debug}function N(){return a(f.editorModel.runningExperiments).pick(function(a){return"new"===a}).keys().sortBy().join(",")}function O(){var a=e(window);this.editorAPI.bi.event(b.bi.events.editor.EDITOR_READY,{is_premium:this.editorAPI.site.isPremium(),is_template:this.editorAPI.documentServices.generalInfo.isFirstSave(),window_width:a.width(),window_height:a.height(),screen_width:screen.width,screen_height:screen.height,avail_width:screen.availWidth,avail_height:screen.availHeight,experiments:N()})}function P(b){return a.pick(b,a.negate(a.isUndefined))}var v=.5;window.bi&&window.bi.event(b.bi.events.editor.EDITOR_LOADED.evid),
f.newrelic.addPageAction("editor loaded"),f.performance.mark("editor loaded"),f.performance.measure("main-r started","domLoading","main-r loaded"),f.performance.measure("addPanelData loaded","main-r loaded","addPanelData loaded"),f.performance.measure("editor loaded","addPanelData loaded","editor loaded");var C,w=!0,x=f.serviceTopology.editorServerRoot||"http://editor.wix.com/html/editor/web",y=x+"/renderer/render/",z=y+"document/",A=y+"template/",B=x+"/renderer/new?",G=/\/([a-zA-Z0-9]{8}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{12})/;return d.createClass({displayName:"editor",mixins:[j.animationManager],propTypes:{},_resetEventListeners:function(){this._scrollListeners=[]},_handleStageScroll:function(b){a.invoke(this._scrollListeners,a.call,null,b)},getInitialState:function(){return this.editorAPI=new h(this),this.notifyEditorInit(),{editorIsInit:!1,editorConfig:this.editorAPI.editorConfig,contextMenu:null,registeredMouseMoveAction:null,performingMouseMoveAction:!1,selectedComponents:null,focusedContainer:null,lastSelectionClickPos:null,previewMode:!1,isMobileEditor:!1,snapData:null,lassoLayout:null,candidates:null,clipboard:{},site:{premiumPackage:void 0},viewTools:{toolbarEnabled:void 0,developerToolBarEnabled:void 0,guidelinesEnabled:void 0,sectionsHandlesEnabled:void 0,snapToEnabled:void 0,rulersEnabled:void 0,rulers:{guidesState:void 0,selectedGuide:void 0,isHovered:void 0}},helpProps:null,attachCandidate:null,constraintArea:null,openPanels:[],previewingStatus:b.constants.PROGRESS_STATUS.IDLE,savingStatus:b.constants.PROGRESS_STATUS.IDLE,publishingStatus:b.constants.PROGRESS_STATUS.IDLE,portalComps:{},floatingBubble:{},leftBar:{isCollapsed:!1,notifications:{},superApps:{desktop:[],mobile:[]}},pageSections:{sections:null,selectedSection:null},siteScale:1,pinPreviewRectStyle:{opacity:0},hideTools:!1,hideToolsAndMaintainStagePosition:!1,shouldHideToolsBtnBlink:!1,halfOpacityTools:!1,mouseOverBubble:!1,unreadComments:0,imageCrop:{isOn:!1,cropArea:null,cropOriginArea:null}}},childContextTypes:{editorAPI:d.PropTypes.object,mediaServices:d.PropTypes.object,bi:d.PropTypes.object},getChildContext:function(){return{editorAPI:this.editorAPI,mediaServices:this.editorAPI.mediaServices,bi:window.bi}},notifyEditorInit:function(){this.editorAPI.initPanelManager(),k.initEditor(this.editorAPI),i.init(this.editorAPI)},notifyPreviewReady:function(a){this.editorAPI.onPreviewReady(a),k.onPreviewReady(this.editorAPI),l.onPreviewReady(this.editorAPI),n.onPreviewReady(this.editorAPI),f.automationUtil.onPreviewReady(this.editorAPI),f.translate.init(this.editorAPI);var b=a.viewMode.get()===a.viewMode.VIEW_MODES.MOBILE;this.editorAPI.setEditorMode(b,null,!0),this.setState({editorIsInit:!0}),w&&(w=!1,O.call(this),f.newrelic.finished()),m.onPreviewReady(this.editorAPI),F(),u&&this.editorAPI.concurrentUsers.checkForConcurrentUsers(!0),f.performance.mark("editor ready"),f.performance.measure("editor ready","editor loaded","editor ready")},getPreviewSize:function(){var a=this.refs.preview.getDOMNode();return{width:a.clientWidth,height:a.clientHeight}},getPreviewSource:function(){return C=C||J(document.location)},componentWillMount:function(){this._resetEventListeners()},componentWillUnmount:function(){this._resetEventListeners()},componentDidMount:function(){this.updateKeyboardShortcutContext();var a=this.refs.preview.getDOMNode();try{a.contentWindow&&a.contentWindow.documentServices&&this.notifyPreviewReady(a.contentWindow.documentServices)}catch(b){console.error("can not access preview iframe")}window.addEventListener("message",this.previewMessageHandler);var c=f.url.getParameterByName("leavePagePopUp");"false"!==c&&(window.onbeforeunload=L),history&&(history.replaceState({preview:!1},"edit mode"),window.onpopstate=this.onHistoryPopState)},componentDidUpdate:function(a,b){if(!b.editorIsInit&&this.state.editorIsInit){var c=document.getElementById("video-preloader");c&&c.parentNode.removeChild(c)}b.previewMode!==this.state.previewMode&&(history.state&&this.state.previewMode&&!history.state.preview?this.onEnterPreview():history.state&&!this.state.previewMode&&history.state.preview&&this.onExitPreview(),this.updateKeyboardShortcutContext(),e(document.body).toggleClass("previewMode",this.state.previewMode))},onExitPreview:function(){history.replaceState({preview:!1},"edit mode")},onEnterPreview:function(){history.pushState({preview:!0},"site preview")},onHistoryPopState:function(a){if(a.state){var b=a.state.preview&&!this.state.previewMode,c=!a.state.preview&&this.state.previewMode;(b||c)&&this.editorAPI.togglePreview()}},updateKeyboardShortcutContext:function(){var a=f.keyboardShortcuts.CONTEXTS;f.keyboardShortcuts.setContext(this.state.previewMode?a.PREVIEW:a.EDITOR)},previewMessageHandler:function(a){if(0===this.getPreviewSource().indexOf(a.origin)&&"documentServicesLoaded"===a.data){var b=this.refs.preview.getDOMNode();this.notifyPreviewReady(b.contentWindow.documentServices)}},getCompPanel:function(){return a.find(this.state.openPanels,{frameType:"compPanelFrame"})},getNonCompPanels:function(){return a.reject(this.state.openPanels,{frameType:"compPanelFrame"})},registerMouseMoveAction:function(b,c,d){a.isFunction(b.start)&&b.start(this.editorAPI,c),d&&(e(window).on("mousemove",this.onMouseMove),e(window).on("mouseup",this.onMouseUp)),this.setState({registeredMouseMoveAction:b,isUsingWindowMouseEvents:!!d})},onMouseMove:function(c){b.utils.mouseScaleHandler.fitMouseCoordinatesToScale(this.editorAPI,c,this.state.siteScale);var d=!this.state.performingMouseMoveAction;d&&(f.keyboardShortcuts.disable(),this.setState({performingMouseMoveAction:!0,lastSelectionClickPos:null})),this.state.registeredMouseMoveAction&&a.isFunction(this.state.registeredMouseMoveAction.on)&&this.state.registeredMouseMoveAction.on(c)},onMouseUp:function(c){if(b.utils.mouseScaleHandler.fitMouseCoordinatesToScale(this.editorAPI,c,this.state.siteScale),e(window).off("mousemove",this.onMouseMove),e(window).off("mouseup",this.onMouseUp),this.state.registeredMouseMoveAction&&a.isFunction(this.state.registeredMouseMoveAction.end)&&this.state.registeredMouseMoveAction.end(c),f.keyboardShortcuts.enable(),p.isOpen("exp171")&&!t){var d={registeredMouseMoveAction:null,isUsingWindowMouseEvents:!1,performingMouseMoveAction:!1};a.isEqual(d,a.pick(this.state,a.keys(d)))||this.setState({registeredMouseMoveAction:null,isUsingWindowMouseEvents:!1,performingMouseMoveAction:!1})}else this.setState({registeredMouseMoveAction:null,isUsingWindowMouseEvents:!1,performingMouseMoveAction:!1})},onMouseDownCapture:function(a){2===a.button&&a.stopPropagation()},onContextMenu:function(a){M(a)||(a.preventDefault(),c.panelManager.closeAllPanels(),this.editorAPI.selection.selectComponentByClick(a),this.editorAPI.openRightClickMenu(a.clientX,a.clientY))},onContextMenuPreventDefault:function(a){M(a)||a.preventDefault()},onIdeClick:function(){c.panelManager.closeAllPanels()},getDocumentType:function(){return this.editorAPI.generalInfo&&this.editorAPI.generalInfo.getDocumentType()},getLanguages:function(){return this.editorAPI.theme&&this.editorAPI.theme.fonts&&this.editorAPI.theme.fonts.getCharacterSet()},getThemeFonts:function(){return this.editorAPI.theme.fonts&&this.editorAPI.theme.fonts.getAll()},getEditorBase:function(){return f.editorModel.editorBase},isPreloaderVisible:function(){var a=document.getElementById("video-preloader");return!a&&!this.state.editorIsInit},getFloatingBubbleTargetStyle:function(){if(!this.state.floatingBubble.targetLayout)return{display:"none"};var b=this.state.floatingBubble.targetLayout,c=a(b).pick(["width","height","top","left"]).assign({position:"fixed"}).value();return c},getFloatingBubbleTarget:function(){return this.isMounted()&&this.refs.floatingBubbleTarget?this.refs.floatingBubbleTarget.getDOMNode():null},getFloatingBubbleProps:function(){return this.state.floatingBubble.props||{}},onMouseLeaveFloatingBubbleTarget:function(){this.state.floatingBubble.shouldNotHideOnMouseLeaveTarget||this.editorAPI.hideFloatingBubble()},updateMousePosition:function(a,b,c){this.refs.editorStage&&this.refs.editorStage.updateMousePosition({x:b,y:c})},setSiteScale:function(a,b,c){var d=a;if(!s||r){var e=this.refs.editingArea.getDOMNode().clientHeight,f=e/this.state.editorConfig.previewHeight;d=D(E(f,a,1),2)}d!==this.state.siteScale&&this.setState({siteScale:d}),this.editorAPI.documentServices.site.setScrollAndScale(0,b,d,v),this.editorAPI.ui.scroll.animateScroll({x:0,y:b},v,c)},isPerformingMouseMoveAction:function(){return this.state.performingMouseMoveAction},getPreviewFrameLayout:function(){return this.refs.preview.getDOMNode().getBoundingClientRect()},getEditingAreaLayout:function(){return P(this.refs.editingArea.getDOMNode().getBoundingClientRect())},getScroll:function(){return this.refs.editorStage.getScroll()},setScroll:function(a){return this.refs.editorStage.setScroll(a)},setHoverBox:function(a,b){this.refs.editorStage.setHoverBox(a,b)},clearHoverBox:function(){this.refs.editorStage.clearHoverBox()},animateScroll:function(a,b,c){return this.refs.editorStage.animateScroll(a,b,c)},addScrollListener:function(a){this._scrollListeners.push(a)},removeScrollListener:function(b){this._scrollListeners=a.without(this._scrollListeners,b)},setFocus:function(){this.getDOMNode().focus()},shouldShowDevModePanels:function(){return!this.state.previewMode&&this.editorAPI.developerMode.isEnabled()},handleEditingAreaResize:function(){this.editorAPI.updateEditingAreaLayout(this.getEditingAreaLayout())},render:o})}),define("rEditor/rootComps/editorMain",["util","react","rEditor/rootComps/editor","experiment","lodash"],function(a,b,c,d,e){"use strict";function f(a){a.debugTools&&(window.testApi=e.assign({},window.testApi,{domSelectors:a.qaAutomation.getDomSelectors(a.react),helpers:a.debugTools.helpers})),a.qaAutomation&&a.qaAutomation.init(window),a.tpaIntegrationEditor&&a.tpaIntegrationEditor.init(window),a.wixckeditor&&a.wixckeditor.init(e)}function g(e){window.document.title=a.translate("EDITOR_BROWSER_TAB_NAME"),f(e),a.polyfills.register(),d.isOpen("qualaroo")&&a.qualaroo.start();var g=document.getElementById("root"),h=b.createElement(c);window.rendered=b.render(h,g)}return{start:g}}),define("rEditor/rootComps/panels/pagesPanelMixin",["react","core","lodash","baseUI","util","pagesMenu","blog","tpa"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,b){return f.specialPages.menuLogic.isSpecialPage(a,b)}function j(){return this.getEditorAPI().viewMode.get()===this.getEditorAPI().viewMode.VIEW_MODES.MOBILE}function k(){var a=this.getEditorAPI(),b=this.state.menuItemSectionNowOpened&&this.state.menuItemSectionNowOpened.pageData||f.specialPages.menuLogic.getSectionPageDataBySpecialPage(a,this.getCurrentPagePageData());b&&b.id&&a.pages.navigateTo(b.id),this.setState({menuItemToShowSettingsFor:null,isSubPagesMenuOpenedByButton:!1,menuItemSectionNowOpened:null})}return{mixins:[b.mixins.editorAPIMixin],getInitialState:function(){return{isSubPagesMenuOpenedByButton:null,menuItemSectionNowOpened:null,menuItemToShowSettingsFor:null}},isSubPagesMenuActive:function(a){return this.state.isSubPagesMenuOpenedByButton||i(this.getEditorAPI(),a)},closeSettingsPanel:function(a){this.setState({menuItemToShowSettingsFor:null}),this.getEditorAPI().bi.event(b.bi.events.topbar.pages.top_bar_PAGES_settings_close,{origin:a})},openSettingsPanel:function(a,b){this.setState({menuItemToShowSettingsFor:a},function(){b&&this.refs.pageSettingsPanel.setSettingsTab(b)}.bind(this))},openSubPagesMenu:function(a){this.setState({isSubPagesMenuOpenedByButton:!0,menuItemSectionNowOpened:a},function(){this.closeSettingsPanel.call(this,"openSpecialPages"),this.props.subpagesOpened&&this.props.subpagesOpened()}.bind(this));var c=b.utils.tpaTypeUtils.isTPA(a.pageData)?"tpa":"blog";this.getEditorAPI().bi.event(b.bi.events.topbar.pages.top_bar_PAGES_special_pages_icon_click,{type:c})},selectedMenuItemChanged:function(a){this.state.menuItemToShowSettingsFor&&this.setState({menuItemToShowSettingsFor:this.hasSettingsPanel(a)?a:null})},getMenuItemToShowSettingsFor:function(){return this.getEditorAPI().mainMenu.getExtendedMenuItemWithPageData(this.state.menuItemToShowSettingsFor.id)},hasSettingsPanel:function(a){return j.call(this)||a.type.isPage},closeSubPagesMenu:function(){k.call(this),this.getEditorAPI().bi.event(b.bi.events.topbar.pages.top_bar_PAGES_special_pages_back_click)},openBlogManager:function(){g.openBlogManagerFrame(this.getEditorAPI(),"allPosts")},openStoreManager:function(){h.superApps.openDashboardUrl(h.superApps.superAppsConstants.ECOM_APP_DEF_ID,"90%","100%"),this.getEditorAPI().bi.event(b.bi.events.topbar.pages.top_bar_PAGES_store_pages_store_manager_click)},getCurrentPagePageData:function(){var a=this.getEditorAPI(),b=a.pages.getCurrentPageId();return a.pages.data.get(b)},getCurrentTitle:function(a,c){var d=this.getEditorAPI();return a?b.utils.blogTypeUtils.isBlog(d,c)?"SiteApp_Blog_PagesPanel_Panel_PanelHeader":b.utils.wixStoreTypeUtils.isWixStore(d,c)?"SiteApp_WixStores_PagesPanel_Panel_PanelHeader":void 0:"Pages_Menu_Title_Title"}}}),define("rEditor/pagesMenu/pageNode/pageInfoTextHelper",["core"],function(a){"use strict";var b=a.utils.tpaTypeUtils,c=a.utils.blogTypeUtils,d=a.utils.wixStoreTypeUtils;return{getInfoTextForSpecialPage:function(a,e){if(c.isBlog(a,e))return"Pages_Blog_Post_Info_WhatisText";if(b.isTPA(e)){if(!d.isWixStore(a,e))return"TPA pages";if(d.isWixStoreProductPage(e))return"Pages_Store_Product_Info_WhatisText";if(d.isWixStoreCartPage(e))return"Pages_Store_Cart_Info_WhatisText";if(d.isWixStoreThankYouPage(e))return"Pages_Store_Thankyou_Info_WhatisText"}},getInfoTextForSectionPage:function(a,e){return c.isBlog(a,e)?"Pages_Menu_Blog_Tooltip":b.isTPA(e)?d.isWixStore(a,e)?"Pages_Store_Panel_Title":"TPA pages":void 0},getInfoTextForNonPage:function(a){return a.type.isLink?"Pages_Menu_Link_Tooltip":a.type.isDropdown?"Pages_Menu_Dropdown_Tooltip":void 0}}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell.rt",["react/addons","lodash","pagesMenu","baseUI","core","symbols","util","rEditor/pagesMenu/pageNode/pageInfoTextHelper"],function(a,b,c,d,e,f,g,h){"use strict";function i(){this.props.actions.openSettingsPanel(this.props.dataSource)}return function(){return a.createElement(c.nodeContentCommon,b.assign({},{isVisible:void 0===this.props.isVisible?this.props.dataSource.isVisibleMobile:this.props.isVisible},this.props),a.createElement("a",{href:"javascript://settings",className:"action-button action-settings",onClick:i.bind(this)},a.createElement(f.symbol,{name:"quickActionsSettings"})),"\n\n    ",this.props.children,"\n")}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell",["react","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell.rt"],function(a,b){"use strict";return a.createClass({displayName:"nodeContentMobileShell",render:b})}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileSimplePage.rt",["react/addons","lodash","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell"],function(a,b,c){"use strict";return function(){return a.createElement(c,this.props)}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileNotPage.rt",["react/addons","lodash","baseUI","symbols","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell","rEditor/pagesMenu/pageNode/pageInfoTextHelper"],function(a,b,c,d,e,f){"use strict";function g(){var b=f.getInfoTextForNonPage(this.props.dataSource);return a.createElement(e,this.getNotPageProps(),a.createElement("a",{href:"#",key:"action-button-info-subpage",className:"action-button"},a.createElement(c.infoIcon,{symbolName:"actionButtonInfo",text:b,ref:"infoIcon"})))}return function(){return g.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileSectionPage.rt",["react/addons","lodash","pagesMenu","baseUI","core","symbols","util","rEditor/pagesMenu/pageNode/pageInfoTextHelper","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){this.props.actions.openSubPagesMenu(this.props.dataSource)}function k(){var b=h.getInfoTextForSectionPage(this.getEditorAPI(),this.props.dataSource.pageData);return a.createElement(i,this.props,a.createElement("a",{className:"action-button action-button-special-pages-mobile",onClick:j.bind(this,b)},a.createElement(d.infoIcon,{symbolName:"actionButtonSpecialPages",propagate:!0,text:b})))}return function(){return k.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/common/nodeContentSubPage.rt",["react/addons","lodash","baseUI","rEditor/pagesMenu/pageNode/pageInfoTextHelper","pagesMenu","symbols"],function(a,b,c,d,e,f){"use strict";function g(a){this.props.actions.openSettingsPanel(this.props.dataSource)}function h(){var h=d.getInfoTextForSpecialPage(this.props.editorAPI,this.props.dataSource.pageData);return a.createElement(e.nodeContentCommon,b.assign({},{isVisible:!0},this.props),a.createElement("a",{href:"javascript://settings",className:"action-button action-settings",onClick:g.bind(this,h)},a.createElement(f.symbol,{name:"quickActionsSettings"})),a.createElement("a",{href:"#",className:"action-button"},a.createElement(c.infoIcon,{symbolName:"actionButtonInfo",text:h})))}return function(){return h.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon.rt",["react/addons","lodash","pagesMenu"],function(a,b,c){"use strict";return function(){return a.createElement(c.nodeContentCommon,b.assign({},{isVisible:void 0===this.props.isVisible?this.props.dataSource.isVisible:this.props.isVisible},this.props),"\n\n    ",this.props.children,"\n\n")}}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon",["react","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon.rt"],function(a,b){"use strict";return a.createClass({displayName:"nodeContentDesktopCommon",render:b})}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon.rt",["react/addons","lodash","baseUI","symbols","util","pagesMenu"],function(a,b,c,d,e,f){"use strict";function g(){var b=this.props.dataSource,g=e.translate,h=f.pageMenuItemHelpers,i=this.props.editorAPI;return a.createElement(c.dropDown.contextMenu,{shouldTranslate:!1,icon:"moreRegular",className:"quick-actions action-button",shrink:this.props.shrink,onClick:this.props.setSelected,onNotificationClick:this.props.onNotificationClick,notificationCount:this.props.notificationCount,onChange:this.actionSelectedHandler},"\n\n    ",this.props.children,"\n\n    ",a.createElement(c.dropDown.option,{value:"rename"},a.createElement(d.symbol,{name:"quickActionsRename"}),a.createElement("span",{className:"qa-label"},g("Pages_Actions_Page_Rename"))),h.canDuplicate(i,b)?a.createElement(c.dropDown.option,{key:"quick-actions-duplicate",value:"duplicate"},a.createElement(d.symbol,{name:"qaDuplicate"}),a.createElement("span",{className:"qa-label"},g("Pages_Actions_Page_Duplicate"))):null,h.canUnhide(i,b)?a.createElement(c.dropDown.option,{key:"quick-actions-unhide",value:"unhide"},a.createElement(d.symbol,{name:"quickActionsShow"}),a.createElement("span",{className:"qa-label"},g("Pages_Actions_Page_Unhide"))):null,h.canHide(i,b)?a.createElement(c.dropDown.option,{key:"quick-actions-hide",value:"hide"},a.createElement(d.symbol,{name:"quickActionsHide"}),a.createElement("span",{className:"qa-label"},g("Pages_Actions_Page_Hide"))):null,h.canSubpage(b)?a.createElement(c.dropDown.option,{key:"quick-actions-subpage",value:"subpage"},a.createElement(d.symbol,{name:"quickActionsSubpage"}),a.createElement("span",{className:"qa-label"},g("Pages_Actions_Page_Subpage"))):null,h.canMoveUp(b)?a.createElement(c.dropDown.option,{key:"quick-actions-moveup",value:"moveup"},a.createElement(d.symbol,{name:"quickActionsMainPage"}),a.createElement("span",{className:"qa-label"},g("Pages_Actions_Page_MoveUp"))):null,h.canRemoveMenuItem(i,b)?a.createElement(c.dropDown.option,{key:"quick-actions-remove",value:"remove"},a.createElement(d.symbol,{name:"qaDelete"}),a.createElement("span",{className:"qa-label"},g("Pages_Actions_Page_Delete"))):null)}return function(){return g.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon",["react","pagesMenu","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"quickActionsMenuCommon",mixins:[b.mixins.quickActionRenameMixin],propTypes:{dataSource:a.PropTypes.object.isRequired,editorAPI:a.PropTypes.object.isRequired,editedPageIdLink:a.PropTypes.object.isRequired,onActionSelected:a.PropTypes.func.isRequired},render:c})}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage.rt",["react/addons","lodash","baseUI","symbols","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon","experiment!pageSettingsTabs","util"],function(a,b,c,d,e,f,g){"use strict";function h(){var h=g.translate;return a.createElement(e,b.assign({},{onNotificationClick:this.getOnNotificationClick(),notificationCount:1},this.props),f?a.createElement(c.dropDown.option,{key:"quick-action-tab-page-info",value:"tabPageInfo",className:"primary psp-qa"},a.createElement(d.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),a.createElement("span",{className:"qa-label"},h("Pages_Actions_Page_Info"))):null,f?a.createElement(c.dropDown.option,{key:"quick-action-tab-layout",value:"tabLayout",className:"primary psp-qa"},a.createElement(d.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),a.createElement("span",{className:"qa-label"},h("Pages_Actions_Page_Layouts"))):null,f?a.createElement(c.dropDown.option,{key:"quick-action-tab-permissions",value:"tabPermissions",className:"primary psp-qa"},a.createElement(d.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),a.createElement("span",{className:"qa-label"},h("Pages_Actions_Page_Permissions"))):null,f?a.createElement(c.dropDown.option,{key:"quick-action-tab-seo",value:"tabSEO",className:"primary psp-qa"},a.createElement(d.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),a.createElement("span",{className:"qa-label"},h("Pages_Actions_Page_SEO"))):null,f?a.createElement(c.dropDown.option,{key:"quick-action-separator",className:"separator"},a.createElement("hr",{className:"divider-long"})):null,f?null:a.createElement(c.dropDown.option,{key:"quick-action-settings",value:"settings",className:"primary"},a.createElement(d.symbol,{name:"quickActionsSettings",style:{position:"relative",top:"4px",left:"-1px"}}),a.createElement("span",{className:"qa-label"},h("Pages_Actions_Page_Settings"))))}return function(){return h.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage",["react","pagesMenu","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"quickActionsMenuPage",getOnNotificationClick:function(){var a=this.props.actions.openSettingsPanel,c=this.props.dataSource;return b.utils.quickActions.hasNotification(this.props.editorAPI,this.props.dataSource.pageData.id)?function(){a(c,"page")}:void 0},render:c})}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopSimplePage.rt",["react/addons","lodash","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage"],function(a,b,c,d){"use strict";return function(){return a.createElement(c,this.props,a.createElement(d,this.props))}}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopSectionPage.rt",["react/addons","lodash","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage","rEditor/pagesMenu/pageNode/pageInfoTextHelper","baseUI"],function(a,b,c,d,e,f){"use strict";function g(a,b){this.props.actions.openSubPagesMenu(a)}function h(){var b=this.props.dataSource,h=e.getInfoTextForSectionPage(this.getEditorAPI(),this.props.dataSource.pageData);return a.createElement(c,this.props,a.createElement(d,this.props),a.createElement("a",{href:"#",className:"action-button",onClick:g.bind(this,b,h)},a.createElement(f.infoIcon,{symbolName:"actionButtonSpecialPages",propagate:!0,text:h})))}return function(){return h.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuNotPage.rt",["react/addons","lodash","baseUI","symbols","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon","rEditor/pagesMenu/pageNode/pageInfoTextHelper","util"],function(a,b,c,d,e,f,g){"use strict";function h(){var b=this.props.dataSource,f=g.translate;return a.createElement(e,this.props,b.type.isLink?a.createElement(c.dropDown.option,{key:"quick-actions-rename-link",value:"changeLink"},a.createElement(d.symbol,{name:"quickActionsLink"}),a.createElement("span",{className:"qa-label"},f("Pages_Actions_Link_Change"))):null)}return function(){return h.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuNotPage",["react","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuNotPage.rt"],function(a,b){"use strict";return a.createClass({displayName:"quickActionsMenuNotPage",render:b})}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopNotPage.rt",["react/addons","lodash","baseUI","rEditor/pagesMenu/pageNode/pageInfoTextHelper","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuNotPage"],function(a,b,c,d,e,f){"use strict";function g(){var b=d.getInfoTextForNonPage(this.props.dataSource);return a.createElement(e,this.getNotPageProps(),a.createElement(f,this.props),a.createElement("a",{href:"#",key:"action-button-info-subpage",className:"action-button"},a.createElement(c.infoIcon,{symbolName:"actionButtonInfo",text:b,ref:"infoIcon"})))}return function(){return g.apply(this,[])}}),define("rEditor/pagesMenu/pageNodeRenderers",["rEditor/pagesMenu/pageNode/mobile/nodeContentMobileSimplePage.rt","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileNotPage.rt","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileSectionPage.rt","rEditor/pagesMenu/pageNode/common/nodeContentSubPage.rt","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopSimplePage.rt","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopSectionPage.rt","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopNotPage.rt"],function(a,b,c,d,e,f,g){"use strict";function h(d,e){return d.type.isPage?e?c:a:d.type.isLink||d.type.isDropdown?b:void 0}function i(a,b){return a.type.isPage?b?f:e:a.type.isLink||a.type.isDropdown?g:void 0}return{mobile:{mainMenu:h},desktop:{mainMenu:i},common:{subPages:function(){return d}}}}),define("rEditor/pagesMenu/pageNode/common/nodeContentSubPage",["react","rEditor/pagesMenu/pageNodeRenderers"],function(a,b){"use strict";return a.createClass({displayName:"nodeContentMobileSubPage",render:function(){return b.common.subPages(this.props.dataSource).call(this)}})}),define("rEditor/pagesMenu/subPages/subPages.rt",["react/addons","lodash","baseUI","core","symbols","util","rEditor/pagesMenu/pageNode/common/nodeContentSubPage"],function(a,b,c,d,e,f,g){"use strict";function h(a){a.preventDefault(),this.props.closeSubPagesMenu()}return function(){return a.createElement("div",{className:"pages-tree-container pages-menu"},a.createElement("div",{className:"pages-tree-controls"},a.createElement("a",{href:"#",className:"panel-header-close",onClick:h.bind(this)},a.createElement("button",{className:"button-control back-to-pages"},a.createElement(e.symbol,{name:"arrowLeft"})),a.createElement("span",{},f.translate("pages_blog_panel_back")))),d.utils.blogTypeUtils.isBlog(this.getEditorAPI(),this._curPageData)?a.createElement(c.firstTimeInfoBox,{key:"subpages-firsttime-for-blog",id:"blog-pages-menu",icon:"firstTimeBlogPages",title:"Pages_Blog_Firsttime_Title",text:"Pages_Blog_Firsttime_Text",hide:!1,userPrefs:this.props.userPrefs,biLearnMore:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}):null,d.utils.tpaTypeUtils.isTPA(this._curPageData)?a.createElement(c.firstTimeInfoBox,{key:"subpages-firsttime-for-tpa",id:"store-pages-menu",icon:"firstTimeStorePages",title:"Pages_Store_Firsttime_Title",text:"Pages_Store_Firsttime_Text",hide:!1,userPrefs:this.props.userPrefs,biLearnMore:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}):null,a.createElement(c.customScroll,{},a.createElement(c.treeView,{className:"pages-tree ",dataSource:this._pagesList,nodeContent:g,equalityComparer:this.equalityComparer,editorAPI:this.getEditorAPI(),actions:{openSettingsPanel:this.props.openSettingsPanel,closeSettingsPanel:this.props.closeSettingsPanel},valueLink:this.linkPage(this._curPageData.id),isRoot:!0})))}}),define("rEditor/pagesMenu/subPages/subPages",["react","lodash","core","rEditor/utils/menuItemsRepository","pagesMenu","rEditor/pagesMenu/subPages/subPages.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"subPages",mixins:[a.addons.LinkedStateMixin,c.mixins.editorAPIMixin],propTypes:{userPrefs:a.PropTypes.object,sectionMenuItem:a.PropTypes.object,openSettingsPanel:a.PropTypes.func.isRequired,closeSubPagesMenu:a.PropTypes.func.isRequired,selectedMenuItemChanged:a.PropTypes.func.isRequired},linkPage:function(a){return{value:a,requestChange:function(a){this.props.selectedMenuItemChanged(a),a&&a.pageData&&this.getEditorAPI().pages.navigateTo(a.pageData.id)}.bind(this)}},getCurrentPagePageData:function(){var a=this.getEditorAPI();return a.pages.data.get(a.pages.getCurrentPageId())},equalityComparer:function(a,b){return a.pageData&&a.pageData.id===b},render:function(){var b,a=this.getEditorAPI();return this._curPageData=this.getCurrentPagePageData(),b=e.specialPages.menuLogic.getSpecialPagesListBySectionPageOrBySibling(a,this.props.sectionMenuItem&&this.props.sectionMenuItem.pageData||this._curPageData),this._pagesList=a.mainMenu.convertPagesDataListToMenuItemsList(b),f.call(this)}})}),define("rEditor/pagesMenu/mainMenuTreeState",["lodash"],function(a){"use strict";function c(a,c){b[a]=Boolean(c)}function d(a,c){return b.hasOwnProperty(a)?b[a]:c||!1}function e(b){a.forEach(b,function(a){a.isCollapsed=d(a.id),a.items.length>0?e(a.items):a.isCollapsed&&(a.isCollapsed=!1,c(a.id,!1))})}function f(a,b){return a.isCollapsed=d(a.id,b),a.items.length<=0&&a.isCollapsed&&(a.isCollapsed=!1,c(a.id,!1)),a}var b={};return{setMenuItemCollapsed:c,reflectStateToMenuTree:e,reflectStateToMenuItem:f}}),define("rEditor/utils/newPagesData",[],function(){"use strict";return{createBlankPageData:function(a){return{componentType:"mobile.core.components.Page",type:"Page",id:"mainPage",styleId:"p2",skin:"skins.core.InlineSkin",layout:{x:0,y:0,width:980,height:500,anchors:[]},data:{type:"Page",metaData:{isPreset:!1,schemaVersion:1,isHidden:!1},title:"Blank",hideTitle:!0,icon:"",descriptionSEO:"",metaKeywordsSEO:"",pageTitleSEO:"",pageUriSEO:"blank",hidePage:!1,underConstruction:!1,pageBackgrounds:a.pages.data.get(a.pages.getCurrentPageId()).pageBackgrounds},components:[]}}}}),define("rEditor/pagesMenu/addPageMenuPanel/addPageMenuPanel.rt",["react/addons","lodash","symbols","baseUI","util"],function(a,b,c,d,e){"use strict";function f(){var b=e.translate;return a.createElement("ul",{className:"tooltip-pages-add-menu"},a.createElement("li",{},a.createElement("div",{onClick:this.props.addPage},a.createElement("span",{className:"icon"},a.createElement(c.symbol,{name:"addPagePanelPage"})),a.createElement("div",{},a.createElement("span",{className:"title"
},b("Pages_Menu_Add_Page_Title")),a.createElement("span",{className:"description"},b("Pages_Menu_Add_Page_Text")))),a.createElement("li",{},a.createElement("div",{onClick:this.props.addLink},a.createElement("span",{className:"icon"},a.createElement(c.symbol,{name:"addPagePanelLink"})),a.createElement("div",{},a.createElement("span",{className:"title"},"\n                    ",b("Pages_Menu_Add_Link_Title"),"\n                    ",a.createElement(d.tooltip,{value:"Pages_Menu_Add_Link_Tooltip",width:"228",alignment:d.uiConstants.TOOLTIP.ALIGNMENT.TOP},a.createElement("div",{className:"title-help-icon"},a.createElement(c.symbol,{name:"infoSmall"})))),a.createElement("span",{className:"description"},b("Pages_Menu_Add_Link_Text"))))),a.createElement("li",{},a.createElement("div",{onClick:this.props.addDropdown},a.createElement("span",{className:"icon"},a.createElement(c.symbol,{name:"addPagePanelDropDown"})),a.createElement("div",{},a.createElement("span",{className:"title"},"\n                    ",b("Pages_Menu_Add_Dropdown_Title"),"\n                    ",a.createElement(d.tooltip,{value:this.getTooltipValue(),width:"240px",alignment:d.uiConstants.TOOLTIP.ALIGNMENT.TOP},a.createElement("div",{className:"title-help-icon"},a.createElement(c.symbol,{name:"infoSmall"})))),a.createElement("span",{className:"description"},b("Pages_Menu_Add_Dropdown_Text")))))))}return function(){return f.apply(this,[])}}),define("rEditor/pagesMenu/addPageMenuPanel/addPageMenuPanel",["react","lodash","baseUI","rEditor/pagesMenu/addPageMenuPanel/addPageMenuPanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"addPageMenuPanel",mixins:[],propTypes:{addPage:a.PropTypes.func,addLink:a.PropTypes.func,addDropdown:a.PropTypes.func},getTooltipValue:function(){return{classPath:"baseUI.popoverTemplates.imageAndTextTooltip",props:{image:"addDropDownHint",imageContainerStyle:{backgroundColor:"#17a8a4"},text:"Pages_Menu_Add_Dropdown_Tooltip"}}},render:d})}),define("rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsUtils",["util"],function(a){"use strict";var b={none:"Pages_Menu_Transitions_None",swipeHorizontalFullScreen:"Pages_Menu_Transitions_SwipeH_Selected",swipeVerticalFullScreen:"Pages_Menu_Transitions_SwipeV_Popup",crossfade:"Pages_Menu_Transitions_CrossFade",outIn:"Pages_Menu_Transitions_OutIn"},c={outIn:"outIn",crossfade:"crossfade",shrinkfade:"crossfade",swipeHorizontal:"swipeHorizontalFullScreen",swipeHorizontalFullScreen:"swipeHorizontalFullScreen",swipeVertical:"swipeVerticalFullScreen",swipeVerticalFullScreen:"swipeVerticalFullScreen",none:"none"};return{calcNewIdFromLegacy:function(a){return c[a]?c[a]:c.none},getTransitionLabelKey:function(a){var c=this.calcNewIdFromLegacy(a);return b[c]},getTransitionLabelTranslated:function(b){return a.translate(this.getTransitionLabelKey(b))}}}),define("rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsPanel.rt",["react/addons","lodash","baseUI","core","symbols","util","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsUtils"],function(a,b,c,d,e,f,g){"use strict";return function(){return a.createElement("section",{className:"page-transitions",tabIndex:"0"},a.createElement("header",{className:"panel-header dark"},a.createElement("h1",{},f.translate("Pages_Menu_Transitions_Title")),a.createElement("div",{className:"buttons"},a.createElement("button",{className:"help",onClick:this.helpClicked},"?"),a.createElement("button",{className:"close",onClick:this.close},a.createElement(e.symbol,{name:"headerCloseButton"})))),a.createElement("div",{className:"content"},a.createElement(c.firstTimeInfoBox,{id:"page-transitions-panel",icon:"pageTransitions",title:"Pages_Menu_Transitions_FirstTime_Title",text:"Pages_Menu_Transitions_FirstTime_Text",hide:!0,userPrefs:this.props.userPrefs,biLearnMore:this.props.biEvent.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.props.biEvent.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}),a.createElement(c.thumbnails,{className:"with-labels",maxThumbsPerRow:"3",options:this.props.transitionsToShow,value:g.calcNewIdFromLegacy(this.getEditorAPI().pages.transitions.get()),onChange:this.onTransitionChange})),a.createElement("i",{className:"triangle"}))}}),define("rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsPanel",["react","lodash","panels","baseUI","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsPanel.rt","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsUtils","core","util"],function(a,b,c,d,e,f,g,h){"use strict";var i=d.tooltipManager,j=[{id:"none",symbolName:"transition-none"},{id:"swipeHorizontalFullScreen",symbolName:"transition-pages-horizontal"},{id:"swipeVerticalFullScreen",symbolName:"transition-pages-vertical"},{id:"crossfade",symbolName:"transition-pages-crossfade"},{id:"outIn",symbolName:"transition-pages-inout"}];return a.createClass({displayName:"pageTransitionsPanel",mixins:[g.mixins.editorAPIMixin,h.outerClickMixin],render:e,propTypes:{onClose:a.PropTypes.func},getDefaultProps:function(){return{transitionsToShow:b.map(j,function(a){return{value:a.id,label:f.getTransitionLabelKey(a.id),symbolName:a.symbolName}})}},componentDidMount:function(){this.getDOMNode().focus()},onTransitionChange:function(a){this.getEditorAPI().pages.transitions.set(a),this.getEditorAPI().bi.event(g.bi.events.topbar.pages.top_bar_PAGES_page_transition_selected_click,{category:a}),this.performAnimationSimulation()},flattenMenuData:function(a){var c=[];return b.forEach(a.mainMenu.getMenu(),function(a){c.push(a),c=c.concat(a.items||[])}),c},performAnimationSimulation:function(){var a=this.getEditorAPI(),c=a.pages.getCurrentPage().id,d=b.filter(this.flattenMenuData(a),function(a){return a.link?"PageLink"===a.link.type:!1}),e=b.pluck(b.pluck(d,"link"),"pageId"),f=e.indexOf("#"+c),g=f+1;f===e.length-1&&(g=0),g!==f&&a.pages.navigateTo(e[g].slice(1))},helpClicked:function(){var a={panel_name:this.props.id,origin:g.constants.BI.HELP.ORIGIN.PAGES,learn_more:!1};c.panelManager.openHelpCenter("dfc95824-954a-4d20-aad2-7971d3fbdb98",null,null,a),i.hide(this.props.id)},close:function(){this.props.onClose&&this.props.onClose(),i.hide(this.props.id)},onOuterClick:function(){this.close()}})}),define("rEditor/pagesMenu/mainMenuPages/mainMenuPageMixin",["react","lodash","core","pagesMenu","rEditor/pagesMenu/mainMenuTreeState","rEditor/utils/menuItemsRepository","experiment!pagesPanelOpenCollapsed"],function(a,b,c,d,e,f,g){"use strict";function j(a){return b.reduce(a||[],function(a,b){return b.isCollapsed||(a+=j(b.items)),a+1},0)}function k(a,b){return b?f.filterItems(a,b):a}function l(a,c){return c.type.isPage&&b.includes(a,b.get(c.pageData,"id"))}function m(a,c){return b.forEach(a,function(a,b){a.items&&a.items.length&&(a.items=m(a.items,c));for(var d=0;d<c.length;d+=1)a=c[d](a,b)}),a}function n(a,b){return a.position=b,a}var h=40,i=17;return{mixins:[c.mixins.editorAPIMixin],propTypes:{filter:a.PropTypes.any,selectedMenuItemChanged:a.PropTypes.func.isRequired},getInitialState:function(){return{selectedItemInfo:{isPage:!0,pageId:this.getEditorAPI().pages.getCurrentPageId(),menuItemId:null}}},componentWillReceiveProps:function(){var a=this.getEditorAPI().pages.getCurrentPageId();this.state.selectedItemInfo.isPage&&this.state.selectedItemInfo.pageId!==a&&this.setState({selectedItemInfo:{isPage:!0,pageId:a,menuItemId:null}})},onPageToggled:function(a,b){var c=a.props.dataSource.id;e.setMenuItemCollapsed(c,b),this.forceUpdate()},linkPage:function(){return{value:this.state.selectedItemInfo,requestChange:function(a){this.setState({selectedItemInfo:{isPage:a.type.isPage,menuItemId:a.id,pageId:a.type.isPage?b.get(a.pageData,"id"):null}}),this.props.selectedMenuItemChanged(a),a.type.isPage?this.navigateToPageById(b.get(a.pageData,"id")):a.type.isLink&&"AnchorLink"===a.type.raw&&this.scrollToAnchor(a.link)}.bind(this)}},closePanel:function(){this.props.onClose()},navigateToPageById:function(a,b){var d=this.getEditorAPI(),e=d.pages.getCurrentPageId();(e!==a||b)&&(d.pages.navigateToAndScroll(a,b,d.applyPreviewScrollToEditorScroll),this.getEditorAPI().bi.event(c.bi.events.topbar.pages.top_bar_PAGES_navigate_to_page,{page_id:a}))},scrollToAnchor:function(a){var b=a.pageId&&a.pageId.replace("#","");this.navigateToPageById(b,a.anchorDataId)},shouldShrinkMenu:function(){return j(this._menuTree)>i},equalityComparer:function(a,b){return b.isPage&&a.pageData&&a.pageData.id===b.pageId||b.menuItemId===a.id},getTreeDockerScrollTop:function(){return this.refs.pagesTree.getScrollTop()},renderTemplate:function(a){var j,c=this.getEditorAPI(),f=c.pages.getPagesData(),i=c.mainMenu.getMenuItemsTreeForMainMenu(f),o=g?f.length>h:!1;i=m(i,[function(a){return e.reflectStateToMenuItem(a,o)},n]),j=k(i,this.props.filter);var p=d.specialPages.menuLogic.getSectionPagesIds(c,f);return this._menuTree=j,this._isSectionPage=b.partial(l,p),a.call(this)}}}),define("rEditor/pagesMenu/pagesTree/pagesTree.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement(c.customScroll,{ref:"customScroll"},a.createElement(c.treeView,b.assign({},{className:this.getTreeViewClasses(),dataSource:this.props.pagesList,collapsedSelector:"isCollapsed",editorAPI:this.getEditorAPI(),isRoot:!0},this.filteredProps())))}}),define("rEditor/pagesMenu/pagesTree/pagesTree",["lodash","react","core","rEditor/pagesMenu/pagesTree/pagesTree.rt"],function(a,b,c,d){"use strict";return b.createClass({displayName:"pagesTree",mixins:[c.mixins.editorAPIMixin],propTypes:{pagesList:b.PropTypes.any.isRequired},filteredProps:function(){return a.omit(this.props,["pagesList","dataSource","className","nodeTemplate","collapsedSelector","editorAPI","valueProperty"])},getScrollTop:function(){return this.refs.customScroll.getScrollTop()},scrollToSelectedNode:function(){this._scrollToSelectedNode=!0},componentDidUpdate:function(){var a,b,c,d,e=NaN;this._scrollToSelectedNode&&(this._scrollToSelectedNode=!1,a=this.getDOMNode(),b=a.querySelector(".pages-tree-item.selected"),b&&(c=a.getBoundingClientRect(),d=b.getBoundingClientRect(),d.top<c.top?e=this.getScrollTop()+(d.top-c.top):d.bottom>c.bottom&&(e=this.getScrollTop()+(d.bottom-c.bottom)),isNaN(e)||this.refs.customScroll.updateScrollPosition(Math.max(0,e))))},getTreeViewClasses:function(){return"pages-tree "},render:d})}),define("rEditor/pagesMenu/pageNode/common/nodeContentNotPageMixin",["lodash"],function(a){"use strict";return{showTooltip:function(){this.refs.infoIcon&&this.refs.infoIcon.showTooltip()},hideTooltip:function(){this.refs.infoIcon&&this.refs.infoIcon.hideTooltip()},getNotPageProps:function(){return a.assign({},this.props,{onClick:this.showTooltip,onMouseLeave:this.hideTooltip})}}}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopMainMenu",["react","core","rEditor/pagesMenu/pageNode/common/nodeContentNotPageMixin","rEditor/pagesMenu/pageNodeRenderers"],function(a,b,c,d){"use strict";return a.createClass({displayName:"nodeContentDesktopMainMenu",mixins:[b.mixins.editorAPIMixin,c],render:function(){var a=this.props.dataSource;return d.desktop.mainMenu(a,this.props.isSectionPage(a)).call(this)}})}),define("rEditor/pagesMenu/mainMenuPages/mainMenuPagesDesktop.rt",["react/addons","lodash","baseUI","core","symbols","util","rEditor/pagesMenu/pageNode/common/nodeContentSubPage","rEditor/pagesMenu/pagesTree/pagesTree","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsUtils","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopMainMenu"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(a,b,c){this.movePage(c,this._menuTree)}function l(){var d=this.getEditorAPI(),g=f.translate;return a.createElement("div",{className:b.keys(b.pick({"pages-menu":!0,"pages-panel-settings-opened":!!this.state.menuItemIdToShowSettingsFor},b.identity)).join(" ")},a.createElement("div",{className:b.keys(b.pick({"pages-tree-container":!0,"disable-drag":this.hasEditedPages()},b.identity)).join(" ")},this._menuTree.length>0?a.createElement(c.treeDocker,{className:b.keys(b.pick({"pages-tree-docker":!0,"pages-tree-shrinked":this.shouldShrinkMenu()},b.identity)).join(" "),key:"pages-tree-docker",onNodeMoved:k.bind(this,d,g),treeClass:"pages-tree",",":!0,treeNodeClass:"pages-tree-node",treeNodeLabelClass:"pages-tree-item",draggedClass:"rotated",previewClass:"shadow",cantBeChildClass:"cant-be-child",isDragAvailable:!this.hasEditedPages(),scrollTopGetter:this.getTreeDockerScrollTop,collapsedClass:"tree-collapsed"},a.createElement(h,{ref:"pagesTree",nodeContent:j,pagesList:this._menuTree,equalityComparer:this.equalityComparer,onNodeToggled:this.onPageToggled,isSectionPage:this._isSectionPage,actions:{openSettingsPanel:this.props.openSettingsPanel,openSubPagesMenu:this.props.openSubPagesMenu},onActionSelected:this.onActionSelected,editedPageIdLink:this.props.editedMenuItemIdLink,valueLink:this.linkPage(),shrink:this.shouldShrinkMenu()})):null,0===this._menuTree.length?a.createElement("div",{key:"noPagesFoundSymbolContainer",className:"no-pages"},a.createElement(e.symbol,{name:"noPagesFound"}),a.createElement("div",{},g("Pages_Menu_Empty_Title")),a.createElement("div",{},g("Pages_Menu_Empty_Text"))):null),a.createElement("footer",{},a.createElement(c.tooltip,{value:this.getAddPageMenu(),alignment:"right",width:"296",marginsFromWindow:"75",openTriggers:[c.uiConstants.TOOLTIP.TRIGGERS.CLICK],closeTriggers:[c.uiConstants.TOOLTIP.TRIGGERS.OUTER_CLICK],onClose:this.onAddPageMenuClose,id:"addPageMenuPopoverId",className:"popover-add-page-menu"},a.createElement(c.button,{label:"Pages_Menu_Add_Button",icon:"addPage",onClick:this.reportClick("add")})),a.createElement(c.tooltip,{value:this.getPageTransitionsPanel(),alignment:"right",width:"296",marginsFromWindow:"0",openTriggers:[c.uiConstants.TOOLTIP.TRIGGERS.CLICK],closeTriggers:[c.uiConstants.TOOLTIP.TRIGGERS.OUTER_CLICK],id:this.getPageTransitionsPanelId()},a.createElement("div",{className:"page-transition",onClick:this.reportClick("transition")},a.createElement("div",{className:"icon"},a.createElement(e.symbol,{name:"truck"})),a.createElement("div",{},a.createElement("span",{},g("Pages_Menu_Transitions_Caption")),a.createElement(c.button,{className:"btn-text",label:i.getTransitionLabelKey(d.pages.transitions.get())}))))))}return function(){return l.apply(this,[])}}),define("rEditor/pagesMenu/mainMenuPages/mainMenuPagesDesktop",["react","core","lodash","baseUI","util","pagesMenu","panels","rEditor/pagesMenu/mainMenuTreeState","rEditor/utils/newPagesData","rEditor/pagesMenu/addPageMenuPanel/addPageMenuPanel","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsPanel","rEditor/pagesMenu/mainMenuPages/mainMenuPageMixin","rEditor/pagesMenu/mainMenuPages/mainMenuPagesDesktop.rt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function r(a,b,c,d){var e=a.viewMode.get();e===a.viewMode.VIEW_MODES.DESKTOP&&n.setHidden(a,b,d),e===a.viewMode.VIEW_MODES.MOBILE&&n.setHidden(a,b,void 0,d)}function t(a,b,d){a.openLinkPanel({visibleSections:{NoLink:!1},hidePageLinks:!0,link:d,pageTabTitle:"LINK_PANEL_TAB_ANCHOR",pageTabPageDropDownTitle:"LINK_PANEL_PAGE_DROP_DOWN_PAGELINK_LABEL",title:"What do you want to link to?",callback:c.once(b)})}var n=f.pageMenuItemHelpers,o="Pages_Menu_Add_New_Page",p="Pages_Menu_Add_New_Link",q="Pages_Menu_Add_New_Category",s={settings:function(a,b,c){this.props.openSettingsPanel(b,c)},rename:function(a,b,c){b.pageData?n.renamePage(a,b.pageData,c):n.renameMenuItem(a,b,c)},duplicate:function(a,b){n.duplicateMenuItem(a,b,function(a){this.props.closeSettingsPanel(),this.renameMenuItemById(a)}.bind(this))},unhide:c.partialRight(r,!1),hide:c.partialRight(r,!0),subpage:n.subpage,moveup:n.moveUp,remove:function(a,b){this.props.closeSettingsPanel(),n.removeMenuItem(a,b)},changeLink:function(a,b){var d=function(d){var e=a.data.createItem(d.type);c.assign(e,c.omit(d,["type"])),n.updateLink(a,b.id,e)};t(a,d,a.data.getById(b.id).link)}};return a.createClass({displayName:"mainMenuPagesDesktop",mixins:[l],propTypes:{pageAdded:a.PropTypes.func},biData:{page:{category:"page"},link:{category:"link"},dropdown:{category:"dropdown menu"}},getInitialState:function(){return{isPageTransitionPanelOpened:!1,isSubPagesMenuOpenedByButton:null}},movePage:function(a,c){var d={items:c},e=a.from.findIn(d,"items"),f=e.id,g=a.to.parent().findIn(d,"items").id||null,i=a.to.findIn(d,"items"),j=i?i.position:a.to.atRight(),k=this.getEditorAPI();f&&(g&&h.setMenuItemCollapsed(g,!1),k.mainMenu.moveItem(f,g,j),k.history.add("moving a page"),k.waitForChangesApplied(function(a){g&&this.refs.pagesTree.scrollToSelectedNode(),this.refs.pagesTree.props.valueLink.requestChange(a)}.bind(this,e)),k.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_menu_drag),g&&1===a.from.length()?k.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_menu_sub_page_created,{category:"drag"}):!g&&a.from.length()>1&&k.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_menu_user_reverted_to_main_page,{category:"drag"}))},onActionSelected:function(a,c,d){switch(a){case"tabPageInfo":a="settings",d="page";break;case"tabLayout":a="settings",d="layout";break;case"tabPermissions":a="settings",d="privacy";break;case"tabSEO":a="settings",d="seo"}s[a]&&s[a].call(this,this.getEditorAPI(),c,d),this.getEditorAPI().bi.event(b.bi.events.topbar.pages.top_bar_PAGES_quick_actions_menu_select_click,{category:a})},closePageTransitionsPanel:function(){this.setState({isPageTransitionPanelOpened:!1})},_onAddPageMenuCloseHandler:c.noop,onAddPageMenuClose:function(){this._onAddPageMenuCloseHandler(this.props.pageAdded||c.noop),this._onAddPageMenuCloseHandler=c.noop},addPage:function(a){var c=this.getEditorAPI(),d=i.createBlankPageData(c),g=e.translate(o);d.data.pageUriSEO=f.utils.convertPageNameToUrl(g),n.addPage(c,g,d,this.state.selectedItemInfo.menuItemId||c.mainMenu.getMenuItemIdForCurrentPage(),function(b,c){this.renameMenuItemById(c),this.setState({selectedItemInfo:{isPage:!0,pageId:b,menuItemId:c}},a)}.bind(this)),c.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_Add_pages_expand_menu_selection_click,this.biData.page)},addLink:function(a){var d=this.getEditorAPI(),f=function(b){var f=d.data.createItem(b.type);c.assign(f,c.omit(b,["type"])),n.addLink(d,f,e.translate(p),this.state.selectedItemInfo.menuItemId||d.mainMenu.getMenuItemIdForCurrentPage(),function(b){this.renameMenuItemById(b),this.setState({selectedItemInfo:{isPage:!1,menuItemId:b,pageId:null}},a)}.bind(this))}.bind(this);t(d,f),d.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_Add_pages_expand_menu_selection_click,this.biData.link)},addDropdown:function(a){var c=this.getEditorAPI();n.addDropdown(c,e.translate(q),this.state.selectedItemInfo.menuItemId||c.mainMenu.getMenuItemIdForCurrentPage(),function(b){this.renameMenuItemById(b),this.setState({selectedItemInfo:{isPage:!1,menuItemId:b,pageId:null}},a)}.bind(this)),c.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_Add_pages_expand_menu_selection_click,this.biData.dropdown)},_setAddPageHandlerAndHideTooltip:function(){this._onAddPageMenuCloseHandler=this.addPage,d.tooltipManager.hide("addPageMenuPopoverId",!0)},_setAddLinkHandlerAndHideTooltip:function(){this._onAddPageMenuCloseHandler=this.addLink,d.tooltipManager.hide("addPageMenuPopoverId",!0)},_setAddDropdownHandlerAndHideTooltip:function(){this._onAddPageMenuCloseHandler=this.addDropdown,d.tooltipManager.hide("addPageMenuPopoverId",!0)},getAddPageMenu:function(){return a.createElement(j,{addPage:this._setAddPageHandlerAndHideTooltip,addLink:this._setAddLinkHandlerAndHideTooltip,addDropdown:this._setAddDropdownHandlerAndHideTooltip})},getPageTransitionsPanel:function(){var b=this.getEditorAPI();return a.createElement(k,{biEvent:b.bi.event,userPrefs:b.getUserPreferences(),id:this.getPageTransitionsPanelId()})},getPageTransitionsPanelId:function(){return"getPageTransitionsPanelId"},hasEditedPages:function(){return Boolean(this.props.editedMenuItemIdLink.value)},renameMenuItemById:function(a){this.props.editedMenuItemIdLink.requestChange(a)},reportClick:function(a){var c=this.getEditorAPI();switch(a){case"add":return function(){c.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_Add_pages_click)};case"transition":return function(){c.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_page_transition_click)}}},render:function(){return this.renderTemplate(m)}})}),define("rEditor/rootComps/panels/pagesPanel.rt",["react/addons","lodash","rEditor/pagesMenu/subPages/subPages","rEditor/pagesMenu/mainMenuPages/mainMenuPagesDesktop","panels","util","pagesMenu"],function(a,b,c,d,e,f,g){"use strict";function h(){var h=this.getEditorAPI().getUserPreferences();return a.createElement(e.frames.pagesPanelFrame,{ref:"frame",className:b.keys(b.pick({"in-transition":this.state.isPageTransitionPanelOpened,"special-pages":this._isSubPagesMenuActive,"pages-panel-settings-opened":!!this.state.menuItemToShowSettingsFor},b.identity)).join(" "),panelName:this.props.panelName,title:f.translate(this._currentTitle),helpId:"280e7ca3-cf44-452f-a2a6-6709aa42dcb6"},a.createElement("div",{className:"pages-panel-shadow"}),!this._isSubPagesMenuActive&&this.state.menuItemToShowSettingsFor?a.createElement(g.settingsPanels.desktop.mainMenu,{key:"page-settings-panel",ref:"pageSettingsPanel",menuItem:this.state.menuItemToShowSettingsFor,helpId:"2f65df85-2eba-4b41-a9bf-2a841a5e5a53",closeSettingsPanel:this.closeSettingsPanel,actions:{duplicate:this.duplicate,closeSettingsPanel:this.closeSettingsPanel}}):null,this._isSubPagesMenuActive&&this.state.menuItemToShowSettingsFor?a.createElement(g.settingsPanels.desktop.subpage,{key:"page-settings-panel-subpages",ref:"pageSettingsPanelSubpages",menuItem:this.state.menuItemToShowSettingsFor,closeSettingsPanel:this.closeSettingsPanel,actions:{openBlogManager:this.openBlogManager,openStoreManager:this.openStoreManager}}):null,this._isSubPagesMenuActive?null:a.createElement(d,b.assign({},{key:"main-menu-pages-desktop",editedMenuItemIdLink:this.linkState("editedMenuItemId"),openSettingsPanel:this.openSettingsPanel,closeSettingsPanel:this.closeSettingsPanel,openSubPagesMenu:this.openSubPagesMenu,selectedMenuItemChanged:this.selectedMenuItemChanged},this.props)),this._isSubPagesMenuActive?a.createElement(c,{key:"subpages-menu",userPrefs:h,sectionMenuItem:this.state.menuItemSectionNowOpened,openSettingsPanel:this.openSettingsPanel,closeSubPagesMenu:this.closeSubPagesMenu,selectedMenuItemChanged:this.selectedMenuItemChanged}):null)}return function(){return h.apply(this,[])}}),define("rEditor/rootComps/panels/pagesPanel",["react","core","pagesMenu","rEditor/rootComps/panels/pagesPanelMixin","rEditor/rootComps/panels/pagesPanel.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"pagesPanel",mixins:[d,a.addons.LinkedStateMixin],propTypes:{pageAdded:a.PropTypes.func,filter:a.PropTypes.any},getInitialState:function(){return{editedMenuItemId:null}},duplicate:function(a){c.pageMenuItemHelpers.duplicateMenuItem(this.getEditorAPI(),a,function(a){this.setState({editedMenuItemId:a,menuItemToShowSettingsFor:null})}.bind(this))},render:function(){var a=this.getCurrentPagePageData();return this._isSubPagesMenuActive=this.isSubPagesMenuActive(a),this._currentTitle=this.getCurrentTitle(this._isSubPagesMenuActive,a),this.state.menuItemToShowSettingsFor&&(this.state.menuItemToShowSettingsFor.pageData=this.getEditorAPI().pages.data.get(this.state.menuItemToShowSettingsFor.pageData.id)),e.call(this)}})}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileMainMenu",["react","core","rEditor/pagesMenu/pageNode/common/nodeContentNotPageMixin","rEditor/pagesMenu/pageNodeRenderers"],function(a,b,c,d){"use strict";return a.createClass({displayName:"nodeContentMobileMainMenu",mixins:[b.mixins.editorAPIMixin,c],render:function(){var a=this.props.dataSource;return d.mobile.mainMenu(a,this.props.isSectionPage(a)).call(this)}})}),define("rEditor/pagesMenu/mainMenuPages/mainMenuPagesMobile.rt",["react/addons","lodash","baseUI","core","symbols","util","rEditor/pagesMenu/pagesTree/pagesTree","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileMainMenu"],function(a,b,c,d,e,f,g,h){"use strict";return function(){return a.createElement("div",{className:"pages-menu"},a.createElement("div",{className:b.keys(b.pick({"pages-tree-container":!0,"pages-tree-shrinked":this.shouldShrinkMenu()},b.identity)).join(" ")},a.createElement(c.firstTimeInfoBox,{context:"pages-panel",id:"pages-menu-mobile-view",title:"MobilePages_teaser_title",text:"MobilePages_teaser_text",hide:!1,userPrefs:this.getEditorAPI().getUserPreferences(),biLearnMore:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}),a.createElement(g,{ref:"pagesTree",nodeContent:h,pagesList:this._menuTree,equalityComparer:this.equalityComparer,onNodeToggled:this.onPageToggled,isSectionPage:this._isSectionPage,actions:{openSettingsPanel:this.props.openSettingsPanel,openSubPagesMenu:this.props.openSubPagesMenu},valueLink:this.linkPage()}),0===this._menuTree.length?a.createElement("div",{key:"noPagesFoundSymbolContainer",className:"no-pages"},a.createElement(e.symbol,{name:"noPagesFound"}),a.createElement("div",{},f.translate("Pages_Menu_Empty_Title")),a.createElement("div",{},f.translate("Pages_Menu_Empty_Text"))):null))}}),define("rEditor/pagesMenu/mainMenuPages/mainMenuPagesMobile",["react","rEditor/pagesMenu/mainMenuPages/mainMenuPageMixin","rEditor/pagesMenu/mainMenuPages/mainMenuPagesMobile.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"mainMenuPagesMobile",mixins:[b],render:function(){return this.renderTemplate(c)}})}),define("rEditor/rootComps/panels/pagesPanelMobile.rt",["react/addons","lodash","pagesMenu","panels","core","util","rEditor/pagesMenu/subPages/subPages","rEditor/pagesMenu/mainMenuPages/mainMenuPagesMobile"],function(a,b,c,d,e,f,g,h){"use strict";function i(){var e=this.getEditorAPI().getUserPreferences();return a.createElement(d.frames.pagesPanelFrame,{className:b.keys(b.pick({"pages-panel-frame":!0,"pages-panel-mobile":!0,"pages-panel-settings-opened":!!this.state.menuItemToShowSettingsFor,"special-pages":this._isSubPagesMenuActive},b.identity)).join(" "),panelName:this.props.panelName,title:f.translate("Pages_Mobile_Menu_Title"),helpId:"24b83680-5690-488d-b382-ac051e329c23"},a.createElement("div",{className:"pages-panel-shadow"}),!this._isSubPagesMenuActive&&this.state.menuItemToShowSettingsFor?a.createElement(c.settingsPanels.mobile.mainMenu,{key:"page-settings-panel",menuItem:this.getMenuItemToShowSettingsFor(),closeSettingsPanel:this.closeSettingsPanel}):null,this._isSubPagesMenuActive&&this.state.menuItemToShowSettingsFor?a.createElement(c.settingsPanels.mobile.subpage,{key:"page-settings-panel-mobile",menuItem:this.state.menuItemToShowSettingsFor,closeSettingsPanel:this.closeSettingsPanel,actions:{openBlogManager:this.openBlogManager,openStoreManager:this.openStoreManager}}):null,this._isSubPagesMenuActive?null:a.createElement(h,b.assign({},{key:"main-menu-pages-mobile",openSettingsPanel:this.openSettingsPanel,openSubPagesMenu:this.openSubPagesMenu,selectedMenuItemChanged:this.selectedMenuItemChanged},this.props)),this._isSubPagesMenuActive?a.createElement(g,{key:"subpages-menu",userPrefs:e,sectionMenuItem:this.state.menuItemSectionNowOpened,openSettingsPanel:this.openSettingsPanel,closeSubPagesMenu:this.closeSubPagesMenu,selectedMenuItemChanged:this.selectedMenuItemChanged}):null)}return function(){return i.apply(this,[])}}),define("rEditor/rootComps/panels/pagesPanelMobile",["react","core","lodash","rEditor/utils/menuItemsRepository","rEditor/rootComps/panels/pagesPanelMixin","rEditor/rootComps/panels/pagesPanelMobile.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"pagesPanelMobile",mixins:[e],render:function(){var a=this.getCurrentPagePageData();return this._isSubPagesMenuActive=this.isSubPagesMenuActive(a),f.call(this)}})}),define("rEditor/rootComps/panels/myMediaPanel.rt",["react/addons","lodash","baseUI","util","core","panels"],function(a,b,c,d,e,f){"use strict";function g(a){a.preventDefault()}function h(a,b,c){this.openMediaManager(a.type)}function i(b,e){return a.createElement("li",{className:"panel-button",onClick:h.bind(this,b,e)},a.createElement("div",{className:"panel-button-inner"},a.createElement("span",{className:"label"},a.createElement("i",{style:{backgroundImage:"url("+this.getIcon(b.type)+")"}}),a.createElement("span",{},d.translate(b.name))),a.createElement("div",{className:"action"},a.createElement(c.symbol,{name:"arrowWithStates"}))))}return function(){return a.createElement(f.frames.leftPanelFrame,{ref:"mediaPanel",className:"panel-background",panelName:this.props.panelName,panelClass:"my-uploads-panel",panelIndex:this.props.panelIndex,label:d.translate("MY_UPLOADS_PANEL_HEADER_TITLE"),helpId:"e1df1248-6bd6-4497-ad2a-2a42cd357eae",onContextMenu:g.bind(this)},a.createElement(c.firstTimeInfoBox,{id:"my-uploads-panel",title:"MY_UPLOADS_PANEL_FIRST_TIME_HELP_TITLE",text:"MY_UPLOADS_PANEL_FIRST_TIME_HELP_TEXT",userPrefs:this.getUserPref(),hide:!1,biLearnMore:this.getEditorAPI().bi.event.bind(null,e.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.getEditorAPI().bi.event.bind(null,e.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}),a.createElement.apply(this,["ul",{},b.map(this.getSections(),i.bind(this))]))}}),define("rEditor/rootComps/panels/myMediaPanelAddCompData",[],function(){"use strict";function b(a){var b=Math.min(600,a.width);return{componentType:"wysiwyg.viewer.components.WPhoto",layout:{width:b,height:Math.floor(b*a.height/a.width)},data:{width:a.width,height:a.height,alt:"",uri:a.uri,title:a.title,type:"Image",description:""}}}function c(b){var c=b.uri.split(".").pop();return{componentType:"wysiwyg.viewer.components.documentmedia.DocumentMedia",layout:{width:90,height:140},data:{title:b.title,uri:a[c]||a.other,description:"",width:105,height:141,type:"Image",link:{docId:b.uri,name:b.title,type:"DocumentLink"}},style:"dm1",props:{type:"DocumentMediaProperties",showTitle:!1}}}function d(a){return{componentType:"wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer",layout:{width:304,height:60},data:{originalFileName:a.title,uri:a.uri,type:"SingleAudioPlayer"},props:{autoplay:!1,loop:!1,showArtist:!0,showTrack:!0,volume:50,type:"SingleAudioPlayerProperties"},style:"SingleAudioPlayer_1"}}var a={pdf:"40d80b8089c8418a961cb75d96d491f7.png",doc:"b8964aa7650d463fac3b77e0d00e8f12.png",docx:"b8964aa7650d463fac3b77e0d00e8f12.png",ppt:"a41192b40f324972a1d919a8350965f8.png",ppx:"a41192b40f324972a1d919a8350965f8.png",xls:"757aeccaa7f4409b93913c55e36a194d.png",xlsx:"757aeccaa7f4409b93913c55e36a194d.png",odp:"ac1fbe0592434c58889947de5714b3c7.png",odt:"ac1fbe0592434c58889947de5714b3c7.png",other:"046956f7d55f4143a30b3b54669ee243.png"};return{picture:b,document:c,music:d}}),define("rEditor/rootComps/panels/myMediaPanel",["react","lodash","core","util","tpa","rEditor/rootComps/panels/myMediaPanel.rt","rEditor/rootComps/panels/myMediaPanelAddCompData"],function(a,b,c,d,e,f,g){"use strict";function h(a){return b.findKey(g,function(b){return b.structure&&b.structure.componentType===a})}function i(a){var b=g[a.mediaType];return b?b(a):void console.error("Unsupported media type",a.mediaType)}return a.createClass({displayName:"MyMediaPanel",mixins:[c.mixins.editorAPIMixin],closePanel:function(){this.refs.mediaPanel.close()},iconMap:{DOCUMENT:d.media.getMediaUrl("rEditor/myMediaPanel/document.png"),IMAGE:d.media.getMediaUrl("rEditor/myMediaPanel/image.png"),MUSIC:d.media.getMediaUrl("rEditor/myMediaPanel/music.png"),MUSIC_PRO:d.media.getMediaUrl("rEditor/myMediaPanel/music_pro.png")},titleMap:{IMAGE:"MMGR_API_IMAGE_MANAGE_TITLE",MUSIC:"MMGR_API_MUSIC_MANAGE_TITLE",DOCUMENT:"MMGR_API_DOCUMENT_MANAGE_TITLE"},submitButtonMap:{IMAGE:"MMGR_submitbutton_uploads_uploads_add",MUSIC:"MMGR_submitbutton_uploads_mytracks_add",DOCUMENT:"MMGR_submitbutton_uploads_mydocs_add"},getSections:function(){
var a=this.getEditorAPI().mediaServices.mediaManager.categories,b=[{name:"MY_UPLOADS_MY_IMAGES_LINK_LABEL",type:a.IMAGE},{name:"MY_UPLOADS_MY_MUSIC_LINK_LABEL",type:a.MUSIC},{name:"MY_UPLOADS_MY_DOCUMENT_LINK_LABEL",type:a.DOCUMENT}];return b},getIcon:function(a){return this.iconMap[a]},openMediaManager:function(a){var b=this.getEditorAPI(),e=b.mediaServices.mediaManager;b.bi.event(c.bi.events.myMediaPanel.my_uploads_panel_section_click,{section:a}),e.open(a,{multiSelect:!0,callback:this.onItemsSelected,translation:{title:d.translate(this.titleMap[a]),submitButton:d.translate(this.submitButtonMap[a])}})},onItemsSelected:function(a){if(a){var c=this.getEditorAPI();c.pasteLogic.addContext.resetPastePosition(),b.forEach(a,this.addComponent)}},addComponent:function(a,d,e){var f=this.getEditorAPI(),g=i(a),j=f.pages.getCurrentPageId(),k=f.pasteLogic.addContext.getPastePosition(f,g.layout,j);b.merge(g.layout,k);var l=f.pages.getReference(j);f.waitForChangesApplied(function(){f.components.add(l,g,void 0,function(a){d===e.length-1&&(f.selection.selectComponentByCompRef(a),f.history.add("added component")),f.bi.event(c.bi.events.addPanel.COMPONENT_ADDED_TO_STAGE,{origin:"my_uploads",category:h(g.componentType),component_type:g.componentType,component_id:a.id,adding_method:"click"})})})},getUserPref:function(){return this.getEditorAPI().getUserPreferences()},render:f})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundPanel.rt",["react/addons","lodash","baseUI","util","panels","uiAnimations","backgroundPresets"],function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,d,e){e.preventDefault()}function i(a,b,c,d,e,f){f.preventDefault()}function j(a,b,c,d,e,f){this.replaceColor(f,a)}function k(a,b,c,d,e,f){this.changeColor(f,a)}function l(a,b,c,d,e){this.changeMedia(this.mediaTypes.IMAGE)}function m(a,b,c,d,e){c||this.changeMedia(this.mediaTypes.VIDEO)}function n(b,d,e,g){var h=this.getMediaType(b.ref);return a.createElement("div",{className:"bg-panel-top"},a.createElement("div",{className:"bg-panel-preview",onContextMenu:i.bind(this,b,d,e,g,h)},a.createElement("div",{className:"bg-panel-preview-media",style:this.getCurrentColor(b)}),a.createElement("div",{ref:"previewMedia",className:"bg-panel-preview-media",style:this.getCurrentMedia(b)}),a.createElement("div",{className:"bg-panel-preview-overlay",style:g.getOverlayStyle(b.ref,this.getEditorAPI())}),a.createElement("div",{className:"bg-panel-preview-buttons"},h!==this.mediaTypes.COLOR?a.createElement(c.tooltip,{disabled:!!this.getCurrentSubPanel(),value:this.getSettingTranslation(h),alignment:"top",className:"control-tooltip-small",key:"settings-tooltip"},a.createElement("div",{className:"bg-panel-preview-button"},a.createElement(f.rotatePartAnimation,{selector:".gear-wheel",play:this.isSettingsPanelOpen()},a.createElement(c.toggle,{name:"settings-icon",label:this.getSettingsButtonTranslation(h),valueLink:this.toggleSubPanel(h),labelAfterSymbol:!0})))):null,h===this.mediaTypes.VIDEO?a.createElement(c.tooltip,{key:"video-controls",id:"video-play-tooltip",disabled:this.isPlayBtnTooltipDisabled(h),alignment:"top",className:"control-tooltip-small",value:this.getPlayBtnTranslation()},a.createElement("div",{className:"bg-panel-preview-button"},a.createElement(c.toggle,{name:"play-video",disabled:this.getVideoReadyState()===this.videoReadyStates.IN_PROCESS,valueLink:this.toggleVideoPlayback(this.isVideoPlaying())}),this.getVideoReadyState()===this.videoReadyStates.IN_PROCESS?a.createElement(c.preloader,{key:"play-spinner"}):null)):null),h===this.mediaTypes.IMAGE?a.createElement("div",{onClick:j.bind(this,b,d,e,g,h),className:"bg-panel-preview-color",style:this.getCurrentColor(b),key:"bg-fold"},a.createElement(c.symbol,{name:"fold-clipart"})):null),a.createElement("div",{className:"bg-panel-top-actions"},a.createElement("div",{className:"bg-panel-action"},a.createElement(c.button2,{className:"default bg-panel-action-btn",label:"BGPP_PANEL_COLOR_BUTTON",symbolName:"color-btn",onClick:k.bind(this,b,d,e,g,h)})),a.createElement("div",{className:"bg-panel-action"},a.createElement(c.button2,{onClick:l.bind(this,b,d,e,g,h),className:"default bg-panel-action-btn",symbolName:"image-btn",label:"BGPP_PANEL_IMAGE_BUTTON"})),a.createElement(c.tooltip,{disabled:!e,value:"BGPP_PANEL_VIDEO_BUTTON_MOBILE_TOOLTIP",alignment:"top",className:"control-tooltip-small"},a.createElement("div",{className:"bg-panel-action"},a.createElement(c.button2,{onClick:m.bind(this,b,d,e,g,h),disabled:e,className:"default bg-panel-action-btn",symbolName:"video-btn",label:"BGPP_PANEL_VIDEO_BUTTON"})))))}function o(a,b,c,d){this.handleApplyToOtherClick()}function p(){var b=this.getData(),f=this.getCurrentSubPanel(),i=this.getEditorAPI().isMobileEditor(),j=d.backgroundPanelUtils;return a.createElement(e.frames.leftPanelFrame,{ref:"backgroundPanel",className:"bg-panel",panelName:this.props.panelName,label:this.getTranslation("TITLE"),panelIndex:this.props.panelIndex,panelClass:"bg-panel",helpId:i?"f0d8190e-e2da-48be-9f44-7ecff4518a82":"f11a3bb9-cff0-46d4-92ff-cc8cd9d30468",onContextMenu:h.bind(this,b,f,i,j)},n.apply(this,[b,f,i,j]),a.createElement(c.customScroll,{addScrolledClass:!0},a.createElement("div",{className:"bg-panel-preset-list"},a.createElement("div",{className:"bg-panel-preset-list-sections sections","data-tooltip-bounds":"true"},a.createElement(g.presetSection,this.getPresetsProps())))),a.createElement("div",{className:"bg-panel-bottom"},a.createElement(c.button2,{label:"BGPP_PANEL_APPLY_TO_OTHER_BUTTON",onClick:o.bind(this,b,f,i,j),disabled:this.isOnePager(),className:"default"})))}return function(){return p.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundPanel",["react","lodash","core","panels","baseUI","util","color","panelUtils","backgroundPresets","rEditor/rootComps/panels/backgroundPanel/backgroundPanel.rt"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function y(a,b,c){c||(c=a.pages.getCurrentPageId()),b||(b=a.isMobileEditor()?"mobile":"desktop");var d=a.pages.background.get(c,b);return d}function z(a){a.ref.colorOverlay="",a.ref.colorOverlayOpacity=0,a.ref.imageOverlay=null}function A(a,c,d,e){var f;b.assign(d.ref,b.omit(c.ref,["id","mediaRef","metaData"])),z(d),d.ref.scrollType="scroll",c.ref.mediaRef?(f="WixVideo"===c.ref.mediaRef.type?c.ref.mediaRef.posterImageRef:c.ref.mediaRef,d.ref.mediaRef=b.omit(f,"id")):d.ref.mediaRef=null,a.pages.background.update(e,d,"mobile")}function B(a,c){var d=a[0],e=b.first(d.fileOutput.image),f=b.groupBy(d.fileOutput.video,"quality"),g=b.pick(e,["width","height","url"]);g.type="Image",g.uri=g.url.replace(/^(.*[\/])/,""),delete g.url,g.description=c.path;var h={type:"WixVideo",title:d.title,videoId:d.fileBaseUrl,duration:Math.round(d.fileInput.duration/1e3),posterImageRef:g,opacity:1,autoplay:!0,loop:!0,preload:"auto",mute:!0,artist:{name:d.vendor||"",id:d.reference||""}};return h.qualities=b.map(f,function(a){var c=b.pluck(a,"format"),d=b.pick(a[0],["width","height","quality"]);return d.formats=c,d}),h}function C(a,b){var c=a[0];return{type:"Image",uri:c.fileName,title:c.title,description:b.path,width:c.width,height:c.height,artist:{name:c.vendor||"",id:c.reference||""}}}function D(a,d,e){a===s.APPLY?k.applyToOtherClick(d,c.bi.events.backgroundPanel.panel_apply_to_other_pages_click):e.origin=u["BG_"+b.invert(s)[a].toUpperCase()]}function E(a,b,c){var d=a.getUserPreferences(),e=a.pages.getCurrentPageId();d.session.set("bg_panel_last_media_path_"+e,{type:b,path:c.path})}function F(a){var b=a.getUserPreferences(),c=a.pages.getCurrentPageId();return b.session.get("bg_panel_last_media_path_"+c)||{}}function G(a,b){return a.homePage.get()===b}function H(a,b,c){G(a,c)&&!b.ref.mediaRef&&(b.ref.id=f.guidUtils.getUniqueId(c,"_")+"_bg")}function I(a,b){var c=b.ref.id;c||(c=y(a,"mobile",a.pages.getCurrentPageId()).ref.id);var d=a.userPreferences.session.get("bg_panel_mobile_data_duplications_"+c);d&&d.count&&(b.ref.id=f.guidUtils.getUniqueId(a.pages.getCurrentPageId(),"_")+"_mobile_bg",b.ref.mediaRef&&(b.ref.mediaRef.id=void 0),a.userPreferences.session.set("bg_panel_mobile_data_duplications_"+c,{count:d.count-1}),a.userPreferences.session.set("bg_panel_mobile_data_duplications_"+b.ref.id,{count:0}))}function J(a,b){var c=a.getUserPreferences(),d=a.pages.getCurrentPageId(),e=b===n.VIDEO?"bg_video_settings_data_changed_":"bg_image_settings_data_changed_";c.session.set(e+d,!1),c.session.set("bg_video_settings_pattern_state_"+d,!1)}function K(a,b){a.ref.scrollType="fixed";var c=b.pages.getCurrentPageId(),d=b.getUserPreferences(),e=d.session.get("bg_video_settings_data_changed_"+c);e||z(a)}function L(a,b,c){var d=c.pages.getCurrentPageId(),e=c.getUserPreferences(),f=e.session.get("bg_image_settings_data_changed_"+d);f&&(a.opacity=b.ref.mediaRef&&b.ref.mediaRef.opacity||1),z(b)}function M(){return x}var k=f.bgPanelBiEvents,l=f.imageTransform,m=f.backgroundPanelUtils,n=m.getMediaTypes(),o=352,p=184,q=600,r=600,s={IMAGE_SETTINGS:"rEditor.panels.bgImageSettingsPanel",VIDEO_SETTINGS:"rEditor.panels.bgVideoSettingsPanel",APPLY:"rEditor.panels.backgroundApplyPanel"},t={APPLY_PANEL:"applyPanel",IMAGE_PANEL:"imagePanel",VIDEO_PANEL:"videoPanel",PRESET:"preset",MEDIA:"media",REMOVE:"remove",COLOR:"color"},u={BG_PRESETS:"bg_presets",BG_COLOR_PICKER:"bg_color_picker",BG_MEDIA_MANAGER_WIXVIDEO:"bg_media_manager_video",BG_MEDIA_MANAGER_IMAGE:"bg_media_manager_image",BG_IMAGE_SETTINGS:"bg_image_settings",BG_VIDEO_SETTINGS:"bg_video_settings"},v={TITLE:{mobile:"BGPP_PANEL_HEADER_MOBILE_TITLE",desktop:"BGPP_PANEL_HEADER_DSKTOP_TITLE"}},w={Image:"BGPP_PANEL_IMAGE_SETTINGS_BUTTON",WixVideo:"BGPP_PANEL_VIDEO_SETTINGS_BUTTON"},x={IN_PROCESS:"in_process",PLAYING_PREVIEW:"playing_preview",IDLE:"idle",NO_VIDEO:"no_video"};return a.createClass({displayName:"backgroundPanel",mixins:[c.mixins.editorAPIMixin,f.blockOuterScrollMixin,h.linkColorPickerMixin],panelBoundingRect:{},mediaTypes:n,getMediaType:m.getMediaType,subPanels:s,videoReadyStates:null,componentDidMount:function(){this.panelBoundingRect=this.getDOMNode().getBoundingClientRect();var a=this.getEditorAPI();a.pages.background.video.registerToPlayingChange(this.playingStatusChanged),this.markMobileDataDuplications()},componentWillUnmount:function(){this.closeSubPanel(this.getCurrentSubPanel());var a=this.getEditorAPI();a.pages.background.video.unregisterToPlayingChange(this.playingStatusChanged),this.pauseVideo(),k.changedBackgroundBiEvent(this.getEditorAPI(),c.bi.events.backgroundPanel.panel_background_changed,this.getData().ref,this.biEventsParams)},getInitialState:function(){return this.videoReadyStates=M(),this.biEventsParams={origin:null,presetIndex:null},{isVideoPlaying:!1,videoReadyState:this.videoReadyStates.IDLE}},componentDidUpdate:function(){this.getVideoReadyState()===this.videoReadyStates.IDLE&&e.tooltipManager.hide("video-play-tooltip")},previewVideo:function(){var a=this.getEditorAPI();a.pages.background.video.play()},pauseVideo:function(){var a=this.getEditorAPI();a.getPreviewMode()||a.pages.background.video.pause()},isVideoPlaying:function(){var a=this.getEditorAPI();return a.pages.background.video.isPlaying()},getVideoReadyState:function(){var a=this.getEditorAPI();return a.pages.background.video.getReadyState()},playingStatusChanged:function(){this.forceUpdate()},videoReadyStateChanged:function(){this.forceUpdate()},linkedBackgroundColor:function(a,b,c){var d=b[c].replace(/[\{\}]/g,"");return{value:d,requestChange:function(d){b[c]=/color_/.test(d)?"{"+d+"}":d,this.biEventsParams.origin=u.BG_COLOR_PICKER,this.onRequestChange(a)}.bind(this)}},getCurrentSubPanel:function(){var a=b.find(this.props.editorState.openPanels,function(a){return b.includes(s,a.name)});return a&&a.name},isSettingsPanelOpen:function(){var a=this.getCurrentSubPanel();return a===s.IMAGE_SETTINGS||a===s.VIDEO_SETTINGS},closeSubPanel:function(a){a&&d.panelManager.closePanelByName(a)},getData:function(a){return y(this.getEditorAPI(),a)},handleMobileDataChange:function(a,b,c,d){if(H(c,b,d),"mobile"===a)b.isPreset=!1,b.ref.scrollType="scroll",I(c,b);else{var e=y(c,"mobile",d);e.isPreset&&(I(c,e),A(c,b,e,d))}},onRequestChange:function(a,b,c){var d=this.getEditorAPI(),e=d.isMobileEditor()?"mobile":"desktop";c=c||d.pages.getCurrentPageId(),H(d,a,c),this.handleMobileDataChange(e,a,d,c),d.pages.background.update(c,a,e),this.undoHandler(b),this.state.isVideoPlaying&&(this.pauseVideo(),this.setState({isVideoPlaying:!1}))},undoHandler:function(a){var c=this.getEditorAPI(),d=b.values(t);b.includes(d,a)&&c.history.add("background panel - "+a)},toggleSubPanel:function(a){var b=this.getCurrentSubPanel();return{value:b&&b!==this.subPanels.APPLY,requestChange:function(){var b=a===this.mediaTypes.VIDEO?this.subPanels.VIDEO_SETTINGS:this.subPanels.IMAGE_SETTINGS;this.toggleSubPanelChange(b)}.bind(this)}},toggleSubPanelChange:function(a){var b=this.getCurrentSubPanel();a===b?this.closeSubPanel(a):this.openSubPanel(a)},openSubPanel:function(a){D(a,this.getEditorAPI(),this.biEventsParams);var b=this.getSubPanelProps();d.panelManager.openPanel(a,b,!0)},getSubPanelProps:function(a){return{requestChange:this.onRequestChange,undoHandler:this.undoHandler,undoOrigins:t,getData:this.getData,panelName:a,top:this.panelBoundingRect.top,left:this.panelBoundingRect.left+this.panelBoundingRect.width+15,width:290}},getCurrentMedia:function(a){var d,e,g,c={};if(a.ref.mediaRef){d=this.getMediaType(a.ref)===this.mediaTypes.IMAGE?a.ref.mediaRef:a.ref.mediaRef.posterImageRef,g=m.isSmallerFromContainer(d.width,d.height,q,r),e=g?l.fittingTypes.TILE:l.fittingTypes.SCALE_TO_FILL;var h=m.getImageDisplayData(e,a.ref.alignType,d.uri,d.width,d.height,o,p);c.backgroundImage="url("+f.url.joinURL(m.MEDIA_URL_PREFIX,h.uri)+")",c.opacity=d.opacity,b.assign(c,h.css.container)}return b.assign(c,this.getCurrentColor(a)),c},getCurrentColor:function(a){var b=m.getColorValue(this.getEditorAPI(),a.ref.color);return{backgroundColor:b}},toggleVideoPlayback:function(a){return{value:a,requestChange:function(a){a?this.previewVideo():this.pauseVideo()}.bind(this)}},replaceColor:function(a,b){this.setColorPicker(a,b,this.colorPickerPanelHandleReplace.bind(this),!0)},changeColor:function(a,b){var c=!b.ref.mediaRef;this.setColorPicker(a,b,this.colorPickerPanelHandleChange.bind(this),c)},setColorPicker:function(a,b,c,d){var e=b.ref.color.replace(/[\[\{\}\]]/g,""),f={top:a.clientY,left:a.clientX};this.openColorPicker(c,e,!0,f,d,!0)},colorPickerPanelHandleReplace:function(a){this.closeSubPanel(this.getCurrentSubPanel());var b=this.getData();b.ref.color=/color_/.test(a)?"{"+a+"}":a,b.ref.color=/rgba/.test(a)?g(a).hex():a,this.biEventsParams.origin=u.BG_COLOR_PICKER,this.onRequestChange(b)},colorPickerPanelHandleChange:function(a){this.closeSubPanel(this.getCurrentSubPanel());var b=this.getData();b.ref.mediaRef&&(b.ref.mediaRef=null,J(this.getEditorAPI(),n.VIDEO),J(this.getEditorAPI(),n.IMAGE),z(b),this.undoHandler(t.REMOVE)),b.ref.color=/color_/.test(a)?"{"+a+"}":a,b.ref.color=/rgba/.test(a)?g(a).hex():a,this.biEventsParams.origin=u.BG_COLOR_PICKER,this.onRequestChange(b)},selectPreset:function(a,c,d){var f=this.getData(),g=this.getEditorAPI();e.tooltipManager.hideAll(),this.closeSubPanel(this.getCurrentSubPanel()),b.assign(a,b.omit(f,"ref")),E(g,this.getMediaType(a.ref),{path:a.path}),delete a.path,delete a.presetIndex,J(g,n.VIDEO),J(g,n.IMAGE),this.biEventsParams={presetIndex:d,origin:u.BG_PRESETS},this.onRequestChange(a,t.PRESET)},onMediaManagerCallback:function(a,b,c){if(b){var d,e,f=this.getEditorAPI(),g=this.getData();E(f,a,c),a===this.mediaTypes.VIDEO?(d=B(b,c),K(g,f),J(f,n.IMAGE),e=d.posterImageRef,g.ref.scrollType="fixed"):a===this.mediaTypes.IMAGE&&(d=C(b,c),L(d,g,f),J(f,n.VIDEO),e=d);var i,h=m.isSmallerFromContainer(e.width,e.height,q,r);i=a===this.mediaTypes.IMAGE&&h?l.fittingTypes.LEGACY_BG_FIT_AND_TILE:l.fittingTypes.SCALE_TO_FILL,g.ref.fittingType=i,g.ref.alignType=l.alignTypes.CENTER,g.ref.mediaRef=d,this.biEventsParams.origin=u["BG_MEDIA_MANAGER_"+a.toUpperCase()],this.onRequestChange(g,t.MEDIA)}},openMediaManager:function(a,b){if(a){var e,c=this.getEditorAPI(),d=c.mediaServices.mediaManager,g=F(c),h=g.type===a?g.path||"":"";a===this.mediaTypes.IMAGE?e=d.categories.BG_IMAGE:a===this.mediaTypes.VIDEO&&(e=d.categories.BG_VIDEO),this.closeSubPanel(this.getCurrentSubPanel()),d.open(e,{callback:b,path:h,translation:{submitButton:f.translate("MMGR_submitbutton_background_uploads_change")}})}},changeMedia:function(a){this.openMediaManager(a,this.onMediaManagerCallback.bind(this,a))},closePanel:function(){this.refs.backgroundPanel.close()},getTranslation:function(a){var b=this.getEditorAPI().isMobileEditor()?"mobile":"desktop";return f.translate(v[a][b])},getSettingsButtonTranslation:function(a){return w[a]},handleApplyToOtherClick:function(){this.isOnePager()||this.toggleSubPanelChange(this.subPanels.APPLY)},isOnePager:function(){return 1===this.getEditorAPI().pages.getPageIdList().length},markMobileDataDuplications:function(){var a=this.getEditorAPI(),b=a.getUserPreferences(),d=this.getData("mobile").ref.id,e=b.session.get("bg_panel_mobile_data_duplications_"+d);if(!e){for(var f=a.pages.getCurrentPageId(),g=0,h=a.pages.getPagesData(),i=0;i<h.length;i++)h[i].id!==f&&h[i].pageBackgrounds.mobile.ref.id===d&&g++;b.session.set("bg_panel_mobile_data_duplications_"+d,{count:g}),g&&k.mobileDataDuplicationError(this.getEditorAPI(),c.bi.errors.BG_MOBILE_DATA_DUPLICATION_ERROR)}},isPlayBtnTooltipDisabled:function(){return this.getVideoReadyState()===this.videoReadyStates.IDLE},getPlayBtnTranslation:function(){var a="",b=this.getVideoReadyState();return b===this.videoReadyStates.PLAYING_PREVIEW?a="BGPP_PANEL_VIDEO_PLAYBACK_PREVIEW_READY_TOOLTIP":b===this.videoReadyStates.IN_PROCESS&&(a="BGPP_PANEL_VIDEO_PLAYBACK_NOT_READY_TOOLTIP"),a},getSettingTranslation:function(a){var b="";return a===this.mediaTypes.IMAGE?b="BGPP_PANEL_IMAGE_SETTINGS_BUTTON_TOOLTIP":a===this.mediaTypes.VIDEO&&(b="BGPP_PANEL_VIDEO_SETTINGS_BUTTON_TOOLTIP"),b},getPresetsProps:function(){return{desktopPresets:i.backgroundDesktopPresets,mobilePresets:i.backgroundMobilePresets,title:f.translate("BGPP_PANEL_SELECTED_SECTION_TITLE"),infoTooltip:"BGPP_PANEL_SELECTED_SECTION_TOOLTIP",onSelectPreset:this.selectPreset,thumbWidth:88,thumbHeight:59}},render:function(){return j.apply(this)}})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgImageSettingsPanel.rt",["react/addons","lodash","baseUI","symbols","panels"],function(a,b,c,d,e){"use strict";function f(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function g(b,d,e){return a.createElement(c.dropDown.option,{key:"fittingTypeOption"+e,value:d.value},d.label)}function h(){var d=this.props.getData();return a.createElement(e.frames.bgSubPanelFrame,f({helpId:"54c7eb1c-a6c7-46c9-9261-96eecf3bb0eb",className:"background-image-settings-panel background-sub-panel",label:"BGPP_SETTINGS_IMAGE_PANEL_HEADER_TITLE"},b.omit(this.props,"children")),a.createElement(c.customScroll,{},a.createElement("div",{className:"bg-image-settings-panel-scrollbox bg-settings-panel-scrollbox"},a.createElement(c.slider,{valueLink:this.linkedBackgroundOpacityData(d,d.ref.mediaRef,"opacity"),label:"BGPP_SETTINGS_IMAGE_OPACITY_TITLE",min:0,max:100,step:1}),a.createElement("hr",{className:"divider-long"}),a.createElement("div",{className:"color-picker-input-wrapper"},a.createElement(c.colorPickerInput,f({label:"BGPP_SETTINGS_IMAGE_BG_COLOR_TITLE",ref:"bgColorPickerInput",className:"label-left",valueLink:this.linkedBackgroundColor(d,d.ref,"color")},this.getColorPickerProps()))),this.getEditorAPI().isMobileEditor()?null:a.createElement("div",{key:"scrollTypeRadiosDivider"},a.createElement("hr",{className:"divider-long"}),a.createElement(c.sectionDividerLabeled,{label:"BGPP_SETTINGS_IMAGE_SCROLL_SECTION_TITLE",infoText:"BGPP_SETTINGS_IMAGE_SCROLL_SECTION_TOOLTIP"}),a.createElement("hr",{className:"divider-long"}),a.createElement(c.thumbnails,{maxThumbsPerRow:"3",className:"with-labels scroll-type-thumbs",options:this.getEffectsThumbOptions(),valueLink:this.linkedBackgroundData(d,d.ref,"scrollType")})),a.createElement("hr",{className:"divider-long"}),a.createElement(c.sectionDividerLabeled,{label:"BGPP_SETTINGS_IMAGE_LAYOUT_SECTION_TITLE"}),a.createElement("hr",{className:"divider-long"}),a.createElement.apply(this,[c.dropDown.select,{valueLink:this.linkedBackgroundData(d,d.ref,"fittingType"),label:"BGPP_SETTINGS_IMAGE_FITTING_TITLE"},b.map(this.getFittingOptions(d.ref.scrollType),g.bind(this,d))]),a.createElement("hr",{className:"divider-long"}),a.createElement(c.alignment,{options:c.commonData.ALIGNMENT_MODES_XY,valueLink:this.linkedBackgroundData(d,d.ref,"alignType"),label:"BGPP_SETTINGS_IMAGE_ALIGN_TITLE"}))))}return function(){return h.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgImageSettingsPanel",["core","react","lodash","panels","util","panelUtils","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgImageSettingsPanel.rt"],function(a,b,c,d,e,f,g){"use strict";function q(a){var b=a.getUserPreferences(),c=a.pages.getCurrentPageId();b.session.set("bg_image_settings_data_changed_"+c,!0)}var h=e.backgroundPanelUtils,i=e.imageTransform.fittingTypes,j=600,k=600,l=[{label:"BGPP_SETTINGS_IMAGE_FITTING_SCALE_TO_FILL",value:i.SCALE_TO_FILL},{label:"BGPP_SETTINGS_IMAGE_FITTING_SCALE_TO_FIT",value:i.SCALE_TO_FIT},{label:"BGPP_SETTINGS_IMAGE_FITTING_ORIGINAL_SIZE",value:i.LEGACY_BG_NORMAL},{label:"BGPP_SETTINGS_IMAGE_FITTING_TILE",value:i.LEGACY_BG_FIT_AND_TILE},{label:"BGPP_SETTINGS_IMAGE_FITTING_TILE_HORIZONTALLY",value:i.LEGACY_BG_FIT_AND_TILE_HORIZONTAL},{label:"BGPP_SETTINGS_IMAGE_FITTING_TILE_VERTICALLY",value:i.LEGACY_BG_FIT_AND_TILE_VERTICAL}],m=[{value:"scroll",label:"BGPP_SETTINGS_IMAGE_SCROLL_NONE",symbolName:"thumb-none"},{value:"parallax",label:"BGPP_SETTINGS_IMAGE_SCROLL_PARALLAX",symbolName:"scroll-fx-site-bg-parallax"},{value:"fixed",label:"BGPP_SETTINGS_IMAGE_SCROLL_FREEZE",symbolName:"scroll-fx-site-bg-freeze"}],n=[{label:"BGPP_SETTINGS_IMAGE_FITTING_SCALE_TO_FILL",value:i.SCALE_TO_FILL},{label:"BGPP_SETTINGS_IMAGE_FITTING_TILE",value:i.LEGACY_BG_FIT_AND_TILE}],o=[i.LEGACY_BG_FIT_AND_TILE,i.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,i.LEGACY_BG_FIT_AND_TILE_VERTICAL],p={opacity:1,fittingType:i.SCALE_TO_FILL,alignType:"center",scrollType:"scroll"};return b.createClass({displayName:"bgImageSettingsPanel",mixins:[a.mixins.editorAPIMixin,f.linkColorPickerMixin],childContextTypes:{reportUIChange:b.PropTypes.func},getInitialState:function(){return this.lastScrollingType=null,{}},shouldComponentUpdate:function(a){var b=a.getData();return b.ref.mediaRef&&"Image"===b.ref.mediaRef.type?!0:(d.panelManager.closePanelByName(a.panelName),!1)},getChildContext:function(){return{reportUIChange:this.onUIChange}},onUIChange:function(a){"slider"===a&&this.props.undoHandler(this.props.undoOrigins.IMAGE_PANEL)},linkedBackgroundData:function(a,b,c){var d="undefined"==typeof b[c]?p[c]:b[c];return{value:d,requestChange:function(d){"scrollType"===c&&"parallax"===d&&(b.fittingType=this.getFittingTypeForParallax(a)),b[c]=d,this.props.requestChange(a,this.props.undoOrigins.IMAGE_PANEL),q(this.getEditorAPI())}.bind(this)}},linkedBackgroundOpacityData:function(a,b,c){var d="undefined"==typeof b[c]?p[c]:b[c];return d*=100,{value:d,requestChange:function(d){d/=100,b[c]=d,this.props.requestChange(a),q(this.getEditorAPI())}.bind(this)}},linkedBackgroundColor:function(a,b,c){var d=b[c].replace(/[\{\}]/g,"");return{value:d,requestChange:function(d){b[c]=/color_/.test(d)?"{"+d+"}":d,this.props.requestChange(a),q(this.getEditorAPI())}.bind(this)}},getColorPickerProps:function(){return{useMouseEvent:!0,colorResolver:this.resolveColor,openColorPicker:this.openColorPicker,previewOnHover:!0}},getFittingOptions:function(a){return"parallax"===a?n:l},getEffectsThumbOptions:function(){return m},getFittingTypeForParallax:function(a){var b=a.ref.fittingType,d=a.ref.mediaRef,e=i.LEGACY_BG_FIT_AND_TILE,f=i.SCALE_TO_FILL,g=h.isSmallerFromContainer(d.width,d.height,j,k),l=c.includes(o,b)||g&&b!==f;return l?e:f},render:g})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgVideoSettingsPanel.rt",["react/addons","lodash","baseUI","symbols","panels","util"],function(a,b,c,d,e,f){"use strict";function g(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function h(b,d,e,f){return a.createElement(c.dropDown.option,{key:"playbackOption"+f,value:e.value},e.label,"\n                \n            ")}function i(){var d=this.props.getData(),i=f.translate;return a.createElement(e.frames.bgSubPanelFrame,g({helpId:"7f54f04e-6e0b-4f73-96e2-6c98dd28e822",className:"background-video-settings-panel background-sub-panel",label:"BGPP_SETTINGS_VIDEO_PANEL_HEADER_TITLE"},b.omit(this.props,"children")),a.createElement(c.customScroll,{},a.createElement("div",{className:"bg-video-settings-panel-scrollbox bg-settings-panel-scrollbox"},a.createElement("div",{className:"background-video-patterns-control"},a.createElement(c.thumbnails,{radioType:"class",valueLink:this.linkedPatternOption(d,d.ref.imageOverlay),maxThumbsPerRow:"4",title:"BGPP_SETTINGS_VIDEO_OVERLAY_PATTERN_TITLE",options:this.thumbPatternOptions}),d.ref.imageOverlay?a.createElement(c.buttonsGroup,{className:"overlay-pattern-btn-group",valueLink:this.applyInversePattern(d,d.ref.imageOverlay),options:this.getInvertPatternOption(),key:"inversePattern"}):null),a.createElement("hr",{className:"divider-long"}),a.createElement(c.toggle,{valueLink:this.applyOverlayColor(d),label:"BGPP_SETTINGS_VIDEO_OVERLAY_COLOR_TITLE"}),this.isColorOverlay(d)?a.createElement("hr",{className:"divider-short",key:"color-picker-input-divider"}):null,this.isColorOverlay(d)?a.createElement(c.colorPickerInputWithOpacity,b.assign({},{ref:"bgColorPickerInput",key:"color-picker-input",label:"BGPP_SETTINGS_VIDEO_COLOR_OPACITY_TITLE",valueLink:this.linkColorWithOpacity(d,d.ref)},this.getColorPickerProps())):null,a.createElement("hr",{className:"divider-long"}),a.createElement(c.sectionDividerLabeled,{label:"BGPP_SETTINGS_VIDEO_PLAYBACK_SECTION_TITLE"}),this.getEditorAPI().isDesktopEditor()?a.createElement("hr",{className:"divider-long",key:"whptoDividerImageDesc"}):null,a.createElement.apply(this,[c.dropDown.select,{valueLink:this.linkedBackgroundData(d,d.ref.mediaRef,"playbackSpeed"),label:f.translate("BGPP_SETTINGS_VIDEO_PLAYBACK_TITLE"),shouldTranslate:!1},b.map(this.getPlaybackOptions(),h.bind(this,d,i))]),a.createElement("hr",{className:"divider-long"}),a.createElement(c.toggle,{valueLink:this.linkedBackgroundData(d,d.ref.mediaRef,"loop"),label:"BGPP_SETTINGS_VIDEO_LOOP_TITLE"}))))}return function(){return i.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgVideoSettingsPanel",["react","core","lodash","panels","panelUtils","util","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgVideoSettingsPanel.rt"],function(a,b,c,d,e,f,g){"use strict";function o(a,b){var c=a.getUserPreferences(),d=a.pages.getCurrentPageId();c.session.set("bg_video_settings_pattern_state_"+d,b)}function p(a){var b=a.getUserPreferences(),c=a.pages.getCurrentPageId();b.session.set("bg_video_settings_data_changed_"+c,!0)}function q(a){return a===j}function r(a,b){var d;if(!a.ref.imageOverlay){var e=b.pages.getCurrentPageId(),f=b.getUserPreferences();return d=f.session.get("bg_video_settings_pattern_state_"+e),d?j:i}return c.find(i,{uri:a.ref.imageOverlay.uri})?i:j}for(var h=[{value:null,className:"v-overlay-pat-0-icon"},{value:"",className:"v-overlay-pat-1-icon"},{value:"",className:"v-overlay-pat-2-icon"},{value:"",className:"v-overlay-pat-3-icon"},{value:"",className:"v-overlay-pat-4-icon"},{value:"",className:"v-overlay-pat-5-icon"},{value:"",className:"v-overlay-pat-6-icon"},{value:"",className:"v-overlay-pat-7-icon"}],i=[{uri:"0da768_8b89980121844d37be099f0dbe33e3e3.png",width:6,height:6},{uri:"0da768_4371c7e64a49489bb88c536f515f2040.png",width:6,height:6},{uri:"0da768_361994b0f154464682a0aaf9724471cc.png",width:56,height:56},{uri:"0da768_880a3209e3744cd0a96b66835a01b8c5.png",width:256,height:256},{uri:"0da768_2729bfbce3874276a7dd057098f93949.png",width:6,height:6},{uri:"0da768_8fae2cc5b7bf477fb13faa1f2582dbd2.png",width:4,height:6},{uri:"0da768_2326357be59441978a570bec687a94d0.png",width:3,height:3}],j=[{uri:"0da768_5810e2bd76f64c77a67904ad2b073444.png",width:6,height:6},{uri:"0da768_46b55443eb984c0eacfbdcb1b67a2b7b.png",width:6,height:6},{uri:"0da768_d3e25a05cedd404f807528f6a4750388.png",width:56,height:56},{uri:"0da768_95dbd595356148718d5876246a20fe90.png",width:256,height:256},{uri:"0da768_0ffcd1b0986d43b4aaa061b8b17d4040.png",width:6,height:6},{uri:"0da768_0c0d2dc79bc14f6b8275c3b72fec1ab6.png",width:4,height:6},{uri:"0da768_09a75bbb10944eafb4539206b6a3c615.png",width:3,height:3}],k=0;k<i.length;k++)i[k].type="Image",j[k].type="Image";var l=[{value:.25,label:"0.25x"},{value:.5,label:"0.50x"},{value:1,label:f.translate("BGPP_SETTINGS_VIDEO_PLAYBACK_NORMAL")},{value:1.25,label:"1.25x"},{value:1.5,label:"1.50x"},{value:2,label:"2.00x"}],m=[{value:!1,label:"BGPP_SETTINGS_VIDEO_OVERLAY_PATTERN_DARKER"},{value:!0,label:"BGPP_SETTINGS_VIDEO_OVERLAY_PATTERN_LIGHTER"}],n={loop:!0,uri:null,colorOverlay:"#ffffff",colorOverlayOpacity:.2,scrollType:"scroll",playbackSpeed:1};return a.createClass({displayName:"bgVideoSettingsPanel",mixins:[b.mixins.editorAPIMixin,e.linkColorPickerMixin],propTypes:{getData:a.PropTypes.func,undoHandler:a.PropTypes.func,requestChange:a.PropTypes.func,undoOrigins:a.PropTypes.shape({VIDEO_PANEL:a.PropTypes.object})},childContextTypes:{reportUIChange:a.PropTypes.func},getInitialState:function(){this.lastColor="",this.lastColorOpacity=null;var a=this.props.getData();return this.currentPatterns=r(a,this.getEditorAPI()),this.patternState=q(this.currentPatterns),this.thumbPatternOptions=this.fillThumbPatternOptions(this.currentPatterns),null},getChildContext:function(){return{reportUIChange:this.onUIChange}},onUIChange:function(a){"slider"===a.toLowerCase()&&this.props.undoHandler(this.props.undoOrigins.VIDEO_PANEL)},linkedPatternOption:function(a,b){return{value:b&&b.uri||null,requestChange:function(b){if(b){var d=c.find(this.currentPatterns,{uri:b});this.patternState=q(this.currentPatterns),a.ref.imageOverlay=a.ref.imageOverlay||{},c.assign(a.ref.imageOverlay,d)}else a.ref.imageOverlay=null;o(this.getEditorAPI(),this.patternState),this.props.requestChange(a,this.props.undoOrigins.VIDEO_PANEL),p(this.getEditorAPI())}.bind(this)}},applyInversePattern:function(a,b){return{value:this.patternState,requestChange:function(d){var e=c.findIndex(this.currentPatterns,{uri:b.uri});this.currentPatterns=d?j:i,this.fillThumbPatternOptions(this.currentPatterns),c.assign(a.ref.imageOverlay,this.currentPatterns[e]),this.patternState=d,o(this.getEditorAPI(),d),this.props.requestChange(a,this.props.undoOrigins.VIDEO_PANEL),p(this.getEditorAPI())}.bind(this)}},isColorOverlay:function(a){return!c.isEmpty(a.ref.colorOverlay)&&c.isNumber(a.ref.colorOverlayOpacity)},applyOverlayColor:function(a){return{value:this.isColorOverlay(a),requestChange:function(b){b?(a.ref.colorOverlay=this.lastColor?this.lastColor:a.ref.color,a.ref.colorOverlayOpacity=c.isNumber(this.lastColorOpacity)?this.lastColorOpacity:n.colorOverlayOpacity):(this.lastColor=a.ref.colorOverlay,this.lastColorOpacity=a.ref.colorOverlayOpacity,a.ref.colorOverlay="",a.ref.colorOverlayOpacity=0),this.props.requestChange(a,this.props.undoOrigins.VIDEO_PANEL),p(this.getEditorAPI())}.bind(this)}},linkColorWithOpacity:function(a,b){return{value:{color:b.colorOverlay.replace(/[\{\}]/g,""),alpha:b.colorOverlayOpacity},requestChange:function(c){b.colorOverlay=/color_/.test(c.color)?"{"+c.color+"}":c.color,
b.colorOverlayOpacity=c.alpha,this.props.requestChange(a),p(this.getEditorAPI())}.bind(this)}},getColorPickerProps:function(){return{colorResolver:this.resolveColor,openColorPicker:this.openColorPicker,previewOnHover:!0,useMouseEvent:!0,enableHistory:!0}},shouldComponentUpdate:function(a){var b=a.getData();return b.ref.mediaRef&&"WixVideo"===b.ref.mediaRef.type?!0:(d.panelManager.closePanelByName(a.panelName),!1)},linkedBackgroundData:function(a,b,c){return{value:b&&"undefined"!=typeof b[c]?b[c]:n[c],requestChange:function(d){b[c]=d,this.props.requestChange(a,this.props.undoOrigins.VIDEO_PANEL),p(this.getEditorAPI())}.bind(this)}},getPlaybackOptions:function(){return l},fillThumbPatternOptions:function(a){return c.forEach(a,function(b,c){h[c+1].value=a[c].uri}),h},getInvertPatternOption:function(){return m},render:g})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanelPageItem.rt",["react/addons","lodash","baseUI","symbols","core"],function(a,b,c,d,e){"use strict";function f(){var f=this.props.page,g=this.initialBgData,h=this.getCurrentPageData(),i=this.getEditorAPI();return a.createElement("div",{className:b.keys(b.pick(this.getItemClassNames(f),b.identity)).join(" ")},a.createElement("label",{className:"item-label"},g?a.createElement(c.toggle,{name:"checkbox",labelAfterSymbol:!0,key:"normal-checkbox",className:"bg-apply-checkbox",value:this.state.checked,onChange:this.handleToggleChanged,disabled:this.isCurrentPage()}):null,g?a.createElement("span",{className:"page-preview",key:"page-preview",style:this.getBgImageUrl(this.state.checked?h:g)},this.getMediaType(this.state.checked?h.ref:this.initialBgData.ref)===this.mediaTypes.VIDEO?a.createElement("div",{key:"page-preview-video-controls",className:"page-preview-video-controls"},a.createElement(c.symbol,{name:"bgVideoIndicator"})):null):null,a.createElement("span",{className:"page-name"},f.label,"\n            ",a.createElement("span",{className:"page-info"},f.pageData&&i.pages.isHomePage(f.pageData.id)?a.createElement(d.symbol,{name:"pageItemHomeIcon",key:"isHome"}):null,f.pageData&&e.utils.tpaTypeUtils.isTPA(f.pageData)&&!e.utils.tpaTypeUtils.isTPASpecialPage(i,f.pageData)?a.createElement(d.symbol,{name:"actionButtonSpecialPages",key:"isTpaPage"}):null,f.pageData&&e.utils.blogTypeUtils.isBlogSectionPage(i,f.pageData)?a.createElement(d.symbol,{name:"actionButtonBlogPages",key:"isBlogPage"}):null,f.type.isLink?a.createElement(d.symbol,{name:"pageItemLinkIcon",key:"isLink"}):null,f.type.isDropdown?a.createElement(d.symbol,{name:"pageItemDropdownIcon",key:"isDropDown"}):null,f.isVisible?null:a.createElement(d.symbol,{name:"pageItemHideIcon",key:"isHidden"})))))}return function(){return f.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanelPageItem",["react","core","lodash","util","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanelPageItem.rt"],function(a,b,c,d,e){"use strict";var f=d.imageTransform,g=d.backgroundPanelUtils,h=g.getMediaTypes(),i=50,j=35;return a.createClass({mixins:[b.mixins.editorAPIMixin,a.addons.LinkedStateMixin],displayName:"bgApplyPanelPageItem",propTypes:{page:a.PropTypes.object.isRequired,itemBgData:a.PropTypes.object,currentPageBgData:a.PropTypes.object,valueLink:a.PropTypes.func,currentPageId:a.PropTypes.string,isCurrentPage:a.PropTypes.bool,isSubMenu:a.PropTypes.bool,isSubMenuLast:a.PropTypes.bool},mediaTypes:h,getInitialState:function(){return this.initialBgData=this.props.itemBgData,{checked:this.isCurrentPage()}},componentWillReceiveProps:function(a){this.isValueChanged(a)&&this.setState({checked:a.valueLink.value})},componentStateChanged:function(){this.props.valueLink.requestChange(this.state.checked,this.props.page.pageData.id,this.initialBgData)},handleToggleChanged:function(a){this.setState({checked:a},this.componentStateChanged)},shouldComponentUpdate:function(a,b){return!this.isCurrentPage()&&(this.isCheckedStateChanged(b)||this.isValueChanged(a))},isValueChanged:function(a){return null!==a.valueLink.value&&this.props.valueLink.value!==a.valueLink.value},isCheckedStateChanged:function(a){return a.checked!==this.state.checked},isCurrentPage:function(){return this.props.isCurrentPage},getItemClassNames:function(a){return{"bg-apply-panel-item":!0,"item-hidden":!a.isVisible,"current-page":this.isCurrentPage(),"item-first-level":!this.props.isSubMenu,"item-second-level":this.props.isSubMenu,"item-second-level-last":this.props.isSubMenuLast,"item-is-page":a.type.isPage}},getMediaType:function(a){return g.getMediaType(a)},getCurrentPageData:function(){return this.props.currentPageBgData},getBgImageUrl:function(a){var b=g.getColorValue(this.getEditorAPI(),a.ref.color),e={backgroundColor:b},k=this.getMediaType(a.ref);if(k!==h.COLOR){var l=k===h.IMAGE?a.ref.mediaRef:a.ref.mediaRef.posterImageRef,m=g.isSmallerFromContainer(l.width,l.height,i,j),n=g.getImageDisplayData(m?f.fittingTypes.TILE:f.fittingTypes.SCALE_TO_FILL,a.ref.alignType,l.uri,l.width,l.height,i,j);e.backgroundImage="url("+d.url.joinURL(g.MEDIA_URL_PREFIX,n.uri)+")",c.assign(e,n.css.container)}return e},render:e})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanel.rt",["react/addons","lodash","util","baseUI","panels","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanelPageItem","symbols"],function(a,b,c,d,e,f,g){"use strict";function h(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function i(c,d,e,g,h){return a.createElement("li",{key:"page"+e+"subPage"+h},a.createElement(f,b.assign({},{valueLink:this.pagesStateChange(),ref:"page"+e+"subPage"+h},this.getSubPagesProps(g,h,d.items.length-1))))}function j(c,d,e){return a.createElement("li",{key:"page"+e},a.createElement(f,b.assign({},{valueLink:this.pagesStateChange(),ref:"page"+e},this.getPagesProps(d))),d.items.length?a.createElement.apply(this,["ul",{key:"pageItems"},b.map(d.items,i.bind(this,c,d,e))]):null)}function k(){var f=this.props.getData();return a.createElement(e.frames.bgSubPanelFrame,h({helpId:"18df7de7-066e-49e6-b005-f01c72d4f680",className:"bg-apply-panel background-sub-panel",label:"BGPP_SETTINGS_APLLY_PANEL_HEADER_TITLE"},b.omit(this.props,"children")),a.createElement("div",{className:"bg-apply-panel-wrapper"},a.createElement("div",{className:"bg-apply-panel-description"},"\n            ",c.translate("BGPP_SETTINGS_APLLY_PANEL_DESCRIPTION"),"\n        "),a.createElement("div",{className:"bg-apply-panel-all"},a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"bg-apply-checkbox",value:this.state.markAllPagesDisplay,onChange:this.handleSelectAllChange,indeterminate:this.state.indeterminate,label:"BGPP_SETTINGS_APLLY_TO_ALL"})),a.createElement(d.customScroll,{},a.createElement("div",{className:"bg-apply-panel-scrollbox bg-settings-panel-scrollbox"},a.createElement.apply(this,["ul",{className:"bg-apply-panel-scrollbox-list"},b.map(this.siteMenuItems,j.bind(this,f))])))))}return function(){return k.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanel",["react","lodash","panels","util","rEditor/utils/menuItemsRepository","core","pagesMenu","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanel.rt"],function(a,b,c,d,e,f,g,h){"use strict";function k(a,c,d,e){return c=c||[],b.forEach(a,function(a){if(a.pageData&&(c.push(a),b.includes(d,a.pageData.id))){var f=this.getEditorAPI().mainMenu.convertPagesDataListToMenuItemsList(i.getSpecialPagesListBySectionPageOrBySibling(this.getEditorAPI(),a.pageData),e);k.call(this,f,c,d,e)}k.call(this,a.items,c,d,e)},this),b.uniq(c,"id")}function l(a,c){var j,d=!1,e=c.mainMenu.getMenu(),g=c.pages.getPagesData(),h=i.getSectionPagesIds(c,g);b.forEach(a,function(a){var k;if(a.pageData&&b.includes(h,a.pageData.id)){if(k=f.utils.tpaTypeUtils.isTPA(a.pageData),d&&k)return;j=c.mainMenu.convertPagesDataListToMenuItemsList(i.getSpecialPagesListBySectionPageOrBySibling(c,a.pageData,g),e),a.items=a.items.concat(j),k&&(d=!0)}})}function m(a,b){var c=a.isMobileEditor()?"mobile":"desktop",d=a.pages.background.get(b,c);return d}function n(a,c,d,e){var f;b.forEach(e,function(e){f=e.checked?o(b.cloneDeep(d),e.pageId,c):o(b.cloneDeep(e.originalPageBgData),e.pageId,c),a.requestChange(f,null,e.pageId)}),e.length>0&&a.undoHandler(a.undoOrigins.APPLY_PANEL)}function o(a,b,c){var d=c.isMobileEditor()?"mobile":"desktop",e=c.pages.background.get(b,d);return a.ref.mediaRef&&e.ref.mediaRef&&a.ref.mediaRef.type===e.ref.mediaRef.type?(a.ref.mediaRef.id=e.ref.mediaRef.id,"WixVideo"===a.ref.mediaRef.type&&(a.ref.mediaRef.posterImageRef.id=e.ref.mediaRef.posterImageRef.id,a.ref.imageOverlay&&(a.ref.imageOverlay.id=e.ref.imageOverlay&&e.ref.imageOverlay.id))):a.ref.mediaRef?(delete a.ref.mediaRef.id,"WixVideo"===a.ref.mediaRef.type&&(delete a.ref.mediaRef.posterImageRef.id,a.ref.imageOverlay&&delete a.ref.imageOverlay.id)):(a.ref.mediaRef=null,a.ref.colorOverlay="",a.ref.imageOverlay=null),a.ref.id=e.ref.id,a}var i=g.specialPages.menuLogic,j=d.bgPanelBiEvents;return a.createClass({displayName:"backgroundApplyPanel",mixins:[c.mixins.panelFrameMixin,f.mixins.editorAPIMixin,d.draggableMixin,a.addons.LinkedStateMixin],getInitialState:function(){return this.selectedItems=[],this.appliedPages=[],this.currentPageId=this.getEditorAPI().pages.getCurrentPageId(),this.currentPageBgData=m(this.getEditorAPI(),this.currentPageId),this.siteMenuItems=this.getTrimmedMenuItems(),this.flatSitePages=this.getFlatPagesList(),this.itemsProps=this.getItemsProps(),{markAllPagesDisplay:!1,indeterminate:!1}},shouldComponentUpdate:function(a,b){return this.state.markAllPagesDisplay!==b.markAllPagesDisplay||this.state.indeterminate!==b.indeterminate||this.appliedPages.length>0},updatePages:function(){n(this.props,this.getEditorAPI(),this.currentPageBgData,this.appliedPages),this.appliedPages=[]},componentWillUnmount:function(){j.applyToOtherClosed(this.getEditorAPI(),f.bi.events.backgroundPanel.panel_apply_to_other_pages_ok,{all_pages_selected:(this.flatSitePages.length===this.selectedItems.length+1).toString(),num_unselected_pages:this.flatSitePages.length-this.selectedItems.length,num_selected_pages:this.selectedItems.length})},handleSelectAllChange:function(a){b.forEach(this.itemsProps,function(c){var d=c.page.pageData.id;d!==this.currentPageId&&(a?b.includes(this.selectedItems,d)||(this.selectedItems.push(d),this.appliedPages.push({checked:a,originalPageBgData:c.itemBgData,pageId:d})):b.includes(this.selectedItems,d)&&(b.pull(this.selectedItems,d),this.appliedPages.push({checked:a,originalPageBgData:c.itemBgData,pageId:d})))},this),this.setState({markAllPagesDisplay:a,indeterminate:!1},this.updatePages)},pagesStateChange:function(){var a=null;return this.flatSitePages.length===this.selectedItems.length+1&&(a=!0),0===this.selectedItems.length&&(a=!1),{value:a,requestChange:function(a,c,d){a&&c!==this.currentPageId?b.includes(this.selectedItems,c)||this.selectedItems.push(c):b.pull(this.selectedItems,c),this.appliedPages.push({checked:a,originalPageBgData:d,pageId:c});var e=this.flatSitePages.length===this.selectedItems.length+1,f=!e&&this.selectedItems.length>0;if(e!==this.state.markAllPagesDisplay||f!==this.state.indeterminate){var g={markAllPagesDisplay:e,indeterminate:f};this.setState(g,this.updatePages)}else this.updatePages()}.bind(this)}},getFlatPagesList:function(){var a=this.getEditorAPI(),b=a.pages.getPagesData(),c=a.mainMenu.getMenuItemsTreeForMainMenu(b),d=i.getSectionPagesIds(a,b),e=a.mainMenu.getMenu();return k.call(this,c,[],d,e)},getTrimmedMenuItems:function(){var a=this.getMenuItemsTreeWithPagesOnly();return l(a,this.getEditorAPI()),a},getMenuItemsTreeWithPagesOnly:function(){var a=this.getEditorAPI(),b=function(b,c){return c&&!i.isSpecialPage(a,c)||!c&&b.items.length>0};return a.mainMenu.extendMenuItemsTreeWithPageData(a.pages.getPagesData(),b)},getItemsProps:function(){var a=[];return b.forEach(this.flatSitePages,function(b){a.push({page:b,currentPageId:this.currentPageId,currentPageBgData:this.currentPageBgData,itemBgData:m(this.getEditorAPI(),b.pageData.id),isCurrentPage:this.currentPageId===(b.type.isPage&&b.pageData.id)})},this),a},getPagesProps:function(a){var c=b.find(this.itemsProps,{page:{id:a.id}});return c||(c={page:a}),c},getSubPagesProps:function(a,c,d){var e=b.find(this.itemsProps,{page:{id:a.id}});return e.isSubMenu=!0,e.isSubMenuLast=c===d,e},render:h})}),define("rEditor/rootComps/panels/siteSettings/siteSettingsPanel.rt",["react/addons","lodash","baseUI","panels"],function(a,b,c,d){"use strict";return function(){return a.createElement(d.frames.focusPanelFrame,{panelName:this.props.panelName,width:"1210",height:"90%",shouldHideHeader:!0,className:"site-settings-panel"},a.createElement("iframe",{ref:"siteSettingsFrame",width:"100%",height:"100%",src:this.getSettingsIframeUrl(),frameBorder:"0"}),a.createElement(c.preloader,{className:b.keys(b.pick({hidden:!this.state.showLoader},b.identity)).join(" ")}))}}),define("rEditor/rootComps/panels/siteSettings/siteSettingsPanel",["react","core","lodash","panels","rEditor/rootComps/panels/siteSettings/siteSettingsPanel.rt"],function(a,b,c,d,e){"use strict";function h(a){return c.isObject(a)&&!c.isEmpty(a.action)&&c.isString(a.action)}function i(a){var b=this.refs.siteSettingsFrame.getDOMNode();b.contentWindow.postMessage(JSON.stringify(a),"*")}function j(a,b){var d=a.action;switch(d){case f.GET_METATAGS:i.call(this,{payload:b.seo.headTags.get(),callId:a.callId});break;case f.SET_METATAGS:b.seo.headTags.set(a.value,c.noop,c.noop);break;case f.NOTIFY_SITENAME_CHANGED:b.siteName.set(a.value);break;case f.CLOSE:this.close();break;case f.OPEN_HELP:this.openHelpCenter()}}var f={CLOSE:"CLOSE",OPEN_HELP:"OPEN_HELP",SET_METATAGS:"SET_METATAGS",GET_METATAGS:"GET_METATAGS",NOTIFY_SITENAME_CHANGED:"NOTIFY_SITENAME_CHANGED"},g=["https://www.wix.com","http://www.wix.com"];return a.createClass({displayName:"siteSettingsPanel",render:e,mixins:[b.mixins.editorAPIMixin,d.mixins.panelFrameMixin],propTypes:{tab:a.PropTypes.string},getInitialState:function(){return{showLoader:!0}},getDefaultProps:function(){return{tab:"overview"}},componentWillMount:function(){window.addEventListener("message",this.handlePostMessage,!1)},componentWillUnmount:function(){window.removeEventListener("message",this.handlePostMessage,!1)},componentDidMount:function(){this.refs.siteSettingsFrame.getDOMNode().addEventListener("load",this.hideLoader)},handlePostMessage:function(a){var d=this.getEditorAPI();if(c.includes(g,a.origin)&&!c.isEmpty(a.data)&&c.isString(a.data))try{this.hideLoader();var e=JSON.parse(a.data);h(e)&&j.call(this,e,d)}catch(f){d.bi.error(b.bi.errors.SITE_SETTINGS_JSON_PARSE_ERROR,{dsc:'message: "'+f.message+'" data: "'+a.data+'"',errscp:this.constructor.displayName})}},getSettingsIframeUrl:function(){var a=this.getEditorAPI(),b=a.generalInfo.getMetaSiteId();return"https://wix.com/my-account/sites/"+b+"/site-settings/"+this.props.tab+"/?mode=editor-dialog"},hideLoader:function(){this.state.showLoader&&this.setState({showLoader:!1})}})}),define("rEditor/rootComps/topBar/menuBar/menuBarItem.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(a){this.props.onHover(this.props.menuItem,this.props.index)}function e(){var c=this.getCounter();return a.createElement("li",{className:b.keys(b.pick(this.getClasses(),b.identity)).join(" ")},a.createElement("a",{onClick:this.onClick,onMouseEnter:d.bind(this,c)},a.createElement("label",{className:"menu-bar-item-label"},this.props.isCheckbox?a.createElement("input",{key:"checkItemInput",ref:"checkboxInput",disabled:this.props.isDisabled&&this.props.isDisabled(),type:"checkbox",className:"menu-bar-item-checkbox",checked:this.props.viewTools[this.props.menuPropsKey],onChange:this.handleCheckChange}):null,"\n                ",this.props.label,"\n                ",a.createElement("span",{className:"shortcut"},this.props.shortcutLabel),c?a.createElement("div",{key:"counter",className:"item-counter"},c):null)))}return function(){return a.createElement(c.tooltip,{value:this.getTooltipText(),alignment:c.uiConstants.TOOLTIP.ALIGNMENT.RIGHT,disabled:!this.getTooltipText()},e.apply(this,[]))}}),define("rEditor/rootComps/topBar/menuBar/menuBarItem",["react","lodash","core","rEditor/rootComps/topBar/menuBar/menuBarItem.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"menuBarItem",propTypes:{action:a.PropTypes.func,bi:a.PropTypes.oneOfType([a.PropTypes.array,a.PropTypes.object]),disabled:a.PropTypes.bool,index:a.PropTypes.number,editorAPI:a.PropTypes.object,isCheckbox:a.PropTypes.bool,shortcutLabel:a.PropTypes.string,label:a.PropTypes.string,menuPropsKey:a.PropTypes.string,closeDropDownHandle:a.PropTypes.func,viewTools:a.PropTypes.object,className:a.PropTypes.string,isSelected:a.PropTypes.bool,getCounter:a.PropTypes.func},componentDidUpdate:function(a){!a.isSelected&&this.props.isSelected&&this.props.onHover(this.props.menuItem,this.props.index)},getClasses:function(){var a={"menu-bar-item":!0,"menu-bar-item-action":!0,"menu-bar-item-action-selected":this.props.isSelected,"enabled-item":!this.props.disabled,"menu-bar-item-separator":this.props.separator};return this.props.className&&(a[this.props.className]=!0),a},handleCheckChange:function(a){var b=a.target.checked;this.executeAction(b)},onClick:function(){this.props.isCheckbox||this.executeAction()},sendBI:function(){if(this.props.editorAPI&&this.props.bi){var a=[].concat(this.props.bi),c=this.props.editorAPI;b.forEach(a,function(a){c.bi.event(a.type,a.fields)},this)}},executeAction:function(a){var b=this.props.action;if(b&&!this.props.disabled)if(this.sendBI(),this.props.isCheckbox){var c=void 0!==a?a:!this.refs.checkboxInput.getDOMNode().checked;b(c)}else b(),this.props.closeDropDownHandle()},getCounter:function(){return b.isFunction(this.props.getCounter)&&this.props.getCounter()},getTooltipText:function(){return this.props.editorAPI.tooltipTextService.getSelectedComponentTooltipText(this.props.menuItem.key)},render:d})}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/menuActionsPanel.rt",["react/addons","lodash","rEditor/rootComps/topBar/menuBar/menuBarItem"],function(a,b,c){"use strict";function d(d,e){return a.createElement(c,b.assign({},{ref:d.key,key:d.key,isSelected:e===this.state.selectedMenuItemIndex,menuItem:d,index:e},this.getItemProps(d)))}return function(){return a.createElement("div",{className:"menubar-actions-panel"},a.createElement.apply(this,["ul",{},b.map(this.getSelectedMenuChildren(this.props.selectedMenu),d.bind(this))]))}}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/menuActionsPanel",["react","lodash","util","panels","rEditor/rootComps/topBar/menuBar/menuBarItemsDefinitions","rEditor/rootComps/topBar/dropPanels/menuPanels/menuActionsPanel.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"menuActionsPanel",PropTypes:{selectedMenu:a.PropTypes.object.isRequired,onMenuItemHover:a.PropTypes.func,closeDropDownHandle:a.PropTypes.func},mixins:[d.mixins.statefulKeyboardContextMixin],keyboardShortcutsContextNamePrefix:"TOP_BAR_DROP_PANEL_",getInitialState:function(){return{selectedMenuItemIndex:null}},componentWillReceiveProps:function(a){this.props.selectedMenu.key!==a.selectedMenu.key&&this.setState({selectedMenuItemIndex:null})},getItemProps:function(a){var c=e[a.key];if(c){var d=this.isMenuItemDisabled(c,a.key),f=this.getLabel(c),g=this.props.viewTools,h={disabled:d,onHover:function(a,b){this.props.onMenuItemHover&&this.props.onMenuItemHover(a),this.setState({selectedMenuItemIndex:b})}.bind(this),label:f,closeDropDownHandle:this.props.closeDropDownHandle,viewTools:g,editorAPI:this.props.editorAPI},i=b.clone(c);return b.assign(i,h),i}return null},getSelectedMenuChildren:function(a){var c=a&&a.children||[];return c&&(c=b.filter(c,this.isMenuBarItemShowing,this)),c},getItemVisibility:function(a){var b=e[a.key];return b?!b.visibilityFunc||b.visibilityFunc():!1},isMenuBarItemShowing:function(a){return this.getItemVisibility(a)},getLabel:function(a){return a.labelFunc&&a.labelFunc()||a.label},isMenuItemDisabled:function(a,c){var d=this.props.editorAPI;if("PASTE"===c)return!d.clipboardContainsComp()||!d.isDesktopEditor();var e=!1;if(a.compActionRestrictionNames){var f=d.getCompRestrictions(d.selection.getSelectedComponents()),g=a.compActionRestrictionNames||[];e=e||b(g).map(function(a){return!!f[a]}).indexOf(!1)>-1}return!e&&a.disabledChecker&&(e=a.disabledChecker()),e},getNumberOfMenuItems:function(){return this.getSelectedMenuChildren(this.props.selectedMenu).length},getKeyboardShortcuts:function(){var a=this,b=c.keyboardShortcuts.CONTEXTS.MENU_BAR,d=c.keyboardShortcuts.extendContext(b,{up:function(b){var d,c=a.state.selectedMenuItemIndex;d=null===c||0===c?a.getNumberOfMenuItems()-1:c-1,a.setState({selectedMenuItemIndex:d}),b.preventDefault()},down:function(b){var d,c=a.state.selectedMenuItemIndex;d=null===c?0:(c+1)%a.getNumberOfMenuItems(),a.setState({selectedMenuItemIndex:d}),b.preventDefault()},enter:function(b){var c=a.state.selectedMenuItemIndex;if(null!==c){var d=a.getSelectedMenuChildren(a.props.selectedMenu)[c].key,e=a.refs[d];e.executeAction&&e.executeAction()}b.preventDefault()}});return d},render:f})}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/promotionPanel.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){var b=this.props.menuKey.toLowerCase(),d=this.props.classes;return a.createElement("div",{className:"menu-bar-promotion-box",style:this.props.style,onClick:this.onClick},a.createElement("div",{className:"graphics-container "+(d.graphics||"graphics-"+b),key:b},this.props.image?a.createElement("img",{key:"promotionImage",src:this.props.image}):null,this.props.symbol?a.createElement(c.symbol,{key:"promotionSymbol",name:this.props.symbol}):null),this.props.title?a.createElement("div",{key:"title",className:d.title||"title"},this.translateIfNeeded(this.props.title)):null,this.props.message?a.createElement("div",{key:"msg",className:d.message||"message",dangerouslySetInnerHTML:{__html:this.translateIfNeeded(this.props.message)}}):null)}return function(){return d.apply(this,[])}}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/promotionPanel",["react","lodash","util","rEditor/rootComps/topBar/dropPanels/menuPanels/promotionPanel.rt"],function(a,b,c,d){"use strict";function e(a,c){if(a&&c){var d=b.cloneDeep(c);b.forEach(d,function(b){b.fields&&b.fields.category&&(b.fields.category+="(Image)"),a.bi.event(b.type,b.fields)})}}return a.createClass({displayName:"promotionPanel",mixins:[c.translationMixin],propTypes:{menuKey:a.PropTypes.string.isRequired,image:a.PropTypes.string,symbol:a.PropTypes.string,title:a.PropTypes.string,message:a.PropTypes.string,action:a.PropTypes.func,bi:a.PropTypes.oneOfType([a.PropTypes.array,a.PropTypes.object]),classes:a.PropTypes.object,editorAPI:a.PropTypes.object},getDefaultProps:function(){return{classes:{}}},onClick:function(){this.props.action&&(this.props.action(null,!0),e(this.props.editorAPI,b.compact([].concat(this.props.bi))))},render:d})}),define("rEditor/rootComps/topBar/dropPanels/dropPanels",["rEditor/rootComps/topBar/dropPanels/menuPanels/menuActionsPanel","rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel","rEditor/rootComps/topBar/dropPanels/menuPanels/promotionPanel"],function(a,b,c){"use strict";return{menuActionsPanel:a,checkListPanel:b,promotionPanel:c}}),define("rEditor/rootComps/panels/editorVersionInfoPanel/editorVersionInfoPanel.rt",["react/addons","lodash","baseUI","panels","util"],function(a,b,c,d,e){"use strict";return function(){return a.createElement(d.frames.focusPanelFrame,{ref:"frame",panelName:this.props.panelName,title:"Editor Version Info",frameClassName:"editorVersionInfoPanel"},a.createElement("div",{className:"content"},a.createElement("div",{className:"row"},a.createElement("label",{},"Editor Version:"),a.createElement("span",{},this.getEditorVersion())),a.createElement("div",{className:"row"},a.createElement("label",{},"Viewer Version:"),a.createElement("span",{},this.getViewerVersion()))),a.createElement("div",{className:"panel-footer"},a.createElement(c.button,{type:"button",shouldTranslate:!1,label:"OK",className:"done-button",onClick:this.close})))}}),define("rEditor/rootComps/panels/editorVersionInfoPanel/editorVersionInfoPanel",["react","util","jquery","rEditor/rootComps/panels/editorVersionInfoPanel/editorVersionInfoPanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"editorVersionInfoPanel",panelName:"editorVersionInfoPanel",getEditorVersion:function(){return b.editorModel.editorVersion||"unknown"},getViewerVersion:function(){var a=c("#preview")[0];return a?a.contentWindow.siteModel.baseVersion||"unknown":"unknown"},close:function(){this.refs.frame&&this.refs.frame.close()},render:d})}),define("rEditor/rootComps/panels/applyStylePanel/applyStylePanel.rt",["react/addons","lodash","panels","baseUI","util","symbols","addPanelInfra"],function(a,b,c,d,e,f,g){"use strict";return function(){return a.createElement(c.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"apply-style-panel",onConfirm:this.onConfirm,onCancel:this.onCancel,shouldHideHeader:!0,confirmLabel:"COPY_DESIGN_APPLY",ref:"frame",cancelLabel:"COPY_DESIGN_APPLY_CANCEL"},a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:this.close},a.createElement(f.symbol,{name:"headerCloseButton"})),a.createElement("button",{className:"help",onClick:this.openHelpCenter,key:"help"},"?"),a.createElement("span",{className:"title"},e.translate("COPY_DESIGN_TITLE")),a.createElement("span",{className:"subtitle"},e.translate("COPY_DESIGN_DESCRIPTION_LINE1"))),a.createElement("div",{className:"panel-content"},a.createElement("div",{className:"current-style-container container-wrapper"},a.createElement("div",{className:"current-style-header header"},a.createElement("span",{className:"text"},e.translate("COPY_DESIGN_LABEL_LEFT"))),a.createElement("div",{className:"current-style comp-container"},a.createElement(g.designPanelLiveComponentSection,this.getSelectedCompProps()))),a.createElement("div",{className:"applied-styles-container container-wrapper"},this.getThemeAndPersonalizeStylesToRender().length>0?a.createElement("div",{key:"applyStyleHeader",className:"applied-styles-header header"},a.createElement("span",{className:"text"}," ",e.translate("COPY_DESIGN_LABEL_RIGHT"))):null,a.createElement(d.customScroll,{},a.createElement("div",{className:"comp-themed-styles comp-container"},this.getThemeAndPersonalizeStylesToRender().length>0?a.createElement(g.designPanelLiveComponentSection,b.assign({},{key:"appliesStylesLiveSections"},this.getThemeAndPersonalizeStylesProps())):null,0===this.getThemeAndPersonalizeStylesToRender().length?a.createElement("div",{className:"empty-styles",key:"emptyStylesKey"},a.createElement(f.symbol,{name:"nothingToEditASP"}),a.createElement("div",{className:"empty-style-text text"},e.translate("COPY_DESIGN_EMPTY_LABEL"))):null)))))}}),define("rEditor/rootComps/panels/applyStylePanel/applyStylePanel",["react","lodash","core","panels","experiment!se_studioCopyDesign","rEditor/rootComps/panels/applyStylePanel/applyStylePanel.rt"],function(a,b,c,d,e,f){"use strict";function o(a,d){var e=a.style||a.styleId;return b.isString(e)&&(e=c.styleManager.getStyleById(d.theme,d.components,e)),e}function p(a,d){var e=b.union([d],n[d]),f=b.map(e,function(d){return b.pluck(c.styleManager.getThemedStyleForComp(a.theme,a.components,d),"id")});return b(f).union().flatten().value()}function q(a,d){var e=b.pluck(c.styleManager.getUniqueCustomStyleList(a.theme,a.components,d),"id");return n[d]&&b.forEach(n[d],function(d){var f=b.pluck(c.styleManager.getUniqueCustomStyleList(a.theme,a.components,d),"id");e=e.concat(f)}),e}function r(a,d){var e=b.pluck(c.styleManager.getUniqueStyleList(a.theme,a.components,d),"id");return n[d]&&b.forEach(n[d],function(d){var f=b.pluck(c.styleManager.getUniqueStyleList(a.theme,a.components,d),"id");e=e.concat(f)}),e}function s(a){return m[a]&&m[a].compOverrideType?m[a].compOverrideType:a}function t(a,c,d,e,f,l){var n={additionalBehaviours:{iconEnabledForComps:[],infoIcon:"none",labelMode:"none"},help:{hide:!0},categoryId:d.substring(d.lastIndexOf(".")+1),hide:!1,id:c,onClick:l,onItemDrag:function(){},parentType:"ADD_PANEL",props:{compTypes:s(d),horizontalMargin:h,verticalMargin:g,scaleProportion:{x:m[d]&&m[d].scale?m[d].scale:i,y:m[d]&&m[d].scale?m[d].scale:i}},showSectionHeader:!1,stylesForSection:e,additionalScaling:1,selectedItemKey:f,getAdditionalElementProps:function(c){var d=o(c,a),e={};return b.includes(j,d.skin)?(e.text="DESIGN_LABEL_NO_COLOR",e.className="design-panel-transparent-skin-item"):b.includes(k,d.skin)&&(e.text="Design_Label_No_Frame",e.className="design-panel-no-frame-skin-item"),e}};return m[d]&&m[d].maxFontSize&&(n.props.maxFontSize=m[d].maxFontSize),n}function u(a,d){return b.filter(a,function(a){var e=c.styleManager.getStyleById(d.theme,d.components,a);return!b.includes(k,e.skin)})}var g=30,h=20,i=1,j=["wysiwyg.viewer.skins.page.TransparentPageSkin","wysiwyg.viewer.skins.screenwidthcontainer.TransparentHalfScreen","wysiwyg.viewer.skins.screenwidthcontainer.TransparentScreen","wysiwyg.viewer.skins.area.TransparentArea"],k=["wysiwyg.viewer.skins.photo.NoSkinPhoto","wysiwyg.viewer.skins.VideoSkin"],l=["wysiwyg.viewer.components.MatrixGallery","wysiwyg.viewer.components.SlideShowGallery","wysiwyg.viewer.components.SliderGallery","wysiwyg.viewer.components.PaginatedGridGallery"],m={"wysiwyg.viewer.components.HeaderContainer":{scale:.5},"wysiwyg.viewer.components.FooterContainer":{scale:.5},"wysiwyg.viewer.components.ScreenWidthContainer":{scale:.5},"mobile.core.components.Page":{compOverrideType:"pageContainer"},"wysiwyg.viewer.components.Video":{scale:.5},"wysiwyg.viewer.components.VerticalLine":{maxFontSize:10},"wysiwyg.viewer.components.FiveGridLine":{maxFontSize:10},fiveGridLineFullWidth:{maxFontSize:10},"wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer":{maxFontSize:10},"wysiwyg.viewer.components.AudioPlayer":{maxFontSize:10},"wysiwyg.viewer.components.menus.DropDownMenu":{maxFontSize:15},"wysiwyg.common.components.verticalmenu.viewer.VerticalMenu":{maxFontSize:15},"wysiwyg.viewer.components.SiteButton":{maxFontSize:22},"mobile.core.components.Container":{scale:.5},"core.components.Container":{scale:.5},"core.components.ContainerOBC":{scale:.5},"wysiwyg.viewer.components.BgImageStrip":{scale:.5},"wysiwyg.viewer.components.ContactForm":{scale:.5},"wysiwyg.common.components.subscribeform.viewer.SubscribeForm":{scale:.5},"wysiwyg.viewer.components.GoogleMap":{scale:.5},"wysiwyg.viewer.components.WPhoto":{scale:.5},"wysiwyg.viewer.components.MatrixGallery":{scale:.25,maxFontSize:12},"wysiwyg.viewer.components.SlideShowGallery":{scale:.25,maxFontSize:12},"wysiwyg.viewer.components.SliderGallery":{scale:.25,maxFontSize:12},"wysiwyg.viewer.components.PaginatedGridGallery":{scale:.25,maxFontSize:12}},n={"mobile.core.components.Container":["core.components.Container","core.components.ContainerOBC"],"core.components.Container":["mobile.core.components.Container","core.components.ContainerOBC"],"core.components.ContainerOBC":["mobile.core.components.Container","core.components.Container"]};return a.createClass({displayName:"applyStylePanel",getInitialState:function(){return{selectedItems:[]}},close:function(){this.refs.frame.close();var a=this.props.editorAPI,b=this.props.selectedComp;a.bi.event(c.bi.events.applyStyle.COPY_STYLE_CANCEL,{component_id:b.id,component_type:a.components.getType(b)})},onCancel:function(){var a=this.props.editorAPI,b=this.props.selectedComp;a.bi.event(c.bi.events.applyStyle.COPY_STYLE_CANCEL,{component_id:b.id,component_type:a.components.getType(b)
})},onConfirm:function(){var a=this.props.editorAPI,d=a.components.style.getId(this.props.selectedComp),f=a.components.getType(this.props.selectedComp),g=c.styleManager.getStyleById(a.theme,a.components,d),h=this.props.selectedComp;a.bi.event(c.bi.events.applyStyle.COPY_STYLE_APPLY,{num_of_styles_chosen:this.state.selectedItems.length,component_id:h.id,component_type:a.components.getType(h)}),b.forEach(this.state.selectedItems,function(d){var h=d.split("."),i=h[h.length-1],j=i.substring(i.indexOf("_")+1),k=c.styleManager.getStyleById(a.theme,a.components,j),l=[k],m=c.styleManager.getDuplicateToStyleList(a.theme,a.components,k,f);b.forEach(n[f],function(b){var d=c.styleManager.getDuplicateToStyleList(a.theme,a.components,k,b,n[f]);m=m.concat(d)}),e&&(m=b.filter(m,{styleType:"custom"})),l=l.concat(m),b.forEach(l,function(b){var c={skin:g.skin,style:g.style,type:b.type};a.theme.styles.update(b.id,c)})})},getSelectedCompProps:function(){var a=this.props.editorAPI,c=this.props.selectedComp,d=a.components.getType(c),e="selectedComp"+c.id,f=a.components.style.getId(c),g=[{styleId:f,compType:s(d)}];return t(a,e,d,g,this.state.selectedItems,b.noop)},getThemeAndPersonalizeStylesProps:function(){var a=this.props.editorAPI,b=this.props.selectedComp,c="themeAndMyForComp"+b.id,d=a.components.getType(b),e=this.themeAndPersonalizedStylesToRender?this.themeAndPersonalizedStylesToRender:this.getThemeAndPersonalizeStylesToRender();return t(a,c,d,e,this.state.selectedItems,this.updateListOfStyleToUpdate)},getThemeAndPersonalizeStylesToRender:function(){if(this.themeAndPersonalizedStylesToRender)return this.themeAndPersonalizedStylesToRender;var a=this.props.editorAPI,d=this.props.selectedComp,f=a.components.getType(d),g=a.components.style.getId(d),h=c.styleManager.getStyleById(a.theme,a.components,g),i=[];i=e?p(a,f):b.includes(l,f)?q(a,f):r(a,f),i=u(i,a);var j=[];return b.forEach(i,function(b){var d=c.styleManager.getStyleById(a.theme,a.components,b),i=b!==g&&!c.styleManager.isEqualWithoutTypeConsideration(d,h);(e||i)&&j.push({compType:s(f),styleId:b})}),this.themeAndPersonalizedStylesToRender=j,j},updateListOfStyleToUpdate:function(a,d,e,f){var g=b.clone(this.state.selectedItems),h=f.split("."),i=h[h.length-1],j=i.substring(i.indexOf("_")+1),k=b.includes(g,f);k?b.remove(g,function(a){return a===f}):g.push(f);var l=this.props.selectedComp,m=this.props.editorAPI;m.bi.event(c.bi.events.applyStyle.COPY_STYLE_CHOOSE_STYLES_TO_REPLACE_CLICK,{style_id:j,status:!k,component_id:l.id,component_type:m.components.getType(l)}),this.setState({selectedItems:g})},openHelpCenter:function(){var a="b853c294-8ff1-418f-b4d2-29d7b59a85c3",b={panel_name:this.props.panelName,component:this.props.editorAPI.selection.getSelectedComponentType(),origin:c.constants.BI.HELP.ORIGIN.PANEL,learn_more:!1};d.panelManager.openHelpCenter(a,null,null,b)},render:f})}),define("rEditor/rootComps/panels/boxSlideShowPanels/boxSlideShowManageSlidesPanel.rt",["react/addons","lodash","baseUI","util","compPanels","helpIds"],function(a,b,c,d,e,f){"use strict";function g(a,b,c,d){this.state.slideRenamingIndex!==c&&this.refs.sortList.startDrag(c,d)}function h(a,b,c){this.setSelected(b,c)}function i(e,f,i){return a.createElement("div",{key:i,className:b.keys(b.pick({"item-list-row":!0,selected:b.isEqual(this.state.selectedSlide,f),compacted:e.length>7},b.identity)).join(" ")},a.createElement("div",{className:"item-details",onMouseDown:g.bind(this,e,f,i),onClick:h.bind(this,e,f,i)},this.state.slideRenamingIndex!==i?a.createElement("div",{key:"slideTitle"},a.createElement(c.symbol,{name:"dragHandle",className:"symbol-dragIcon"}),a.createElement("div",{className:"slide-name"},this.getSlideName(f)),a.createElement(c.dropDown.contextMenu,{icon:"moreRegular",className:"quick-actions",shouldTranslate:!1,onChange:this.handleSlideAction.bind(this,f,i)},a.createElement(c.dropDown.option,{value:"rename"},a.createElement(c.symbol,{name:"quickActionsRename"}),"\n                            ",d.translate("Regular_Slideshow_Slides_Rename"),"\n                        "),a.createElement(c.dropDown.option,{value:"duplicate"},a.createElement(c.symbol,{name:"qaDuplicate"}),"\n                            ",d.translate("Regular_Slideshow_Slides_Duplicate"),"\n                        "),e.length>1?a.createElement(c.dropDown.option,{value:"delete",key:"delete"},a.createElement(c.symbol,{name:"qaDelete"}),"\n                            ",d.translate("Regular_Slideshow_Slides_Delete"),"\n                        "):null)):null,this.state.slideRenamingIndex===i?a.createElement(c.textInputWithFixedButton,{key:"slideTitleInput",value:this.getSlideName(f),onChange:this.changeSlideName.bind(this,f),buttonLabel:"Pages_Actions_Rename_Button",maxLength:40,selectOnFocus:!0,validator:d.validate.notEmptyString,invalidMessage:"Box_slide_show_slides_invalid_slide_name"}):null))}function j(){var d=this.getCompSlides();return a.createElement.apply(this,[c.sortByDragList,{className:"sort-list",key:"sortList",ref:"sortList",onItemMoved:this.moveSlide},b.map(d,i.bind(this,d))])}function k(){this.duplicateCurrentSlide()}function l(){this.addNewSlide()}return function(){return a.createElement(e.compPanelFrame,b.assign({},{contentClass:"box-slide-show-manage-slides-panel",title:"Regular_Slideshow_Slides_Title",helpId:f.EXTERNAL.BOX_SLIDE_SHOW_MANAGE_SLIDES},this.getFrameProps()),this.getCompSlides().length?j.apply(this,[]):null,a.createElement("div",{className:"button-wrapper"},a.createElement(c.button,{className:"mainButton",label:"Regular_Slideshow_Slides_Add_Duplicate_Slide",onClick:k.bind(this)}),a.createElement(c.button,{className:"secondaryButton btn-text",label:"Regular_Slideshow_Slides_Add_New_Slide",onClick:l.bind(this)})))}}),define("rEditor/rootComps/panels/boxSlideShowPanels/boxSlideShowManageSlidesPanel",["react","lodash","core","util","compPanels","rEditor/rootComps/panels/boxSlideShowPanels/boxSlideShowManageSlidesPanel.rt"],function(a,b,c,d,e,f){"use strict";var g="Regular_Slideshow_Slides_Copy_Slide_Label",h="Regular_Slideshow_Slides_New_Slide_Label",i="title",j=c.utils.boxSlideShowUtils;return a.createClass({displayName:"boxSlideShowManageSlidesPanel",render:f,mixins:[e.compPanelMixin,d.translationMixin],getInitialState:function(){var a=j.findCurrentSlide(this.getEditorAPI(),this.props.selectedComponent);return{slideRenamingIndex:null,selectedSlide:a,isCurrentlyAddingSlide:!1}},componentWillReceiveProps:function(){var a=j.findCurrentSlide(this.getEditorAPI(),this.props.selectedComponent);b.isEqual(a,this.state.selectedSlide)||this.setState({selectedSlide:a})},addSlide:function(a,c){this.setState({isCurrentlyAddingSlide:!0});var d=this.getEditorAPI(),e=d.components.add(b.first(this.props.selectedComponent),a);d.components.arrangement.moveToIndex(e,c),d.waitForChangesApplied(function(){this.setState({isCurrentlyAddingSlide:!1,selectedSlide:e})}.bind(this))},duplicateCurrentSlide:function(){var a=j.findCurrentSlide(this.getEditorAPI(),this.props.selectedComponent),b=this.getCompSlides().length;this.duplicateSlide(a,b-1)},addNewSlide:function(){if(!this.state.isCurrentlyAddingSlide){var a=this.getEditorAPI(),b=j.findCurrentSlide(this.getEditorAPI(),this.props.selectedComponent),c=a.components.serialize(b);c.components=[];var d=this.getCompSlides().length,e={curr_slide:d+1};c.data[i]=this.translateTemplate(h,e,a),this.addSlide(c,d)}},duplicateSlide:function(a,b){if(!this.state.isCurrentlyAddingSlide){var c=this.getEditorAPI().components.serialize(a),d={curr_slide_title:c.data[i]};c.data[i]=this.translateTemplate(g,d,this.getEditorAPI()),this.addSlide(c,b+1)}},deleteSlide:function(a){this.getCompSlides().length>1&&this.getEditorAPI().components.remove(a)},getCompSlides:function(){return j.getAllSlides(this.getEditorAPI(),this.props.selectedComponent)},moveSlide:function(a,b){var c=this.getEditorAPI();if(a!==b){var d=this.getCompSlides()[a];c.components.arrangement.moveToIndex(d,b)}},getSlideName:function(a){var b=this.getEditorAPI();return b.components.data.get(a)[i]},changeSlideName:function(a,b){var c=this.getEditorAPI();if(this.getSlideName(a)!==b){var d={};d[i]=b,c.components.data.update(a,d),this.setState({slideRenamingIndex:null})}},renameSlide:function(a){this.setState({slideRenamingIndex:a})},handleSlideAction:function(a,b,c){switch(c){case"rename":this.renameSlide(b);break;case"duplicate":this.duplicateSlide(a,b);break;case"delete":this.deleteSlide(a)}},setSelected:function(a,b){var c=this.getEditorAPI();c.components.behaviors.execute(this.props.selectedComponent,"setSlide",{slide:b}),this.setState({selectedSlide:a,slideRenamingIndex:null})}})}),define("rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanelItem.rt",["react/addons","lodash","baseUI","symbols","core"],function(a,b,c,d,e){"use strict";function f(){var d=this.props.slide,e=this.getCurrentSlideData(),f=this.initialBgData;return a.createElement("div",{className:b.keys(b.pick(this.getItemClassNames(d),b.identity)).join(" ")},a.createElement("label",{className:"item-label"},f?a.createElement(c.toggle,{name:"checkbox",labelAfterSymbol:!0,key:"normal-checkbox",className:"bg-apply-checkbox",value:this.state.checked,onChange:this.handleToggleChanged,disabled:this.isCurrentSlide()}):null,f?a.createElement("span",{className:"slide-preview",key:"slide-preview",style:this.getBgImageUrl(this.state.checked?e:f)},this.getMediaType(this.state.checked?e:f)===this.mediaTypes.VIDEO?a.createElement("div",{key:"slide-preview-video-controls",className:"slide-preview-video-controls"},a.createElement(c.symbol,{name:"bgVideoIndicator"})):null):null,a.createElement("span",{className:"slide-name"},this.props.slideTitle)))}return function(){return f.apply(this,[])}}),define("rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanelItem",["react","core","lodash","util","rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanelItem.rt"],function(a,b,c,d,e){"use strict";var f=d.imageTransform,g=d.backgroundPanelUtils,h=g.getMediaTypes(),i=50,j=35;return a.createClass({mixins:[b.mixins.editorAPIMixin,a.addons.LinkedStateMixin],displayName:"slideShowBgApplyPanelItem",propTypes:{slide:a.PropTypes.object.isRequired,slideTitle:a.PropTypes.string.isRequired,itemBgData:a.PropTypes.object,isCurrentSlide:a.PropTypes.bool,currentSlideBgData:a.PropTypes.object,valueLink:a.PropTypes.object},mediaTypes:h,getInitialState:function(){return this.origin=this.props.origin,this.initialBgData=this.props.itemBgData,{checked:this.isCurrentSlide()}},isCurrentSlide:function(){return this.props.isCurrentSlide},componentWillReceiveProps:function(a){this.isValueChanged(a)&&this.setState({checked:a.valueLink.value})},componentStateChanged:function(){this.props.valueLink.requestChange(this.state.checked,this.props.slide,this.initialBgData)},handleToggleChanged:function(a){this.setState({checked:a},this.componentStateChanged)},shouldComponentUpdate:function(a,b){return!this.isCurrentSlide()&&(this.isCheckedStateChanged(b)||this.isValueChanged(a))},isValueChanged:function(a){return null!==a.valueLink.value&&this.props.valueLink.value!==a.valueLink.value},isCheckedStateChanged:function(a){return a.checked!==this.state.checked},getItemClassNames:function(){return{"slideShow-apply-panel-item":!0,"current-slide":this.isCurrentSlide()}},getMediaType:function(a){return g.getMediaType(a)},getCurrentSlideData:function(){return this.props.currentSlideBgData},getBgImageUrl:function(a){var b,e;switch(this.origin){case"strip":e=g.getColorValue(this.getEditorAPI(),a.color),b={backgroundColor:e};var k=this.getMediaType(a);if(k!==h.COLOR){var l=k===h.IMAGE?a.mediaRef:a.mediaRef.posterImageRef,m=g.isSmallerFromContainer(l.width,l.height,i,j),n=g.getImageDisplayData(m?f.fittingTypes.TILE:f.fittingTypes.SCALE_TO_FILL,a.alignType,l.uri,l.width,l.height,i,j);b.backgroundImage="url("+d.url.joinURL(g.MEDIA_URL_PREFIX,n.uri)+")",c.assign(b,n.css.container)}break;case"box":e=g.getColorValue(this.getEditorAPI(),a.style.properties.bg),b={backgroundColor:e}}return b},render:e})}),define("rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanel.rt",["react/addons","lodash","util","baseUI","panels","rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanelItem","helpIds"],function(a,b,c,d,e,f,g){"use strict";function h(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function i(c,d){return a.createElement("li",{key:"slide"+d},a.createElement(f,b.assign({},{valueLink:this.slidesStateChange(),ref:"slide"+d},this.getSlideProps(c))))}return function(){return a.createElement(e.frames.bgSubPanelFrame,h({helpId:g.EXTERNAL.BOX_SLIDE_SHOW_BG_APPLY,className:"slide-show-apply-panel",label:"Regular_Slideshow_Apply_Panel_Header_Title"},b.omit(this.props,"children")),a.createElement("div",{className:"slide-show-apply-panel-wrapper"},a.createElement("div",{className:"slide-show-apply-panel-description"},"\n            ",c.translate("Regular_Slideshow_Apply_Panel_Header_Description"),"\n        "),a.createElement("div",{className:"slide-show-apply-panel-all"},a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"slide-show-apply-checkbox",label:"Regular_Slideshow_Apply_To_All",value:this.state.markAllSlidesDisplay,onChange:this.handleSelectAllChange,indeterminate:this.state.indeterminate})),a.createElement(d.customScroll,{},a.createElement("div",{className:"slide-show-apply-panel-scrollbox slide-show-settings-panel-scrollbox"},a.createElement.apply(this,["ul",{className:"slide-show-apply-panel-scrollbox-list"},b.map(this.allSlides,i.bind(this))])))))}}),define("rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanel",["react","core","lodash","rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanel.rt"],function(a,b,c,d){"use strict";function f(a,b,d,e){var f;c.forEach(b,function(b){switch(f=b.checked?i(c.cloneDeep(a),b):i(c.cloneDeep(b.originalSlideBgData),b),e){case"strip":g(f,b.slide,d);break;case"box":h(f,b.slide,d)}})}function g(a,b,c){var d=c.components.data.get(b);d.background=a,c.components.data.update(b,d)}function h(a,c,d){var e=b.styleManager.getStyleIdByDef(d.theme,d.components,a,d.components.getType(c)),f=d.theme.styles.get(e);d.components.style.update(c,f)}function i(a,b){var c=b.originalSlideBgData;return a.mediaRef&&c.mediaRef&&a.mediaRef.type===c.mediaRef.type?(a.mediaRef.id=c.mediaRef.id,"WixVideo"===a.mediaRef.type&&(a.mediaRef.posterImageRef.id=c.mediaRef.posterImageRef.id,a.imageOverlay&&(a.imageOverlay.id=c.imageOverlay&&c.imageOverlay.id))):a.mediaRef?(delete a.mediaRef.id,"WixVideo"===a.mediaRef.type&&(delete a.mediaRef.posterImageRef.id,a.imageOverlay&&delete a.imageOverlay.id)):(a.mediaRef=null,a.colorOverlay="",a.imageOverlay=null),a.id=c.id,a}var e=b.utils.boxSlideShowUtils;return a.createClass({displayName:"slideShowBgApplyPanel",mixins:[b.mixins.editorAPIMixin],getAllSlides:function(){var a=this.getEditorAPI();return e.getAllSlides(a,a.selection.getSelectedComponents())},getInitialState:function(){var a=this.getEditorAPI();return this.selectedItems=[],this.appliedSlides=[],this.origin=this.props.origin,this.currentSlide=e.findCurrentSlide(a,a.selection.getSelectedComponents()),this.currentSlideBgData=this.getSlideBgData(this.currentSlide),this.allSlides=this.getAllSlides(),this.itemsProps=this.getItemsProps(),{markAllSlidesDisplay:!1,indeterminate:!1}},getSlideBgData:function(a){var b=this.getEditorAPI();switch(this.origin){case"strip":return b.components.data.get(a).background;case"box":var c=b.components.style.getId(a);return b.theme.styles.get(c)}},shouldComponentUpdate:function(a,b){return this.state.markAllSlidesDisplay!==b.markAllSlidesDisplay||this.state.indeterminate!==b.indeterminate||this.appliedSlides.length>0},handleSelectAllChange:function(a){c.forEach(this.itemsProps,function(b){var d=b.slide,e=d.id;e!==this.currentSlide.id&&(a?c.includes(this.selectedItems,e)||(this.selectedItems.push(e),this.appliedSlides.push({checked:a,originalSlideBgData:b.itemBgData,slide:d})):c.includes(this.selectedItems,e)&&(c.pull(this.selectedItems,e),this.appliedSlides.push({checked:a,originalSlideBgData:b.itemBgData,slide:d})))},this),this.setState({markAllSlidesDisplay:a,indeterminate:!1},this.updateSlides)},getItemsProps:function(){var a=[],b=this.getEditorAPI();return c.forEach(this.allSlides,function(c){a.push({slide:c,slideTitle:b.components.data.get(c).title,currentSlideBgData:this.currentSlideBgData,itemBgData:this.getSlideBgData(c),isCurrentSlide:this.currentSlide.id===c.id})},this),a},getSlideProps:function(a){var b=c.find(this.itemsProps,{slide:{id:a.id}});return b.origin=this.origin,b},updateSlides:function(){f(this.currentSlideBgData,this.appliedSlides,this.getEditorAPI(),this.origin),this.appliedSlides=[]},slidesStateChange:function(){var a=null;return this.allSlides.length===this.selectedItems.length+1&&(a=!0),0===this.selectedItems.length&&(a=!1),{value:a,requestChange:function(a,b,d){var e=b.id;a&&e!==this.currentSlide.id?c.includes(this.selectedItems,e)||this.selectedItems.push(e):c.pull(this.selectedItems,e),this.appliedSlides.push({checked:a,originalSlideBgData:d,slide:b});var f=this.allSlides.length===this.selectedItems.length+1,g=!f&&this.selectedItems.length>0;if(f!==this.state.markAllSlidesDisplay||g!==this.state.indeterminate){var h={markAllSlidesDisplay:f,indeterminate:g};this.setState(h,this.updateSlides)}else this.updateSlides()}.bind(this)}},render:d})}),define("rEditor/rootComps/panels/panels",["rEditor/rootComps/panels/pagesPanel","rEditor/rootComps/panels/pagesPanelMobile","rEditor/rootComps/panels/myMediaPanel","rEditor/rootComps/panels/backgroundPanel/backgroundPanel","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgImageSettingsPanel","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgVideoSettingsPanel","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanel","rEditor/rootComps/panels/siteSettings/siteSettingsPanel","rEditor/rootComps/topBar/dropPanels/dropPanels","rEditor/rootComps/panels/editorVersionInfoPanel/editorVersionInfoPanel","rEditor/rootComps/panels/applyStylePanel/applyStylePanel","rEditor/rootComps/panels/boxSlideShowPanels/boxSlideShowManageSlidesPanel","rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanel","rEditor/rootComps/panels/boxSlideShowPanels/slideShowBgApplyPanelItem"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";return{pagesPanel:a,pagesPanelMobile:b,myMediaPanel:c,backgroundPanel:d,bgImageSettingsPanel:e,bgVideoSettingsPanel:f,backgroundApplyPanel:g,siteSettingsPanel:h,topBar:{menuActionsPanel:i.menuActionsPanel,checkListPanel:i.checkListPanel,promotionPanel:i.promotionPanel},editorVersionInfoPanel:j,applyStylePanel:k,boxSlideShowManageSlidesPanel:l,slideShowBgApplyPanel:m,slideShowBgApplyPanelItem:n}}),define("rEditor/rootComps/mixins/rootCompsMixins",["rEditor/rootComps/mixins/hiddenableMixin","rEditor/rootComps/mixins/keepInViewportMixin"],function(a,b){"use strict";return{hiddenableMixin:a,keepInViewportMixin:b}}),define("rEditor",["rEditor/rootComps/editorMain","rEditor/rootComps/editor","rEditor/rootComps/panels/panels","rEditor/app/EditorAPI","rEditor/rootComps/mixins/rootCompsMixins"],function(a,b,c,d,e){"use strict";return{editorMain:a,editorComp:b,panels:c,EditorAPI:d,mixins:e}});