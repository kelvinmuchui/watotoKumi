define("textControls/utils/richTextManager",[],function(){"use strict";var a=[];return{latestCopiedLinks:a}}),define("textControls/utils/constants",["lodash"],function(a){"use strict";var b={h1:{seoTag:"h1",label:"FONT_0_LABEL",tag:"h1",displayName:"text_editor_theme_1",cssClass:"font_0"},h2:{seoTag:"h2",label:"FONT_2_LABEL",tag:"h2",displayName:"text_editor_theme_2",cssClass:"font_2"},h3:{seoTag:"h3",label:"FONT_3_LABEL",tag:"h3",displayName:"text_editor_theme_3",cssClass:"font_3"},h4:{seoTag:"h4",label:"FONT_4_LABEL",tag:"h4",displayName:"text_editor_theme_4",cssClass:"font_4"},h5:{seoTag:"h5",label:"FONT_5_LABEL",tag:"h5",displayName:"text_editor_theme_5",cssClass:"font_5"},h6:{seoTag:"h6",label:"FONT_6_LABEL",tag:"h6",displayName:"text_editor_theme_6",cssClass:"font_6"},p:{seoTag:"p",label:"FONT_7_LABEL",tag:"p",displayName:"text_editor_theme_7",cssClass:"font_7"},div:{seoTag:"p",label:"FONT_8_LABEL",tag:"div",displayName:"text_editor_theme_8",cssClass:"font_8"},address:{seoTag:"p",label:"FONT_9_LABEL",tag:"address",displayName:"text_editor_theme_9",cssClass:"font_9"}};return{MAX_TEXT_LENGTH:6e4,CK_OFF:2,CK_ON:1,IMAGE_WHITE_LIST_ATTRIBUTES:["src","style","wix-comp"],FORBIDDEN_TAGS:["script","iframe","embed","object","meta"],SENSITIVE_ATTRIBUTES:["href","src","style"],FORBIDDEN_TAGS_AND_ATTRIBUTES:["script","iframe","embed","object","meta","expression","id","comp","dataquery","propertyquery","styleid","skin","skinpart","y","x","scale","angle","idprefix","state","container","listposition","hasproxy","vcfield","vcview","vctype","pos","onAbort","onActivate","onAfterPrint","onAfterUpdate","onBeforeActivate","onBeforeCopy","onBeforeCut","onBeforeDeactivate","onBeforeEditFocus","onBeforePaste","onBeforePrint","onBeforeUnload","onBeforeUpdate","onBegin","onBlur","onBounce","onCellChange","onChange","onClick","onContextMenu","onControlSelect","onCopy","onCut","onDataAvailable","onDataSetChanged","onDataSetComplete","onDblClick","onDeactivate","onDrag","onDragEnd","onDragLeave","onDragEnter","onDragOver","onDragDrop","onDragStart","onDrop","onEnd","onError","onErrorUpdate","onFilterChange","onFinish","onFocus","onFocusIn","onFocusOut","onHashChange","onHelp","onInput","onKeyDown","onKeyPress","onKeyUp","onLayoutComplete","onLoad","onLoseCapture","onMediaComplete","onMediaError","onMessage","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseWheel","onMove","onMoveEnd","onMoveStart","onOffline","onOnline","onOutOfSync","onPaste","onPause","onPopState","onProgress","onPropertyChange","onReadyStateChange","onRedo","onRepeat","onReset","onResize","onResizeEnd","onResizeStart","onResume","onReverse","onRowsEnter","onRowExit","onRowDelete","onRowInserted","onScroll","onSeek","onSelect","onSelectionChange","onSelectStart","onStart","onStop","onStorage","onSyncRestored","onSubmit","onTimeError","onTrackChange","onUndo","onUnload","onURLFlip","seekSegmentTime"],DEFAULT_STYLES_MAP:b,CLASS_TO_FONT:{font_0:{tag:"h1","class":"font_0"},font_2:{tag:"h2","class":"font_2"},font_3:{tag:"h3","class":"font_3"},font_4:{tag:"h4","class":"font_4"},font_5:{tag:"h5","class":"font_5"},font_6:{tag:"h6","class":"font_6"},font_7:{tag:"p","class":"font_7"},font_8:{tag:"p","class":"font_8"},font_9:{tag:"p","class":"font_9"}},PALETTE_SEQUENCES:["color_11","color_12","color_13","color_14","color_15","color_16","color_17","color_18","color_19","color_20","color_21","color_22","color_23","color_24","color_25","color_26","color_27","color_28","color_29","color_30","color_31","color_32","color_33","color_34","color_35"],TEXT_LIST_TYPES:{textListNone:"nonelist",textListNumbers:"numberedlist",textListBullets:"bulletedlist"},TEXT_BACK_COLOR_TYPES:{textListNone:"noColor"},TEXT_LIST_TYPES_RTL:{textListNone:"nonelist",textListNumbersRight:"numberedlist",textListBulletsRight:"bulletedlist"},ALIGNMENT_TYPES:{textAlignLeft:"justifyleft",textAlignCenter:"justifycenter",textAlignRight:"justifyright",textAlignBlock:"justifyblock"},EFFECTS:{effect_0:{label:"-",value:2},effect_1:{label:"A",value:"rgba(255, 255, 255, 0.6) 1px 1px 1px, rgba(0, 0, 0, 0.6) -1px -1px 1px"},effect_2:{label:"B",value:"rgba(0, 0, 0, 0.298039) 0px 5px 0px"},effect_3:{label:"C",value:"rgba(0, 0, 0, 0.4) 0px 4px 5px"},effect_4:{label:"D",value:"rgba(0, 0, 0, 0.498039) -1px -1px 0px, rgba(0, 0, 0, 0.498039) -1px 1px 0px, rgba(0, 0, 0, 0.498039) 1px 1px 0px, rgba(0, 0, 0, 0.498039) 1px -1px 0px"},effect_5:{label:"E",value:"rgb(255, 255, 255) -1px -1px 0px, rgb(255, 255, 255) -1px 1px 0px, rgb(255, 255, 255) 1px 1px 0px, rgb(255, 255, 255) 1px -1px 0px"},effect_6:{label:"F",value:"rgb(255, 255, 255) 0px 0px 6px"},effect_7:{label:"G",value:"rgb(200, 200, 200) 1px 1px 0px, rgb(180, 180, 180) 0px 2px 0px, rgb(160, 160, 160) 0px 3px 0px, rgba(140, 140, 140, 0.498039) 0px 4px 0px, rgb(120, 120, 120) 0px 0px 0px, rgba(0, 0, 0, 0.498039) 0px 5px 10px"},effect_8:{label:"H",value:"rgb(255, 255, 255) 3px 3px 0px, rgba(0, 0, 0, 0.2) 6px 6px 0px"},effect_9:{label:"I",value:"rgba(10, 189, 240, 0.298039) 3px 3px 0px, rgba(254, 1, 1, 0.298039) -3px -3px 0px"}},FONT_SIZE:{MIN:6,MAX:215},BLOG_CK_EDITOR_FONT_STYLES:{type:"map",metaData:{isPreset:!0,isHidden:!1,description:"",isPersistent:!1},items:{font_0:{seoTag:"h1",label:"FONT_0_LABEL"},font_1:{seoTag:"h2",label:"FONT_1_LABEL"},font_2:{seoTag:"h2",label:"FONT_2_LABEL"},font_3:{seoTag:"h3",label:"FONT_3_LABEL"},font_4:{seoTag:"h4",label:"FONT_4_LABEL"},font_5:{seoTag:"h5",label:"FONT_5_LABEL"},font_6:{seoTag:"h6",label:"FONT_6_LABEL"},font_7:{seoTag:"p",label:"FONT_7_LABEL"},font_8:{seoTag:"p",label:"FONT_8_LABEL"},font_9:{seoTag:"p",label:"FONT_9_LABEL"},font_10:{seoTag:"p",label:"FONT_10_LABEL"}},id:"CK_EDITOR_FONT_STYLES"},BLOG_EDITOR_STYLES:{type:"map",metaData:{isPersistent:!1},items:{h1:{tag:"h1",cssClass:"font_3"},h2:{tag:"h2",cssClass:"font_4"},h3:{tag:"h3",cssClass:"font_5"},h4:{tag:"h4",cssClass:"font_6"},h5:{tag:"h5",cssClass:"font_7"},h6:{tag:"h6",cssClass:"font_8"},p:{tag:"p",cssClass:"font_9"},div:{tag:"div",cssClass:"font_8",label:"default",seoTag:"hatul"}},id:"WIXAPPS_EDITOR_STYLES"},DEFAULT_STYLE_CLASS:"font_100",FALLBACK_STYLE_CLASS:"font_8",STYLE_COMMANDS:["bold","fontSize","fontFamily","foreColor","italic"],TEXT_BLOCKS:a.keys(b).concat(["ul","ol"]),LANG_TO_EXAMPLE_KEY:{latin:"","latin-ext":"text_editor_font_example_latin_ext_constant",cyrillic:"text_editor_font_example_cyrillic_constant",japanese:"text_editor_text_editor_font_example_japanese_constant",korean:"text_editor_font_example_korean_constant",arabic:"text_editor_font_example_arabic_constant",hebrew:"text_editor_font_example_hebrew_constant"}}}),define("textControls/utils/colorUtils",["lodash","textControls/utils/constants","util","experiment"],function(a,b,c,d){"use strict";function e(d,e){d=c.colors.getColorInHex(d);var g=a.findKey(e,function(a){return a===d});return f(g,b.PALETTE_SEQUENCES)?g:d}function f(b,c){return a.includes(c,b)}function g(b){var c=[];return a.forEach(b,function(a,b){var d=b.split("_")[1];c[d]=a}),{color:c}}function h(b,d){var e={};return a.forEach(d,function(a,d){var f=b+d;e[f]=c.colors.getColorInHex(a)}),e}function i(c,e){return c="noColor"!==c&&c?c:b.CK_OFF,!d.isOpen("newCK")&&a.includes(c,"color")&&(c=e[c]),c}return{getColorValueFromTheme:e,isColorInPaletteSequences:f,getThemeColorData:g,getHexColorsMap:h,getColorPickerValue:i}}),define("textControls/utils/fontUtils",["lodash","util","pLoader!santa:fonts","pLoader","textControls/utils/colorUtils"],function(a,b,c,d,e){"use strict";function f(a,b,d,e){if(a){var f=c.fontUtils.collectFontsFromTextDataArray([a]),g=h(f,b,d);e.fonts=e.fonts.concat(f),g&&e.urls.push(g)}}function g(b,d,e,f){var g=a(b).map(function(a){return c.fontUtils.getFontFamily(a).replace(/\+/g," ").toLowerCase()}).uniq().value(),i=h(g,e,f);d.fonts=d.fonts.concat(g),i&&d.urls.push(i)}function h(a,b,d){var e=c.fontUtils.getFontsUrlWithParams(a,b,d);return e?e:""}function i(a,e){var f=d.getRootUrl("santa"),g=c.fontUtils.getWixStoredFontsCssUrlsWithParams(f,a);return"WixSite"===e&&(g=g.concat(b.serviceTopology.publicStaticsUrl+"/css/Helvetica/fontFace.css")),g}function j(a,b,c,d){var e={fonts:[],urls:[]};return f(a,b,c,e),g(d,e,b,c),e.urls=e.urls.concat(i(c,b)),e}function k(b,d,e){return a.isString(b)?c.fontUtils.parseStyleFont(b,e,d):null}function l(a,b){var d=a.generalInfo.getDocumentType();return b=b||a.theme.fonts.getCharacterSet(),c.fontUtils.getCurrentSelectablefontsWithParams(d,b)}function m(b,d,f){var g=e.getThemeColorData(b),h=a.groupBy(d,"cssClass"),i="";return a.forEach(f,function(a,b){var d="font: "+c.fontCss.fontToCSSWithColor(a,g),e=n(b,h);i+=e+"{"+d+"}"}),i}function n(b,c){var d="";return c[b]&&a.forEach(c[b],function(a){d+=a.tag+", "}),d+="."+b}function o(a){return a=a.toLowerCase(),c.fontMetadata[a]}function p(b){var d=a.clone(c.fontMetadata);return"WixSite"!==b&&(d=a.omit(d,function(a){return"studio"===a.permissions})),a.forEach(d,function(a,b){a.cssFontFamily=c.fontUtils.getFontFamilyWithFallbacks(b)}),d}function q(b,d){var e={};a.forEach(c.fontMetadata,function(a,b){a.cdnName&&(e[b]=b)});var f=h(a.keys(e),b,d);return{missingFontsNames:e,missingFontsUrl:f}}function r(a){return this.stringifyFont(a,!1)}function s(a){return a===!0?"700":a===!1?"normal":a}function t(a){return a===!0?"italic":a===!1?"normal":a}function u(c,d,e){var f=t(c.italic)+" "+c.variant+" "+s(c.bold)+" "+c.size+"/"+c.lineHeight+" "+c.family.replace(/\s/g,"+");if(d&&c.color){var g=b.colors.getColorInHex(c.color);if(e){var h=a.findKey(e,function(a){return a===g});h&&(g="{"+h+"}")}f+=" "+g}return f}function v(a){return"string"==typeof a?a.toLowerCase().replace(/['"\s]/g,""):a}function w(b){var c={},d={};return a.forEach(b,function(b){a.forEach(b.fonts,function(a){c[v(a.cssFontFamily)]=a,d[a.fontFamily]=a.cssFontFamily})}),{normalizedCssToFont:c,fontFamilyToCss:d}}function x(){return"url("+b.media.getMediaUrl("textEditor/fonts.v3.png")+")"}function y(b){var d=a.filter(c.fontMetadata,{provider:"google"});return c.fontUtils.getGoogleFontsUrl(d,b)}function z(a,b,c){var d=[],e=this.getGoogleFontsUrl(a);e&&d.push(e);var f=this.getFontsToLoad("",b,a,c).urls;return f&&(d=d.concat(f)),d}return{getStyleFont:k,getFontsToLoad:j,parseStyleFont:c.fontUtils.parseStyleFont,stringifyFontWithoutColor:r,stringifyFont:u,createFontsCssString:m,getCurrentSelectableFontsWithParams:l,getFont:o,getWixStoredFontsCss:i,getFontsMetadata:p,getTextCustomFonts:f,getAllCustomFontsUrls:q,getFontsUrlWithParams:h,normalizeFontCss:v,calcFontsMaps:w,getFontsSpriteUrl:x,getGoogleFontsUrl:y,getAllCssLinks:z}}),define("textControls/utils/dataUtils",["lodash","jquery","textControls/utils/constants"],function(a,b,c){"use strict";function k(a){return a.replace(/<!--[^>]*>/g,"")}function l(b){var c=[];a.forEach(b.children,function(a){n(a)?c.push(a):(m(a),s(a),l(a))})}function m(b){var c=o(b)?q(b):p(b);a.forEach(c,function(a){b.removeAttribute(d+a)},this)}function n(b){return a.some(c.FORBIDDEN_TAGS,function(a){return b.nodeName.toLowerCase()===d+a},this)}function o(a){return"img"===a.nodeName.toLowerCase()}function p(b){var d=c.FORBIDDEN_TAGS_AND_ATTRIBUTES;return"a"===b.nodeName.toLowerCase()&&a.pull(d,"dataquery"),d}function q(b){var d=a.difference(r(b),c.IMAGE_WHITE_LIST_ATTRIBUTES);return d}function r(b){var c=a.map(b.attributes,function(a){return a.nodeName.toLowerCase()});return c}function s(b){var d;a.forEach(c.SENSITIVE_ATTRIBUTES,function(a){d=b.getAttribute(a),d&&(d=d.toLowerCase(),("style"!==a&&d.indexOf("script")>-1||d.indexOf("expression")>-1)&&b.removeAttribute(a))})}function t(a){return u(a).replace(/[\u200b\s]/g,"").length<1}function u(a){var b=window.document.createElement("div");return b.innerHTML=a,b.textContent}function v(a){for(var b=new RegExp(i,"ig"),c=a,d=b.exec(a);d;){var e;e=j.test(d[0])?d[0]:new RegExp(g,"i").exec(d[0])[0],c=c.replace(e,function(a){var b=a.replace(/(<a dataquery="#[^>]*>)(.*?)(<\/a>)/i,"$2"),c=b.replace(/text-decoration:underline;?/,""),d=c.replace('style=""',""),e=d.replace(/(<span\s*>)([^>]*)(<\/span>)/i,"$2");return e}),d=b.exec(a)}return c}function w(a){for(var b=[/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi],c=0;c<b.length;c++)a=a.replace(b[c],"");return a}function x(b){return b.nodeName&&a.includes(c.TEXT_BLOCKS,b.nodeName.toLowerCase())}function y(d){if(!a.isString(d))return d;var g,e=b.parseHTML(d.trim()),f=b("<div>");return a.forEach(e,function(a){x(a)?(g&&(f.append(g),g=void 0),f.append(a)):a.textContent.trim().length>0&&(g=g||b("<p>").addClass(c.DEFAULT_STYLES_MAP.div.cssClass),g.append(a))}),g&&f.append(g),f.html()}var d="",e="(</span>)",f="(<span .*?text\\-decoration.*?>)?",g='<a dataquery="#[^>]*?>'+f+".*?"+e+"?</a>",h=f+g+e,i=h+"?",j=new RegExp(h,"i");return{removeHtmlComments:k,removeScripts:w,removeRedundantNodesAndAttributes:l,isEmptyHtmlText:t,getTextContentFromHtml:u,removeLinksFromHtml:v,wrapOrphans:y}}),define("textControls/utils/ckUtils",["textControls/utils/constants","textControls/utils/fontUtils","util","textControls/utils/dataUtils","textControls/utils/colorUtils","jquery","lodash","experiment"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,b){var c=a.editable().getDocument();g.forEach(b.urls,function(a){c.appendStyleSheet(a)})}function j(a){return g.reduce(a,function(a,b,c){var d="."+c+"{ color:"+b+";}",e=".back"+c+"{background-color:"+b+";}";return a+d+e},"")}function k(a,c,d,e){var f=b.createFontsCssString(a,c,d);if(h.isOpen("newCK")){var g=j(a);e.execCommand("wixCss",f+g)}else e.document.appendStyleText(f)}function l(a,c,d,e,f,g,h){k(h,d,e,a),i(a,b.getFontsToLoad(c,f,g,e))}function m(a,b,c){a.config.stylesMap=b,a.config.colorsMap=e.getHexColorsMap("",c),a.config.bgColorsMap=e.getHexColorsMap("back",c),CKEDITOR.plugins.wixParser.resetTheMaps(a.config)}function n(b,c){b.on("beforeCommandExec",function(b){var d=b.data.name;if("fontFamily"===d){var e=b.data.commandData;if(e&&e!==a.CK_OFF){var f=e.replace(/"/g,"").split(",");c(f)}}})}function o(a,b,d,e,j,k,o){var q;return q=h.isOpen("newCK")?CKEDITOR.replace(b,{removePlugins:d?"autogrow":""}):CKEDITOR.replace(b,{customConfig:"my/myConfig.js",ignoreEmptyParagraph:!1,removePlugins:"wixComp, image2, wixHtml, wgallery, widget, wline, resize, htmlComp"+(d?",autogrow":""),autoGrow_minHeight:d?0:k.layout.height}),q.on("instanceReady",function(b){var q=b.editor,r=q.document.$.defaultView.frameElement;h.isOpen("newCK")||w(),c.url.isTrue("isqa")&&(r.id="CurrentTextEditor"),h.isOpen("newCK")||q.container.hide(),q.on("change",a.handleDataChange),q.on("selectionChange",a.handleSelectionChange),q.on("selectionCheck",a.handleSelectionChange),q.on("contentDom",function(){q.editable().on("copy",a.handleCutOrCopy),q.editable().on("cut",a.handleCutOrCopy)}),q.on("resize",function(b){var c=b.data.newHeight;g.isNumber(c)&&c!==b.data.oldHeight&&a.handleHeightChange(c)}),q.on("externalPasteHandle",a.handlePaste),f(r).bind("mousewheel",function(a){d&&(a.preventDefault(),a.stopPropagation())}),f(r).css("display","block"),h.isOpen("newCK")||m(q,j,k.themeColors),q.on("dataReady",function(){l(q,e,j,k.themeFonts,k.documentType,k.languages,k.themeColors)}),q.setData(e,{noSnapshot:!0,callback:function(){p(q),k.layout&&v(q,k.layout.height,k.layout.width),E(q),B(q),a.handleCKCreated&&a.handleCKCreated()}}),q.on("focus",a.handleFocus),n(q,function(a){var b=o(a);i(q,b)})}),q}function p(a){a.resetUndo()}function q(){return CKEDITOR&&"loaded"===CKEDITOR.status}function r(a){return a&&"ready"===a.status}function s(a,b){b.execCommand("wixLink",{dataQuery:"#"+a})}function t(a){a.execCommand("selectAll")}function u(a){a.setReadOnly(!0),a.getSelection().removeAllRanges()}function v(a,b,c){a.resize(c||"100%",b,!0,!1,!1)}function w(){CKEDITOR.plugins.autogrow&&CKEDITOR.plugins.autogrow.refreshHeightConfig&&CKEDITOR.plugins.autogrow.refreshHeightConfig()}function x(a,b){a.setKeystroke(CKEDITOR.CTRL+66,!1),b?a.setKeystroke(CKEDITOR.CTRL+66,"unBold"):a.setKeystroke(CKEDITOR.CTRL+66,"bold")}function y(a,b){a.setKeystroke(CKEDITOR.CTRL+73,!1),b?a.setKeystroke(CKEDITOR.CTRL+73,"unItalic"):a.setKeystroke(CKEDITOR.CTRL+73,"italic")}function z(a){var b=a.getSelection();r(a)&&(b.ignoreFillingCharRemoveOnSelectionChange(),a.focus(),b.resumeFillingCharRemoveOnSelectionChange())}function A(a,b){var c=a.editable().getDocument().$,d=f(c).find("#transparentSelectionCss");b?0===d.length&&f(c).find("head").append('<style id="transparentSelectionCss">body ::selection{background: transparent;} body::-moz-selection{background: transparent;}</style>'):d&&d.remove()}function B(a){var b=a.editable().getDocument().$;f(b).find("head").append('<style id="overflowCss">body {overflow: hidden !important;}</style>')}function C(a){var b=a.editable().getDocument().$;f(b).find("head").find("#overflowCss").remove()}function D(a){var b=a.editable().getDocument().$;f(b).scrollTop(0)}function E(a){var b=a.editable().getDocument().$,d=c.serviceTopology.scriptsLocationMap.santa+"/static/css/viewer.css",e='<link rel="stylesheet" href="'+d+'" type="text/css" charset="utf-8"></link>';f(b).find("head").append(e)}function F(a,b,c){var d=c.undoManager.currentImage,e=b?"afterUndo":"afterRedo",f=b?"undo":"redo",g=c.getCommand(f);g&&g.on(e,function(){d.equalsContent(c.undoManager.currentImage)&&a()})}function G(c,d,e){var f=c.getCommand("formatBlock").state;return f===a.CK_OFF&&(f={tag:"p","class":"font_8"}),b.getStyleFont(f["class"],d,e)}function H(c,d,e){var f=c.getCommand("formatBlock").state;return a.DEFAULT_STYLES_MAP[f]||(f=c.plugins.wixpreservestyle.getSavedStyles(c).formatBlock),b.getStyleFont(a.DEFAULT_STYLES_MAP[f].cssClass,d,e)}function I(a,b,c){return h.isOpen("newCK")?G(a,b,c):H(a,b,c)}function J(a,b,c){if(!window.CKEDITOR||!CKEDITOR.env.ie||c){var d=a.document.$.body,e=!b;d.setAttribute("contenteditable",e)}}function K(a){var b=a.getSelection();return g.isEmpty(b&&b.getSelectedText())}function L(a,b,c){b.getCommand(a).canUndo=c}function M(a,b,c){b.getCommand(a).editorFocus=c}function N(a){a.undoManager.undo()}function O(a){return h.isOpen("newCK")?d.removeHtmlComments(a.WIX.getData()):(a.plugins.wixpreservestyle.fixDom(a),d.removeHtmlComments(a.getData()))}function P(a,b,c,d){a.editable()&&(a.execCommand("wixSetHtml",b),t(a),l(a,O(a),c,d.themeFonts,d.documentType,d.languages,d.themeColors))}return{createCKInstance:o,isCKLoaded:q,isEditorReady:r,getData:O,createLink:s,selectAll:t,prepareClosing:u,focus:z,toggleSelectionToTransparent:A,updateThemeStyles:k,loadFontsToCK:i,afterUndoRedoCallback:F,refreshHeightConfig:w,setOverflowCss:B,removeOverflowCss:C,scrollCkToTop:D,toggleBoldShortcutKey:x,toggleItalicShortcutKey:y,getTagFontStyle:I,setCkReadOnly:J,isNoSelection:K,toggleCommandUndoManager:L,toggleCommandFocus:M,execUndoCommand:N,setData:P,resetUndo:p}}),define("textControls/utils/ckBridge",[],function(){"use strict";function a(a,b){return a.getCommand(b)}function b(b,c){var d=a(b,c);return d?d.state:""}function c(b,c){var d=a(b,c);return d&&d.canPerformCmd&&d.canPerformCmd(b)}function d(a,b,c){a.execCommand(b,c)}function e(a,b){a.fire(b)}function f(b,c){var d=a(b,c);d&&d.refresh(b)}return{getCmdState:b,execCmd:d,canPerformCmd:c,refresh:f,fire:e}}),define("textControls/utils/shadowUtils",["lodash","jquery","util"],function(a,b,c){"use strict";function d(){return new RegExp(/(rgba?\([^\)]*\))/g)}function e(){return new RegExp(/(#[0-9a-f]{3,6})/g)}function f(a){var b=g(a);return b.replace(/\s+/g,"").toLowerCase()}function g(a){var b=e(),d=a.match(b),f=a;if(null!==d)for(var g=0;g<d.length;g++){var h=c.colors.hexToRgb(d[g]),i=c.colors.rgbObjectToString(h);f=f.replace(d[g],i)}return f}function h(b,c){var e=d(),f=b.match(e),g=c.match(e);return a.isEqual(f,g)||j(f,g)}function i(a,b){for(var c=0;3>c;c++)if(a[c]!==b[c])return!1;return Math.floor(1e3*a[3])===Math.floor(1e3*b[3])}function j(a,b){if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(0===a[c].indexOf("rgba")&&0===b[c].indexOf("rgba")){var d=k(a[c]),e=k(b[c]);if(!i(d,e))return!1}else if(a[c]!==b[c])return!1;return!0}function k(a){return a.replace("rgba(","").replace(")","").split(",")}function l(a,b){var c=a.replace(d(),""),e=b.replace(d(),"");return c===e}function m(a,b){return h(a,b)&&l(a,b)}function n(a,b){var c=f(a),d=f(b);return c===d||m(c,d)}return{cssTextShadowCompare:n}}),define("textControls/utils/styleCommandsUtils",["lodash","textControls/utils/constants","textControls/utils/fontUtils"],function(a,b,c){"use strict";function d(c){return a.includes(b.STYLE_COMMANDS,c)}function e(a,d,e,f){if(e){switch(a){case"fontSize":return d===b.CK_OFF?parseInt(e.size,10):parseInt(d,10);case"bold":return"normal"===e.weight&&d===b.CK_OFF?b.CK_OFF:b.CK_ON;case"italic":return"normal"===e.style&&d===b.CK_OFF?b.CK_OFF:b.CK_ON;case"fontFamily":if(d===b.CK_OFF){var g=c.getFont(e.family);return g?c.getFont(e.family).fontFamily:""}var h=c.normalizeFontCss(d);return f[h]?f[h].fontFamily:"";case"foreColor":return d===b.CK_OFF?e.cssColor:d}return d}}return{isStyleCommand:d,calculateStyledValue:e}}),define("textControls/mixins/textEditorMixin",["lodash","jquery","util","textControls/utils/ckUtils","textControls/utils/ckBridge","textControls/utils/constants","textControls/utils/fontUtils","textControls/utils/colorUtils","textControls/utils/shadowUtils","textControls/utils/styleCommandsUtils","experiment"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a,b){a.execCommand(b)}function m(a){a.openLinkDialog()}function n(a){a&&"EmailLink"===a.type&&!a.subject&&(a.subject="")}function o(a){return d.isNoSelection(a)?"text_editor_link_disabled":"text_editor_link_disabled_2"}function p(a){a.execCommand("wixUnlink")}return{isCkReady:function(){return this.richTextInput&&d.isEditorReady(this.richTextInput.editor)},execCommand:function(a,b){this.isCkReady()&&(k.isOpen("newCK")?(this.richTextInput.lockChangeHandler(),e.execCmd(this.richTextInput.editor,a,b),this.richTextInput.unlockChangeHandler()):e.execCmd(this.richTextInput.editor,a,b),e.fire(this.richTextInput.editor,"selectionCheck"))},getLinkValue:function(){return this.isCkReady()?(e.refresh(this.richTextInput.editor,"wixLink"),e.getCmdState(this.richTextInput.editor,"wixLink")):null},getValue:function(a){if(this.isCkReady()){var b=e.getCmdState(this.richTextInput.editor,a);if(j.isStyleCommand(a)){var c=d.getTagFontStyle(this.richTextInput.editor,this.richTextInput.props.themeColors,this.richTextInput.props.themeFonts);if(c)return j.calculateStyledValue(a,b,c,this.richTextInput.fontsMaps.normalizedCssToFont)}return b}return""},getBooleanValue:function(a){return this.isCkReady()?this.getValue(a)===f.CK_ON:!1},getCommandState:function(a){return this.isCkReady()?e.getCmdState(this.richTextInput.editor,a):""},getListType:function(){if(this.isCkReady()){if(this.getBooleanValue(f.TEXT_LIST_TYPES.textListNumbers))return f.TEXT_LIST_TYPES.textListNumbers;if(this.getBooleanValue(f.TEXT_LIST_TYPES.textListBullets))return f.TEXT_LIST_TYPES.textListBullets}return f.TEXT_LIST_TYPES.textListNone},getTextAlignment:function(){if(this.isCkReady()){var b=this;return a.find(f.ALIGNMENT_TYPES,function(a){return b.getBooleanValue(a)})}return""},selectionChange:function(){this.forceUpdate()},componentDidMount:function(){this.richTextInput.registerOnSelectionChange(this.selectionChange)},componentWillUnmount:function(){this.richTextInput.unregisterOnSelectionChange(this.selectionChange)},changeFontFamily:function(a){this.execCommand("fontFamily",this.richTextInput.fontsMaps.fontFamilyToCss[a]),this.focus()},execListCommand:function(a){var b=this.getListType();a!==b&&(a===f.TEXT_LIST_TYPES.textListNone?this.execCommand(b):this.execCommand(a)),this.focus()},execLineHeightCommand:function(a){"auto"===a?this.execCommand("lineHeight",f.CK_OFF):this.execCommand("lineHeight",a+"em")},changeAlignment:function(a){a!==this.getTextAlignment()&&this.execCommand(a),this.focus()},changeTextShadow:function(a){var b=this.getValue("textShadow"),c=b!==a?a:f.CK_OFF;this.execCommand("textShadow",c)},getTextShadowValue:function(){if(this.isCkReady()){var b=this.getValue("textShadow");if(b!==f.CK_OFF){var c=a.findKey(f.EFFECTS,function(a){return a.value!==f.CK_OFF?i.cssTextShadowCompare(a.value,b):void 0});if(c)return c}}return"EFFECT_0"},getLetterSpacingValue:function(){if(this.isCkReady()){var a=this.getValue("letterSpacing");return a===f.CK_OFF?0:parseFloat(a)}return""},getLineHeightValue:function(){if(this.isCkReady()){var a=this.getValue("lineHeight");return a===f.CK_OFF?"auto":parseFloat(a)}return""},getBackColorValue:function(){if(this.isCkReady()){var b=this.getValue("backColor");return b===f.CK_OFF?null:a.startsWith(b,"back")?this.richTextInput.props.themeColors[b.replace("back","")]:b}},getForeColorValue:function(){var b=this.getValue("foreColor");return a.startsWith(b,"color")?this.richTextInput.props.themeColors[b]:b},prepareColorPickerParams:function(a,b){var e=a?"foreColor":"backColor",f=a?this.getValue(e):this.getBackColorValue(),g=c.colors.getColorInHex(f),i=h.getColorValueFromTheme(f,this.richTextInput.props.themeColors),j=!d.isNoSelection(this.richTextInput.editor);return f=i?i:c.colors.getColorInHex(f),!b&&this.richTextInput.refs.toolbar&&(b=this.richTextInput.refs.toolbar.getColorPickerPosition(a)),{colorCommand:e,colorValue:f,originalColor:g,isOriginalColorFromTheme:a&&this.isColorFromTheme(),themeColorValue:i,previewOnHover:j,position:b}},execColorPickerChangeCommand:function(b,c,e,g,h){this.isColorPickerClosed()||(d.toggleCommandUndoManager(c,this.richTextInput.editor,!g),d.setCkReadOnly(this.richTextInput.editor,!1),k.isOpen("newCK")&&a.startsWith(b,"color")&&a.startsWith(c,"back")&&(b="back"+b),h&&b===e?this.execCommand(c,f.CK_OFF):this.execCommand(c,b),d.setCkReadOnly(this.richTextInput.editor,!0))},openColorPicker:function(a,b){var c=this,e=this.prepareColorPickerParams(a,b);d.setCkReadOnly(c.richTextInput.editor,!0),this.richTextInput.props.openColorPicker(e.colorValue,function(a,b){var d=h.getColorPickerValue(a,c.richTextInput.props.themeColors);c.execColorPickerChangeCommand(d,e.colorCommand,e.originalColor,b,e.isOriginalColorFromTheme)},e.position,e.previewOnHover),this.richTextInput.props.panelManager&&this.richTextInput.props.panelManager.registerObserver(this.colorPickerObserver),this.richTextInput.isColorPickerOpen=!0,this.richTextInput.forceIsCustomStyleValue=this.isCustomStyle()},isColorFromTheme:function(){return this.getCommandState("foreColor")===f.CK_OFF},handleColorClick:function(a,b){this.openColorPicker(a,b)},isPanelClosed:function(b){return-1===a.findIndex(this.richTextInput.props.panelManager.getOpenPanels(),{name:b})},isColorPickerClosed:function(){var a=this.richTextInput.props.colorPickerPanelName||"panels.toolPanels.colorPicker.colorPickerPanel";return this.isPanelClosed(a)},colorPickerObserver:function(){var a=this.isColorPickerClosed();d.toggleSelectionToTransparent(this.richTextInput.editor,!a),a&&(this.focus(),d.setCkReadOnly(this.richTextInput.editor,!1),this.richTextInput.props.panelManager.unregisterObserver(this.colorPickerObserver),this.richTextInput.isColorPickerOpen=!1,this.richTextInput.forceIsCustomStyleValue=void 0)},getFormatBlockValue:function(){if(this.isCkReady()){var a=this.getValue("formatBlock");if(!k.isOpen("newCK")){var b=this.richTextInput.editor;return f.DEFAULT_STYLES_MAP[a]||(a=this.richTextInput.editor.plugins.wixpreservestyle.getSavedStyles(b).formatBlock),f.DEFAULT_STYLES_MAP[a].cssClass}return a["class"]}return""},execFormatBlockCommand:function(b){var c;c=k.isOpen("newCK")?f.CLASS_TO_FONT[b]:a.findKey(f.DEFAULT_STYLES_MAP,function(a){return a.cssClass===b}),this.execCommand("formatBlock",c),this.focus()},execNoBackColor:function(){return this.execCommand("backColor",f.CK_OFF)},openLanguageSupport:function(){this.richTextInput.props.openLanguageSupport()},focus:function(){if(this.richTextInput){var a=this.richTextInput.editor;setTimeout(function(){d.focus(a)},0)}},isCustomStyle:function(){if(void 0!==this.richTextInput.forceIsCustomStyleValue)return this.richTextInput.forceIsCustomStyleValue;var b=!1,c=this;return a.forEach(f.STYLE_COMMANDS,function(a){c.getCommandState(a)!==f.CK_OFF&&(b=!0)}),this.getCommandState("unBold")===f.CK_OFF&&this.getCommandState("unItalic")===f.CK_OFF||(b=!0),b},getBoldProps:function(){var b={name:"textBold",instanceId:"textBold",tooltipValue:this.getTooltipValue("bold","B")},c=d.getTagFontStyle(this.richTextInput.editor,this.richTextInput.props.themeColors,this.richTextInput.props.themeFonts);return c&&"normal"!==c.weight?(b.value=!this.getBooleanValue("unBold"),b.onChange=a.partial(l,this,"unBold"),d.toggleBoldShortcutKey(this.richTextInput.editor,!0)):(b.value=this.getBooleanValue("bold"),b.onChange=a.partial(l,this,"bold"),d.toggleBoldShortcutKey(this.richTextInput.editor,!1)),b},getItalicProps:function(){var b={name:"textItalic",instanceId:"textItalic",tooltipValue:this.getTooltipValue("italic","I")},c=d.getTagFontStyle(this.richTextInput.editor,this.richTextInput.props.themeColors,this.richTextInput.props.themeFonts);return c&&"normal"!==c.style?(b.value=!this.getBooleanValue("unItalic"),b.onChange=a.partial(l,this,"unItalic"),d.toggleItalicShortcutKey(this.richTextInput.editor,!0)):(b.value=this.getBooleanValue("italic"),b.onChange=a.partial(l,this,"italic"),d.toggleItalicShortcutKey(this.richTextInput.editor,!1)),b},getUnderlineProps:function(){return{name:"textUnderline",instanceId:"textUnderline",tooltipValue:this.getTooltipValue("underline","U"),value:this.getBooleanValue("underline"),onChange:a.partial(l,this,"underline")}},getLinkProps:function(){return{name:"textLink",instanceId:"textLink",tooltipValue:this.shouldEnableLinkButton()?this.getTooltipValue("link"):o(this.richTextInput.editor),value:this.hasLink(),onChange:a.partial(m,this),disabled:!this.shouldEnableLinkButton(),onUnlink:a.partial(p,this)}},shouldEnableLinkButton:function(){return this.isCkReady()&&e.canPerformCmd(this.richTextInput.editor,"wixLink")},getBulletsItems:function(){var a=this.getBooleanValue("bidiltr")?f.TEXT_LIST_TYPES:f.TEXT_LIST_TYPES_RTL;return a},getBulletsIconName:function(){var a=this.getBooleanValue("bidiltr")?"textListBullets":"textListBulletsRight";return a},hasLink:function(){return null!==this.getLinkValue()},getCurrentLinkData:function(){var b=this.getLinkValue();return null!==b&&b!==f.CK_OFF?("#"===b.charAt(0)&&(b=b.substring(1)),a.find(this.richTextInput._links,{id:b})):void 0},isLinkDialogClosed:function(){var a=this.richTextInput.props.linkDialogPanelName||"panels.toolPanels.linkPanel";return this.isPanelClosed(a)},linkDialogObserver:function(){this.isLinkDialogClosed()&&(this.focus(),this.richTextInput.props.panelManager.unregisterObserver(this.linkDialogObserver),this.richTextInput.isLinkDialogOpen=!1)},openLinkDialog:function(){function g(c){c.id=f,a.remove(b.richTextInput._links,{id:f}),b.richTextInput._links.push(c)}function h(){b.execCommand("wixUnlink"),a.remove(b.richTextInput._links,{id:f})}function i(a){a.id=c.guidUtils.getUniqueId("textLink","_"),d.createLink(a.id,b.richTextInput.editor),b.richTextInput._links.push(a)}var b=this,e=this.getCurrentLinkData(),f=e&&e.id;this.richTextInput.props.openLinkDialog(e,function(a){var c=!1;n(a),f?(c=!0,a?g(a):h()):a&&(c=!0,i(a)),c&&b.richTextInput.callOnChangeIfExists({text:d.getData(b.richTextInput.editor),linkList:b.richTextInput._links})}),this.richTextInput.props.panelManager&&this.richTextInput.props.panelManager.registerObserver(this.linkDialogObserver),this.richTextInput.isLinkDialogOpen=!0},linkFontSize:function(){return{value:this.getValue("fontSize"),requestChange:function(a,b){this.richTextInput.forceIsCustomStyleValue=this.isCustomStyle(),b?this.execCommandWithoutFocus("fontSize",a+"px"):this.execCommand("fontSize",a+"px")}.bind(this)}},handleFontSizeEnd:function(){this.richTextInput.forceIsCustomStyleValue=void 0,this.props.textSettingsPanel.forceUpdate(),this.focus()},linkSpacing:function(){return{value:this.getLetterSpacingValue(),requestChange:function(a,b){b?this.execCommandWithoutFocus("letterSpacing",a+"em"):this.execCommand("letterSpacing",a+"em");
}.bind(this)}},execCommandWithoutFocus:function(a,b){d.toggleCommandFocus(a,this.richTextInput.editor,!1),this.execCommand(a,b),d.toggleCommandFocus(a,this.richTextInput.editor,!0)},registerSaveThemeUndoRedoHandler:function(a,b){d.afterUndoRedoCallback(a,b,this.richTextInput.editor)}}}),define("textControls/mixins/textTooltipMixin",["react","baseUI","core"],function(a,b,c){"use strict";return{getTooltipValue:function(a,b){return"bold"===a||"italic"===a||"underline"===a?this.getTooltipWithShortcut(a,b):"text_editor_buttons_tooltip_"+a},getTooltipWithShortcut:function(d,e){return a.createElement(b.popoverTemplates.keyboardShortcutTooltip,{label:"text_editor_buttons_tooltip_"+d,shortcut:c.constants.KEYBOARD_SPECIAL_KEY.label+" + "+e})}}}),define("textControls/comps/iconButton.rt",["react/addons","lodash","symbols","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(d.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:d.uiConstants.TOOLTIP.STYLE_TYPE.SMALL},a.createElement("div",{className:"icon-button-container"},a.createElement("button",{className:this.getClassName(),onClick:this.handleClick,style:this.props.style,disabled:this.props.disabled},this.props.name?a.createElement("span",{key:"key"+this.props.name},a.createElement(c.symbol,{name:this.props.name})):null,a.createElement("span",{},this.props.children),this.props.popupMode?a.createElement(d.arrowButton,{key:"iconButtonArrow",withoutBorder:!0}):null)))}}),define("textControls/comps/iconButton",["react","lodash","textControls/comps/iconButton.rt","baseUI"],function(a,b,c,d){"use strict";function e(a){var b={};switch(a){case"textOutdentLeft":case"textOutdentRight":b.category="decrease";break;case"textIndentLeft":case"textIndentRight":b.category="increase";break;case"textWriteDirectionLeft":b.category="RTL";break;case"textWriteDirectionRight":b.category="LTR"}return b}return a.createClass({displayName:"iconButton",render:c,mixins:[d.reportUIChangeMixin],propTypes:{isSelected:a.PropTypes.bool,buttonMode:a.PropTypes.bool,popupMode:a.PropTypes.bool},contextTypes:{reportUIChange:a.PropTypes.func},getDefaultProps:function(){return{isSelected:!1,buttonMode:!0,popupMode:!1}},getClassName:function(){var a="";return this.props.className&&(a+=" "+this.props.className),this.props.isSelected&&(a+=" selected"),this.props.buttonMode&&!this.props.popupMode&&(a+=" icon-button"),this.props.popupMode&&(a+=" icon-button popup"),a.trim()},handleClick:function(){var a=e(this.props.name);this.reportUIChange(a,this.props.name||this.props.biName),this.props.onClick()}})}),define("textControls/comps/colorDrop.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("span",{},this.props.isBackColor||this.props.colorDropOnly?null:a.createElement("span",{key:"backColorDrop"},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"symbol-textForeColor","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"22px",height:"18px"},a.createElement("path",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd",d:"M 17 3C 17 3 27.03 17 17 17 6.9 17 17 3 17 3Z"}),a.createElement("path",{"fill-rule":"evenodd",d:"M 16.96 18C 13.35 18 12 14.95 12 13.03 12 9.97 15.69 4.09 16.12 3.43 16.12 3.43 16.95 2.12 16.95 2.12 16.95 2.12 17.8 3.42 17.8 3.42 18.23 4.08 22 9.97 22 13.03 22 15.09 20.44 18 16.96 18ZM 16.96 3.97C 16.96 3.97 13 10.18 13 13.03 13 14.52 14.02 16.99 16.96 16.99 19.89 16.99 21 14.52 21 13.03 21 10.18 16.96 3.97 16.96 3.97ZM 3.6 9.02C 3.6 9.02 2 13.03 2 13.03 2 13.03-0 13.03-0 13.03-0 13.03 5 1 5 1 5 1 6 0 6 0 6 0 7 0 7 0 7 0 8 1 8 1 8 1 11 7.01 11 7.01 11 7.01 11 11.02 11 11.02 11 11.02 9.4 9.02 9.4 9.02 9.4 9.02 3.6 9.02 3.6 9.02ZM 7 3.01C 7 3.01 6 3.01 6 3.01 6 3.01 4.4 7.01 4.4 7.01 4.4 7.01 8.6 7.01 8.6 7.01 8.6 7.01 7 3.01 7 3.01Z"}))),this.props.isBackColor&&!this.props.colorDropOnly?a.createElement("span",{key:"foreColorDrop"},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"symbol-textBackColor","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"28px",height:"21px"},a.createElement("path",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd",d:"M 23 6C 23 6 33.03 20 23 20 12.9 20 23 6 23 6Z"}),a.createElement("path",{"fill-rule":"evenodd",d:"M 22.96 21C 19.35 21 18 17.95 18 16.03 18 12.98 21.69 7.09 22.12 6.43 22.12 6.43 22.95 5.12 22.95 5.12 22.95 5.12 23.8 6.42 23.8 6.42 24.23 7.09 28 12.97 28 16.03 28 18.09 26.44 21 22.96 21ZM 22.96 6.97C 22.96 6.97 19 13.18 19 16.03 19 17.52 20.02 20 22.96 20 25.89 20 27 17.52 27 16.03 27 13.18 22.96 6.97 22.96 6.97ZM 14 6.01C 14 6.01 15 10.02 15 10.02 15 10.02 12 10.02 12 10.02 12 10.02 13 6.01 13 6.01 13 6.01 14 6.01 14 6.01ZM 18 10.02C 18 10.02 15 4.01 15 4.01 15 4.01 14 3.01 14 3.01 14 3.01 13 3.01 13 3.01 13 3.01 12 4.01 12 4.01 12 4.01 6.63 16.03 6.63 16.03 6.63 16.03 9 16.03 9 16.03 9 16.03 11 12.02 11 12.02 11 12.02 16 12.02 16 12.02 16 12.02 16.79 13 16.79 13 16.32 14.18 16 15.26 16 16.03 16 16.93 16.3 18.07 16.98 19.04 16.98 19.04 6 19.04 6 19.04 4.9 19.04 4 18.14 4 17.03 4 17.03 4 15.03 4 15.03 4 15.03 3 15.03 3 15.03 2.45 15.03 2 14.58 2 14.03 2 13.47 2.45 13.02 3 13.02 3 13.02 4 13.02 4 13.02 4 13.02 4 11.02 4 11.02 4 11.02 3 11.02 3 11.02 2.45 11.02 2 10.57 2 10.02 2 9.47 2.45 9.02 3 9.02 3 9.02 4 9.02 4 9.02 4 9.02 4 7.01 4 7.01 4 7.01 2 7.01 2 7.01 1.45 7.01 1 6.57 1 6.01 1 5.46 1.45 5.01 2 5.01 2 5.01 4 5.01 4 5.01 4 5.01 4 2 4 2 4 2 1 2 1 2 0.45 2 0 1.56 0 1 0 0.45 0.45 0 1 0 1 0 4 0 4 0 4 0 20 0 20 0 21.1 0 22 0.9 22 2 22 2 22 4.01 22 4.01 22 4.01 21 5.01 21 5.01 21 5.01 19.43 7.1 18 10.02Z"}))):null,this.props.colorDropOnly?a.createElement("span",{key:"colorDrop"},a.createElement("svg",{width:"13px",height:"20px",viewBox:"0 0 13 20",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},a.createElement("g",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd"},a.createElement("g",{stroke:"#FFFFFF"},a.createElement("path",{d:"M6.444,1.22000003 L5.521,2.66700003 C5.055,3.39800003 0.968,9.90800003 0.968,13.287 C0.968,15.411 2.457,18.783 6.454,18.783 C10.302,18.783 12.032,15.569 12.032,13.287 C12.032,9.90200003 7.857,3.39000003 7.381,2.65900003 L6.444,1.22000003 L6.444,1.22000003 Z"}))))):null)}}),define("textControls/comps/colorDrop",["react","lodash","textControls/comps/colorDrop.rt"],function(a,b,c){"use strict";return a.createClass({propTypes:{fill:a.PropTypes.string},displayName:"colorDrop",render:c})}),define("textControls/comps/textColor.rt",["react/addons","lodash","textControls/comps/colorDrop","textControls/comps/iconButton"],function(a,b,c,d){"use strict";return function(){return a.createElement("span",{},a.createElement(d,{onClick:this.props.onClick,tooltipValue:this.props.tooltipValue,biName:this.getBiName()},a.createElement(c,{isBackColor:this.props.isBackColor,fill:this.props.value})))}}),define("textControls/comps/textColor",["react","lodash","textControls/comps/textColor.rt","textControls/utils/ckUtils"],function(a,b,c){"use strict";return a.createClass({displayName:"textColor",propTypes:{tooltipValue:a.PropTypes.string,value:a.PropTypes.string,isBackColor:a.PropTypes.bool,onClick:a.PropTypes.func.isRequired},getDefaultProps:function(){return{isBackColor:!1}},getBiName:function(){var a=this.props.isBackColor?"textHighlight":"textColor";return a},render:c})}),define("textControls/comps/fontFamily.rt",["react/addons","lodash","baseUI","experiment"],function(a,b,c,d){"use strict";function e(a,b){this.handleOptionsVisible(b)}function f(b,d,e){return a.createElement(c.dropDown.option,{shouldTranslate:!1,value:d.value,className:"font-option "+(this.props.optionsClass?this.props.optionsClass:""),key:this.props.value,searchText:d.label},a.createElement("div",{className:"font-option-container"},a.createElement("span",{className:"font-label"},d.label),a.createElement("span",{className:"font-example"},this.translateIfNeeded(d.example)),b&&d.isNew?a.createElement("span",{key:"font-badge",className:"font-badge"},this.translateIfNeeded("text_editor_fonts_dropdown_new_badge")):null))}function g(){var g=d.isOpen("newFontsBadge");return a.createElement.apply(this,[c.dropDown.combobox,{label:this.props.label,ref:"combobox",optionsWidth:this.props.optionsWidth,valueLink:this.props.valueLink,value:this.props.value,className:"font-family-dd "+(this.props.toolbarMode?"toolbar-mode":""),onChange:this.props.onChange,infoText:this.props.infoText,onOptionsVisible:e.bind(this,g),infoTitle:this.props.infoTitle},b.map(this.state.fontsItems,f.bind(this,g)),this.props.footerText&&(this.props.footerOnClick||this.props.footerText)?a.createElement(c.dropDown.footer,{key:"font_family_footer"},a.createElement("span",{className:"font-family-footer-label",onClick:this.handleFooterOnClick},this.props.footerText)):null])}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},a.createElement("div",{style:{display:"inline"}},g.apply(this,[])))}}),define("textControls/comps/fontFamily",["react","lodash","jquery","textControls/comps/fontFamily.rt","util","textControls/utils/fontUtils","textControls/utils/constants","experiment"],function(a,b,c,d,e,f,g,h){"use strict";function k(a){b.includes(j,a.label)&&b.assign(a,{isNew:!0})}function l(a){var b=a.scrollTop;return Math.round(b/i)}function m(a,b,c){var d=a.clientHeight,e=Math.round(d/i);return Math.min(b+e,c.length)}var i=24,j=["Adobe Caslon","Avenir","Avenir Light","Belinda","Brandon Grotesque","Bree","Cinzel","DIN Neuzeit Grotesk","Futura","Futura Light","Kepler","Libre Baskerville","Linotype Didot","Lulo Clean","Monotype Baskerville","Peaches & Cream","Playfair Display","Proxima Nova","Sail","Trend"];return a.createClass({displayName:"fontFamily",render:d,mixins:[e.translationMixin],getInitialState:function(){return{fontsItems:this.getFontsItems(this.props.fonts)}},getDefaultProps:function(){return{optionsWidth:284}},componentWillReceiveProps:function(a){b.isEqual(this.props.fonts,a.fonts)||this.setState({fontsItems:this.getFontsItems(a.fonts)})},getFontsItems:function(a){var c=[],d=a;return b.forEach(d,function(a){var d={groupName:a.lang,items:[]};b.forEach(a.fonts,function(b){if("legacy"!==b.permissions){var c={label:b.displayName,value:b.fontFamily,example:g.LANG_TO_EXAMPLE_KEY[a.lang],cssFontFamily:b.cssFontFamily};h.isOpen("newFontsBadge")&&k(c),d.items.push(c)}}),c.push(d)}),b(c).pluck("items").flattenDeep().value()},handleFooterOnClick:function(){this.props.footerOnClick()},handleOptionsVisible:function(a){a&&this.addFontFamilyAttrToList(a)},addFontFamilyAttrToList:function(a){for(var d=c(a).find(".option"),e=l(a),f=m(a,e,d),g=e;f>g;g++){var h=this.state.fontsItems[g],i=d[g].firstChild;i&&b.includes(i.classList,"font-option-container")&&!b.has(i.style.fontFamily)&&(i.style.fontFamily=h.cssFontFamily)}},isExpanded:function(){return this.refs.combobox.isExpanded()}})}),define("textControls/comps/textStyle.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c.dropDown.option,{value:b.cssClass,key:b.displayName+b.family,className:"style-option "+(this.props.optionsClass?this.props.optionsClass:"")},a.createElement("div",{className:"style-option-header"},a.createElement("div",{className:"style-color-container"},a.createElement("span",{className:"style-color",style:{backgroundColor:b.cssColor}})),a.createElement("span",{className:"style-name",style:this.getDisplayStyle(b)},this.translateIfNeeded(b.displayName))),a.createElement("div",{className:"style-option-footer"},a.createElement("span",{className:"style-size"},b.size),a.createElement("span",{className:"style-tag"},"<",b.seoTag,">")),a.createElement("div",{className:"style-option-label"},a.createElement("span",{className:"display-name"},this.translateIfNeeded(b.displayName)),a.createElement("span",{className:"custom-style-indicator"},"*")))}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},a.createElement("div",{style:{display:"inline"}},a.createElement.apply(this,[c.dropDown.select,{label:this.props.label,value:this.props.value,onChange:this.props.onChange,ref:"dropdown",infoText:this.props.infoText,infoTitle:this.props.infoTitle,optionsWidth:this.props.optionsWidth,className:"text-style-dd "+(this.props.toolbarMode?"toolbar-mode":"")+" "+(this.props.className?this.props.className:""),setSelectedAnyway:!0,doNotFocus:this.props.doNotFocus},b.map(this.getStyleOptions(),d.bind(this)),this.isCustom()?a.createElement(c.dropDown.option,{key:"textStyleCustom",value:this.props.value,className:"style-option",style:{display:"none"}},"\n                ",this.state.nullLabel,"\n            "):null])))}}),define("textControls/comps/textStyle",["react","lodash","textControls/comps/textStyle.rt","textControls/utils/constants","textControls/utils/fontUtils","util"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"textStyle",mixins:[f.translationMixin],propTypes:{nullLabel:a.PropTypes.string},getNullLabelFromProps:function(){return this.props.nullLabel||this.translateIfNeeded("list_design_panel_Customize_TextField_CustomTheme_DropdownItem_Label")},getInitialState:function(){return{nullLabel:this.getNullLabelFromProps()}},getDefaultProps:function(){return{stylesMap:d.DEFAULT_STYLES_MAP,toolbarMode:!1,optionsWidth:264}},getStyleOptions:function(){return b.map(this.props.stylesMap,function(a){var c=e.getStyleFont(a.cssClass,this.props.themeColors,this.props.themeFonts);return b.assign(c,b.pick(a,["seoTag","cssClass","displayName"]))},this)},getDisplayStyle:function(a){var b={fontWeight:a.weight,fontFamily:a.family+","+a.fontWithFallbacks,fontSize:parseInt(a.size,10)<=28?a.size:"28px",fontStyle:a.style};return b},isExpanded:function(){return this.refs.dropdown.isExpanded()},render:c,isCustom:function(){return!b.some(this.props.stylesMap,{cssClass:this.props.value})}})}),define("textControls/comps/textPopup.rt",["react/addons","lodash","textControls/comps/iconButton"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:"text-popup-control"},a.createElement("span",{},a.createElement(c,{ref:"popupButton",isSelected:this.state.popupOpen,style:{width:this.props.width},onClick:this.togglePopup,popupMode:!0,name:this.props.iconName},this.props.label?a.createElement("span",{key:"textPopupLabel"},this.props.label):null)),a.createElement("div",{className:"tri with-shadow",style:{visibility:this.state.popupOpen?"visible":"hidden"}}),a.createElement("div",{className:"text-popup with-shadow",ref:"popupContainer",style:{visibility:this.state.popupOpen?"visible":"hidden"}},a.createElement("span",{},this.props.children)),a.createElement("div",{className:"tri cover-shadow",style:{visibility:this.state.popupOpen?"visible":"hidden"}}))}}),define("textControls/comps/textPopup",["react","lodash","util","textControls/comps/textPopup.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"textPopup",propTypes:{label:a.PropTypes.string,iconName:a.PropTypes.string,width:a.PropTypes.number},mixins:[c.outerClickMixin],getInitialState:function(){return{popupOpen:!1}},togglePopup:function(){var a=!this.state.popupOpen;this.setState({popupOpen:a}),a&&this.setPopupPosition()},hide:function(){this.state.popupOpen&&this.setState({popupOpen:!1})},onOuterClick:function(){this.hide()},setPopupPosition:function(){var a=this.refs.popupButton.getDOMNode().getBoundingClientRect();if(this.refs.popupContainer){var b=this.refs.popupContainer.getDOMNode(),c=0-b.getBoundingClientRect().width/2,d=a.height+10;b.style.setProperty("bottom",d+"px"),b.style.setProperty("right",c+"px")}},render:d})}),define("textControls/comps/lineHeight.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(a){this.selectionChange(a)}return function(){return a.createElement("div",{className:"control-line-height"},this.props.infoText||this.props.infoTitle?a.createElement(c.infoIcon,{key:"lineHeightInfo",title:this.props.infoTitle,text:this.props.infoText}):null,a.createElement(c.radioButtons,{value:this.getSelectedOption(),label:"text_editor_line_spacing_label",onChange:d.bind(this),options:this.props.options}),a.createElement("div",{style:{display:b.isNumber(this.state.value)?"block":"none"}},a.createElement(c.slider,{value:this.props.value,min:.5,max:3,stepperMax:9,stepperStep:.01,step:.1,onChange:this.handleSliderChange,onSlideEnd:this.props.onSlideEnd})))}}),define("textControls/comps/lineHeight",["react","lodash","textControls/comps/lineHeight.rt","baseUI"],function(a,b,c,d){"use strict";return a.createClass({displayName:"lineHeight",render:c,mixins:[d.inputMixin],propTypes:{infoText:a.PropTypes.string,infoTitle:a.PropTypes.string,options:a.PropTypes.arrayOf(a.PropTypes.shape({label:a.PropTypes.string.isRequired,value:a.PropTypes.string.isRequired})),label:a.PropTypes.string,value:a.PropTypes.oneOfType([a.PropTypes.string,a.PropTypes.number])},getInitialState:function(){var a=this.getValueFromProps();return{value:a}},getDefaultProps:function(){return{options:[{value:"auto",label:"text_editor_line_spacing_automatic"},{value:"custom",label:"text_editor_line_spacing_customize"}]}},getSelectedOption:function(){var a="auto"===this.state.value?"auto":"custom";return a},handleSliderChange:function(a){this.handleControlChange(a)},selectionChange:function(a){"auto"===a?this.handleControlChange(a):this.handleControlChange(1.2)},handleControlChange:function(a){b.isNumber(a)&&this.setState({value:a}),this.callOnChangeIfExists(a)},componentWillReceiveProps:function(a){var b=this.getValueFromProps(a);this.getValueFromProps(this.props)!==b&&this.setState({value:b})}})}),define("textControls/comps/iconsDropDown.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c.dropDown.option,{value:b,className:"icons-dd-option",key:d},a.createElement(c.symbol,{name:d}))}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"}},a.createElement.apply(this,[c.dropDown.select,{ref:"dropdown",shouldTranslate:!1,value:this.props.value,onChange:this.props.onChange,className:"icons-dd "+this.props.className,optionsWidth:56,template:this.props.fixedIconName?this.getFixedIcon:void 0,doNotFocus:this.props.doNotFocus},b.map(this.props.items,d.bind(this))])))}}),define("textControls/comps/iconsDropDown",["react","lodash","textControls/comps/iconsDropDown.rt","baseUI"],function(a,b,c,d){"use strict";return a.createClass({displayName:"iconsDropDown",propTypes:{fixedIconName:a.PropTypes.string},render:c,getFixedIcon:function(){return this.props.fixedIconName?a.createElement(d.symbol,{name:this.props.fixedIconName}):void 0},isExpanded:function(){return this.refs.dropdown.isExpanded()}})}),define("textControls/comps/textBackgroundColor.rt",["react/addons","lodash","textControls/comps/colorDrop","textControls/comps/textColor","textControls/utils/constants","baseUI"],function(a,b,c,d,e,f){"use strict";function g(){this.props.onClick()}function h(b,c){return a.createElement(f.dropDown.option,{value:b,className:"icons-dd-option",key:c},a.createElement(f.symbol,{name:c}))}return function(){return a.createElement("span",{},this.shouldRenderDropOwn()?null:a.createElement(d,{onClick:g.bind(this),tooltipValue:this.props.tooltipValue,key:"backColorButton",tooltipStyleType:this.props.tooltipStyleType,isBackColor:!0,value:this.props.color}),this.shouldRenderDropOwn()?a.createElement(f.tooltip,{value:this.props.tooltipValue,styleType:this.props.tooltipStyleType,key:"backColorDropdown"},a.createElement("span",{},a.createElement.apply(this,[f.dropDown.select,{ref:"dropdown",shouldTranslate:!1,value:this.getDropDownValue(),onChange:this.handleChange,className:"back-color-dd",optionsWidth:40,toggleIcon:!1,template:this.getTemplate,setSelectedAnyway:!0,doNotFocus:this.props.doNotFocus},b.map(e.TEXT_BACK_COLOR_TYPES,h.bind(this)),this.props.colorDrop?a.createElement(f.dropDown.option,{key:"colorDropOption",value:"customColor",className:"icons-dd-option"},a.createElement(c,{colorDropOnly:!0,fill:this.props.color})):null]))):null)}}),define("textControls/comps/textBackgroundColor",["react","lodash","textControls/comps/textBackgroundColor.rt","baseUI","textControls/comps/colorDrop"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"backColorDropDown",render:c,getDefaultProps:function(){return{colorDrop:!0}},shouldRenderDropOwn:function(){return null!==this.props.color},getDropDownValue:function(){return null===this.props.color?"noColor":"customColor"},getTemplate:function(){return a.createElement(e,{fill:this.props.color,isBackColor:!0})},handleChange:function(a){"noColor"===a&&this.props.handleNoColor&&this.props.handleNoColor(),"customColor"===a&&this.props.onClick&&this.props.onClick()},isExpanded:function(){return this.refs.dropdown.isExpanded()}})}),define("textControls/comps/textLinkControl.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("span",{},this.shouldRenderDropDown()?null:a.createElement(c.toggleButton,b.assign({},{key:"linkToggleButton"},this.props)),this.shouldRenderDropDown()?a.createElement(c.tooltip,{value:this.props.tooltipValue,styleType:this.props.tooltipStyleType,key:"textLinkDropdown"},a.createElement("span",{},a.createElement(c.dropDown.select,{ref:"dropdown",shouldTranslate:!1,onChange:this.handleChange,className:"text-link-dd",optionsWidth:40,toggleIcon:!1,value:"link",setSelectedAnyway:!0},a.createElement(c.dropDown.option,{value:"unlink",className:"link-dd-option"},a.createElement("div",{className:"link-icon-container"},a.createElement(c.symbol,{name:"textUnlink",key:"textUnlink"}))),a.createElement(c.dropDown.option,{value:"link",className:"link-dd-option"},a.createElement("div",{className:"link-icon-container"},a.createElement(c.symbol,{name:"textLink",key:"textLink"})))))):null)}}),define("textControls/comps/textLinkControl",["react","lodash","textControls/comps/textLinkControl.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"textLinkControl",render:c,shouldRenderDropDown:function(){return this.props.value===!0},handleChange:function(a){"unlink"===a?this.props.onUnlink():"link"===a&&this.props.onChange()}})}),define("textControls/comps/textToolBar.rt",["react/addons","lodash","textControls/comps/iconButton","textControls/comps/textColor","textControls/comps/fontFamily","textControls/comps/textStyle","textControls/comps/textPopup","textControls/comps/lineHeight","textControls/comps/iconsDropDown","textControls/comps/textBackgroundColor","textControls/comps/textLinkControl","textControls/utils/constants","baseUI","experiment"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";function o(a,b,c){this.execFormatBlockCommand(c)}function p(a,b,c){this.changeFontFamily(c)}function q(a,b,c){this.execCommand("fontSize",c+"px")}function r(a,b){this.openColorPicker(!0)}function s(a,b){this.handleColorClick(!1)}function t(a,b){this.execCommand("resetThemeAndStyles")}function u(a,b){this.toggleToolbar()}function v(a,b,c){this.changeAlignment(c)}function w(a,b,c){this.execListCommand(c)}function x(a,b){this.execCommand("outdent")}function y(a,b){this.execCommand("indent")}function z(a,b,c){this.execLineHeightCommand(c)}function A(a,b,c){this.execCommand("letterSpacing",c+"em")}function B(a,b){this.execCommand("bidiltr")}function C(a,b){this.execCommand("bidirtl")}function D(){var D=m.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,E=n.isOpen("linkDropdownOption");return a.createElement("div",{className:"rich-text-toolbar",key:"richTextToolBar"},a.createElement("section",{},a.createElement(f,{value:this.getFormatBlockValue(),themeColors:this.props.themeColors,ref:"textStyle",tooltipStyleType:D,themeFonts:this.props.themeFonts,toolbarMode:!0,hasSmallArrow:!0,tooltipValue:"text_editor_theme_label",optionsWidth:264,onChange:o.bind(this,D,E)}),a.createElement(e,{ref:"fontFamily",tooltipStyleType:D,value:this.getValue("fontFamily"),onChange:p.bind(this,D,E),tooltipValue:"text_editor_font_label",fonts:this.props.fonts,toolbarMode:!0}),a.createElement(g,{label:this.getValue("fontSize")+" px",width:71,ref:"fontSizePopUp"},a.createElement(m.slider,{label:"text_editor_font_size_label",id:"font-size-slider",value:this.getValue("fontSize"),min:6,max:176,stepperMax:999,onChange:q.bind(this,D,E),onSlideEnd:this.focus})),a.createElement(m.toggleButton,this.getBoldProps()),a.createElement(m.toggleButton,this.getItalicProps()),a.createElement(m.toggleButton,this.getUnderlineProps()),a.createElement(d,{value:this.getForeColorValue(),onClick:r.bind(this,D,E),tooltipValue:this.getTooltipValue("text_color"),tooltipStyleType:D,ref:"foreColorButton"}),a.createElement(j,{ref:"backColorButton",color:this.getBackColorValue(),onClick:s.bind(this,D,E),handleNoColor:this.execNoBackColor,tooltipValue:this.getTooltipValue("text_highlight"),tooltipStyleType:D}),E?null:a.createElement(m.toggleButton,b.assign({},{key:"linkToggleButton"},this.getLinkProps())),E?a.createElement(k,b.assign({},{ref:"linkDropdownOption",key:"linkDropdownOption",tooltipStyleType:D},this.getLinkProps())):null,a.createElement(c,{onClick:t.bind(this,D,E),name:"textRemoveFormat",tooltipValue:"text_editor_reset_button",tooltipStyleType:D}),a.createElement("span",{className:"expand-toolbar-button",onClick:u.bind(this,D,E)},this.state.extraToolbarOpened?null:a.createElement("span",{className:"more-text",key:"richTextToolBarMore"},a.createElement(m.symbol,{name:"accordionClose"}),a.createElement("span",{},this.translateIfNeeded("list_dbe_edit_item_text_toolbar_more"))),this.state.extraToolbarOpened?a.createElement("span",{className:"less-text",key:"richTextToolBarLess"},a.createElement(m.symbol,{name:"accordionOpen"}),a.createElement("span",{},this.translateIfNeeded("list_dbe_edit_item_text_toolbar_less"))):null)),this.state.extraToolbarOpened?a.createElement("div",{key:"richTextToolBarDivider",className:"toolbar-divider"}):null,this.state.extraToolbarOpened?a.createElement("section",{key:"richTextToolBarExtraControls"},a.createElement(i,{ref:"textAlign",className:"align-dd",value:this.getTextAlignment(),onChange:v.bind(this,D,E),items:l.ALIGNMENT_TYPES,tooltipValue:this.getTooltipValue("alignment"),tooltipStyleType:D}),a.createElement(i,{ref:"textBullets",className:"bullets-dd",value:this.getListType(),onChange:w.bind(this,D,E),items:this.getBulletsItems(),tooltipValue:this.getTooltipValue("bullets_and_numbering"),tooltipStyleType:D,fixedIconName:this.getBulletsIconName()}),a.createElement(c,{onClick:x.bind(this,D,E),name:this.getBooleanValue("bidiltr")?"textOutdentLeft":"textOutdentRight",tooltipValue:this.getTooltipValue("decrease_indent"),tooltipStyleType:D}),a.createElement(c,{onClick:y.bind(this,D,E),name:this.getBooleanValue("bidiltr")?"textIndentLeft":"textIndentRight",tooltipValue:this.getTooltipValue("increase_indent"),tooltipStyleType:D}),a.createElement(g,{iconName:"textLineHeight",ref:"lineHeightPopUp"},a.createElement(h,{value:this.getLineHeightValue(),onChange:z.bind(this,D,E),onSlideEnd:this.focus})),a.createElement(g,{iconName:"textCharSpacing",ref:"charSpacingPopUp"},a.createElement(m.slider,{value:this.getLetterSpacingValue(),min:-.1,max:.7,stepperMin:-.4,stepperMax:3,step:.05,stepperStep:.01,onChange:A.bind(this,D,E),label:"text_editor_character_spacing_label",onSlideEnd:this.focus})),this.getBooleanValue("bidirtl")?a.createElement(c,{onClick:B.bind(this,D,E),key:"richTextWriteLTR",name:"textWriteDirectionLeft",tooltipValue:this.getTooltipValue("text_direction"),tooltipStyleType:D}):null,this.getBooleanValue("bidiltr")?a.createElement(c,{onClick:C.bind(this,D,E),key:"richTextWriteRTL",name:"textWriteDirectionRight",tooltipValue:this.getTooltipValue("text_direction"),tooltipStyleType:D}):null):null)}return function(){return this.props.hideToolbar?null:D.apply(this,[])}}),define("textControls/comps/textToolBar",["react","lodash","jquery","util","textControls/mixins/textEditorMixin","textControls/mixins/textTooltipMixin","baseUI","textControls/comps/textToolBar.rt"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){return b.some(a,function(a){return a&&a.isExpanded()})}return a.createClass({displayName:"textToolBar",mixins:[d.translationMixin,e,f,g.inputMixin],render:h,getInitialState:function(){return this.richTextInput=this.props.richTextInput,{extraToolbarOpened:!1}},componentWillUnmount:function(){this.state.extraToolbarOpened&&this.changeRichTextHeight(!1)},isAnyDropdownOpen:function(){return i([this.refs.textStyle,this.refs.fontFamily,this.refs.textBullets,this.refs.textAlign,this.refs.backColorButton&&this.refs.backColorButton.refs.dropdown,this.refs.linkDropdownOption&&this.refs.linkDropdownOption.refs.dropdown])},toggleToolbar:function(){var a=!this.state.extraToolbarOpened;this.setState({extraToolbarOpened:a}),this.changeRichTextHeight(a)},getColorPickerPosition:function(a){var b=a?this.refs.foreColorButton.getDOMNode():this.refs.backColorButton.getDOMNode(),d=c(b).offset(),e=d.top-c(document).scrollTop(),f=d.left;return{top:370>=e?e+40:e-370,left:f}},changeRichTextHeight:function(a){var b=this.richTextInput.editor.getResizable().getSize("height");a?b-=50:b+=50,this.richTextInput.editor.resize("100%",b)}})}),define("textControls/comps/richTextInput.rt",["react/addons","lodash","textControls/comps/textToolBar","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement("div",{className:this.getClassName("rich-text-input-control")+" "+(this.props.hideToolbar?"":"with-toolbar")+" "+(this.props.isResizing?"resizing":""),style:this.props.layout,ref:"textStyle"},this.props.hideToolbar?null:a.createElement(c,b.assign({},{key:"textToolbar",ref:"toolbar",richTextInput:this},this.getToolbarProps())),a.createElement("div",{className:"rich-text-content"},a.createElement("div",{ref:"editorContainer"})))}}),define("textControls/utils/textLimitsUtils",["lodash","textControls/utils/ckUtils","panels","textControls/utils/constants"],function(a,b,c,d){"use strict";function g(a){return a>d.MAX_TEXT_LENGTH}function h(a){return Math.max(a,f)>f}function i(d){function f(){k(e)&&(b.setCkReadOnly(d,!1,!0),b.focus(d),c.panelManager.unregisterObserver(f))}a.defer(function(){b.execUndoCommand(d),b.setCkReadOnly(d,!0,!0)}),j(d),c.panelManager.openPanel(e,{isSingleInstance:!0},!0),c.panelManager.registerObserver(f)}function j(a){a.on("key",function(a){k(e)?a.removeListener():27===a.data.keyCode&&(c.panelManager.closePanelByName(e),a.removeListener())})}function k(){return!a.find(c.panelManager.getOpenPanels(),{name:e})}function l(a){f=a}function m(a){return g(a)&&h(a)}var f,e="panels.focusPanels.createNewTextBoxPanel";return{handleTextLengthExceeded:i,setCachedTextReadableLength:l,isNewTextLengthLimitExceeded:m}}),define("textControls/comps/richTextInput",["react","lodash","textControls/utils/richTextManager","textControls/comps/richTextInput.rt","util","textControls/utils/ckUtils","textControls/utils/constants","textControls/utils/fontUtils","textControls/utils/dataUtils","textControls/utils/textLimitsUtils","experiment"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=!1;return a.createClass({displayName:"richTextInput",render:d,mixins:[e.outerClickMixin,e.valueLinkMixin],propTypes:{panelManager:a.PropTypes.object.isRequired,themeColors:a.PropTypes.object.isRequired,themeFonts:a.PropTypes.object.isRequired,documentType:a.PropTypes.string.isRequired,languages:a.PropTypes.array.isRequired,fonts:a.PropTypes.array.isRequired,isFixedHeight:a.PropTypes.bool,isFocusOnInit:a.PropTypes.bool,selectAllOnInit:a.PropTypes.bool,onFocus:a.PropTypes.func,onBlur:a.PropTypes.func,hideToolbar:a.PropTypes.bool,openLinkDialog:a.PropTypes.func.isRequired,
linkDialogPanelName:a.PropTypes.string,openColorPicker:a.PropTypes.func.isRequired,colorPickerPanelName:a.PropTypes.string,shouldLimitTextLength:a.PropTypes.bool},getClassName:function(a){return e.inheritClassName(this.props,a)},getToolbarProps:function(){return b.assign({},b.pick(this.props,["themeColors","themeFonts","fonts","hideToolbar"]))},showScroll:function(){f.removeOverflowCss(this.editor)},hideScroll:function(){f.setOverflowCss(this.editor),f.scrollCkToTop(this.editor)},onOuterClick:function(){this.props.hideToolbar||!this._isFocused||this.isAnySubPanelOpen()||(this._isFocused=!1,this.props.onBlur&&(this.props.onBlur(),this.editor.focusManager&&this.editor.focusManager.blur(!0)))},handleFocus:function(){this.props.hideToolbar&&!this._isFocused&&(this._isFocused=!0,this.props.onFocus&&this.props.onFocus())},isAnySubPanelOpen:function(){return this.isColorPickerOpen||this.isLinkDialogOpen||this.refs.toolbar.isAnyDropdownOpen()},handleHeightChange:function(a){this.isReadyAndVisible()&&b.isFunction(this.props.onHeightChange)&&this.props.onHeightChange(a)},handleCKCreated:function(){this.props.onShow?this.props.onShow(this.showEditor):this.showEditor()},fontsDataGetter:function(a){var b=h.getFontsUrlWithParams(a,this.props.documentType,this.props.languages);return{fonts:a,urls:[b]}},createCK:function(){if(f.isCKLoaded()){var a=i.wrapOrphans(this.getValueFromProps().text);this.editor=f.createCKInstance({handleDataChange:this.handleDataChange,handleHeightChange:this.handleHeightChange,handleSelectionChange:this.handleSelectionChange,handleCKCreated:this.handleCKCreated,handleFocus:this.handleFocus,handlePaste:this.fixLinks,handleCutOrCopy:this.onCutOrCopy},this.refs.editorContainer.getDOMNode(),this.props.isFixedHeight,a,g.DEFAULT_STYLES_MAP,this.props,this.fontsDataGetter)}else setTimeout(this.createCK,50)},onCutOrCopy:function(){c.latestCopiedLinks=b.clone(this._links)},focus:function(){f.focus(this.editor)},selectAll:function(){f.selectAll(this.editor)},showEditor:function(){this.editor.container.show(),this.props.isFocusOnInit&&this.focus(),this.props.selectAllOnInit&&this.selectAll()},getDefaultProps:function(){return{isFocusOnInit:!0}},findCopiedLinkById:function(a){return b.find(c.latestCopiedLinks,{id:a})},cloneLink:function(a){var d,c=this.findCopiedLinkById(a);return c&&(d=b.clone(c),d.id=e.guidUtils.getUniqueId("textLink","_")),d},cloneLinks:function(a){var d,c={};return b.forEach(a,function(a){d=this.cloneLink(a),d&&(c[a]=d)},this),b.keys(c).length!==a.length&&(c=null),c},fixPasteDuplicateLinks:function(a){var c=a.data.pasteString,d=b.map(c.match(/dataquery="#[^"]*/g),function(a){return a.split("#")[1]}),e=this.cloneLinks(d);return e?(b.forEach(e,function(a,b){this._links.push(a),c=c.replace(b,a.id)},this),void(a.data.pasteString=c)):void(a.data.pasteString=i.removeLinksFromHtml(c))},fixExternalLinks:function(a){var b=a.data.pasteString.replace(/<a\s+href=['"](.*?)["'].*?>(.*?)<\/a>/g,function(a,b,c){var d=e.validationExpressions.validUrlReg.test(b);if(d){var f={type:"ExternalLink",target:"_blank",url:b,id:e.guidUtils.getUniqueId("textLink","_")};return this._links.push(f),'<span style="text-decoration:underline"><a dataquery="#'+f.id+'">'+c+"</a></span>"}return c}.bind(this));a.data.pasteString=b},fixLinks:function(a){/<a\s+dataquery/.test(a.data.pasteString)?this.fixPasteDuplicateLinks(a):/<a\s+href/.test(a.data.pasteString)&&this.fixExternalLinks(a)},lockChangeHandler:function(){l=!0},unlockChangeHandler:function(){l=!1,this.handleDataChange()},handleDataChange:function(){if(this.isReadyAndVisible()&&(!k.isOpen("newCK")||!l)){var a=f.getData(this.editor);if(!b.isEqual(a,this._internalTextValue)){this._internalTextValue=a,this.clearUnusedLinks(),this.callOnChangeIfExists({text:a,linkList:this._links});var c=i.getTextContentFromHtml(a).length;this.props.shouldLimitTextLength&&j.isNewTextLengthLimitExceeded(c)&&j.handleTextLengthExceeded(this.editor),j.setCachedTextReadableLength(c)}}},cacheLinks:function(){this.getValueFromProps().linkList?this._links=b.cloneDeep(this.getValueFromProps().linkList):this._links=[]},shouldComponentUpdate:function(){return!(!this.editor||!this.editor.editable())},componentDidMount:function(){this.createCK(),this.fontsMaps=h.calcFontsMaps(this.props.fonts),this.props.layout&&this.props.layout.height&&(this.originalHeight=this.props.layout.height),this._internalTextValue=this.getValueFromProps().text,j.setCachedTextReadableLength(i.getTextContentFromHtml(this._internalTextValue).length),this.cacheLinks()},clearUnusedLinks:function(){var a=[],c=!1;b.forEach(this._links,function(b){-1!==this._internalTextValue.indexOf('<a dataquery="#'+b.id+'"')?a.push(b):c=!0},this),c&&(this._links=a)},componentWillUnmount:function(){f.isEditorReady(this.editor)&&this.editor.destroy()},getSelectionChangeCallbacks:function(){return this.selectionChangeCallbacks||(this.selectionChangeCallbacks=[]),this.selectionChangeCallbacks},registerOnSelectionChange:function(a){this.getSelectionChangeCallbacks().push(a)},unregisterOnSelectionChange:function(a){b.remove(this.getSelectionChangeCallbacks(),function(b){return b===a})},handleSelectionChange:function(){b.forEach(this.getSelectionChangeCallbacks(),function(a){a()})},setCkDataFromProps:function(){this.isReady()?(f.setData(this.editor,this.getValueFromProps().text,g.DEFAULT_STYLES_MAP,this.props),this._internalTextValue=this.getValueFromProps().text):setTimeout(function(){this.setCkDataFromProps()}.bind(this),30)},componentDidUpdate:function(a){var c=b.difference(this.props.languages,a.languages);if(c.length>0){var d=h.getWixStoredFontsCss(c);f.loadFontsToCK(this.editor,{urls:d})}b.isEqual(a.fonts,this.props.fonts)||(this.fontsMaps=h.calcFontsMaps(this.props.fonts)),b.isEqual(a.themeFonts,this.props.themeFonts)&&b.isEqual(a.themeColors,this.props.themeColors)||f.updateThemeStyles(this.props.themeColors,g.DEFAULT_STYLES_MAP,this.props.themeFonts,this.editor),this.getValueFromProps().text!==this._internalTextValue&&(k.isOpen("newCK")?this.setCkDataFromProps():(this._internalTextValue=this.getValueFromProps().text,this.editor.setData(this.getValueFromProps().text))),(k.isOpen("newCK")&&this.isReady()||this.props.isResizing)&&!b.isEqual(this.props.layout,a.layout)&&(this.editor.resize(this.props.layout.width,this.props.layout.height),this.editor.config.autoGrow_minHeight=this.props.layout.height,f.refreshHeightConfig()),this.cacheLinks()},isReadyAndVisible:function(){return this.isReady()&&this.editor.container.isVisible()},isReady:function(){return f.isEditorReady(this.editor)},resetUndo:function(){f.resetUndo(this.editor)}})}),define("textControls/comps/textEffectButton.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("span",{className:this.props.className},a.createElement("button",{className:b.keys(b.pick({"text-effect-button":!0,selected:this.props.isSelected},b.identity)).join(" "),onClick:this.props.onClick},a.createElement("span",{},this.props.children)))}}),define("textControls/comps/textEffectButton",["react","lodash","textControls/comps/textEffectButton.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"textEffectButton",render:c})}),define("textControls/comps/textEffects.rt",["react/addons","lodash","textControls/comps/textEffectButton","symbols","baseUI","textControls/utils/constants"],function(a,b,c,d,e,f){"use strict";function g(){this.handleOnChange(f.CK_OFF)}function h(a,b){this.handleOnChange(a.value,b)}function i(b,d){return a.createElement(c,{isSelected:this.props.value===d,onClick:h.bind(this,b,d),key:d,className:d},a.createElement("span",{className:"text-shadow-effect",style:{textShadow:b.value}},this.translateIfNeeded("text_editor_"+d)))}return function(){return a.createElement.apply(this,["div",{className:"text-effect-container"},a.createElement(e.tooltip,{value:"text_editor_effects_tooltip_no_effect",styleType:e.uiConstants.TOOLTIP.STYLE_TYPE.SMALL},a.createElement("span",{onClick:g.bind(this),className:"text-none-icon "+("EFFECT_0"===this.props.value?"selected":"")})),b.map(this.getShadowEffects(),i.bind(this))])}}),define("textControls/comps/textEffects",["react","lodash","textControls/comps/textEffects.rt","util","textControls/utils/constants","baseUI"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"textEffects",mixins:[d.translationMixin,f.reportUIChangeMixin],render:c,getDefaultProps:function(){return{value:"effect_0",onChange:function(){}}},contextTypes:{reportUIChange:a.PropTypes.func},getShadowEffects:function(){var a=e.EFFECTS;return a.effect_0&&delete a.effect_0,a},handleOnChange:function(a,b){this.props.onChange(a);var c=2===a?"none":b;this.reportUIChange({value:c,control_name:"text_effects"})}})}),define("textControls/comps/textLinkButton.rt",["react/addons","lodash","textControls/comps/iconButton"],function(a,b,c){"use strict";return function(){return a.createElement(c,b.assign({},{name:"Link",onClick:this.openLinkDialog},this.props))}}),define("textControls/comps/textLinkButton",["react","lodash","textControls/comps/textLinkButton.rt","panels"],function(a,b,c,d){"use strict";return a.createClass({displayName:"textLinkButton",mixins:[d.linkToMixin],render:c})}),define("textControls/comps/themeFontsLoader.rt",["react/addons","lodash"],function(a,b){"use strict";function c(b,c){return a.createElement("link",{type:"text/css",key:c,href:b,rel:"stylesheet"})}return function(){return a.createElement.apply(this,["div",{},b.map(this.getCssLinks(),c.bind(this))])}}),define("textControls/comps/themeFontsLoader",["react","lodash","textControls/utils/fontUtils","textControls/comps/themeFontsLoader.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"themeFontsLoader",getCssLinks:function(){return c.getAllCssLinks(this.props.languages,this.props.documentType,this.props.themeFonts)},render:d,shouldComponentUpdate:function(a){return!b.isEqual(a,this.props)}})}),define("textControls/comps/saveTextStyleConfirmation.rt",["react/addons","lodash","panels","baseUI","experiment!saveThemeUIChanges"],function(a,b,c,d,e){"use strict";return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",key:"saveTextConfirmationPanel",helpId:"1df23b96-45a4-41e0-b356-e1ee05308c9b",className:"text-style-save-confirm-panel",title:this.translateIfNeeded("text_editor_save_theme_dialog_header"),panelName:this.props.panelName},a.createElement("div",{className:"text-style-save-confirm-content"},e?a.createElement("div",{className:"image-container",key:"save-your-theme-clipart"},a.createElement(d.symbol,{name:"save-your-theme-clipart"})):null,a.createElement("div",{className:b.keys(b.pick({"description-container":!0,"ui-change":e},b.identity)).join(" ")},a.createElement("span",{className:"description-text"},this.translateIfNeeded("text_editor_save_theme_dialog_text_1")),a.createElement("span",{className:"description-text bold"}," '",this.props.textStyleName,"' "),a.createElement("span",{className:"description-text"},this.translateIfNeeded("text_editor_save_theme_dialog_text_2")),a.createElement("div",{className:"learn-more-link-container"},a.createElement("a",{className:"learn-more-link",onClick:this.openLearnMore},this.translateIfNeeded("text_editor_save_theme_dialog_learn_more")))),a.createElement("div",{className:"footer-buttons"},a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,key:"dontShowAgainCheckbox",label:"text_editor_save_theme_dialog_dont_show",valueLink:this.linkDontShowAgainValue()}),a.createElement(d.button,{onClick:this.handleOnSave,className:"save-button btn-md",label:"text_editor_save_theme_confirm_button"}))))}}),define("textControls/comps/saveTextStyleConfirmation",["react","panels","util","core","textControls/comps/saveTextStyleConfirmation.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"saveTextStyleConfirmation",propTypes:{editorAPI:a.PropTypes.object.isRequired,panelName:a.PropTypes.string.isRequired,dontShowAgainKey:a.PropTypes.string.isRequired,onConfirm:a.PropTypes.func.isRequired,textStyleName:a.PropTypes.string.isRequired,userPrefType:a.PropTypes.oneOf(["site","session","global"])},mixins:[c.translationMixin,d.mixins.editorAPIMixin,b.mixins.reportBiEventOnUiChangeMixin,b.mixins.dontShowAgainMixin],getDefaultProps:function(){return{userPrefType:"session"}},getInitialState:function(){return{dontShowAgain:this.getDontShowAgain()}},handleOnSave:function(){this.props.onConfirm(),this.close()},close:function(){b.panelManager.closePanelByName(this.props.panelName)},openLearnMore:function(){var a={panel_name:this.props.panelName,origin:d.constants.BI.HELP.ORIGIN.PANEL,component:this.props.editorAPI.selection.getSelectedComponentType(),learn_more:!0},c="1df23b96-45a4-41e0-b356-e1ee05308c9b";b.panelManager.openHelpCenter(c,null,null,a)},render:e})}),define("textControls/utils/mobileUtils",["lodash","jquery","textControls/utils/fontUtils"],function(a,b,c){"use strict";function d(a,b){var c={},d=document.createElement("div");return d.innerHTML=a,f(d,c,b,""),parseInt(e(c),10)}function e(b){var c,d="";return a.forEach(b,function(a,b){(void 0===c||a>c)&&(c=a,d=b)}),d}function f(b,c,d,e){"#text"!==b.nodeName&&(e=g(b,d)?g(b,d):e,a.forEach(b.childNodes,function(a){if("#text"===a.nodeName){if(e){var b=a.textContent.replace(/ /g,"").length;c[e]||(c[e]=0),c[e]+=b}}else f(a,c,d,e)}))}function g(d,e){var f=b(d).css("fontSize");return f||a.forEach(d.classList,function(a){e[a]&&(f=c.parseStyleFont(a,e).size)}),f}return{getMostCommonTextSize:d}}),define("textControls/utils/textMigrationDomHelper",["lodash","jquery"],function(a,b){"use strict";function d(a){if(null===a)return"null";if(a.$family)return a.$family();if(a.nodeName){if(1===a.nodeType)return"element";if(3===a.nodeType)return/\S/.test(a.nodeValue)?"textnode":"whitespace"}else if("number"==typeof a.length){if(a.callee)return"arguments";if("item"in a)return"collection"}return typeof a}function e(b){var c=b.attributes,d=[];if(c.length<20)d=g(c);else{var e=b.getProperties("class","style","dir","href","background","action","src","data","align","alt","color","face","label","for","link","id","name","value");a.forEach(e,function(a,b){b&&a&&d.push({name:b,value:a})})}return d}function f(a,b){if(a!==b)for(var c;c=a.firstChild;)b.appendChild(a.removeChild(c))}function g(a){function b(a){for(var b=[],c=a.length;c--;)b.unshift(a[c]);return b}return b(a)}function h(b,c){if(b.tagName.toLowerCase()===c.toLowerCase())return b;var d=document.createElement(c),g=e(b);return a.forEach(g,function(a){d.setAttribute(a.name,a.value)}),f(b,d),b.parentNode&&b.parentNode.replaceChild(d,b),d}function i(b){var d=b.tagName&&b.tagName.toLowerCase();return a.includes(c,d)}function j(a){return a.every(function(a){return"whitespace"===d(a)})}function k(a){return"element"===d(a)}function l(a){return"textnode"===d(a)}function m(b){return a.some(b.children,i)}function n(b){var c=b.parentNode,d=g(b.childNodes);a.forEach(d,function(a){c.insertBefore(a,b)}),c.removeChild(b)}function o(a){var b=e(a);if(!b)return!1;for(var c=0;c<b.length;c++){var d=b[c].value;if(d)return!0}return!1}function p(a,c){var d=b(a);d.removeClass(c),0===d.prop("class").length&&d.removeAttr("class")}function q(a,c){b(a).css(c);var d=a.getAttribute("style");d&&" "===d.charAt(d.length-1)&&a.setAttribute("style",d.substr(0,d.length-1))}var c=["audio","dd","dt","li","video","address","article","aside","blockquote","details","div","dl","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","menu","nav","ol","p","pre","section","table","ul","center","dir","noframes"];return{moveChildren:f,collectionToArray:g,isBlockElement:i,hasBlockElementChildren:m,isDomElement:k,isTextNode:l,isElementHasAttributes:o,replaceElementWithItsChildren:n,renameNode:h,isOnlyWhiteSpace:j,removeClass:p,setStyle:q}}),define("textControls/utils/textMigrationStylesHelper",["jquery","lodash","textControls/utils/textMigrationDomHelper","textControls/utils/fontUtils"],function(a,b,c,d){"use strict";function e(a){var b=a.classList;if(!b)return null;for(var c=0;c<b.length;c++)if(b[c].indexOf("font_")>-1)return b[c];return null}function f(b,d){if(e(b))return b;var g=a(b).clone();g.empty();for(var i=c.collectionToArray(b.childNodes),j=0;j<i.length;j++){var k=i[j];if(e(k)||h(k)){var l=a(k).clone();l.empty();var m=f(k,l.get(0));return g.append(a(m)),l.get(0).firstChild&&a(d).append(l),g.get(0)}a(d).append(a(k))}return g.get(0)}function g(b){if(h(b)){var d=a(b).clone(!1);d.empty();for(var i=c.collectionToArray(b.childNodes),k=0;k<i.length;k++){var l=i[k];if(e(l)||h(l)){var m=a(l).clone(!1);m.empty();var n=f(l,m);return m.get(0).firstChild&&d.append(m),a(b).before(d),a(b).before(a(n)),j(n),void g(b)}d.append(a(l))}}}function h(b){return c.isDomElement(b)&&a(b).find('span[class*="font_"]').length}function i(a,d){if(c.isDomElement(a)){var f=e(a);f&&"span"===a.tagName.toLowerCase()?d.push(a):b.forEach(a.children,function(a){d.concat(i(a,d))})}return d}function j(a){if(e(a)&&g(a),h(a)){var c=i(a,[]);b.forEach(c,g)}}function k(a){if(c.isTextNode(a))return!0;if(e(a))return!1;for(var b=c.collectionToArray(a.childNodes),d=0;d<b.length;d++)if(k(b[d]))return!0;return!1}function l(a){var c=0,d=null;return b.forEach(a,function(a,b){a>c&&(c=a,d=b)}),d}function m(a){var c={};return b.forEach(a,function(a){var b=e(a);c[b]=c[b]||0,c[b]+=a.textContent.length}),l(c)}function n(a,b,c,e){var f=a&&d.parseStyleFont(a,c,e),g=d.parseStyleFont(b,c,e);return g?f&&f.color===g.color?null:"#"===g.color.charAt(0)?{isRef:!1,value:g.color}:{isRef:!0,value:g.color.replace("{","").replace("}","")}:null}function p(a,c,e,f){var g=a&&d.parseStyleFont(a,e,f),h=d.parseStyleFont(c,e,f),i={};return b.forEach(o,function(a,b){g&&g[a]===h[a]||(i[b]=h[a])}),i}var o={"font-family":"family","font-size":"size","font-style":"style","font-variant":"variant","font-weight":"weight","line-height":"lineHeight"};return{flattenStyledSpans:j,isBlockContainUnstyledText:k,getStyledSpansRecursive:i,getMostCommonStyle:m,getElementStyleClass:e,getStyleDelta:p,getColorDelta:n}}),define("textControls/utils/textStylesMigration",["lodash","jquery","textControls/utils/textMigrationDomHelper","textControls/utils/textMigrationStylesHelper","textControls/utils/fontUtils","textControls/utils/constants"],function(a,b,c,d,e,f){"use strict";function j(b,e,f,g){a.forEach(e,function(a){var e=d.getElementStyleClass(a);e===b?0===a.childNodes.length?a.remove():k(a,b):(c.removeClass(a,e),l(b,e,a,f,g))})}function k(a,d){b(a).removeClass(d),c.isElementHasAttributes(a)||c.replaceElementWithItsChildren(a)}function l(a,e,f,g,h){var i=d.getStyleDelta(a,e,g,h),j=f;c.setStyle(j,i);var k=d.getColorDelta(a,e,g,h);k&&(k.isRef?b(j).addClass(k.value):c.setStyle(j,{color:k.value}))}function m(b,d,f,g){var h;if(a.includes(a.keys(f),d)){var i=e.parseStyleFont(d,f,g);h=i.lineHeight,c.setStyle(b,{"line-height":h}),n(b,h),b=o(b,d)}return b}function n(a,b){var d=document.createElement("span");c.setStyle(d,{"line-height":b}),c.moveChildren(a,d),a.appendChild(d)}function o(a,b){var d=i[b];return c.renameNode(a,d)}function p(b){return a.includes(h,b)}function q(a){return p(a)?f.FALLBACK_STYLE_CLASS:a}function r(a,c,e){var f=d.getStyledSpansRecursive(a,[]),g=d.getMostCommonStyle(f),h=null;if(g){var i=q(g);return i!==g&&(h=g,g=i),b(a).addClass(g),j(g,f,c,e),h&&s(a,g,h,c,e),g}return null}function s(a,b,d,f,g){var h=e.parseStyleFont(d,f,g).size,i=e.parseStyleFont(b,f,g).size;i>h&&c.setStyle(a,{"font-size":h})}function t(a,d,e){if(!d||!e)return null;if(a&&a.tagName===d&&a.hasClass(e))return null;var f=c.renameNode(a,d);return b(f).addClass(e),f}function u(a,b,c,e,f){if(0!==a.childNodes.length){d.flattenStyledSpans(a);var g=null;if(d.isBlockContainUnstyledText(a)){var h=t(a,b,c),i=d.getStyledSpansRecursive(h,[]);j(null,i,e,f)}else g=r(a,e,f),g&&m(a,g,e,f);v(a,g,e,f)}}function v(a,c,d,e){var f=b(a).find('span[class*="font_"]');f.length&&j(c,f,d,e)}function w(a,d,e,f,g){if(!c.isOnlyWhiteSpace(a)){var h=document.createElement("p");b(a[0]).before(b(h)),b(h).append(b(a)),u(h,d,e,f,g)}}function x(b,d,e,f,h){var i=[],j=c.collectionToArray(b.childNodes);a.forEach(j,function(b){if(c.isBlockElement(b)){i.length>0&&(w(i,d,e,f,h),i=[]);var j=!a.includes(g,b.tagName.toLowerCase())||c.hasBlockElementChildren(b);j?x(b,d,e,f,h):u(b,d,e,f,h)}else i.push(b)}),i.length>0&&w(i,d,e,f,h)}var g=["h1","h2","h3","h4","h5","h6","p","div"],h=["font_1","font_10"],i=a.transform(f.DEFAULT_STYLES_MAP,function(a,b){a[b.cssClass]=b.seoTag});return{migrateElement:x,verifyNoStyledSpans:v}}),define("textControls/utils/textSimpleFormatMigration",["lodash","jquery","textControls/utils/textMigrationDomHelper","textControls/utils/textMigrationStylesHelper","textControls/utils/constants"],function(a,b,c,d,e){"use strict";function f(a){g(a),h(a),i(a),j(a),k(a),l(a),m(a)}function g(a){var c=b(a).find(".bold");n(c,"bold","strong")}function h(a){var c=b(a).find(".italic");n(c,"italic","em")}function i(a){var c=b(a).find(".underline");n(c,"underline","u")}function j(a){var c=b(a).find(".alignRight");o(c,"alignRight","text-align","right")}function k(a){var c=b(a).find(".alignCenter");o(c,"alignCenter","text-align","center")}function l(a){var c=b(a).find(".alignJustify");o(c,"alignJustify","text-align","justify")}function m(c){var f=b(c).find("ul, ol");a.forEach(f,function(a){d.getElementStyleClass(a)||b(a).addClass(e.DEFAULT_STYLE_CLASS)})}function n(d,e,f){a.forEach(d,function(a){var d=document.createElement(f);c.moveChildren(a,d),c.removeClass(a,e),c.isElementHasAttributes(a)||"span"!==a.nodeName.toLowerCase()?b(a).append(b(d)):b(a).replaceWith(b(d))})}function o(b,d,e,f){a.forEach(b,function(a){c.removeClass(a,d);var b={};b[e]=f,c.setStyle(a,b)})}return{migrateElement:f}}),define("textControls/utils/textMigrationHandler",["lodash","textControls/utils/textStylesMigration","textControls/utils/textSimpleFormatMigration"],function(a,b,c){"use strict";function d(d,e,f,g,h){if(g=g||"p",h=h||"font_8",!a.isString(d))return null;if(""===d)return a.template('<<%= defaultTag %> class="<%= defaultClass %>"></<%= defaultTag %>>')({defaultTag:g,defaultClass:h});var i=document.createElement("div");return i.innerHTML=d,b.migrateElement(i,g,h,e,f),c.migrateElement(i),i.innerHTML}return{migrateText:d}}),define("textControls/utils/migrationUtils",["lodash","textControls/utils/textMigrationHandler"],function(a,b){"use strict";function c(a,b){var c=b.components.data.get(a);return"StyledText"!==c.type&&"MediaRichText"!==c.type}function d(c,d,e,f,g){function i(b,c){return!a.includes(["id","metaData"],c)}var h=b.migrateText(c.text,d,e,f,g),j=a.omit(c,i);return j.type="StyledText",j.stylesMapId="CK_EDITOR_PARAGRAPH_STYLES",j.text=h,j}function e(a,b){var c=b.components.data.get(a);c=d(c,b.theme.fonts.getAll(),b.theme.colors.getAll()),b.components.data.update(a,c,!0),b.components.style.setId(a,"txtNew")}return{isOldTextComponent:c,migrateComponent:e}}),define("textControls/mixins/textBiMixin",["react","baseUI","core","lodash"],function(a,b,c,d){"use strict";return{sendTextBiEvent:function(a,b){this.getEditorAPI().bi.event(c.bi.events.textControls[a],b)},sendTextBiEventWithPanelName:function(a,b){var c=this.constructor.displayName,e=d.merge({panel_name:c},b);this.sendTextBiEvent(a,e)}}}),define("textControls/mixins/textPanelMixin",["react","baseUI","core"],function(a,b,c){"use strict";return{mixins:[c.mixins.editorAPIMixin],componentDidMount:function(){this.richTextInput||this.getEditorAPI().text.startEditing()}}}),define("textControls",["react","textControls/comps/richTextInput","textControls/comps/iconButton","textControls/comps/fontFamily","textControls/comps/iconsDropDown","textControls/comps/textBackgroundColor","textControls/comps/textLinkControl","textControls/comps/textStyle","textControls/comps/textColor","textControls/comps/textEffects","textControls/comps/lineHeight","textControls/comps/textLinkButton","textControls/comps/textPopup","textControls/comps/themeFontsLoader","textControls/comps/saveTextStyleConfirmation","textControls/utils/constants","textControls/utils/fontUtils","textControls/utils/dataUtils","textControls/utils/mobileUtils","textControls/utils/shadowUtils","textControls/utils/migrationUtils","textControls/mixins/textTooltipMixin","textControls/mixins/textEditorMixin","textControls/mixins/textBiMixin","textControls/mixins/textPanelMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){"use strict";return{textStyle:h,fontFamily:d,iconButton:c,iconsDropDown:e,textBackgroundColor:f,textLinkControl:g,richTextInput:b,textColor:i,textEffects:j,lineHeight:k,textLinkButton:l,textPopup:m,themeFontsLoader:n,constants:p,fontUtils:q,dataUtils:r,mobileUtils:s,shadowUtils:t,textTooltipMixin:v,saveTextStyleConfirmation:o,textEditorMixin:w,migrationUtils:u,textBiMixin:x,textPanelMixin:y}});